/*!---- jquery-ui-min-----*/
$j = jQuery.noConflict();

/*! jQuery UI - v1.10.0 - 2013-01-17
 * http://jqueryui.com
 * Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.resizable.js, jquery.ui.selectable.js, jquery.ui.sortable.js, jquery.ui.effect.js, jquery.ui.accordion.js, jquery.ui.autocomplete.js, jquery.ui.button.js, jquery.ui.datepicker.js, jquery.ui.dialog.js, jquery.ui.effect-blind.js, jquery.ui.effect-bounce.js, jquery.ui.effect-clip.js, jquery.ui.effect-drop.js, jquery.ui.effect-explode.js, jquery.ui.effect-fade.js, jquery.ui.effect-fold.js, jquery.ui.effect-highlight.js, jquery.ui.effect-pulsate.js, jquery.ui.effect-scale.js, jquery.ui.effect-shake.js, jquery.ui.effect-slide.js, jquery.ui.effect-transfer.js, jquery.ui.menu.js, jquery.ui.position.js, jquery.ui.progressbar.js, jquery.ui.slider.js, jquery.ui.spinner.js, jquery.ui.tabs.js, jquery.ui.tooltip.js
 * Copyright 2013 jQuery Foundation and other contributors; Licensed MIT */
(function(e, t) {
    function i(t, n) {
        var r, i, o, u = t.nodeName.toLowerCase();
        return "area" === u ? (r = t.parentNode, i = r.name, !t.href || !i || r.nodeName.toLowerCase() !== "map" ? !1 : (o = e("img[usemap=#" + i + "]")[0], !!o && s(o))) : (/input|select|textarea|button|object/.test(u) ? !t.disabled : "a" === u ? t.href || n : n) && s(t)
    }

    function s(t) {
        return e.expr.filters.visible(t) && !e(t).parents().addBack().filter(function() {
            return e.css(this, "visibility") === "hidden"
        }).length
    }
    var n = 0,
        r = /^ui-id-\d+$/;
    e.ui = e.ui || {};
    if (e.ui.version) return;
    e.extend(e.ui, {
        version: "1.10.0",
        keyCode: {
            BACKSPACE: 8,
            COMMA: 188,
            DELETE: 46,
            DOWN: 40,
            END: 35,
            ENTER: 13,
            ESCAPE: 27,
            HOME: 36,
            LEFT: 37,
            NUMPAD_ADD: 107,
            NUMPAD_DECIMAL: 110,
            NUMPAD_DIVIDE: 111,
            NUMPAD_ENTER: 108,
            NUMPAD_MULTIPLY: 106,
            NUMPAD_SUBTRACT: 109,
            PAGE_DOWN: 34,
            PAGE_UP: 33,
            PERIOD: 190,
            RIGHT: 39,
            SPACE: 32,
            TAB: 9,
            UP: 38
        }
    }), e.fn.extend({
        _focus: e.fn.focus,
        focus: function(t, n) {
            return typeof t == "number" ? this.each(function() {
                var r = this;
                setTimeout(function() {
                    e(r).focus(), n && n.call(r)
                }, t)
            }) : this._focus.apply(this, arguments)
        },
        scrollParent: function() {
            var t;
            return e.ui.ie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? t = this.parents().filter(function() {
                return /(relative|absolute|fixed)/.test(e.css(this, "position")) && /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"))
            }).eq(0) : t = this.parents().filter(function() {
                return /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"))
            }).eq(0), /fixed/.test(this.css("position")) || !t.length ? e(document) : t
        },
        zIndex: function(n) {
            if (n !== t) return this.css("zIndex", n);
            if (this.length) {
                var r = e(this[0]),
                    i, s;
                while (r.length && r[0] !== document) {
                    i = r.css("position");
                    if (i === "absolute" || i === "relative" || i === "fixed") {
                        s = parseInt(r.css("zIndex"), 10);
                        if (!isNaN(s) && s !== 0) return s
                    }
                    r = r.parent()
                }
            }
            return 0
        },
        uniqueId: function() {
            return this.each(function() {
                this.id || (this.id = "ui-id-" + ++n)
            })
        },
        removeUniqueId: function() {
            return this.each(function() {
                r.test(this.id) && e(this).removeAttr("id")
            })
        }
    }), e.extend(e.expr[":"], {
        data: e.expr.createPseudo ? e.expr.createPseudo(function(t) {
            return function(n) {
                return !!e.data(n, t)
            }
        }) : function(t, n, r) {
            return !!e.data(t, r[3])
        },
        focusable: function(t) {
            return i(t, !isNaN(e.attr(t, "tabindex")))
        },
        tabbable: function(t) {
            var n = e.attr(t, "tabindex"),
                r = isNaN(n);
            return (r || n >= 0) && i(t, !r)
        }
    }), e("<a>").outerWidth(1).jquery || e.each(["Width", "Height"], function(n, r) {
        function u(t, n, r, s) {
            return e.each(i, function() {
                n -= parseFloat(e.css(t, "padding" + this)) || 0, r && (n -= parseFloat(e.css(t, "border" + this + "Width")) || 0), s && (n -= parseFloat(e.css(t, "margin" + this)) || 0)
            }), n
        }
        var i = r === "Width" ? ["Left", "Right"] : ["Top", "Bottom"],
            s = r.toLowerCase(),
            o = {
                innerWidth: e.fn.innerWidth,
                innerHeight: e.fn.innerHeight,
                outerWidth: e.fn.outerWidth,
                outerHeight: e.fn.outerHeight
            };
        e.fn["inner" + r] = function(n) {
            return n === t ? o["inner" + r].call(this) : this.each(function() {
                e(this).css(s, u(this, n) + "px")
            })
        }, e.fn["outer" + r] = function(t, n) {
            return typeof t != "number" ? o["outer" + r].call(this, t) : this.each(function() {
                e(this).css(s, u(this, t, !0, n) + "px")
            })
        }
    }), e.fn.addBack || (e.fn.addBack = function(e) {
        return this.add(e == null ? this.prevObject : this.prevObject.filter(e))
    }), e("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (e.fn.removeData = function(t) {
        return function(n) {
            return arguments.length ? t.call(this, e.camelCase(n)) : t.call(this)
        }
    }(e.fn.removeData)), e.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()), e.support.selectstart = "onselectstart" in document.createElement("div"), e.fn.extend({
        disableSelection: function() {
            return this.bind((e.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", function(e) {
                e.preventDefault()
            })
        },
        enableSelection: function() {
            return this.unbind(".ui-disableSelection")
        }
    }), e.extend(e.ui, {
        plugin: {
            add: function(t, n, r) {
                var i, s = e.ui[t].prototype;
                for (i in r) s.plugins[i] = s.plugins[i] || [], s.plugins[i].push([n, r[i]])
            },
            call: function(e, t, n) {
                var r, i = e.plugins[t];
                if (!i || !e.element[0].parentNode || e.element[0].parentNode.nodeType === 11) return;
                for (r = 0; r < i.length; r++) e.options[i[r][0]] && i[r][1].apply(e.element, n)
            }
        },
        hasScroll: function(t, n) {
            if (e(t).css("overflow") === "hidden") return !1;
            var r = n && n === "left" ? "scrollLeft" : "scrollTop",
                i = !1;
            return t[r] > 0 ? !0 : (t[r] = 1, i = t[r] > 0, t[r] = 0, i)
        }
    })
})(jQuery),
function(e, t) {
    var n = 0,
        r = Array.prototype.slice,
        i = e.cleanData;
    e.cleanData = function(t) {
        for (var n = 0, r;
            (r = t[n]) != null; n++) try {
            e(r).triggerHandler("remove")
        } catch (s) {}
        i(t)
    }, e.widget = function(t, n, r) {
        var i, s, o, u, a = {},
            f = t.split(".")[0];
        t = t.split(".")[1], i = f + "-" + t, r || (r = n, n = e.Widget), e.expr[":"][i.toLowerCase()] = function(t) {
            return !!e.data(t, i)
        }, e[f] = e[f] || {}, s = e[f][t], o = e[f][t] = function(e, t) {
            if (!this._createWidget) return new o(e, t);
            arguments.length && this._createWidget(e, t)
        }, e.extend(o, s, {
            version: r.version,
            _proto: e.extend({}, r),
            _childConstructors: []
        }), u = new n, u.options = e.widget.extend({}, u.options), e.each(r, function(t, r) {
            if (!e.isFunction(r)) {
                a[t] = r;
                return
            }
            a[t] = function() {
                var e = function() {
                        return n.prototype[t].apply(this, arguments)
                    },
                    i = function(e) {
                        return n.prototype[t].apply(this, e)
                    };
                return function() {
                    var t = this._super,
                        n = this._superApply,
                        s;
                    return this._super = e, this._superApply = i, s = r.apply(this, arguments), this._super = t, this._superApply = n, s
                }
            }()
        }), o.prototype = e.widget.extend(u, {
            widgetEventPrefix: s ? u.widgetEventPrefix : t
        }, a, {
            constructor: o,
            namespace: f,
            widgetName: t,
            widgetFullName: i
        }), s ? (e.each(s._childConstructors, function(t, n) {
            var r = n.prototype;
            e.widget(r.namespace + "." + r.widgetName, o, n._proto)
        }), delete s._childConstructors) : n._childConstructors.push(o), e.widget.bridge(t, o)
    }, e.widget.extend = function(n) {
        var i = r.call(arguments, 1),
            s = 0,
            o = i.length,
            u, a;
        for (; s < o; s++)
            for (u in i[s]) a = i[s][u], i[s].hasOwnProperty(u) && a !== t && (e.isPlainObject(a) ? n[u] = e.isPlainObject(n[u]) ? e.widget.extend({}, n[u], a) : e.widget.extend({}, a) : n[u] = a);
        return n
    }, e.widget.bridge = function(n, i) {
        var s = i.prototype.widgetFullName || n;
        e.fn[n] = function(o) {
            var u = typeof o == "string",
                a = r.call(arguments, 1),
                f = this;
            return o = !u && a.length ? e.widget.extend.apply(null, [o].concat(a)) : o, u ? this.each(function() {
                var r, i = e.data(this, s);
                if (!i) return e.error("cannot call methods on " + n + " prior to initialization; " + "attempted to call method '" + o + "'");
                if (!e.isFunction(i[o]) || o.charAt(0) === "_") return e.error("no such method '" + o + "' for " + n + " widget instance");
                r = i[o].apply(i, a);
                if (r !== i && r !== t) return f = r && r.jquery ? f.pushStack(r.get()) : r, !1
            }) : this.each(function() {
                var t = e.data(this, s);
                t ? t.option(o || {})._init() : e.data(this, s, new i(o, this))
            }), f
        }
    }, e.Widget = function() {}, e.Widget._childConstructors = [], e.Widget.prototype = {
        widgetName: "widget",
        widgetEventPrefix: "",
        defaultElement: "<div>",
        options: {
            disabled: !1,
            create: null
        },
        _createWidget: function(t, r) {
            r = e(r || this.defaultElement || this)[0], this.element = e(r), this.uuid = n++, this.eventNamespace = "." + this.widgetName + this.uuid, this.options = e.widget.extend({}, this.options, this._getCreateOptions(), t), this.bindings = e(), this.hoverable = e(), this.focusable = e(), r !== this && (e.data(r, this.widgetFullName, this), this._on(!0, this.element, {
                remove: function(e) {
                    e.target === r && this.destroy()
                }
            }), this.document = e(r.style ? r.ownerDocument : r.document || r), this.window = e(this.document[0].defaultView || this.document[0].parentWindow)), this._create(), this._trigger("create", null, this._getCreateEventData()), this._init()
        },
        _getCreateOptions: e.noop,
        _getCreateEventData: e.noop,
        _create: e.noop,
        _init: e.noop,
        destroy: function() {
            this._destroy(), this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)), this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled " + "ui-state-disabled"), this.bindings.unbind(this.eventNamespace), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")
        },
        _destroy: e.noop,
        widget: function() {
            return this.element
        },
        option: function(n, r) {
            var i = n,
                s, o, u;
            if (arguments.length === 0) return e.widget.extend({}, this.options);
            if (typeof n == "string") {
                i = {}, s = n.split("."), n = s.shift();
                if (s.length) {
                    o = i[n] = e.widget.extend({}, this.options[n]);
                    for (u = 0; u < s.length - 1; u++) o[s[u]] = o[s[u]] || {}, o = o[s[u]];
                    n = s.pop();
                    if (r === t) return o[n] === t ? null : o[n];
                    o[n] = r
                } else {
                    if (r === t) return this.options[n] === t ? null : this.options[n];
                    i[n] = r
                }
            }
            return this._setOptions(i), this
        },
        _setOptions: function(e) {
            var t;
            for (t in e) this._setOption(t, e[t]);
            return this
        },
        _setOption: function(e, t) {
            return this.options[e] = t, e === "disabled" && (this.widget().toggleClass(this.widgetFullName + "-disabled ui-state-disabled", !!t).attr("aria-disabled", t), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")), this
        },
        enable: function() {
            return this._setOption("disabled", !1)
        },
        disable: function() {
            return this._setOption("disabled", !0)
        },
        _on: function(t, n, r) {
            var i, s = this;
            typeof t != "boolean" && (r = n, n = t, t = !1), r ? (n = i = e(n), this.bindings = this.bindings.add(n)) : (r = n, n = this.element, i = this.widget()), e.each(r, function(r, o) {
                function u() {
                    if (!t && (s.options.disabled === !0 || e(this).hasClass("ui-state-disabled"))) return;
                    return (typeof o == "string" ? s[o] : o).apply(s, arguments)
                }
                typeof o != "string" && (u.guid = o.guid = o.guid || u.guid || e.guid++);
                var a = r.match(/^(\w+)\s*(.*)$/),
                    f = a[1] + s.eventNamespace,
                    l = a[2];
                l ? i.delegate(l, f, u) : n.bind(f, u)
            })
        },
        _off: function(e, t) {
            t = (t || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, e.unbind(t).undelegate(t)
        },
        _delay: function(e, t) {
            function n() {
                return (typeof e == "string" ? r[e] : e).apply(r, arguments)
            }
            var r = this;
            return setTimeout(n, t || 0)
        },
        _hoverable: function(t) {
            this.hoverable = this.hoverable.add(t), this._on(t, {
                mouseenter: function(t) {
                    e(t.currentTarget).addClass("ui-state-hover")
                },
                mouseleave: function(t) {
                    e(t.currentTarget).removeClass("ui-state-hover")
                }
            })
        },
        _focusable: function(t) {
            this.focusable = this.focusable.add(t), this._on(t, {
                focusin: function(t) {
                    e(t.currentTarget).addClass("ui-state-focus")
                },
                focusout: function(t) {
                    e(t.currentTarget).removeClass("ui-state-focus")
                }
            })
        },
        _trigger: function(t, n, r) {
            var i, s, o = this.options[t];
            r = r || {}, n = e.Event(n), n.type = (t === this.widgetEventPrefix ? t : this.widgetEventPrefix + t).toLowerCase(), n.target = this.element[0], s = n.originalEvent;
            if (s)
                for (i in s) i in n || (n[i] = s[i]);
            return this.element.trigger(n, r), !(e.isFunction(o) && o.apply(this.element[0], [n].concat(r)) === !1 || n.isDefaultPrevented())
        }
    }, e.each({
        show: "fadeIn",
        hide: "fadeOut"
    }, function(t, n) {
        e.Widget.prototype["_" + t] = function(r, i, s) {
            typeof i == "string" && (i = {
                effect: i
            });
            var o, u = i ? i === !0 || typeof i == "number" ? n : i.effect || n : t;
            i = i || {}, typeof i == "number" && (i = {
                duration: i
            }), o = !e.isEmptyObject(i), i.complete = s, i.delay && r.delay(i.delay), o && e.effects && e.effects.effect[u] ? r[t](i) : u !== t && r[u] ? r[u](i.duration, i.easing, s) : r.queue(function(n) {
                e(this)[t](), s && s.call(r[0]), n()
            })
        }
    })
}(jQuery),
function(e, t) {
    var n = !1;
    e(document).mouseup(function() {
        n = !1
    }), e.widget("ui.mouse", {
        version: "1.10.0",
        options: {
            cancel: "input,textarea,button,select,option",
            distance: 1,
            delay: 0
        },
        _mouseInit: function() {
            var t = this;
            this.element.bind("mousedown." + this.widgetName, function(e) {
                return t._mouseDown(e)
            }).bind("click." + this.widgetName, function(n) {
                if (!0 === e.data(n.target, t.widgetName + ".preventClickEvent")) return e.removeData(n.target, t.widgetName + ".preventClickEvent"), n.stopImmediatePropagation(), !1
            }), this.started = !1
        },
        _mouseDestroy: function() {
            this.element.unbind("." + this.widgetName), this._mouseMoveDelegate && e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate)
        },
        _mouseDown: function(t) {
            if (n) return;
            this._mouseStarted && this._mouseUp(t), this._mouseDownEvent = t;
            var r = this,
                i = t.which === 1,
                s = typeof this.options.cancel == "string" && t.target.nodeName ? e(t.target).closest(this.options.cancel).length : !1;
            if (!i || s || !this._mouseCapture(t)) return !0;
            this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function() {
                r.mouseDelayMet = !0
            }, this.options.delay));
            if (this._mouseDistanceMet(t) && this._mouseDelayMet(t)) {
                this._mouseStarted = this._mouseStart(t) !== !1;
                if (!this._mouseStarted) return t.preventDefault(), !0
            }
            return !0 === e.data(t.target, this.widgetName + ".preventClickEvent") && e.removeData(t.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function(e) {
                return r._mouseMove(e)
            }, this._mouseUpDelegate = function(e) {
                return r._mouseUp(e)
            }, e(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), t.preventDefault(), n = !0, !0
        },
        _mouseMove: function(t) {
            return e.ui.ie && (!document.documentMode || document.documentMode < 9) && !t.button ? this._mouseUp(t) : this._mouseStarted ? (this._mouseDrag(t), t.preventDefault()) : (this._mouseDistanceMet(t) && this._mouseDelayMet(t) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, t) !== !1, this._mouseStarted ? this._mouseDrag(t) : this._mouseUp(t)), !this._mouseStarted)
        },
        _mouseUp: function(t) {
            return e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, t.target === this._mouseDownEvent.target && e.data(t.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(t)), !1
        },
        _mouseDistanceMet: function(e) {
            return Math.max(Math.abs(this._mouseDownEvent.pageX - e.pageX), Math.abs(this._mouseDownEvent.pageY - e.pageY)) >= this.options.distance
        },
        _mouseDelayMet: function() {
            return this.mouseDelayMet
        },
        _mouseStart: function() {},
        _mouseDrag: function() {},
        _mouseStop: function() {},
        _mouseCapture: function() {
            return !0
        }
    })
}(jQuery),
function(e, t) {
    e.widget("ui.draggable", e.ui.mouse, {
        version: "1.10.0",
        widgetEventPrefix: "drag",
        options: {
            addClasses: !0,
            appendTo: "parent",
            axis: !1,
            connectToSortable: !1,
            containment: !1,
            cursor: "auto",
            cursorAt: !1,
            grid: !1,
            handle: !1,
            helper: "original",
            iframeFix: !1,
            opacity: !1,
            refreshPositions: !1,
            revert: !1,
            revertDuration: 500,
            scope: "default",
            scroll: !0,
            scrollSensitivity: 20,
            scrollSpeed: 20,
            snap: !1,
            snapMode: "both",
            snapTolerance: 20,
            stack: !1,
            zIndex: !1,
            drag: null,
            start: null,
            stop: null
        },
        _create: function() {
            this.options.helper === "original" && !/^(?:r|a|f)/.test(this.element.css("position")) && (this.element[0].style.position = "relative"), this.options.addClasses && this.element.addClass("ui-draggable"), this.options.disabled && this.element.addClass("ui-draggable-disabled"), this._mouseInit()
        },
        _destroy: function() {
            this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"), this._mouseDestroy()
        },
        _mouseCapture: function(t) {
            var n = this.options;
            return this.helper || n.disabled || e(t.target).closest(".ui-resizable-handle").length > 0 ? !1 : (this.handle = this._getHandle(t), this.handle ? (e(n.iframeFix === !0 ? "iframe" : n.iframeFix).each(function() {
                e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({
                    width: this.offsetWidth + "px",
                    height: this.offsetHeight + "px",
                    position: "absolute",
                    opacity: "0.001",
                    zIndex: 1e3
                }).css(e(this).offset()).appendTo("body")
            }), !0) : !1)
        },
        _mouseStart: function(t) {
            var n = this.options;
            return this.helper = this._createHelper(t), this.helper.addClass("ui-draggable-dragging"), this._cacheHelperProportions(), e.ui.ddmanager && (e.ui.ddmanager.current = this), this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(), this.offset = this.positionAbs = this.element.offset(), this.offset = {
                top: this.offset.top - this.margins.top,
                left: this.offset.left - this.margins.left
            }, e.extend(this.offset, {
                click: {
                    left: t.pageX - this.offset.left,
                    top: t.pageY - this.offset.top
                },
                parent: this._getParentOffset(),
                relative: this._getRelativeOffset()
            }), this.originalPosition = this.position = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, n.cursorAt && this._adjustOffsetFromHelper(n.cursorAt), n.containment && this._setContainment(), this._trigger("start", t) === !1 ? (this._clear(), !1) : (this._cacheHelperProportions(), e.ui.ddmanager && !n.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this._mouseDrag(t, !0), e.ui.ddmanager && e.ui.ddmanager.dragStart(this, t), !0)
        },
        _mouseDrag: function(t, n) {
            this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute");
            if (!n) {
                var r = this._uiHash();
                if (this._trigger("drag", t, r) === !1) return this._mouseUp({}), !1;
                this.position = r.position
            }
            if (!this.options.axis || this.options.axis !== "y") this.helper[0].style.left = this.position.left + "px";
            if (!this.options.axis || this.options.axis !== "x") this.helper[0].style.top = this.position.top + "px";
            return e.ui.ddmanager && e.ui.ddmanager.drag(this, t), !1
        },
        _mouseStop: function(t) {
            var n, r = this,
                i = !1,
                s = !1;
            e.ui.ddmanager && !this.options.dropBehaviour && (s = e.ui.ddmanager.drop(this, t)), this.dropped && (s = this.dropped, this.dropped = !1), n = this.element[0];
            while (n && (n = n.parentNode)) n === document && (i = !0);
            return !i && this.options.helper === "original" ? !1 : (this.options.revert === "invalid" && !s || this.options.revert === "valid" && s || this.options.revert === !0 || e.isFunction(this.options.revert) && this.options.revert.call(this.element, s) ? e(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function() {
                r._trigger("stop", t) !== !1 && r._clear()
            }) : this._trigger("stop", t) !== !1 && this._clear(), !1)
        },
        _mouseUp: function(t) {
            return e("div.ui-draggable-iframeFix").each(function() {
                this.parentNode.removeChild(this)
            }), e.ui.ddmanager && e.ui.ddmanager.dragStop(this, t), e.ui.mouse.prototype._mouseUp.call(this, t)
        },
        cancel: function() {
            return this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear(), this
        },
        _getHandle: function(t) {
            var n = !this.options.handle || !e(this.options.handle, this.element).length ? !0 : !1;
            return e(this.options.handle, this.element).find("*").addBack().each(function() {
                this === t.target && (n = !0)
            }), n
        },
        _createHelper: function(t) {
            var n = this.options,
                r = e.isFunction(n.helper) ? e(n.helper.apply(this.element[0], [t])) : n.helper === "clone" ? this.element.clone().removeAttr("id") : this.element;
            return r.parents("body").length || r.appendTo(n.appendTo === "parent" ? this.element[0].parentNode : n.appendTo), r[0] !== this.element[0] && !/(fixed|absolute)/.test(r.css("position")) && r.css("position", "absolute"), r
        },
        _adjustOffsetFromHelper: function(t) {
            typeof t == "string" && (t = t.split(" ")), e.isArray(t) && (t = {
                left: +t[0],
                top: +t[1] || 0
            }), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
        },
        _getParentOffset: function() {
            this.offsetParent = this.helper.offsetParent();
            var t = this.offsetParent.offset();
            this.cssPosition === "absolute" && this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop());
            if (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() === "html" && e.ui.ie) t = {
                top: 0,
                left: 0
            };
            return {
                top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
                left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
            }
        },
        _getRelativeOffset: function() {
            if (this.cssPosition === "relative") {
                var e = this.element.position();
                return {
                    top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
                    left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
                }
            }
            return {
                top: 0,
                left: 0
            }
        },
        _cacheMargins: function() {
            this.margins = {
                left: parseInt(this.element.css("marginLeft"), 10) || 0,
                top: parseInt(this.element.css("marginTop"), 10) || 0,
                right: parseInt(this.element.css("marginRight"), 10) || 0,
                bottom: parseInt(this.element.css("marginBottom"), 10) || 0
            }
        },
        _cacheHelperProportions: function() {
            this.helperProportions = {
                width: this.helper.outerWidth(),
                height: this.helper.outerHeight()
            }
        },
        _setContainment: function() {
            var t, n, r, i = this.options;
            i.containment === "parent" && (i.containment = this.helper[0].parentNode);
            if (i.containment === "document" || i.containment === "window") this.containment = [i.containment === "document" ? 0 : e(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, i.containment === "document" ? 0 : e(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, (i.containment === "document" ? 0 : e(window).scrollLeft()) + e(i.containment === "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (i.containment === "document" ? 0 : e(window).scrollTop()) + (e(i.containment === "document" ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top];
            if (!/^(document|window|parent)$/.test(i.containment) && i.containment.constructor !== Array) {
                n = e(i.containment), r = n[0];
                if (!r) return;
                t = e(r).css("overflow") !== "hidden", this.containment = [(parseInt(e(r).css("borderLeftWidth"), 10) || 0) + (parseInt(e(r).css("paddingLeft"), 10) || 0), (parseInt(e(r).css("borderTopWidth"), 10) || 0) + (parseInt(e(r).css("paddingTop"), 10) || 0), (t ? Math.max(r.scrollWidth, r.offsetWidth) : r.offsetWidth) - (parseInt(e(r).css("borderLeftWidth"), 10) || 0) - (parseInt(e(r).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (t ? Math.max(r.scrollHeight, r.offsetHeight) : r.offsetHeight) - (parseInt(e(r).css("borderTopWidth"), 10) || 0) - (parseInt(e(r).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relative_container = n
            } else i.containment.constructor === Array && (this.containment = i.containment)
        },
        _convertPositionTo: function(t, n) {
            n || (n = this.position);
            var r = t === "absolute" ? 1 : -1,
                i = this.cssPosition !== "absolute" || this.scrollParent[0] !== document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
                s = /(html|body)/i.test(i[0].tagName);
            return {
                top: n.top + this.offset.relative.top * r + this.offset.parent.top * r - (this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : s ? 0 : i.scrollTop()) * r,
                left: n.left + this.offset.relative.left * r + this.offset.parent.left * r - (this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : s ? 0 : i.scrollLeft()) * r
            }
        },
        _generatePosition: function(t) {
            var n, r, i, s, o = this.options,
                u = this.cssPosition !== "absolute" || this.scrollParent[0] !== document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
                a = /(html|body)/i.test(u[0].tagName),
                f = t.pageX,
                l = t.pageY;
            return this.originalPosition && (this.containment && (this.relative_container ? (r = this.relative_container.offset(), n = [this.containment[0] + r.left, this.containment[1] + r.top, this.containment[2] + r.left, this.containment[3] + r.top]) : n = this.containment, t.pageX - this.offset.click.left < n[0] && (f = n[0] + this.offset.click.left), t.pageY - this.offset.click.top < n[1] && (l = n[1] + this.offset.click.top), t.pageX - this.offset.click.left > n[2] && (f = n[2] + this.offset.click.left), t.pageY - this.offset.click.top > n[3] && (l = n[3] + this.offset.click.top)), o.grid && (i = o.grid[1] ? this.originalPageY + Math.round((l - this.originalPageY) / o.grid[1]) * o.grid[1] : this.originalPageY, l = n ? i - this.offset.click.top >= n[1] || i - this.offset.click.top > n[3] ? i : i - this.offset.click.top >= n[1] ? i - o.grid[1] : i + o.grid[1] : i, s = o.grid[0] ? this.originalPageX + Math.round((f - this.originalPageX) / o.grid[0]) * o.grid[0] : this.originalPageX, f = n ? s - this.offset.click.left >= n[0] || s - this.offset.click.left > n[2] ? s : s - this.offset.click.left >= n[0] ? s - o.grid[0] : s + o.grid[0] : s)), {
                top: l - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : a ? 0 : u.scrollTop()),
                left: f - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : a ? 0 : u.scrollLeft())
            }
        },
        _clear: function() {
            this.helper.removeClass("ui-draggable-dragging"), this.helper[0] !== this.element[0] && !this.cancelHelperRemoval && this.helper.remove(), this.helper = null, this.cancelHelperRemoval = !1
        },
        _trigger: function(t, n, r) {
            return r = r || this._uiHash(), e.ui.plugin.call(this, t, [n, r]), t === "drag" && (this.positionAbs = this._convertPositionTo("absolute")), e.Widget.prototype._trigger.call(this, t, n, r)
        },
        plugins: {},
        _uiHash: function() {
            return {
                helper: this.helper,
                position: this.position,
                originalPosition: this.originalPosition,
                offset: this.positionAbs
            }
        }
    }), e.ui.plugin.add("draggable", "connectToSortable", {
        start: function(t, n) {
            var r = e(this).data("ui-draggable"),
                i = r.options,
                s = e.extend({}, n, {
                    item: r.element
                });
            r.sortables = [], e(i.connectToSortable).each(function() {
                var n = e.data(this, "ui-sortable");
                n && !n.options.disabled && (r.sortables.push({
                    instance: n,
                    shouldRevert: n.options.revert
                }), n.refreshPositions(), n._trigger("activate", t, s))
            })
        },
        stop: function(t, n) {
            var r = e(this).data("ui-draggable"),
                i = e.extend({}, n, {
                    item: r.element
                });
            e.each(r.sortables, function() {
                this.instance.isOver ? (this.instance.isOver = 0, r.cancelHelperRemoval = !0, this.instance.cancelHelperRemoval = !1, this.shouldRevert && (this.instance.options.revert = !0), this.instance._mouseStop(t), this.instance.options.helper = this.instance.options._helper, r.options.helper === "original" && this.instance.currentItem.css({
                    top: "auto",
                    left: "auto"
                })) : (this.instance.cancelHelperRemoval = !1, this.instance._trigger("deactivate", t, i))
            })
        },
        drag: function(t, n) {
            var r = e(this).data("ui-draggable"),
                i = this;
            e.each(r.sortables, function() {
                var s = !1,
                    o = this;
                this.instance.positionAbs = r.positionAbs, this.instance.helperProportions = r.helperProportions, this.instance.offset.click = r.offset.click, this.instance._intersectsWith(this.instance.containerCache) && (s = !0, e.each(r.sortables, function() {
                    return this.instance.positionAbs = r.positionAbs, this.instance.helperProportions = r.helperProportions, this.instance.offset.click = r.offset.click, this !== o && this.instance._intersectsWith(this.instance.containerCache) && e.ui.contains(o.instance.element[0], this.instance.element[0]) && (s = !1), s
                })), s ? (this.instance.isOver || (this.instance.isOver = 1, this.instance.currentItem = e(i).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item", !0), this.instance.options._helper = this.instance.options.helper, this.instance.options.helper = function() {
                    return n.helper[0]
                }, t.target = this.instance.currentItem[0], this.instance._mouseCapture(t, !0), this.instance._mouseStart(t, !0, !0), this.instance.offset.click.top = r.offset.click.top, this.instance.offset.click.left = r.offset.click.left, this.instance.offset.parent.left -= r.offset.parent.left - this.instance.offset.parent.left, this.instance.offset.parent.top -= r.offset.parent.top - this.instance.offset.parent.top, r._trigger("toSortable", t), r.dropped = this.instance.element, r.currentItem = r.element, this.instance.fromOutside = r), this.instance.currentItem && this.instance._mouseDrag(t)) : this.instance.isOver && (this.instance.isOver = 0, this.instance.cancelHelperRemoval = !0, this.instance.options.revert = !1, this.instance._trigger("out", t, this.instance._uiHash(this.instance)), this.instance._mouseStop(t, !0), this.instance.options.helper = this.instance.options._helper, this.instance.currentItem.remove(), this.instance.placeholder && this.instance.placeholder.remove(), r._trigger("fromSortable", t), r.dropped = !1)
            })
        }
    }), e.ui.plugin.add("draggable", "cursor", {
        start: function() {
            var t = e("body"),
                n = e(this).data("ui-draggable").options;
            t.css("cursor") && (n._cursor = t.css("cursor")), t.css("cursor", n.cursor)
        },
        stop: function() {
            var t = e(this).data("ui-draggable").options;
            t._cursor && e("body").css("cursor", t._cursor)
        }
    }), e.ui.plugin.add("draggable", "opacity", {
        start: function(t, n) {
            var r = e(n.helper),
                i = e(this).data("ui-draggable").options;
            r.css("opacity") && (i._opacity = r.css("opacity")), r.css("opacity", i.opacity)
        },
        stop: function(t, n) {
            var r = e(this).data("ui-draggable").options;
            r._opacity && e(n.helper).css("opacity", r._opacity)
        }
    }), e.ui.plugin.add("draggable", "scroll", {
        start: function() {
            var t = e(this).data("ui-draggable");
            t.scrollParent[0] !== document && t.scrollParent[0].tagName !== "HTML" && (t.overflowOffset = t.scrollParent.offset())
        },
        drag: function(t) {
            var n = e(this).data("ui-draggable"),
                r = n.options,
                i = !1;
            if (n.scrollParent[0] !== document && n.scrollParent[0].tagName !== "HTML") {
                if (!r.axis || r.axis !== "x") n.overflowOffset.top + n.scrollParent[0].offsetHeight - t.pageY < r.scrollSensitivity ? n.scrollParent[0].scrollTop = i = n.scrollParent[0].scrollTop + r.scrollSpeed : t.pageY - n.overflowOffset.top < r.scrollSensitivity && (n.scrollParent[0].scrollTop = i = n.scrollParent[0].scrollTop - r.scrollSpeed);
                if (!r.axis || r.axis !== "y") n.overflowOffset.left + n.scrollParent[0].offsetWidth - t.pageX < r.scrollSensitivity ? n.scrollParent[0].scrollLeft = i = n.scrollParent[0].scrollLeft + r.scrollSpeed : t.pageX - n.overflowOffset.left < r.scrollSensitivity && (n.scrollParent[0].scrollLeft = i = n.scrollParent[0].scrollLeft - r.scrollSpeed)
            } else {
                if (!r.axis || r.axis !== "x") t.pageY - e(document).scrollTop() < r.scrollSensitivity ? i = e(document).scrollTop(e(document).scrollTop() - r.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < r.scrollSensitivity && (i = e(document).scrollTop(e(document).scrollTop() + r.scrollSpeed));
                if (!r.axis || r.axis !== "y") t.pageX - e(document).scrollLeft() < r.scrollSensitivity ? i = e(document).scrollLeft(e(document).scrollLeft() - r.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < r.scrollSensitivity && (i = e(document).scrollLeft(e(document).scrollLeft() + r.scrollSpeed))
            }
            i !== !1 && e.ui.ddmanager && !r.dropBehaviour && e.ui.ddmanager.prepareOffsets(n, t)
        }
    }), e.ui.plugin.add("draggable", "snap", {
        start: function() {
            var t = e(this).data("ui-draggable"),
                n = t.options;
            t.snapElements = [], e(n.snap.constructor !== String ? n.snap.items || ":data(ui-draggable)" : n.snap).each(function() {
                var n = e(this),
                    r = n.offset();
                this !== t.element[0] && t.snapElements.push({
                    item: this,
                    width: n.outerWidth(),
                    height: n.outerHeight(),
                    top: r.top,
                    left: r.left
                })
            })
        },
        drag: function(t, n) {
            var r, i, s, o, u, a, f, l, c, h, p = e(this).data("ui-draggable"),
                d = p.options,
                v = d.snapTolerance,
                m = n.offset.left,
                g = m + p.helperProportions.width,
                y = n.offset.top,
                b = y + p.helperProportions.height;
            for (c = p.snapElements.length - 1; c >= 0; c--) {
                u = p.snapElements[c].left, a = u + p.snapElements[c].width, f = p.snapElements[c].top, l = f + p.snapElements[c].height;
                if (!(u - v < m && m < a + v && f - v < y && y < l + v || u - v < m && m < a + v && f - v < b && b < l + v || u - v < g && g < a + v && f - v < y && y < l + v || u - v < g && g < a + v && f - v < b && b < l + v)) {
                    p.snapElements[c].snapping && p.options.snap.release && p.options.snap.release.call(p.element, t, e.extend(p._uiHash(), {
                        snapItem: p.snapElements[c].item
                    })), p.snapElements[c].snapping = !1;
                    continue
                }
                d.snapMode !== "inner" && (r = Math.abs(f - b) <= v, i = Math.abs(l - y) <= v, s = Math.abs(u - g) <= v, o = Math.abs(a - m) <= v, r && (n.position.top = p._convertPositionTo("relative", {
                    top: f - p.helperProportions.height,
                    left: 0
                }).top - p.margins.top), i && (n.position.top = p._convertPositionTo("relative", {
                    top: l,
                    left: 0
                }).top - p.margins.top), s && (n.position.left = p._convertPositionTo("relative", {
                    top: 0,
                    left: u - p.helperProportions.width
                }).left - p.margins.left), o && (n.position.left = p._convertPositionTo("relative", {
                    top: 0,
                    left: a
                }).left - p.margins.left)), h = r || i || s || o, d.snapMode !== "outer" && (r = Math.abs(f - y) <= v, i = Math.abs(l - b) <= v, s = Math.abs(u - m) <= v, o = Math.abs(a - g) <= v, r && (n.position.top = p._convertPositionTo("relative", {
                    top: f,
                    left: 0
                }).top - p.margins.top), i && (n.position.top = p._convertPositionTo("relative", {
                    top: l - p.helperProportions.height,
                    left: 0
                }).top - p.margins.top), s && (n.position.left = p._convertPositionTo("relative", {
                    top: 0,
                    left: u
                }).left - p.margins.left), o && (n.position.left = p._convertPositionTo("relative", {
                    top: 0,
                    left: a - p.helperProportions.width
                }).left - p.margins.left)), !p.snapElements[c].snapping && (r || i || s || o || h) && p.options.snap.snap && p.options.snap.snap.call(p.element, t, e.extend(p._uiHash(), {
                    snapItem: p.snapElements[c].item
                })), p.snapElements[c].snapping = r || i || s || o || h
            }
        }
    }), e.ui.plugin.add("draggable", "stack", {
        start: function() {
            var t, n = e(this).data("ui-draggable").options,
                r = e.makeArray(e(n.stack)).sort(function(t, n) {
                    return (parseInt(e(t).css("zIndex"), 10) || 0) - (parseInt(e(n).css("zIndex"), 10) || 0)
                });
            if (!r.length) return;
            t = parseInt(r[0].style.zIndex, 10) || 0, e(r).each(function(e) {
                this.style.zIndex = t + e
            }), this[0].style.zIndex = t + r.length
        }
    }), e.ui.plugin.add("draggable", "zIndex", {
        start: function(t, n) {
            var r = e(n.helper),
                i = e(this).data("ui-draggable").options;
            r.css("zIndex") && (i._zIndex = r.css("zIndex")), r.css("zIndex", i.zIndex)
        },
        stop: function(t, n) {
            var r = e(this).data("ui-draggable").options;
            r._zIndex && e(n.helper).css("zIndex", r._zIndex)
        }
    })
}(jQuery),
function(e, t) {
    function n(e, t, n) {
        return e > t && e < t + n
    }
    e.widget("ui.droppable", {
        version: "1.10.0",
        widgetEventPrefix: "drop",
        options: {
            accept: "*",
            activeClass: !1,
            addClasses: !0,
            greedy: !1,
            hoverClass: !1,
            scope: "default",
            tolerance: "intersect",
            activate: null,
            deactivate: null,
            drop: null,
            out: null,
            over: null
        },
        _create: function() {
            var t = this.options,
                n = t.accept;
            this.isover = !1, this.isout = !0, this.accept = e.isFunction(n) ? n : function(e) {
                return e.is(n)
            }, this.proportions = {
                width: this.element[0].offsetWidth,
                height: this.element[0].offsetHeight
            }, e.ui.ddmanager.droppables[t.scope] = e.ui.ddmanager.droppables[t.scope] || [], e.ui.ddmanager.droppables[t.scope].push(this), t.addClasses && this.element.addClass("ui-droppable")
        },
        _destroy: function() {
            var t = 0,
                n = e.ui.ddmanager.droppables[this.options.scope];
            for (; t < n.length; t++) n[t] === this && n.splice(t, 1);
            this.element.removeClass("ui-droppable ui-droppable-disabled")
        },
        _setOption: function(t, n) {
            t === "accept" && (this.accept = e.isFunction(n) ? n : function(e) {
                return e.is(n)
            }), e.Widget.prototype._setOption.apply(this, arguments)
        },
        _activate: function(t) {
            var n = e.ui.ddmanager.current;
            this.options.activeClass && this.element.addClass(this.options.activeClass), n && this._trigger("activate", t, this.ui(n))
        },
        _deactivate: function(t) {
            var n = e.ui.ddmanager.current;
            this.options.activeClass && this.element.removeClass(this.options.activeClass), n && this._trigger("deactivate", t, this.ui(n))
        },
        _over: function(t) {
            var n = e.ui.ddmanager.current;
            if (!n || (n.currentItem || n.element)[0] === this.element[0]) return;
            this.accept.call(this.element[0], n.currentItem || n.element) && (this.options.hoverClass && this.element.addClass(this.options.hoverClass), this._trigger("over", t, this.ui(n)))
        },
        _out: function(t) {
            var n = e.ui.ddmanager.current;
            if (!n || (n.currentItem || n.element)[0] === this.element[0]) return;
            this.accept.call(this.element[0], n.currentItem || n.element) && (this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("out", t, this.ui(n)))
        },
        _drop: function(t, n) {
            var r = n || e.ui.ddmanager.current,
                i = !1;
            return !r || (r.currentItem || r.element)[0] === this.element[0] ? !1 : (this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function() {
                var t = e.data(this, "ui-droppable");
                if (t.options.greedy && !t.options.disabled && t.options.scope === r.options.scope && t.accept.call(t.element[0], r.currentItem || r.element) && e.ui.intersect(r, e.extend(t, {
                        offset: t.element.offset()
                    }), t.options.tolerance)) return i = !0, !1
            }), i ? !1 : this.accept.call(this.element[0], r.currentItem || r.element) ? (this.options.activeClass && this.element.removeClass(this.options.activeClass), this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("drop", t, this.ui(r)), this.element) : !1)
        },
        ui: function(e) {
            return {
                draggable: e.currentItem || e.element,
                helper: e.helper,
                position: e.position,
                offset: e.positionAbs
            }
        }
    }), e.ui.intersect = function(e, t, r) {
        if (!t.offset) return !1;
        var i, s, o = (e.positionAbs || e.position.absolute).left,
            u = o + e.helperProportions.width,
            a = (e.positionAbs || e.position.absolute).top,
            f = a + e.helperProportions.height,
            l = t.offset.left,
            c = l + t.proportions.width,
            h = t.offset.top,
            p = h + t.proportions.height;
        switch (r) {
            case "fit":
                return l <= o && u <= c && h <= a && f <= p;
            case "intersect":
                return l < o + e.helperProportions.width / 2 && u - e.helperProportions.width / 2 < c && h < a + e.helperProportions.height / 2 && f - e.helperProportions.height / 2 < p;
            case "pointer":
                return i = (e.positionAbs || e.position.absolute).left + (e.clickOffset || e.offset.click).left, s = (e.positionAbs || e.position.absolute).top + (e.clickOffset || e.offset.click).top, n(s, h, t.proportions.height) && n(i, l, t.proportions.width);
            case "touch":
                return (a >= h && a <= p || f >= h && f <= p || a < h && f > p) && (o >= l && o <= c || u >= l && u <= c || o < l && u > c);
            default:
                return !1
        }
    }, e.ui.ddmanager = {
        current: null,
        droppables: {
            "default": []
        },
        prepareOffsets: function(t, n) {
            var r, i, s = e.ui.ddmanager.droppables[t.options.scope] || [],
                o = n ? n.type : null,
                u = (t.currentItem || t.element).find(":data(ui-droppable)").addBack();
            e: for (r = 0; r < s.length; r++) {
                if (s[r].options.disabled || t && !s[r].accept.call(s[r].element[0], t.currentItem || t.element)) continue;
                for (i = 0; i < u.length; i++)
                    if (u[i] === s[r].element[0]) {
                        s[r].proportions.height = 0;
                        continue e
                    }
                s[r].visible = s[r].element.css("display") !== "none";
                if (!s[r].visible) continue;
                o === "mousedown" && s[r]._activate.call(s[r], n), s[r].offset = s[r].element.offset(), s[r].proportions = {
                    width: s[r].element[0].offsetWidth,
                    height: s[r].element[0].offsetHeight
                }
            }
        },
        drop: function(t, n) {
            var r = !1;
            return e.each(e.ui.ddmanager.droppables[t.options.scope] || [], function() {
                if (!this.options) return;
                !this.options.disabled && this.visible && e.ui.intersect(t, this, this.options.tolerance) && (r = this._drop.call(this, n) || r), !this.options.disabled && this.visible && this.accept.call(this.element[0], t.currentItem || t.element) && (this.isout = !0, this.isover = !1, this._deactivate.call(this, n))
            }), r
        },
        dragStart: function(t, n) {
            t.element.parentsUntil("body").bind("scroll.droppable", function() {
                t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, n)
            })
        },
        drag: function(t, n) {
            t.options.refreshPositions && e.ui.ddmanager.prepareOffsets(t, n), e.each(e.ui.ddmanager.droppables[t.options.scope] || [], function() {
                if (this.options.disabled || this.greedyChild || !this.visible) return;
                var r, i, s, o = e.ui.intersect(t, this, this.options.tolerance),
                    u = !o && this.isover ? "isout" : o && !this.isover ? "isover" : null;
                if (!u) return;
                this.options.greedy && (i = this.options.scope, s = this.element.parents(":data(ui-droppable)").filter(function() {
                    return e.data(this, "ui-droppable").options.scope === i
                }), s.length && (r = e.data(s[0], "ui-droppable"), r.greedyChild = u === "isover")), r && u === "isover" && (r.isover = !1, r.isout = !0, r._out.call(r, n)), this[u] = !0, this[u === "isout" ? "isover" : "isout"] = !1, this[u === "isover" ? "_over" : "_out"].call(this, n), r && u === "isout" && (r.isout = !1, r.isover = !0, r._over.call(r, n))
            })
        },
        dragStop: function(t, n) {
            t.element.parentsUntil("body").unbind("scroll.droppable"), t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, n)
        }
    }
}(jQuery),
function(e, t) {
    function n(e) {
        return parseInt(e, 10) || 0
    }

    function r(e) {
        return !isNaN(parseInt(e, 10))
    }
    e.widget("ui.resizable", e.ui.mouse, {
        version: "1.10.0",
        widgetEventPrefix: "resize",
        options: {
            alsoResize: !1,
            animate: !1,
            animateDuration: "slow",
            animateEasing: "swing",
            aspectRatio: !1,
            autoHide: !1,
            containment: !1,
            ghost: !1,
            grid: !1,
            handles: "e,s,se",
            helper: !1,
            maxHeight: null,
            maxWidth: null,
            minHeight: 10,
            minWidth: 10,
            zIndex: 90,
            resize: null,
            start: null,
            stop: null
        },
        _create: function() {
            var t, n, r, i, s, o = this,
                u = this.options;
            this.element.addClass("ui-resizable"), e.extend(this, {
                _aspectRatio: !!u.aspectRatio,
                aspectRatio: u.aspectRatio,
                originalElement: this.element,
                _proportionallyResizeElements: [],
                _helper: u.helper || u.ghost || u.animate ? u.helper || "ui-resizable-helper" : null
            }), this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i) && (this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({
                position: this.element.css("position"),
                width: this.element.outerWidth(),
                height: this.element.outerHeight(),
                top: this.element.css("top"),
                left: this.element.css("left")
            })), this.element = this.element.parent().data("ui-resizable", this.element.data("ui-resizable")), this.elementIsWrapper = !0, this.element.css({
                marginLeft: this.originalElement.css("marginLeft"),
                marginTop: this.originalElement.css("marginTop"),
                marginRight: this.originalElement.css("marginRight"),
                marginBottom: this.originalElement.css("marginBottom")
            }), this.originalElement.css({
                marginLeft: 0,
                marginTop: 0,
                marginRight: 0,
                marginBottom: 0
            }), this.originalResizeStyle = this.originalElement.css("resize"), this.originalElement.css("resize", "none"), this._proportionallyResizeElements.push(this.originalElement.css({
                position: "static",
                zoom: 1,
                display: "block"
            })), this.originalElement.css({
                margin: this.originalElement.css("margin")
            }), this._proportionallyResize()), this.handles = u.handles || (e(".ui-resizable-handle", this.element).length ? {
                n: ".ui-resizable-n",
                e: ".ui-resizable-e",
                s: ".ui-resizable-s",
                w: ".ui-resizable-w",
                se: ".ui-resizable-se",
                sw: ".ui-resizable-sw",
                ne: ".ui-resizable-ne",
                nw: ".ui-resizable-nw"
            } : "e,s,se");
            if (this.handles.constructor === String) {
                this.handles === "all" && (this.handles = "n,e,s,w,se,sw,ne,nw"), t = this.handles.split(","), this.handles = {};
                for (n = 0; n < t.length; n++) r = e.trim(t[n]), s = "ui-resizable-" + r, i = e("<div class='ui-resizable-handle " + s + "'></div>"), i.css({
                    zIndex: u.zIndex
                }), "se" === r && i.addClass("ui-icon ui-icon-gripsmall-diagonal-se"), this.handles[r] = ".ui-resizable-" + r, this.element.append(i)
            }
            this._renderAxis = function(t) {
                var n, r, i, s;
                t = t || this.element;
                for (n in this.handles) {
                    this.handles[n].constructor === String && (this.handles[n] = e(this.handles[n], this.element).show()), this.elementIsWrapper && this.originalElement[0].nodeName.match(/textarea|input|select|button/i) && (r = e(this.handles[n], this.element), s = /sw|ne|nw|se|n|s/.test(n) ? r.outerHeight() : r.outerWidth(), i = ["padding", /ne|nw|n/.test(n) ? "Top" : /se|sw|s/.test(n) ? "Bottom" : /^e$/.test(n) ? "Right" : "Left"].join(""), t.css(i, s), this._proportionallyResize());
                    if (!e(this.handles[n]).length) continue
                }
            }, this._renderAxis(this.element), this._handles = e(".ui-resizable-handle", this.element).disableSelection(), this._handles.mouseover(function() {
                o.resizing || (this.className && (i = this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)), o.axis = i && i[1] ? i[1] : "se")
            }), u.autoHide && (this._handles.hide(), e(this.element).addClass("ui-resizable-autohide").mouseenter(function() {
                if (u.disabled) return;
                e(this).removeClass("ui-resizable-autohide"), o._handles.show()
            }).mouseleave(function() {
                if (u.disabled) return;
                o.resizing || (e(this).addClass("ui-resizable-autohide"), o._handles.hide())
            })), this._mouseInit()
        },
        _destroy: function() {
            this._mouseDestroy();
            var t, n = function(t) {
                e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()
            };
            return this.elementIsWrapper && (n(this.element), t = this.element, this.originalElement.css({
                position: t.css("position"),
                width: t.outerWidth(),
                height: t.outerHeight(),
                top: t.css("top"),
                left: t.css("left")
            }).insertAfter(t), t.remove()), this.originalElement.css("resize", this.originalResizeStyle), n(this.originalElement), this
        },
        _mouseCapture: function(t) {
            var n, r, i = !1;
            for (n in this.handles) {
                r = e(this.handles[n])[0];
                if (r === t.target || e.contains(r, t.target)) i = !0
            }
            return !this.options.disabled && i
        },
        _mouseStart: function(t) {
            var r, i, s, o = this.options,
                u = this.element.position(),
                a = this.element;
            return this.resizing = !0, /absolute/.test(a.css("position")) ? a.css({
                position: "absolute",
                top: a.css("top"),
                left: a.css("left")
            }) : a.is(".ui-draggable") && a.css({
                position: "absolute",
                top: u.top,
                left: u.left
            }), this._renderProxy(), r = n(this.helper.css("left")), i = n(this.helper.css("top")), o.containment && (r += e(o.containment).scrollLeft() || 0, i += e(o.containment).scrollTop() || 0), this.offset = this.helper.offset(), this.position = {
                left: r,
                top: i
            }, this.size = this._helper ? {
                width: a.outerWidth(),
                height: a.outerHeight()
            } : {
                width: a.width(),
                height: a.height()
            }, this.originalSize = this._helper ? {
                width: a.outerWidth(),
                height: a.outerHeight()
            } : {
                width: a.width(),
                height: a.height()
            }, this.originalPosition = {
                left: r,
                top: i
            }, this.sizeDiff = {
                width: a.outerWidth() - a.width(),
                height: a.outerHeight() - a.height()
            }, this.originalMousePosition = {
                left: t.pageX,
                top: t.pageY
            }, this.aspectRatio = typeof o.aspectRatio == "number" ? o.aspectRatio : this.originalSize.width / this.originalSize.height || 1, s = e(".ui-resizable-" + this.axis).css("cursor"), e("body").css("cursor", s === "auto" ? this.axis + "-resize" : s), a.addClass("ui-resizable-resizing"), this._propagate("start", t), !0
        },
        _mouseDrag: function(t) {
            var n, r = this.helper,
                i = {},
                s = this.originalMousePosition,
                o = this.axis,
                u = this.position.top,
                a = this.position.left,
                f = this.size.width,
                l = this.size.height,
                c = t.pageX - s.left || 0,
                h = t.pageY - s.top || 0,
                p = this._change[o];
            if (!p) return !1;
            n = p.apply(this, [t, c, h]), this._updateVirtualBoundaries(t.shiftKey);
            if (this._aspectRatio || t.shiftKey) n = this._updateRatio(n, t);
            return n = this._respectSize(n, t), this._updateCache(n), this._propagate("resize", t), this.position.top !== u && (i.top = this.position.top + "px"), this.position.left !== a && (i.left = this.position.left + "px"), this.size.width !== f && (i.width = this.size.width + "px"), this.size.height !== l && (i.height = this.size.height + "px"), r.css(i), !this._helper && this._proportionallyResizeElements.length && this._proportionallyResize(), e.isEmptyObject(i) || this._trigger("resize", t, this.ui()), !1
        },
        _mouseStop: function(t) {
            this.resizing = !1;
            var n, r, i, s, o, u, a, f = this.options,
                l = this;
            return this._helper && (n = this._proportionallyResizeElements, r = n.length && /textarea/i.test(n[0].nodeName), i = r && e.ui.hasScroll(n[0], "left") ? 0 : l.sizeDiff.height, s = r ? 0 : l.sizeDiff.width, o = {
                width: l.helper.width() - s,
                height: l.helper.height() - i
            }, u = parseInt(l.element.css("left"), 10) + (l.position.left - l.originalPosition.left) || null, a = parseInt(l.element.css("top"), 10) + (l.position.top - l.originalPosition.top) || null, f.animate || this.element.css(e.extend(o, {
                top: a,
                left: u
            })), l.helper.height(l.size.height), l.helper.width(l.size.width), this._helper && !f.animate && this._proportionallyResize()), e("body").css("cursor", "auto"), this.element.removeClass("ui-resizable-resizing"), this._propagate("stop", t), this._helper && this.helper.remove(), !1
        },
        _updateVirtualBoundaries: function(e) {
            var t, n, i, s, o, u = this.options;
            o = {
                minWidth: r(u.minWidth) ? u.minWidth : 0,
                maxWidth: r(u.maxWidth) ? u.maxWidth : Infinity,
                minHeight: r(u.minHeight) ? u.minHeight : 0,
                maxHeight: r(u.maxHeight) ? u.maxHeight : Infinity
            };
            if (this._aspectRatio || e) t = o.minHeight * this.aspectRatio, i = o.minWidth / this.aspectRatio, n = o.maxHeight * this.aspectRatio, s = o.maxWidth / this.aspectRatio, t > o.minWidth && (o.minWidth = t), i > o.minHeight && (o.minHeight = i), n < o.maxWidth && (o.maxWidth = n), s < o.maxHeight && (o.maxHeight = s);
            this._vBoundaries = o
        },
        _updateCache: function(e) {
            this.offset = this.helper.offset(), r(e.left) && (this.position.left = e.left), r(e.top) && (this.position.top = e.top), r(e.height) && (this.size.height = e.height), r(e.width) && (this.size.width = e.width)
        },
        _updateRatio: function(e) {
            var t = this.position,
                n = this.size,
                i = this.axis;
            return r(e.height) ? e.width = e.height * this.aspectRatio : r(e.width) && (e.height = e.width / this.aspectRatio), i === "sw" && (e.left = t.left + (n.width - e.width), e.top = null), i === "nw" && (e.top = t.top + (n.height - e.height), e.left = t.left + (n.width - e.width)), e
        },
        _respectSize: function(e) {
            var t = this._vBoundaries,
                n = this.axis,
                i = r(e.width) && t.maxWidth && t.maxWidth < e.width,
                s = r(e.height) && t.maxHeight && t.maxHeight < e.height,
                o = r(e.width) && t.minWidth && t.minWidth > e.width,
                u = r(e.height) && t.minHeight && t.minHeight > e.height,
                a = this.originalPosition.left + this.originalSize.width,
                f = this.position.top + this.size.height,
                l = /sw|nw|w/.test(n),
                c = /nw|ne|n/.test(n);
            return o && (e.width = t.minWidth), u && (e.height = t.minHeight), i && (e.width = t.maxWidth), s && (e.height = t.maxHeight), o && l && (e.left = a - t.minWidth), i && l && (e.left = a - t.maxWidth), u && c && (e.top = f - t.minHeight), s && c && (e.top = f - t.maxHeight), !e.width && !e.height && !e.left && e.top ? e.top = null : !e.width && !e.height && !e.top && e.left && (e.left = null), e
        },
        _proportionallyResize: function() {
            if (!this._proportionallyResizeElements.length) return;
            var e, t, n, r, i, s = this.helper || this.element;
            for (e = 0; e < this._proportionallyResizeElements.length; e++) {
                i = this._proportionallyResizeElements[e];
                if (!this.borderDif) {
                    this.borderDif = [], n = [i.css("borderTopWidth"), i.css("borderRightWidth"), i.css("borderBottomWidth"), i.css("borderLeftWidth")], r = [i.css("paddingTop"), i.css("paddingRight"), i.css("paddingBottom"), i.css("paddingLeft")];
                    for (t = 0; t < n.length; t++) this.borderDif[t] = (parseInt(n[t], 10) || 0) + (parseInt(r[t], 10) || 0)
                }
                i.css({
                    height: s.height() - this.borderDif[0] - this.borderDif[2] || 0,
                    width: s.width() - this.borderDif[1] - this.borderDif[3] || 0
                })
            }
        },
        _renderProxy: function() {
            var t = this.element,
                n = this.options;
            this.elementOffset = t.offset(), this._helper ? (this.helper = this.helper || e("<div style='overflow:hidden;'></div>"), this.helper.addClass(this._helper).css({
                width: this.element.outerWidth() - 1,
                height: this.element.outerHeight() - 1,
                position: "absolute",
                left: this.elementOffset.left + "px",
                top: this.elementOffset.top + "px",
                zIndex: ++n.zIndex
            }), this.helper.appendTo("body").disableSelection()) : this.helper = this.element
        },
        _change: {
            e: function(e, t) {
                return {
                    width: this.originalSize.width + t
                }
            },
            w: function(e, t) {
                var n = this.originalSize,
                    r = this.originalPosition;
                return {
                    left: r.left + t,
                    width: n.width - t
                }
            },
            n: function(e, t, n) {
                var r = this.originalSize,
                    i = this.originalPosition;
                return {
                    top: i.top + n,
                    height: r.height - n
                }
            },
            s: function(e, t, n) {
                return {
                    height: this.originalSize.height + n
                }
            },
            se: function(t, n, r) {
                return e.extend(this._change.s.apply(this, arguments), this._change.e.apply(this, [t, n, r]))
            },
            sw: function(t, n, r) {
                return e.extend(this._change.s.apply(this, arguments), this._change.w.apply(this, [t, n, r]))
            },
            ne: function(t, n, r) {
                return e.extend(this._change.n.apply(this, arguments), this._change.e.apply(this, [t, n, r]))
            },
            nw: function(t, n, r) {
                return e.extend(this._change.n.apply(this, arguments), this._change.w.apply(this, [t, n, r]))
            }
        },
        _propagate: function(t, n) {
            e.ui.plugin.call(this, t, [n, this.ui()]), t !== "resize" && this._trigger(t, n, this.ui())
        },
        plugins: {},
        ui: function() {
            return {
                originalElement: this.originalElement,
                element: this.element,
                helper: this.helper,
                position: this.position,
                size: this.size,
                originalSize: this.originalSize,
                originalPosition: this.originalPosition
            }
        }
    }), e.ui.plugin.add("resizable", "animate", {
        stop: function(t) {
            var n = e(this).data("ui-resizable"),
                r = n.options,
                i = n._proportionallyResizeElements,
                s = i.length && /textarea/i.test(i[0].nodeName),
                o = s && e.ui.hasScroll(i[0], "left") ? 0 : n.sizeDiff.height,
                u = s ? 0 : n.sizeDiff.width,
                a = {
                    width: n.size.width - u,
                    height: n.size.height - o
                },
                f = parseInt(n.element.css("left"), 10) + (n.position.left - n.originalPosition.left) || null,
                l = parseInt(n.element.css("top"), 10) + (n.position.top - n.originalPosition.top) || null;
            n.element.animate(e.extend(a, l && f ? {
                top: l,
                left: f
            } : {}), {
                duration: r.animateDuration,
                easing: r.animateEasing,
                step: function() {
                    var r = {
                        width: parseInt(n.element.css("width"), 10),
                        height: parseInt(n.element.css("height"), 10),
                        top: parseInt(n.element.css("top"), 10),
                        left: parseInt(n.element.css("left"), 10)
                    };
                    i && i.length && e(i[0]).css({
                        width: r.width,
                        height: r.height
                    }), n._updateCache(r), n._propagate("resize", t)
                }
            })
        }
    }), e.ui.plugin.add("resizable", "containment", {
        start: function() {
            var t, r, i, s, o, u, a, f = e(this).data("ui-resizable"),
                l = f.options,
                c = f.element,
                h = l.containment,
                p = h instanceof e ? h.get(0) : /parent/.test(h) ? c.parent().get(0) : h;
            if (!p) return;
            f.containerElement = e(p), /document/.test(h) || h === document ? (f.containerOffset = {
                left: 0,
                top: 0
            }, f.containerPosition = {
                left: 0,
                top: 0
            }, f.parentData = {
                element: e(document),
                left: 0,
                top: 0,
                width: e(document).width(),
                height: e(document).height() || document.body.parentNode.scrollHeight
            }) : (t = e(p), r = [], e(["Top", "Right", "Left", "Bottom"]).each(function(e, i) {
                r[e] = n(t.css("padding" + i))
            }), f.containerOffset = t.offset(), f.containerPosition = t.position(), f.containerSize = {
                height: t.innerHeight() - r[3],
                width: t.innerWidth() - r[1]
            }, i = f.containerOffset, s = f.containerSize.height, o = f.containerSize.width, u = e.ui.hasScroll(p, "left") ? p.scrollWidth : o, a = e.ui.hasScroll(p) ? p.scrollHeight : s, f.parentData = {
                element: p,
                left: i.left,
                top: i.top,
                width: u,
                height: a
            })
        },
        resize: function(t) {
            var n, r, i, s, o = e(this).data("ui-resizable"),
                u = o.options,
                a = o.containerOffset,
                f = o.position,
                l = o._aspectRatio || t.shiftKey,
                c = {
                    top: 0,
                    left: 0
                },
                h = o.containerElement;
            h[0] !== document && /static/.test(h.css("position")) && (c = a), f.left < (o._helper ? a.left : 0) && (o.size.width = o.size.width + (o._helper ? o.position.left - a.left : o.position.left - c.left), l && (o.size.height = o.size.width / o.aspectRatio), o.position.left = u.helper ? a.left : 0), f.top < (o._helper ? a.top : 0) && (o.size.height = o.size.height + (o._helper ? o.position.top - a.top : o.position.top), l && (o.size.width = o.size.height * o.aspectRatio), o.position.top = o._helper ? a.top : 0), o.offset.left = o.parentData.left + o.position.left, o.offset.top = o.parentData.top + o.position.top, n = Math.abs((o._helper ? o.offset.left - c.left : o.offset.left - c.left) + o.sizeDiff.width), r = Math.abs((o._helper ? o.offset.top - c.top : o.offset.top - a.top) + o.sizeDiff.height), i = o.containerElement.get(0) === o.element.parent().get(0), s = /relative|absolute/.test(o.containerElement.css("position")), i && s && (n -= o.parentData.left), n + o.size.width >= o.parentData.width && (o.size.width = o.parentData.width - n, l && (o.size.height = o.size.width / o.aspectRatio)), r + o.size.height >= o.parentData.height && (o.size.height = o.parentData.height - r, l && (o.size.width = o.size.height * o.aspectRatio))
        },
        stop: function() {
            var t = e(this).data("ui-resizable"),
                n = t.options,
                r = t.containerOffset,
                i = t.containerPosition,
                s = t.containerElement,
                o = e(t.helper),
                u = o.offset(),
                a = o.outerWidth() - t.sizeDiff.width,
                f = o.outerHeight() - t.sizeDiff.height;
            t._helper && !n.animate && /relative/.test(s.css("position")) && e(this).css({
                left: u.left - i.left - r.left,
                width: a,
                height: f
            }), t._helper && !n.animate && /static/.test(s.css("position")) && e(this).css({
                left: u.left - i.left - r.left,
                width: a,
                height: f
            })
        }
    }), e.ui.plugin.add("resizable", "alsoResize", {
        start: function() {
            var t = e(this).data("ui-resizable"),
                n = t.options,
                r = function(t) {
                    e(t).each(function() {
                        var t = e(this);
                        t.data("ui-resizable-alsoresize", {
                            width: parseInt(t.width(), 10),
                            height: parseInt(t.height(), 10),
                            left: parseInt(t.css("left"), 10),
                            top: parseInt(t.css("top"), 10)
                        })
                    })
                };
            typeof n.alsoResize == "object" && !n.alsoResize.parentNode ? n.alsoResize.length ? (n.alsoResize = n.alsoResize[0], r(n.alsoResize)) : e.each(n.alsoResize, function(e) {
                r(e)
            }) : r(n.alsoResize)
        },
        resize: function(t, n) {
            var r = e(this).data("ui-resizable"),
                i = r.options,
                s = r.originalSize,
                o = r.originalPosition,
                u = {
                    height: r.size.height - s.height || 0,
                    width: r.size.width - s.width || 0,
                    top: r.position.top - o.top || 0,
                    left: r.position.left - o.left || 0
                },
                a = function(t, r) {
                    e(t).each(function() {
                        var t = e(this),
                            i = e(this).data("ui-resizable-alsoresize"),
                            s = {},
                            o = r && r.length ? r : t.parents(n.originalElement[0]).length ? ["width", "height"] : ["width", "height", "top", "left"];
                        e.each(o, function(e, t) {
                            var n = (i[t] || 0) + (u[t] || 0);
                            n && n >= 0 && (s[t] = n || null)
                        }), t.css(s)
                    })
                };
            typeof i.alsoResize == "object" && !i.alsoResize.nodeType ? e.each(i.alsoResize, function(e, t) {
                a(e, t)
            }) : a(i.alsoResize)
        },
        stop: function() {
            e(this).removeData("resizable-alsoresize")
        }
    }), e.ui.plugin.add("resizable", "ghost", {
        start: function() {
            var t = e(this).data("ui-resizable"),
                n = t.options,
                r = t.size;
            t.ghost = t.originalElement.clone(), t.ghost.css({
                opacity: .25,
                display: "block",
                position: "relative",
                height: r.height,
                width: r.width,
                margin: 0,
                left: 0,
                top: 0
            }).addClass("ui-resizable-ghost").addClass(typeof n.ghost == "string" ? n.ghost : ""), t.ghost.appendTo(t.helper)
        },
        resize: function() {
            var t = e(this).data("ui-resizable");
            t.ghost && t.ghost.css({
                position: "relative",
                height: t.size.height,
                width: t.size.width
            })
        },
        stop: function() {
            var t = e(this).data("ui-resizable");
            t.ghost && t.helper && t.helper.get(0).removeChild(t.ghost.get(0))
        }
    }), e.ui.plugin.add("resizable", "grid", {
        resize: function() {
            var t = e(this).data("ui-resizable"),
                n = t.options,
                r = t.size,
                i = t.originalSize,
                s = t.originalPosition,
                o = t.axis,
                u = typeof n.grid == "number" ? [n.grid, n.grid] : n.grid,
                a = u[0] || 1,
                f = u[1] || 1,
                l = Math.round((r.width - i.width) / a) * a,
                c = Math.round((r.height - i.height) / f) * f,
                h = i.width + l,
                p = i.height + c,
                d = n.maxWidth && n.maxWidth < h,
                v = n.maxHeight && n.maxHeight < p,
                m = n.minWidth && n.minWidth > h,
                g = n.minHeight && n.minHeight > p;
            n.grid = u, m && (h += a), g && (p += f), d && (h -= a), v && (p -= f), /^(se|s|e)$/.test(o) ? (t.size.width = h, t.size.height = p) : /^(ne)$/.test(o) ? (t.size.width = h, t.size.height = p, t.position.top = s.top - c) : /^(sw)$/.test(o) ? (t.size.width = h, t.size.height = p, t.position.left = s.left - l) : (t.size.width = h, t.size.height = p, t.position.top = s.top - c, t.position.left = s.left - l)
        }
    })
}(jQuery),
function(e, t) {
    e.widget("ui.selectable", e.ui.mouse, {
        version: "1.10.0",
        options: {
            appendTo: "body",
            autoRefresh: !0,
            distance: 0,
            filter: "*",
            tolerance: "touch",
            selected: null,
            selecting: null,
            start: null,
            stop: null,
            unselected: null,
            unselecting: null
        },
        _create: function() {
            var t, n = this;
            this.element.addClass("ui-selectable"), this.dragged = !1, this.refresh = function() {
                t = e(n.options.filter, n.element[0]), t.addClass("ui-selectee"), t.each(function() {
                    var t = e(this),
                        n = t.offset();
                    e.data(this, "selectable-item", {
                        element: this,
                        $element: t,
                        left: n.left,
                        top: n.top,
                        right: n.left + t.outerWidth(),
                        bottom: n.top + t.outerHeight(),
                        startselected: !1,
                        selected: t.hasClass("ui-selected"),
                        selecting: t.hasClass("ui-selecting"),
                        unselecting: t.hasClass("ui-unselecting")
                    })
                })
            }, this.refresh(), this.selectees = t.addClass("ui-selectee"), this._mouseInit(), this.helper = e("<div class='ui-selectable-helper'></div>")
        },
        _destroy: function() {
            this.selectees.removeClass("ui-selectee").removeData("selectable-item"), this.element.removeClass("ui-selectable ui-selectable-disabled"), this._mouseDestroy()
        },
        _mouseStart: function(t) {
            var n = this,
                r = this.options;
            this.opos = [t.pageX, t.pageY];
            if (this.options.disabled) return;
            this.selectees = e(r.filter, this.element[0]), this._trigger("start", t), e(r.appendTo).append(this.helper), this.helper.css({
                left: t.pageX,
                top: t.pageY,
                width: 0,
                height: 0
            }), r.autoRefresh && this.refresh(), this.selectees.filter(".ui-selected").each(function() {
                var r = e.data(this, "selectable-item");
                r.startselected = !0, !t.metaKey && !t.ctrlKey && (r.$element.removeClass("ui-selected"), r.selected = !1, r.$element.addClass("ui-unselecting"), r.unselecting = !0, n._trigger("unselecting", t, {
                    unselecting: r.element
                }))
            }), e(t.target).parents().addBack().each(function() {
                var r, i = e.data(this, "selectable-item");
                if (i) return r = !t.metaKey && !t.ctrlKey || !i.$element.hasClass("ui-selected"), i.$element.removeClass(r ? "ui-unselecting" : "ui-selected").addClass(r ? "ui-selecting" : "ui-unselecting"), i.unselecting = !r, i.selecting = r, i.selected = r, r ? n._trigger("selecting", t, {
                    selecting: i.element
                }) : n._trigger("unselecting", t, {
                    unselecting: i.element
                }), !1
            })
        },
        _mouseDrag: function(t) {
            this.dragged = !0;
            if (this.options.disabled) return;
            var n, r = this,
                i = this.options,
                s = this.opos[0],
                o = this.opos[1],
                u = t.pageX,
                a = t.pageY;
            return s > u && (n = u, u = s, s = n), o > a && (n = a, a = o, o = n), this.helper.css({
                left: s,
                top: o,
                width: u - s,
                height: a - o
            }), this.selectees.each(function() {
                var n = e.data(this, "selectable-item"),
                    f = !1;
                if (!n || n.element === r.element[0]) return;
                i.tolerance === "touch" ? f = !(n.left > u || n.right < s || n.top > a || n.bottom < o) : i.tolerance === "fit" && (f = n.left > s && n.right < u && n.top > o && n.bottom < a), f ? (n.selected && (n.$element.removeClass("ui-selected"), n.selected = !1), n.unselecting && (n.$element.removeClass("ui-unselecting"), n.unselecting = !1), n.selecting || (n.$element.addClass("ui-selecting"), n.selecting = !0, r._trigger("selecting", t, {
                    selecting: n.element
                }))) : (n.selecting && ((t.metaKey || t.ctrlKey) && n.startselected ? (n.$element.removeClass("ui-selecting"), n.selecting = !1, n.$element.addClass("ui-selected"), n.selected = !0) : (n.$element.removeClass("ui-selecting"), n.selecting = !1, n.startselected && (n.$element.addClass("ui-unselecting"), n.unselecting = !0), r._trigger("unselecting", t, {
                    unselecting: n.element
                }))), n.selected && !t.metaKey && !t.ctrlKey && !n.startselected && (n.$element.removeClass("ui-selected"), n.selected = !1, n.$element.addClass("ui-unselecting"), n.unselecting = !0, r._trigger("unselecting", t, {
                    unselecting: n.element
                })))
            }), !1
        },
        _mouseStop: function(t) {
            var n = this;
            return this.dragged = !1, e(".ui-unselecting", this.element[0]).each(function() {
                var r = e.data(this, "selectable-item");
                r.$element.removeClass("ui-unselecting"), r.unselecting = !1, r.startselected = !1, n._trigger("unselected", t, {
                    unselected: r.element
                })
            }), e(".ui-selecting", this.element[0]).each(function() {
                var r = e.data(this, "selectable-item");
                r.$element.removeClass("ui-selecting").addClass("ui-selected"), r.selecting = !1, r.selected = !0, r.startselected = !0, n._trigger("selected", t, {
                    selected: r.element
                })
            }), this._trigger("stop", t), this.helper.remove(), !1
        }
    })
}(jQuery),
function(e, t) {
    function n(e, t, n) {
        return e > t && e < t + n
    }
    e.widget("ui.sortable", e.ui.mouse, {
        version: "1.10.0",
        widgetEventPrefix: "sort",
        ready: !1,
        options: {
            appendTo: "parent",
            axis: !1,
            connectWith: !1,
            containment: !1,
            cursor: "auto",
            cursorAt: !1,
            dropOnEmpty: !0,
            forcePlaceholderSize: !1,
            forceHelperSize: !1,
            grid: !1,
            handle: !1,
            helper: "original",
            items: "> *",
            opacity: !1,
            placeholder: !1,
            revert: !1,
            scroll: !0,
            scrollSensitivity: 20,
            scrollSpeed: 20,
            scope: "default",
            tolerance: "intersect",
            zIndex: 1e3,
            activate: null,
            beforeStop: null,
            change: null,
            deactivate: null,
            out: null,
            over: null,
            receive: null,
            remove: null,
            sort: null,
            start: null,
            stop: null,
            update: null
        },
        _create: function() {
            var e = this.options;
            this.containerCache = {}, this.element.addClass("ui-sortable"), this.refresh(), this.floating = this.items.length ? e.axis === "x" || /left|right/.test(this.items[0].item.css("float")) || /inline|table-cell/.test(this.items[0].item.css("display")) : !1, this.offset = this.element.offset(), this._mouseInit(), this.ready = !0
        },
        _destroy: function() {
            this.element.removeClass("ui-sortable ui-sortable-disabled"), this._mouseDestroy();
            for (var e = this.items.length - 1; e >= 0; e--) this.items[e].item.removeData(this.widgetName + "-item");
            return this
        },
        _setOption: function(t, n) {
            t === "disabled" ? (this.options[t] = n, this.widget().toggleClass("ui-sortable-disabled", !!n)) : e.Widget.prototype._setOption.apply(this, arguments)
        },
        _mouseCapture: function(t, n) {
            var r = null,
                i = !1,
                s = this;
            if (this.reverting) return !1;
            if (this.options.disabled || this.options.type === "static") return !1;
            this._refreshItems(t), e(t.target).parents().each(function() {
                if (e.data(this, s.widgetName + "-item") === s) return r = e(this), !1
            }), e.data(t.target, s.widgetName + "-item") === s && (r = e(t.target));
            if (!r) return !1;
            if (this.options.handle && !n) {
                e(this.options.handle, r).find("*").addBack().each(function() {
                    this === t.target && (i = !0)
                });
                if (!i) return !1
            }
            return this.currentItem = r, this._removeCurrentsFromItems(), !0
        },
        _mouseStart: function(t, n, r) {
            var i, s = this.options;
            this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(t), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = {
                top: this.offset.top - this.margins.top,
                left: this.offset.left - this.margins.left
            }, e.extend(this.offset, {
                click: {
                    left: t.pageX - this.offset.left,
                    top: t.pageY - this.offset.top
                },
                parent: this._getParentOffset(),
                relative: this._getRelativeOffset()
            }), this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), this.originalPosition = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, s.cursorAt && this._adjustOffsetFromHelper(s.cursorAt), this.domPosition = {
                prev: this.currentItem.prev()[0],
                parent: this.currentItem.parent()[0]
            }, this.helper[0] !== this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), s.containment && this._setContainment(), s.cursor && (e("body").css("cursor") && (this._storedCursor = e("body").css("cursor")), e("body").css("cursor", s.cursor)), s.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", s.opacity)), s.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", s.zIndex)), this.scrollParent[0] !== document && this.scrollParent[0].tagName !== "HTML" && (this.overflowOffset = this.scrollParent.offset()), this._trigger("start", t, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions();
            if (!r)
                for (i = this.containers.length - 1; i >= 0; i--) this.containers[i]._trigger("activate", t, this._uiHash(this));
            return e.ui.ddmanager && (e.ui.ddmanager.current = this), e.ui.ddmanager && !s.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(t), !0
        },
        _mouseDrag: function(t) {
            var n, r, i, s, o = this.options,
                u = !1;
            this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs), this.options.scroll && (this.scrollParent[0] !== document && this.scrollParent[0].tagName !== "HTML" ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - t.pageY < o.scrollSensitivity ? this.scrollParent[0].scrollTop = u = this.scrollParent[0].scrollTop + o.scrollSpeed : t.pageY - this.overflowOffset.top < o.scrollSensitivity && (this.scrollParent[0].scrollTop = u = this.scrollParent[0].scrollTop - o.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - t.pageX < o.scrollSensitivity ? this.scrollParent[0].scrollLeft = u = this.scrollParent[0].scrollLeft + o.scrollSpeed : t.pageX - this.overflowOffset.left < o.scrollSensitivity && (this.scrollParent[0].scrollLeft = u = this.scrollParent[0].scrollLeft - o.scrollSpeed)) : (t.pageY - e(document).scrollTop() < o.scrollSensitivity ? u = e(document).scrollTop(e(document).scrollTop() - o.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < o.scrollSensitivity && (u = e(document).scrollTop(e(document).scrollTop() + o.scrollSpeed)), t.pageX - e(document).scrollLeft() < o.scrollSensitivity ? u = e(document).scrollLeft(e(document).scrollLeft() - o.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < o.scrollSensitivity && (u = e(document).scrollLeft(e(document).scrollLeft() + o.scrollSpeed))), u !== !1 && e.ui.ddmanager && !o.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t)), this.positionAbs = this._convertPositionTo("absolute");
            if (!this.options.axis || this.options.axis !== "y") this.helper[0].style.left = this.position.left + "px";
            if (!this.options.axis || this.options.axis !== "x") this.helper[0].style.top = this.position.top + "px";
            for (n = this.items.length - 1; n >= 0; n--) {
                r = this.items[n], i = r.item[0], s = this._intersectsWithPointer(r);
                if (!s) continue;
                if (r.instance !== this.currentContainer) continue;
                if (i !== this.currentItem[0] && this.placeholder[s === 1 ? "next" : "prev"]()[0] !== i && !e.contains(this.placeholder[0], i) && (this.options.type === "semi-dynamic" ? !e.contains(this.element[0], i) : !0)) {
                    this.direction = s === 1 ? "down" : "up";
                    if (this.options.tolerance !== "pointer" && !this._intersectsWithSides(r)) break;
                    this._rearrange(t, r), this._trigger("change", t, this._uiHash());
                    break
                }
            }
            return this._contactContainers(t), e.ui.ddmanager && e.ui.ddmanager.drag(this, t), this._trigger("sort", t, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1
        },
        _mouseStop: function(t, n) {
            if (!t) return;
            e.ui.ddmanager && !this.options.dropBehaviour && e.ui.ddmanager.drop(this, t);
            if (this.options.revert) {
                var r = this,
                    i = this.placeholder.offset();
                this.reverting = !0, e(this.helper).animate({
                    left: i.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollLeft),
                    top: i.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollTop)
                }, parseInt(this.options.revert, 10) || 500, function() {
                    r._clear(t)
                })
            } else this._clear(t, n);
            return !1
        },
        cancel: function() {
            if (this.dragging) {
                this._mouseUp({
                    target: null
                }), this.options.helper === "original" ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
                for (var t = this.containers.length - 1; t >= 0; t--) this.containers[t]._trigger("deactivate", null, this._uiHash(this)), this.containers[t].containerCache.over && (this.containers[t]._trigger("out", null, this._uiHash(this)), this.containers[t].containerCache.over = 0)
            }
            return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.options.helper !== "original" && this.helper && this.helper[0].parentNode && this.helper.remove(), e.extend(this, {
                helper: null,
                dragging: !1,
                reverting: !1,
                _noFinalSort: null
            }), this.domPosition.prev ? e(this.domPosition.prev).after(this.currentItem) : e(this.domPosition.parent).prepend(this.currentItem)), this
        },
        serialize: function(t) {
            var n = this._getItemsAsjQuery(t && t.connected),
                r = [];
            return t = t || {}, e(n).each(function() {
                var n = (e(t.item || this).attr(t.attribute || "id") || "").match(t.expression || /(.+)[\-=_](.+)/);
                n && r.push((t.key || n[1] + "[]") + "=" + (t.key && t.expression ? n[1] : n[2]))
            }), !r.length && t.key && r.push(t.key + "="), r.join("&")
        },
        toArray: function(t) {
            var n = this._getItemsAsjQuery(t && t.connected),
                r = [];
            return t = t || {}, n.each(function() {
                r.push(e(t.item || this).attr(t.attribute || "id") || "")
            }), r
        },
        _intersectsWith: function(e) {
            var t = this.positionAbs.left,
                n = t + this.helperProportions.width,
                r = this.positionAbs.top,
                i = r + this.helperProportions.height,
                s = e.left,
                o = s + e.width,
                u = e.top,
                a = u + e.height,
                f = this.offset.click.top,
                l = this.offset.click.left,
                c = r + f > u && r + f < a && t + l > s && t + l < o;
            return this.options.tolerance === "pointer" || this.options.forcePointerForContainers || this.options.tolerance !== "pointer" && this.helperProportions[this.floating ? "width" : "height"] > e[this.floating ? "width" : "height"] ? c : s < t + this.helperProportions.width / 2 && n - this.helperProportions.width / 2 < o && u < r + this.helperProportions.height / 2 && i - this.helperProportions.height / 2 < a
        },
        _intersectsWithPointer: function(e) {
            var t = this.options.axis === "x" || n(this.positionAbs.top + this.offset.click.top, e.top, e.height),
                r = this.options.axis === "y" || n(this.positionAbs.left + this.offset.click.left, e.left, e.width),
                i = t && r,
                s = this._getDragVerticalDirection(),
                o = this._getDragHorizontalDirection();
            return i ? this.floating ? o && o === "right" || s === "down" ? 2 : 1 : s && (s === "down" ? 2 : 1) : !1
        },
        _intersectsWithSides: function(e) {
            var t = n(this.positionAbs.top + this.offset.click.top, e.top + e.height / 2, e.height),
                r = n(this.positionAbs.left + this.offset.click.left, e.left + e.width / 2, e.width),
                i = this._getDragVerticalDirection(),
                s = this._getDragHorizontalDirection();
            return this.floating && s ? s === "right" && r || s === "left" && !r : i && (i === "down" && t || i === "up" && !t)
        },
        _getDragVerticalDirection: function() {
            var e = this.positionAbs.top - this.lastPositionAbs.top;
            return e !== 0 && (e > 0 ? "down" : "up")
        },
        _getDragHorizontalDirection: function() {
            var e = this.positionAbs.left - this.lastPositionAbs.left;
            return e !== 0 && (e > 0 ? "right" : "left")
        },
        refresh: function(e) {
            return this._refreshItems(e), this.refreshPositions(), this
        },
        _connectWith: function() {
            var e = this.options;
            return e.connectWith.constructor === String ? [e.connectWith] : e.connectWith
        },
        _getItemsAsjQuery: function(t) {
            var n, r, i, s, o = [],
                u = [],
                a = this._connectWith();
            if (a && t)
                for (n = a.length - 1; n >= 0; n--) {
                    i = e(a[n]);
                    for (r = i.length - 1; r >= 0; r--) s = e.data(i[r], this.widgetFullName), s && s !== this && !s.options.disabled && u.push([e.isFunction(s.options.items) ? s.options.items.call(s.element) : e(s.options.items, s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), s])
                }
            u.push([e.isFunction(this.options.items) ? this.options.items.call(this.element, null, {
                options: this.options,
                item: this.currentItem
            }) : e(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]);
            for (n = u.length - 1; n >= 0; n--) u[n][0].each(function() {
                o.push(this)
            });
            return e(o)
        },
        _removeCurrentsFromItems: function() {
            var t = this.currentItem.find(":data(" + this.widgetName + "-item)");
            this.items = e.grep(this.items, function(e) {
                for (var n = 0; n < t.length; n++)
                    if (t[n] === e.item[0]) return !1;
                return !0
            })
        },
        _refreshItems: function(t) {
            this.items = [], this.containers = [this];
            var n, r, i, s, o, u, a, f, l = this.items,
                c = [
                    [e.isFunction(this.options.items) ? this.options.items.call(this.element[0], t, {
                        item: this.currentItem
                    }) : e(this.options.items, this.element), this]
                ],
                h = this._connectWith();
            if (h && this.ready)
                for (n = h.length - 1; n >= 0; n--) {
                    i = e(h[n]);
                    for (r = i.length - 1; r >= 0; r--) s = e.data(i[r], this.widgetFullName), s && s !== this && !s.options.disabled && (c.push([e.isFunction(s.options.items) ? s.options.items.call(s.element[0], t, {
                        item: this.currentItem
                    }) : e(s.options.items, s.element), s]), this.containers.push(s))
                }
            for (n = c.length - 1; n >= 0; n--) {
                o = c[n][1], u = c[n][0];
                for (r = 0, f = u.length; r < f; r++) a = e(u[r]), a.data(this.widgetName + "-item", o), l.push({
                    item: a,
                    instance: o,
                    width: 0,
                    height: 0,
                    left: 0,
                    top: 0
                })
            }
        },
        refreshPositions: function(t) {
            this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset());
            var n, r, i, s;
            for (n = this.items.length - 1; n >= 0; n--) {
                r = this.items[n];
                if (r.instance !== this.currentContainer && this.currentContainer && r.item[0] !== this.currentItem[0]) continue;
                i = this.options.toleranceElement ? e(this.options.toleranceElement, r.item) : r.item, t || (r.width = i.outerWidth(), r.height = i.outerHeight()), s = i.offset(), r.left = s.left, r.top = s.top
            }
            if (this.options.custom && this.options.custom.refreshContainers) this.options.custom.refreshContainers.call(this);
            else
                for (n = this.containers.length - 1; n >= 0; n--) s = this.containers[n].element.offset(), this.containers[n].containerCache.left = s.left, this.containers[n].containerCache.top = s.top, this.containers[n].containerCache.width = this.containers[n].element.outerWidth(), this.containers[n].containerCache.height = this.containers[n].element.outerHeight();
            return this
        },
        _createPlaceholder: function(t) {
            t = t || this;
            var n, r = t.options;
            if (!r.placeholder || r.placeholder.constructor === String) n = r.placeholder, r.placeholder = {
                element: function() {
                    var r = e(document.createElement(t.currentItem[0].nodeName)).addClass(n || t.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];
                    return n || (r.style.visibility = "hidden"), r
                },
                update: function(e, i) {
                    if (n && !r.forcePlaceholderSize) return;
                    i.height() || i.height(t.currentItem.innerHeight() - parseInt(t.currentItem.css("paddingTop") || 0, 10) - parseInt(t.currentItem.css("paddingBottom") || 0, 10)), i.width() || i.width(t.currentItem.innerWidth() - parseInt(t.currentItem.css("paddingLeft") || 0, 10) - parseInt(t.currentItem.css("paddingRight") || 0, 10))
                }
            };
            t.placeholder = e(r.placeholder.element.call(t.element, t.currentItem)), t.currentItem.after(t.placeholder), r.placeholder.update(t, t.placeholder)
        },
        _contactContainers: function(t) {
            var n, r, i, s, o, u, a, f, l, c = null,
                h = null;
            for (n = this.containers.length - 1; n >= 0; n--) {
                if (e.contains(this.currentItem[0], this.containers[n].element[0])) continue;
                if (this._intersectsWith(this.containers[n].containerCache)) {
                    if (c && e.contains(this.containers[n].element[0], c.element[0])) continue;
                    c = this.containers[n], h = n
                } else this.containers[n].containerCache.over && (this.containers[n]._trigger("out", t, this._uiHash(this)), this.containers[n].containerCache.over = 0)
            }
            if (!c) return;
            if (this.containers.length === 1) this.containers[h]._trigger("over", t, this._uiHash(this)), this.containers[h].containerCache.over = 1;
            else {
                i = 1e4, s = null, o = this.containers[h].floating ? "left" : "top", u = this.containers[h].floating ? "width" : "height", a = this.positionAbs[o] + this.offset.click[o];
                for (r = this.items.length - 1; r >= 0; r--) {
                    if (!e.contains(this.containers[h].element[0], this.items[r].item[0])) continue;
                    if (this.items[r].item[0] === this.currentItem[0]) continue;
                    f = this.items[r].item.offset()[o], l = !1, Math.abs(f - a) > Math.abs(f + this.items[r][u] - a) && (l = !0, f += this.items[r][u]), Math.abs(f - a) < i && (i = Math.abs(f - a), s = this.items[r], this.direction = l ? "up" : "down")
                }
                if (!s && !this.options.dropOnEmpty) return;
                this.currentContainer = this.containers[h], s ? this._rearrange(t, s, null, !0) : this._rearrange(t, null, this.containers[h].element, !0), this._trigger("change", t, this._uiHash()), this.containers[h]._trigger("change", t, this._uiHash(this)), this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[h]._trigger("over", t, this._uiHash(this)), this.containers[h].containerCache.over = 1
            }
        },
        _createHelper: function(t) {
            var n = this.options,
                r = e.isFunction(n.helper) ? e(n.helper.apply(this.element[0], [t, this.currentItem])) : n.helper === "clone" ? this.currentItem.clone() : this.currentItem;
            return r.parents("body").length || e(n.appendTo !== "parent" ? n.appendTo : this.currentItem[0].parentNode)[0].appendChild(r[0]), r[0] === this.currentItem[0] && (this._storedCSS = {
                width: this.currentItem[0].style.width,
                height: this.currentItem[0].style.height,
                position: this.currentItem.css("position"),
                top: this.currentItem.css("top"),
                left: this.currentItem.css("left")
            }), (!r[0].style.width || n.forceHelperSize) && r.width(this.currentItem.width()), (!r[0].style.height || n.forceHelperSize) && r.height(this.currentItem.height()), r
        },
        _adjustOffsetFromHelper: function(t) {
            typeof t == "string" && (t = t.split(" ")), e.isArray(t) && (t = {
                left: +t[0],
                top: +t[1] || 0
            }), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
        },
        _getParentOffset: function() {
            this.offsetParent = this.helper.offsetParent();
            var t = this.offsetParent.offset();
            this.cssPosition === "absolute" && this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop());
            if (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() === "html" && e.ui.ie) t = {
                top: 0,
                left: 0
            };
            return {
                top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
                left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
            }
        },
        _getRelativeOffset: function() {
            if (this.cssPosition === "relative") {
                var e = this.currentItem.position();
                return {
                    top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
                    left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
                }
            }
            return {
                top: 0,
                left: 0
            }
        },
        _cacheMargins: function() {
            this.margins = {
                left: parseInt(this.currentItem.css("marginLeft"), 10) || 0,
                top: parseInt(this.currentItem.css("marginTop"), 10) || 0
            }
        },
        _cacheHelperProportions: function() {
            this.helperProportions = {
                width: this.helper.outerWidth(),
                height: this.helper.outerHeight()
            }
        },
        _setContainment: function() {
            var t, n, r, i = this.options;
            i.containment === "parent" && (i.containment = this.helper[0].parentNode);
            if (i.containment === "document" || i.containment === "window") this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, e(i.containment === "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (e(i.containment === "document" ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top];
            /^(document|window|parent)$/.test(i.containment) || (t = e(i.containment)[0], n = e(i.containment).offset(), r = e(t).css("overflow") !== "hidden", this.containment = [n.left + (parseInt(e(t).css("borderLeftWidth"), 10) || 0) + (parseInt(e(t).css("paddingLeft"), 10) || 0) - this.margins.left, n.top + (parseInt(e(t).css("borderTopWidth"), 10) || 0) + (parseInt(e(t).css("paddingTop"), 10) || 0) - this.margins.top, n.left + (r ? Math.max(t.scrollWidth, t.offsetWidth) : t.offsetWidth) - (parseInt(e(t).css("borderLeftWidth"), 10) || 0) - (parseInt(e(t).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, n.top + (r ? Math.max(t.scrollHeight, t.offsetHeight) : t.offsetHeight) - (parseInt(e(t).css("borderTopWidth"), 10) || 0) - (parseInt(e(t).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top])
        },
        _convertPositionTo: function(t, n) {
            n || (n = this.position);
            var r = t === "absolute" ? 1 : -1,
                i = this.cssPosition !== "absolute" || this.scrollParent[0] !== document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
                s = /(html|body)/i.test(i[0].tagName);
            return {
                top: n.top + this.offset.relative.top * r + this.offset.parent.top * r - (this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : s ? 0 : i.scrollTop()) * r,
                left: n.left + this.offset.relative.left * r + this.offset.parent.left * r - (this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : s ? 0 : i.scrollLeft()) * r
            }
        },
        _generatePosition: function(t) {
            var n, r, i = this.options,
                s = t.pageX,
                o = t.pageY,
                u = this.cssPosition !== "absolute" || this.scrollParent[0] !== document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
                a = /(html|body)/i.test(u[0].tagName);
            return this.cssPosition === "relative" && (this.scrollParent[0] === document || this.scrollParent[0] === this.offsetParent[0]) && (this.offset.relative = this._getRelativeOffset()), this.originalPosition && (this.containment && (t.pageX - this.offset.click.left < this.containment[0] && (s = this.containment[0] + this.offset.click.left), t.pageY - this.offset.click.top < this.containment[1] && (o = this.containment[1] + this.offset.click.top), t.pageX - this.offset.click.left > this.containment[2] && (s = this.containment[2] + this.offset.click.left), t.pageY - this.offset.click.top > this.containment[3] && (o = this.containment[3] + this.offset.click.top)), i.grid && (n = this.originalPageY + Math.round((o - this.originalPageY) / i.grid[1]) * i.grid[1], o = this.containment ? n - this.offset.click.top >= this.containment[1] && n - this.offset.click.top <= this.containment[3] ? n : n - this.offset.click.top >= this.containment[1] ? n - i.grid[1] : n + i.grid[1] : n, r = this.originalPageX + Math.round((s - this.originalPageX) / i.grid[0]) * i.grid[0], s = this.containment ? r - this.offset.click.left >= this.containment[0] && r - this.offset.click.left <= this.containment[2] ? r : r - this.offset.click.left >= this.containment[0] ? r - i.grid[0] : r + i.grid[0] : r)), {
                top: o - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : a ? 0 : u.scrollTop()),
                left: s - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : a ? 0 : u.scrollLeft())
            }
        },
        _rearrange: function(e, t, n, r) {
            n ? n[0].appendChild(this.placeholder[0]) : t.item[0].parentNode.insertBefore(this.placeholder[0], this.direction === "down" ? t.item[0] : t.item[0].nextSibling), this.counter = this.counter ? ++this.counter : 1;
            var i = this.counter;
            this._delay(function() {
                i === this.counter && this.refreshPositions(!r)
            })
        },
        _clear: function(t, n) {
            this.reverting = !1;
            var r, i = [];
            !this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem), this._noFinalSort = null;
            if (this.helper[0] === this.currentItem[0]) {
                for (r in this._storedCSS)
                    if (this._storedCSS[r] === "auto" || this._storedCSS[r] === "static") this._storedCSS[r] = "";
                this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")
            } else this.currentItem.show();
            this.fromOutside && !n && i.push(function(e) {
                this._trigger("receive", e, this._uiHash(this.fromOutside))
            }), (this.fromOutside || this.domPosition.prev !== this.currentItem.prev().not(".ui-sortable-helper")[0] || this.domPosition.parent !== this.currentItem.parent()[0]) && !n && i.push(function(e) {
                this._trigger("update", e, this._uiHash())
            }), this !== this.currentContainer && (n || (i.push(function(e) {
                this._trigger("remove", e, this._uiHash())
            }), i.push(function(e) {
                return function(t) {
                    e._trigger("receive", t, this._uiHash(this))
                }
            }.call(this, this.currentContainer)), i.push(function(e) {
                return function(t) {
                    e._trigger("update", t, this._uiHash(this))
                }
            }.call(this, this.currentContainer))));
            for (r = this.containers.length - 1; r >= 0; r--) n || i.push(function(e) {
                return function(t) {
                    e._trigger("deactivate", t, this._uiHash(this))
                }
            }.call(this, this.containers[r])), this.containers[r].containerCache.over && (i.push(function(e) {
                return function(t) {
                    e._trigger("out", t, this._uiHash(this))
                }
            }.call(this, this.containers[r])), this.containers[r].containerCache.over = 0);
            this._storedCursor && e("body").css("cursor", this._storedCursor), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", this._storedZIndex === "auto" ? "" : this._storedZIndex), this.dragging = !1;
            if (this.cancelHelperRemoval) {
                if (!n) {
                    this._trigger("beforeStop", t, this._uiHash());
                    for (r = 0; r < i.length; r++) i[r].call(this, t);
                    this._trigger("stop", t, this._uiHash())
                }
                return this.fromOutside = !1, !1
            }
            n || this._trigger("beforeStop", t, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.helper[0] !== this.currentItem[0] && this.helper.remove(), this.helper = null;
            if (!n) {
                for (r = 0; r < i.length; r++) i[r].call(this, t);
                this._trigger("stop", t, this._uiHash())
            }
            return this.fromOutside = !1, !0
        },
        _trigger: function() {
            e.Widget.prototype._trigger.apply(this, arguments) === !1 && this.cancel()
        },
        _uiHash: function(t) {
            var n = t || this;
            return {
                helper: n.helper,
                placeholder: n.placeholder || e([]),
                position: n.position,
                originalPosition: n.originalPosition,
                offset: n.positionAbs,
                item: n.currentItem,
                sender: t ? t.element : null
            }
        }
    })
}(jQuery), jQuery.effects || function(e, t) {
        var n = "ui-effects-";
        e.effects = {
                effect: {}
            },
            function(e, t) {
                function h(e, t, n) {
                    var r = u[t.type] || {};
                    return e == null ? n || !t.def ? null : t.def : (e = r.floor ? ~~e : parseFloat(e), isNaN(e) ? t.def : r.mod ? (e + r.mod) % r.mod : 0 > e ? 0 : r.max < e ? r.max : e)
                }

                function p(t) {
                    var n = s(),
                        r = n._rgba = [];
                    return t = t.toLowerCase(), c(i, function(e, i) {
                        var s, u = i.re.exec(t),
                            a = u && i.parse(u),
                            f = i.space || "rgba";
                        if (a) return s = n[f](a), n[o[f].cache] = s[o[f].cache], r = n._rgba = s._rgba, !1
                    }), r.length ? (r.join() === "0,0,0,0" && e.extend(r, l.transparent), n) : l[t]
                }

                function d(e, t, n) {
                    return n = (n + 1) % 1, n * 6 < 1 ? e + (t - e) * n * 6 : n * 2 < 1 ? t : n * 3 < 2 ? e + (t - e) * (2 / 3 - n) * 6 : e
                }
                var n = "backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",
                    r = /^([\-+])=\s*(\d+\.?\d*)/,
                    i = [{
                        re: /rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
                        parse: function(e) {
                            return [e[1], e[2], e[3], e[4]]
                        }
                    }, {
                        re: /rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
                        parse: function(e) {
                            return [e[1] * 2.55, e[2] * 2.55, e[3] * 2.55, e[4]]
                        }
                    }, {
                        re: /#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,
                        parse: function(e) {
                            return [parseInt(e[1], 16), parseInt(e[2], 16), parseInt(e[3], 16)]
                        }
                    }, {
                        re: /#([a-f0-9])([a-f0-9])([a-f0-9])/,
                        parse: function(e) {
                            return [parseInt(e[1] + e[1], 16), parseInt(e[2] + e[2], 16), parseInt(e[3] + e[3], 16)]
                        }
                    }, {
                        re: /hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
                        space: "hsla",
                        parse: function(e) {
                            return [e[1], e[2] / 100, e[3] / 100, e[4]]
                        }
                    }],
                    s = e.Color = function(t, n, r, i) {
                        return new e.Color.fn.parse(t, n, r, i)
                    },
                    o = {
                        rgba: {
                            props: {
                                red: {
                                    idx: 0,
                                    type: "byte"
                                },
                                green: {
                                    idx: 1,
                                    type: "byte"
                                },
                                blue: {
                                    idx: 2,
                                    type: "byte"
                                }
                            }
                        },
                        hsla: {
                            props: {
                                hue: {
                                    idx: 0,
                                    type: "degrees"
                                },
                                saturation: {
                                    idx: 1,
                                    type: "percent"
                                },
                                lightness: {
                                    idx: 2,
                                    type: "percent"
                                }
                            }
                        }
                    },
                    u = {
                        "byte": {
                            floor: !0,
                            max: 255
                        },
                        percent: {
                            max: 1
                        },
                        degrees: {
                            mod: 360,
                            floor: !0
                        }
                    },
                    a = s.support = {},
                    f = e("<p>")[0],
                    l, c = e.each;
                f.style.cssText = "background-color:rgba(1,1,1,.5)", a.rgba = f.style.backgroundColor.indexOf("rgba") > -1, c(o, function(e, t) {
                    t.cache = "_" + e, t.props.alpha = {
                        idx: 3,
                        type: "percent",
                        def: 1
                    }
                }), s.fn = e.extend(s.prototype, {
                    parse: function(n, r, i, u) {
                        if (n === t) return this._rgba = [null, null, null, null], this;
                        if (n.jquery || n.nodeType) n = e(n).css(r), r = t;
                        var a = this,
                            f = e.type(n),
                            d = this._rgba = [];
                        r !== t && (n = [n, r, i, u], f = "array");
                        if (f === "string") return this.parse(p(n) || l._default);
                        if (f === "array") return c(o.rgba.props, function(e, t) {
                            d[t.idx] = h(n[t.idx], t)
                        }), this;
                        if (f === "object") return n instanceof s ? c(o, function(e, t) {
                            n[t.cache] && (a[t.cache] = n[t.cache].slice())
                        }) : c(o, function(t, r) {
                            var i = r.cache;
                            c(r.props, function(e, t) {
                                if (!a[i] && r.to) {
                                    if (e === "alpha" || n[e] == null) return;
                                    a[i] = r.to(a._rgba)
                                }
                                a[i][t.idx] = h(n[e], t, !0)
                            }), a[i] && e.inArray(null, a[i].slice(0, 3)) < 0 && (a[i][3] = 1, r.from && (a._rgba = r.from(a[i])))
                        }), this
                    },
                    is: function(e) {
                        var t = s(e),
                            n = !0,
                            r = this;
                        return c(o, function(e, i) {
                            var s, o = t[i.cache];
                            return o && (s = r[i.cache] || i.to && i.to(r._rgba) || [], c(i.props, function(e, t) {
                                if (o[t.idx] != null) return n = o[t.idx] === s[t.idx], n
                            })), n
                        }), n
                    },
                    _space: function() {
                        var e = [],
                            t = this;
                        return c(o, function(n, r) {
                            t[r.cache] && e.push(n)
                        }), e.pop()
                    },
                    transition: function(e, t) {
                        var n = s(e),
                            r = n._space(),
                            i = o[r],
                            a = this.alpha() === 0 ? s("transparent") : this,
                            f = a[i.cache] || i.to(a._rgba),
                            l = f.slice();
                        return n = n[i.cache], c(i.props, function(e, r) {
                            var i = r.idx,
                                s = f[i],
                                o = n[i],
                                a = u[r.type] || {};
                            if (o === null) return;
                            s === null ? l[i] = o : (a.mod && (o - s > a.mod / 2 ? s += a.mod : s - o > a.mod / 2 && (s -= a.mod)), l[i] = h((o - s) * t + s, r))
                        }), this[r](l)
                    },
                    blend: function(t) {
                        if (this._rgba[3] === 1) return this;
                        var n = this._rgba.slice(),
                            r = n.pop(),
                            i = s(t)._rgba;
                        return s(e.map(n, function(e, t) {
                            return (1 - r) * i[t] + r * e
                        }))
                    },
                    toRgbaString: function() {
                        var t = "rgba(",
                            n = e.map(this._rgba, function(e, t) {
                                return e == null ? t > 2 ? 1 : 0 : e
                            });
                        return n[3] === 1 && (n.pop(), t = "rgb("), t + n.join() + ")"
                    },
                    toHslaString: function() {
                        var t = "hsla(",
                            n = e.map(this.hsla(), function(e, t) {
                                return e == null && (e = t > 2 ? 1 : 0), t && t < 3 && (e = Math.round(e * 100) + "%"), e
                            });
                        return n[3] === 1 && (n.pop(), t = "hsl("), t + n.join() + ")"
                    },
                    toHexString: function(t) {
                        var n = this._rgba.slice(),
                            r = n.pop();
                        return t && n.push(~~(r * 255)), "#" + e.map(n, function(e) {
                            return e = (e || 0).toString(16), e.length === 1 ? "0" + e : e
                        }).join("")
                    },
                    toString: function() {
                        return this._rgba[3] === 0 ? "transparent" : this.toRgbaString()
                    }
                }), s.fn.parse.prototype = s.fn, o.hsla.to = function(e) {
                    if (e[0] == null || e[1] == null || e[2] == null) return [null, null, null, e[3]];
                    var t = e[0] / 255,
                        n = e[1] / 255,
                        r = e[2] / 255,
                        i = e[3],
                        s = Math.max(t, n, r),
                        o = Math.min(t, n, r),
                        u = s - o,
                        a = s + o,
                        f = a * .5,
                        l, c;
                    return o === s ? l = 0 : t === s ? l = 60 * (n - r) / u + 360 : n === s ? l = 60 * (r - t) / u + 120 : l = 60 * (t - n) / u + 240, u === 0 ? c = 0 : f <= .5 ? c = u / a : c = u / (2 - a), [Math.round(l) % 360, c, f, i == null ? 1 : i]
                }, o.hsla.from = function(e) {
                    if (e[0] == null || e[1] == null || e[2] == null) return [null, null, null, e[3]];
                    var t = e[0] / 360,
                        n = e[1],
                        r = e[2],
                        i = e[3],
                        s = r <= .5 ? r * (1 + n) : r + n - r * n,
                        o = 2 * r - s;
                    return [Math.round(d(o, s, t + 1 / 3) * 255), Math.round(d(o, s, t) * 255), Math.round(d(o, s, t - 1 / 3) * 255), i]
                }, c(o, function(n, i) {
                    var o = i.props,
                        u = i.cache,
                        a = i.to,
                        f = i.from;
                    s.fn[n] = function(n) {
                        a && !this[u] && (this[u] = a(this._rgba));
                        if (n === t) return this[u].slice();
                        var r, i = e.type(n),
                            l = i === "array" || i === "object" ? n : arguments,
                            p = this[u].slice();
                        return c(o, function(e, t) {
                            var n = l[i === "object" ? e : t.idx];
                            n == null && (n = p[t.idx]), p[t.idx] = h(n, t)
                        }), f ? (r = s(f(p)), r[u] = p, r) : s(p)
                    }, c(o, function(t, i) {
                        if (s.fn[t]) return;
                        s.fn[t] = function(s) {
                            var o = e.type(s),
                                u = t === "alpha" ? this._hsla ? "hsla" : "rgba" : n,
                                a = this[u](),
                                f = a[i.idx],
                                l;
                            return o === "undefined" ? f : (o === "function" && (s = s.call(this, f), o = e.type(s)), s == null && i.empty ? this : (o === "string" && (l = r.exec(s), l && (s = f + parseFloat(l[2]) * (l[1] === "+" ? 1 : -1))), a[i.idx] = s, this[u](a)))
                        }
                    })
                }), s.hook = function(t) {
                    var n = t.split(" ");
                    c(n, function(t, n) {
                        e.cssHooks[n] = {
                            set: function(t, r) {
                                var i, o, u = "";
                                if (r !== "transparent" && (e.type(r) !== "string" || (i = p(r)))) {
                                    r = s(i || r);
                                    if (!a.rgba && r._rgba[3] !== 1) {
                                        o = n === "backgroundColor" ? t.parentNode : t;
                                        while ((u === "" || u === "transparent") && o && o.style) try {
                                            u = e.css(o, "backgroundColor"), o = o.parentNode
                                        } catch (f) {}
                                        r = r.blend(u && u !== "transparent" ? u : "_default")
                                    }
                                    r = r.toRgbaString()
                                }
                                try {
                                    t.style[n] = r
                                } catch (f) {}
                            }
                        }, e.fx.step[n] = function(t) {
                            t.colorInit || (t.start = s(t.elem, n), t.end = s(t.end), t.colorInit = !0), e.cssHooks[n].set(t.elem, t.start.transition(t.end, t.pos))
                        }
                    })
                }, s.hook(n), e.cssHooks.borderColor = {
                    expand: function(e) {
                        var t = {};
                        return c(["Top", "Right", "Bottom", "Left"], function(n, r) {
                            t["border" + r + "Color"] = e
                        }), t
                    }
                }, l = e.Color.names = {
                    aqua: "#00ffff",
                    black: "#000000",
                    blue: "#0000ff",
                    fuchsia: "#ff00ff",
                    gray: "#808080",
                    green: "#008000",
                    lime: "#00ff00",
                    maroon: "#800000",
                    navy: "#000080",
                    olive: "#808000",
                    purple: "#800080",
                    red: "#ff0000",
                    silver: "#c0c0c0",
                    teal: "#008080",
                    white: "#ffffff",
                    yellow: "#ffff00",
                    transparent: [null, null, null, 0],
                    _default: "#ffffff"
                }
            }(jQuery),
            function() {
                function i(t) {
                    var n, r, i = t.ownerDocument.defaultView ? t.ownerDocument.defaultView.getComputedStyle(t, null) : t.currentStyle,
                        s = {};
                    if (i && i.length && i[0] && i[i[0]]) {
                        r = i.length;
                        while (r--) n = i[r], typeof i[n] == "string" && (s[e.camelCase(n)] = i[n])
                    } else
                        for (n in i) typeof i[n] == "string" && (s[n] = i[n]);
                    return s
                }

                function s(t, n) {
                    var i = {},
                        s, o;
                    for (s in n) o = n[s], t[s] !== o && !r[s] && (e.fx.step[s] || !isNaN(parseFloat(o))) && (i[s] = o);
                    return i
                }
                var n = ["add", "remove", "toggle"],
                    r = {
                        border: 1,
                        borderBottom: 1,
                        borderColor: 1,
                        borderLeft: 1,
                        borderRight: 1,
                        borderTop: 1,
                        borderWidth: 1,
                        margin: 1,
                        padding: 1
                    };
                e.each(["borderLeftStyle", "borderRightStyle", "borderBottomStyle", "borderTopStyle"], function(t, n) {
                    e.fx.step[n] = function(e) {
                        if (e.end !== "none" && !e.setAttr || e.pos === 1 && !e.setAttr) jQuery.style(e.elem, n, e.end), e.setAttr = !0
                    }
                }), e.fn.addBack || (e.fn.addBack = function(e) {
                    return this.add(e == null ? this.prevObject : this.prevObject.filter(e))
                }), e.effects.animateClass = function(t, r, o, u) {
                    var a = e.speed(r, o, u);
                    return this.queue(function() {
                        var r = e(this),
                            o = r.attr("class") || "",
                            u, f = a.children ? r.find("*").addBack() : r;
                        f = f.map(function() {
                            var t = e(this);
                            return {
                                el: t,
                                start: i(this)
                            }
                        }), u = function() {
                            e.each(n, function(e, n) {
                                t[n] && r[n + "Class"](t[n])
                            })
                        }, u(), f = f.map(function() {
                            return this.end = i(this.el[0]), this.diff = s(this.start, this.end), this
                        }), r.attr("class", o), f = f.map(function() {
                            var t = this,
                                n = e.Deferred(),
                                r = e.extend({}, a, {
                                    queue: !1,
                                    complete: function() {
                                        n.resolve(t)
                                    }
                                });
                            return this.el.animate(this.diff, r), n.promise()
                        }), e.when.apply(e, f.get()).done(function() {
                            u(), e.each(arguments, function() {
                                var t = this.el;
                                e.each(this.diff, function(e) {
                                    t.css(e, "")
                                })
                            }), a.complete.call(r[0])
                        })
                    })
                }, e.fn.extend({
                    _addClass: e.fn.addClass,
                    addClass: function(t, n, r, i) {
                        return n ? e.effects.animateClass.call(this, {
                            add: t
                        }, n, r, i) : this._addClass(t)
                    },
                    _removeClass: e.fn.removeClass,
                    removeClass: function(t, n, r, i) {
                        return n ? e.effects.animateClass.call(this, {
                            remove: t
                        }, n, r, i) : this._removeClass(t)
                    },
                    _toggleClass: e.fn.toggleClass,
                    toggleClass: function(n, r, i, s, o) {
                        return typeof r == "boolean" || r === t ? i ? e.effects.animateClass.call(this, r ? {
                            add: n
                        } : {
                            remove: n
                        }, i, s, o) : this._toggleClass(n, r) : e.effects.animateClass.call(this, {
                            toggle: n
                        }, r, i, s)
                    },
                    switchClass: function(t, n, r, i, s) {
                        return e.effects.animateClass.call(this, {
                            add: n,
                            remove: t
                        }, r, i, s)
                    }
                })
            }(),
            function() {
                function r(t, n, r, i) {
                    e.isPlainObject(t) && (n = t, t = t.effect), t = {
                        effect: t
                    }, n == null && (n = {}), e.isFunction(n) && (i = n, r = null, n = {});
                    if (typeof n == "number" || e.fx.speeds[n]) i = r, r = n, n = {};
                    return e.isFunction(r) && (i = r, r = null), n && e.extend(t, n), r = r || n.duration, t.duration = e.fx.off ? 0 : typeof r == "number" ? r : r in e.fx.speeds ? e.fx.speeds[r] : e.fx.speeds._default, t.complete = i || n.complete, t
                }

                function i(t) {
                    return !t || typeof t == "number" || e.fx.speeds[t] ? !0 : typeof t == "string" && !e.effects.effect[t]
                }
                e.extend(e.effects, {
                    version: "1.10.0",
                    save: function(e, t) {
                        for (var r = 0; r < t.length; r++) t[r] !== null && e.data(n + t[r], e[0].style[t[r]])
                    },
                    restore: function(e, r) {
                        var i, s;
                        for (s = 0; s < r.length; s++) r[s] !== null && (i = e.data(n + r[s]), i === t && (i = ""), e.css(r[s], i))
                    },
                    setMode: function(e, t) {
                        return t === "toggle" && (t = e.is(":hidden") ? "show" : "hide"), t
                    },
                    getBaseline: function(e, t) {
                        var n, r;
                        switch (e[0]) {
                            case "top":
                                n = 0;
                                break;
                            case "middle":
                                n = .5;
                                break;
                            case "bottom":
                                n = 1;
                                break;
                            default:
                                n = e[0] / t.height
                        }
                        switch (e[1]) {
                            case "left":
                                r = 0;
                                break;
                            case "center":
                                r = .5;
                                break;
                            case "right":
                                r = 1;
                                break;
                            default:
                                r = e[1] / t.width
                        }
                        return {
                            x: r,
                            y: n
                        }
                    },
                    createWrapper: function(t) {
                        if (t.parent().is(".ui-effects-wrapper")) return t.parent();
                        var n = {
                                width: t.outerWidth(!0),
                                height: t.outerHeight(!0),
                                "float": t.css("float")
                            },
                            r = e("<div></div>").addClass("ui-effects-wrapper").css({
                                fontSize: "100%",
                                background: "transparent",
                                border: "none",
                                margin: 0,
                                padding: 0
                            }),
                            i = {
                                width: t.width(),
                                height: t.height()
                            },
                            s = document.activeElement;
                        try {
                            s.id
                        } catch (o) {
                            s = document.body
                        }
                        return t.wrap(r), (t[0] === s || e.contains(t[0], s)) && e(s).focus(), r = t.parent(), t.css("position") === "static" ? (r.css({
                            position: "relative"
                        }), t.css({
                            position: "relative"
                        })) : (e.extend(n, {
                            position: t.css("position"),
                            zIndex: t.css("z-index")
                        }), e.each(["top", "left", "bottom", "right"], function(e, r) {
                            n[r] = t.css(r), isNaN(parseInt(n[r], 10)) && (n[r] = "auto")
                        }), t.css({
                            position: "relative",
                            top: 0,
                            left: 0,
                            right: "auto",
                            bottom: "auto"
                        })), t.css(i), r.css(n).show()
                    },
                    removeWrapper: function(t) {
                        var n = document.activeElement;
                        return t.parent().is(".ui-effects-wrapper") && (t.parent().replaceWith(t), (t[0] === n || e.contains(t[0], n)) && e(n).focus()), t
                    },
                    setTransition: function(t, n, r, i) {
                        return i = i || {}, e.each(n, function(e, n) {
                            var s = t.cssUnit(n);
                            s[0] > 0 && (i[n] = s[0] * r + s[1])
                        }), i
                    }
                }), e.fn.extend({
                    effect: function() {
                        function o(n) {
                            function u() {
                                e.isFunction(i) && i.call(r[0]), e.isFunction(n) && n()
                            }
                            var r = e(this),
                                i = t.complete,
                                o = t.mode;
                            (r.is(":hidden") ? o === "hide" : o === "show") ? u(): s.call(r[0], t, u)
                        }
                        var t = r.apply(this, arguments),
                            n = t.mode,
                            i = t.queue,
                            s = e.effects.effect[t.effect];
                        return e.fx.off || !s ? n ? this[n](t.duration, t.complete) : this.each(function() {
                            t.complete && t.complete.call(this)
                        }) : i === !1 ? this.each(o) : this.queue(i || "fx", o)
                    },
                    _show: e.fn.show,
                    show: function(e) {
                        if (i(e)) return this._show.apply(this, arguments);
                        var t = r.apply(this, arguments);
                        return t.mode = "show", this.effect.call(this, t)
                    },
                    _hide: e.fn.hide,
                    hide: function(e) {
                        if (i(e)) return this._hide.apply(this, arguments);
                        var t = r.apply(this, arguments);
                        return t.mode = "hide", this.effect.call(this, t)
                    },
                    __toggle: e.fn.toggle,
                    toggle: function(t) {
                        if (i(t) || typeof t == "boolean" || e.isFunction(t)) return this.__toggle.apply(this, arguments);
                        var n = r.apply(this, arguments);
                        return n.mode = "toggle", this.effect.call(this, n)
                    },
                    cssUnit: function(t) {
                        var n = this.css(t),
                            r = [];
                        return e.each(["em", "px", "%", "pt"], function(e, t) {
                            n.indexOf(t) > 0 && (r = [parseFloat(n), t])
                        }), r
                    }
                })
            }(),
            function() {
                var t = {};
                e.each(["Quad", "Cubic", "Quart", "Quint", "Expo"], function(e, n) {
                    t[n] = function(t) {
                        return Math.pow(t, e + 2)
                    }
                }), e.extend(t, {
                    Sine: function(e) {
                        return 1 - Math.cos(e * Math.PI / 2)
                    },
                    Circ: function(e) {
                        return 1 - Math.sqrt(1 - e * e)
                    },
                    Elastic: function(e) {
                        return e === 0 || e === 1 ? e : -Math.pow(2, 8 * (e - 1)) * Math.sin(((e - 1) * 80 - 7.5) * Math.PI / 15)
                    },
                    Back: function(e) {
                        return e * e * (3 * e - 2)
                    },
                    Bounce: function(e) {
                        var t, n = 4;
                        while (e < ((t = Math.pow(2, --n)) - 1) / 11);
                        return 1 / Math.pow(4, 3 - n) - 7.5625 * Math.pow((t * 3 - 2) / 22 - e, 2)
                    }
                }), e.each(t, function(t, n) {
                    e.easing["easeIn" + t] = n, e.easing["easeOut" + t] = function(e) {
                        return 1 - n(1 - e)
                    }, e.easing["easeInOut" + t] = function(e) {
                        return e < .5 ? n(e * 2) / 2 : 1 - n(e * -2 + 2) / 2
                    }
                })
            }()
    }(jQuery),
    function(e, t) {
        var n = 0,
            r = {},
            i = {};
        r.height = r.paddingTop = r.paddingBottom = r.borderTopWidth = r.borderBottomWidth = "hide", i.height = i.paddingTop = i.paddingBottom = i.borderTopWidth = i.borderBottomWidth = "show", e.widget("ui.accordion", {
            version: "1.10.0",
            options: {
                active: 0,
                animate: {},
                collapsible: !1,
                event: "click",
                header: "> li > :first-child,> :not(li):even",
                heightStyle: "auto",
                icons: {
                    activeHeader: "ui-icon-triangle-1-s",
                    header: "ui-icon-triangle-1-e"
                },
                activate: null,
                beforeActivate: null
            },
            _create: function() {
                var t = this.options;
                this.prevShow = this.prevHide = e(), this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role", "tablist"), !t.collapsible && (t.active === !1 || t.active == null) && (t.active = 0), this._processPanels(), t.active < 0 && (t.active += this.headers.length), this._refresh()
            },
            _getCreateEventData: function() {
                return {
                    header: this.active,
                    content: this.active.length ? this.active.next() : e()
                }
            },
            _createIcons: function() {
                var t = this.options.icons;
                t && (e("<span>").addClass("ui-accordion-header-icon ui-icon " + t.header).prependTo(this.headers), this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader), this.headers.addClass("ui-accordion-icons"))
            },
            _destroyIcons: function() {
                this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()
            },
            _destroy: function() {
                var e;
                this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"), this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function() {
                    /^ui-accordion/.test(this.id) && this.removeAttribute("id")
                }), this._destroyIcons(), e = this.headers.next().css("display", "").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function() {
                    /^ui-accordion/.test(this.id) && this.removeAttribute("id")
                }), this.options.heightStyle !== "content" && e.css("height", "")
            },
            _setOption: function(e, t) {
                if (e === "active") {
                    this._activate(t);
                    return
                }
                e === "event" && (this.options.event && this._off(this.headers, this.options.event), this._setupEvents(t)), this._super(e, t), e === "collapsible" && !t && this.options.active === !1 && this._activate(0), e === "icons" && (this._destroyIcons(), t && this._createIcons()), e === "disabled" && this.headers.add(this.headers.next()).toggleClass("ui-state-disabled", !!t)
            },
            _keydown: function(t) {
                if (t.altKey || t.ctrlKey) return;
                var n = e.ui.keyCode,
                    r = this.headers.length,
                    i = this.headers.index(t.target),
                    s = !1;
                switch (t.keyCode) {
                    case n.RIGHT:
                    case n.DOWN:
                        s = this.headers[(i + 1) % r];
                        break;
                    case n.LEFT:
                    case n.UP:
                        s = this.headers[(i - 1 + r) % r];
                        break;
                    case n.SPACE:
                    case n.ENTER:
                        this._eventHandler(t);
                        break;
                    case n.HOME:
                        s = this.headers[0];
                        break;
                    case n.END:
                        s = this.headers[r - 1]
                }
                s && (e(t.target).attr("tabIndex", -1), e(s).attr("tabIndex", 0), s.focus(), t.preventDefault())
            },
            _panelKeyDown: function(t) {
                t.keyCode === e.ui.keyCode.UP && t.ctrlKey && e(t.currentTarget).prev().focus()
            },
            refresh: function() {
                var t = this.options;
                this._processPanels();
                if (t.active === !1 && t.collapsible === !0 || !this.headers.length) t.active = !1, this.active = e();
                t.active === !1 ? this._activate(0) : this.active.length && !e.contains(this.element[0], this.active[0]) ? this.headers.length === this.headers.find(".ui-state-disabled").length ? (t.active = !1, this.active = e()) : this._activate(Math.max(0, t.active - 1)) : t.active = this.headers.index(this.active), this._destroyIcons(), this._refresh()
            },
            _processPanels: function() {
                this.headers = this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"), this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()
            },
            _refresh: function() {
                var t, r = this.options,
                    i = r.heightStyle,
                    s = this.element.parent(),
                    o = this.accordionId = "ui-accordion-" + (this.element.attr("id") || ++n);
                this.active = this._findActive(r.active).addClass("ui-accordion-header-active ui-state-active").toggleClass("ui-corner-all ui-corner-top"), this.active.next().addClass("ui-accordion-content-active").show(), this.headers.attr("role", "tab").each(function(t) {
                    var n = e(this),
                        r = n.attr("id"),
                        i = n.next(),
                        s = i.attr("id");
                    r || (r = o + "-header-" + t, n.attr("id", r)), s || (s = o + "-panel-" + t, i.attr("id", s)), n.attr("aria-controls", s), i.attr("aria-labelledby", r)
                }).next().attr("role", "tabpanel"), this.headers.not(this.active).attr({
                    "aria-selected": "false",
                    tabIndex: -1
                }).next().attr({
                    "aria-expanded": "false",
                    "aria-hidden": "true"
                }).hide(), this.active.length ? this.active.attr({
                    "aria-selected": "true",
                    tabIndex: 0
                }).next().attr({
                    "aria-expanded": "true",
                    "aria-hidden": "false"
                }) : this.headers.eq(0).attr("tabIndex", 0), this._createIcons(), this._setupEvents(r.event), i === "fill" ? (t = s.height(), this.element.siblings(":visible").each(function() {
                    var n = e(this),
                        r = n.css("position");
                    if (r === "absolute" || r === "fixed") return;
                    t -= n.outerHeight(!0)
                }), this.headers.each(function() {
                    t -= e(this).outerHeight(!0)
                }), this.headers.next().each(function() {
                    e(this).height(Math.max(0, t - e(this).innerHeight() + e(this).height()))
                }).css("overflow", "auto")) : i === "auto" && (t = 0, this.headers.next().each(function() {
                    t = Math.max(t, e(this).css("height", "").height())
                }).height(t))
            },
            _activate: function(t) {
                var n = this._findActive(t)[0];
                if (n === this.active[0]) return;
                n = n || this.active[0], this._eventHandler({
                    target: n,
                    currentTarget: n,
                    preventDefault: e.noop
                })
            },
            _findActive: function(t) {
                return typeof t == "number" ? this.headers.eq(t) : e()
            },
            _setupEvents: function(t) {
                var n = {
                    keydown: "_keydown"
                };
                t && e.each(t.split(" "), function(e, t) {
                    n[t] = "_eventHandler"
                }), this._off(this.headers.add(this.headers.next())), this._on(this.headers, n), this._on(this.headers.next(), {
                    keydown: "_panelKeyDown"
                }), this._hoverable(this.headers), this._focusable(this.headers)
            },
            _eventHandler: function(t) {
                var n = this.options,
                    r = this.active,
                    i = e(t.currentTarget),
                    s = i[0] === r[0],
                    o = s && n.collapsible,
                    u = o ? e() : i.next(),
                    a = r.next(),
                    f = {
                        oldHeader: r,
                        oldPanel: a,
                        newHeader: o ? e() : i,
                        newPanel: u
                    };
                t.preventDefault();
                if (s && !n.collapsible || this._trigger("beforeActivate", t, f) === !1) return;
                n.active = o ? !1 : this.headers.index(i), this.active = s ? e() : i, this._toggle(f), r.removeClass("ui-accordion-header-active ui-state-active"), n.icons && r.children(".ui-accordion-header-icon").removeClass(n.icons.activeHeader).addClass(n.icons.header), s || (i.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"), n.icons && i.children(".ui-accordion-header-icon").removeClass(n.icons.header).addClass(n.icons.activeHeader), i.next().addClass("ui-accordion-content-active"))
            },
            _toggle: function(t) {
                var n = t.newPanel,
                    r = this.prevShow.length ? this.prevShow : t.oldPanel;
                this.prevShow.add(this.prevHide).stop(!0, !0), this.prevShow = n, this.prevHide = r, this.options.animate ? this._animate(n, r, t) : (r.hide(), n.show(), this._toggleComplete(t)), r.attr({
                    "aria-expanded": "false",
                    "aria-hidden": "true"
                }), r.prev().attr("aria-selected", "false"), n.length && r.length ? r.prev().attr("tabIndex", -1) : n.length && this.headers.filter(function() {
                    return e(this).attr("tabIndex") === 0
                }).attr("tabIndex", -1), n.attr({
                    "aria-expanded": "true",
                    "aria-hidden": "false"
                }).prev().attr({
                    "aria-selected": "true",
                    tabIndex: 0
                })
            },
            _animate: function(e, t, n) {
                var s, o, u, a = this,
                    f = 0,
                    l = e.length && (!t.length || e.index() < t.index()),
                    c = this.options.animate || {},
                    h = l && c.down || c,
                    p = function() {
                        a._toggleComplete(n)
                    };
                typeof h == "number" && (u = h), typeof h == "string" && (o = h), o = o || h.easing || c.easing, u = u || h.duration || c.duration;
                if (!t.length) return e.animate(i, u, o, p);
                if (!e.length) return t.animate(r, u, o, p);
                s = e.show().outerHeight(), t.animate(r, {
                    duration: u,
                    easing: o,
                    step: function(e, t) {
                        t.now = Math.round(e)
                    }
                }), e.hide().animate(i, {
                    duration: u,
                    easing: o,
                    complete: p,
                    step: function(e, n) {
                        n.now = Math.round(e), n.prop !== "height" ? f += n.now : a.options.heightStyle !== "content" && (n.now = Math.round(s - t.outerHeight() - f), f = 0)
                    }
                })
            },
            _toggleComplete: function(e) {
                var t = e.oldPanel;
                t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"), t.length && (t.parent()[0].className = t.parent()[0].className), this._trigger("activate", null, e)
            }
        })
    }(jQuery),
    function(e, t) {
        var n = 0;
        e.widget("ui.autocomplete", {
            version: "1.10.0",
            defaultElement: "<input>",
            options: {
                appendTo: null,
                autoFocus: !1,
                delay: 300,
                minLength: 1,
                position: {
                    my: "left top",
                    at: "left bottom",
                    collision: "none"
                },
                source: null,
                change: null,
                close: null,
                focus: null,
                open: null,
                response: null,
                search: null,
                select: null
            },
            pending: 0,
            _create: function() {
                var t, n, r;
                this.isMultiLine = this._isMultiLine(), this.valueMethod = this.element[this.element.is("input,textarea") ? "val" : "text"], this.isNewMenu = !0, this.element.addClass("ui-autocomplete-input").attr("autocomplete", "off"), this._on(this.element, {
                    keydown: function(i) {
                        if (this.element.prop("readOnly")) {
                            t = !0, r = !0, n = !0;
                            return
                        }
                        t = !1, r = !1, n = !1;
                        var s = e.ui.keyCode;
                        switch (i.keyCode) {
                            case s.PAGE_UP:
                                t = !0, this._move("previousPage", i);
                                break;
                            case s.PAGE_DOWN:
                                t = !0, this._move("nextPage", i);
                                break;
                            case s.UP:
                                t = !0, this._keyEvent("previous", i);
                                break;
                            case s.DOWN:
                                t = !0, this._keyEvent("next", i);
                                break;
                            case s.ENTER:
                            case s.NUMPAD_ENTER:
                                this.menu.active && (t = !0, i.preventDefault(), this.menu.select(i));
                                break;
                            case s.TAB:
                                this.menu.active && this.menu.select(i);
                                break;
                            case s.ESCAPE:
                                this.menu.element.is(":visible") && (this._value(this.term), this.close(i), i.preventDefault());
                                break;
                            default:
                                n = !0, this._searchTimeout(i)
                        }
                    },
                    keypress: function(r) {
                        if (t) {
                            t = !1, r.preventDefault();
                            return
                        }
                        if (n) return;
                        var i = e.ui.keyCode;
                        switch (r.keyCode) {
                            case i.PAGE_UP:
                                this._move("previousPage", r);
                                break;
                            case i.PAGE_DOWN:
                                this._move("nextPage", r);
                                break;
                            case i.UP:
                                this._keyEvent("previous", r);
                                break;
                            case i.DOWN:
                                this._keyEvent("next", r)
                        }
                    },
                    input: function(e) {
                        if (r) {
                            r = !1, e.preventDefault();
                            return
                        }
                        this._searchTimeout(e)
                    },
                    focus: function() {
                        this.selectedItem = null, this.previous = this._value()
                    },
                    blur: function(e) {
                        if (this.cancelBlur) {
                            delete this.cancelBlur;
                            return
                        }
                        clearTimeout(this.searching), this.close(e), this._change(e)
                    }
                }), this._initSource(), this.menu = e("<ul>").addClass("ui-autocomplete").appendTo(this._appendTo()).menu({
                    input: e(),
                    role: null
                }).zIndex(this.element.zIndex() + 1).hide().data("ui-menu"), this._on(this.menu.element, {
                    mousedown: function(t) {
                        t.preventDefault(), this.cancelBlur = !0, this._delay(function() {
                            delete this.cancelBlur
                        });
                        var n = this.menu.element[0];
                        e(t.target).closest(".ui-menu-item").length || this._delay(function() {
                            var t = this;
                            this.document.one("mousedown", function(r) {
                                r.target !== t.element[0] && r.target !== n && !e.contains(n, r.target) && t.close()
                            })
                        })
                    },
                    menufocus: function(t, n) {
                        if (this.isNewMenu) {
                            this.isNewMenu = !1;
                            if (t.originalEvent && /^mouse/.test(t.originalEvent.type)) {
                                this.menu.blur(), this.document.one("mousemove", function() {
                                    e(t.target).trigger(t.originalEvent)
                                });
                                return
                            }
                        }
                        var r = n.item.data("ui-autocomplete-item");
                        !1 !== this._trigger("focus", t, {
                            item: r
                        }) ? t.originalEvent && /^key/.test(t.originalEvent.type) && this._value(r.value) : this.liveRegion.text(r.value)
                    },
                    menuselect: function(e, t) {
                        var n = t.item.data("ui-autocomplete-item"),
                            r = this.previous;
                        this.element[0] !== this.document[0].activeElement && (this.element.focus(), this.previous = r, this._delay(function() {
                            this.previous = r, this.selectedItem = n
                        })), !1 !== this._trigger("select", e, {
                            item: n
                        }) && this._value(n.value), this.term = this._value(), this.close(e), this.selectedItem = n
                    }
                }), this.liveRegion = e("<span>", {
                    role: "status",
                    "aria-live": "polite"
                }).addClass("ui-helper-hidden-accessible").insertAfter(this.element), this._on(this.window, {
                    beforeunload: function() {
                        this.element.removeAttr("autocomplete")
                    }
                })
            },
            _destroy: function() {
                clearTimeout(this.searching), this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"), this.menu.element.remove(), this.liveRegion.remove()
            },
            _setOption: function(e, t) {
                this._super(e, t), e === "source" && this._initSource(), e === "appendTo" && this.menu.element.appendTo(this._appendTo()), e === "disabled" && t && this.xhr && this.xhr.abort()
            },
            _appendTo: function() {
                var t = this.options.appendTo;
                return t && (t = t.jquery || t.nodeType ? e(t) : this.document.find(t).eq(0)), t || (t = this.element.closest(".ui-front")), t.length || (t = this.document[0].body), t
            },
            _isMultiLine: function() {
                return this.element.is("textarea") ? !0 : this.element.is("input") ? !1 : this.element.prop("isContentEditable")
            },
            _initSource: function() {
                var t, n, r = this;
                e.isArray(this.options.source) ? (t = this.options.source, this.source = function(n, r) {
                    r(e.ui.autocomplete.filter(t, n.term))
                }) : typeof this.options.source == "string" ? (n = this.options.source, this.source = function(t, i) {
                    r.xhr && r.xhr.abort(), r.xhr = e.ajax({
                        url: n,
                        data: t,
                        dataType: "json",
                        success: function(e) {
                            i(e)
                        },
                        error: function() {
                            i([])
                        }
                    })
                }) : this.source = this.options.source
            },
            _searchTimeout: function(e) {
                clearTimeout(this.searching), this.searching = this._delay(function() {
                    this.term !== this._value() && (this.selectedItem = null, this.search(null, e))
                }, this.options.delay)
            },
            search: function(e, t) {
                e = e != null ? e : this._value(), this.term = this._value();
                if (e.length < this.options.minLength) return this.close(t);
                if (this._trigger("search", t) === !1) return;
                return this._search(e)
            },
            _search: function(e) {
                this.pending++, this.element.addClass("ui-autocomplete-loading"), this.cancelSearch = !1, this.source({
                    term: e
                }, this._response())
            },
            _response: function() {
                var e = this,
                    t = ++n;
                return function(r) {
                    t === n && e.__response(r), e.pending--, e.pending || e.element.removeClass("ui-autocomplete-loading")
                }
            },
            __response: function(e) {
                e && (e = this._normalize(e)), this._trigger("response", null, {
                    content: e
                }), !this.options.disabled && e && e.length && !this.cancelSearch ? (this._suggest(e), this._trigger("open")) : this._close()
            },
            close: function(e) {
                this.cancelSearch = !0, this._close(e)
            },
            _close: function(e) {
                this.menu.element.is(":visible") && (this.menu.element.hide(), this.menu.blur(), this.isNewMenu = !0, this._trigger("close", e))
            },
            _change: function(e) {
                this.previous !== this._value() && this._trigger("change", e, {
                    item: this.selectedItem
                })
            },
            _normalize: function(t) {
                return t.length && t[0].label && t[0].value ? t : e.map(t, function(t) {
                    return typeof t == "string" ? {
                        label: t,
                        value: t
                    } : e.extend({
                        label: t.label || t.value,
                        value: t.value || t.label
                    }, t)
                })
            },
            _suggest: function(t) {
                var n = this.menu.element.empty().zIndex(this.element.zIndex() + 1);
                this._renderMenu(n, t), this.menu.refresh(), n.show(), this._resizeMenu(), n.position(e.extend({ of: this.element
                }, this.options.position)), this.options.autoFocus && this.menu.next()
            },
            _resizeMenu: function() {
                var e = this.menu.element;
                e.outerWidth(Math.max(e.width("").outerWidth() + 1, this.element.outerWidth()))
            },
            _renderMenu: function(t, n) {
                var r = this;
                e.each(n, function(e, n) {
                    r._renderItemData(t, n)
                })
            },
            _renderItemData: function(e, t) {
                return this._renderItem(e, t).data("ui-autocomplete-item", t)
            },
            _renderItem: function(t, n) {
                return e("<li>").append(e("<a>").text(n.label)).appendTo(t)
            },
            _move: function(e, t) {
                if (!this.menu.element.is(":visible")) {
                    this.search(null, t);
                    return
                }
                if (this.menu.isFirstItem() && /^previous/.test(e) || this.menu.isLastItem() && /^next/.test(e)) {
                    this._value(this.term), this.menu.blur();
                    return
                }
                this.menu[e](t)
            },
            widget: function() {
                return this.menu.element
            },
            _value: function() {
                return this.valueMethod.apply(this.element, arguments)
            },
            _keyEvent: function(e, t) {
                if (!this.isMultiLine || this.menu.element.is(":visible")) this._move(e, t), t.preventDefault()
            }
        }), e.extend(e.ui.autocomplete, {
            escapeRegex: function(e) {
                return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&")
            },
            filter: function(t, n) {
                var r = new RegExp(e.ui.autocomplete.escapeRegex(n), "i");
                return e.grep(t, function(e) {
                    return r.test(e.label || e.value || e)
                })
            }
        }), e.widget("ui.autocomplete", e.ui.autocomplete, {
            options: {
                messages: {
                    noResults: "No search results.",
                    results: function(e) {
                        return e + (e > 1 ? " results are" : " result is") + " available, use up and down arrow keys to navigate."
                    }
                }
            },
            __response: function(e) {
                var t;
                this._superApply(arguments);
                if (this.options.disabled || this.cancelSearch) return;
                e && e.length ? t = this.options.messages.results(e.length) : t = this.options.messages.noResults, this.liveRegion.text(t)
            }
        })
    }(jQuery),
    function(e, t) {
        var n, r, i, s, o = "ui-button ui-widget ui-state-default ui-corner-all",
            u = "ui-state-hover ui-state-active ",
            a = "ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",
            f = function() {
                var t = e(this).find(":ui-button");
                setTimeout(function() {
                    t.button("refresh")
                }, 1)
            },
            l = function(t) {
                var n = t.name,
                    r = t.form,
                    i = e([]);
                return n && (n = n.replace(/'/g, "\\'"), r ? i = e(r).find("[name='" + n + "']") : i = e("[name='" + n + "']", t.ownerDocument).filter(function() {
                    return !this.form
                })), i
            };
        e.widget("ui.button", {
            version: "1.10.0",
            defaultElement: "<button>",
            options: {
                disabled: null,
                text: !0,
                label: null,
                icons: {
                    primary: null,
                    secondary: null
                }
            },
            _create: function() {
                this.element.closest("form").unbind("reset" + this.eventNamespace).bind("reset" + this.eventNamespace, f), typeof this.options.disabled != "boolean" ? this.options.disabled = !!this.element.prop("disabled") : this.element.prop("disabled", this.options.disabled), this._determineButtonType(), this.hasTitle = !!this.buttonElement.attr("title");
                var t = this,
                    u = this.options,
                    a = this.type === "checkbox" || this.type === "radio",
                    c = a ? "" : "ui-state-active",
                    h = "ui-state-focus";
                u.label === null && (u.label = this.type === "input" ? this.buttonElement.val() : this.buttonElement.html()), this._hoverable(this.buttonElement), this.buttonElement.addClass(o).attr("role", "button").bind("mouseenter" + this.eventNamespace, function() {
                    if (u.disabled) return;
                    this === n && e(this).addClass("ui-state-active")
                }).bind("mouseleave" + this.eventNamespace, function() {
                    if (u.disabled) return;
                    e(this).removeClass(c)
                }).bind("click" + this.eventNamespace, function(e) {
                    u.disabled && (e.preventDefault(), e.stopImmediatePropagation())
                }), this.element.bind("focus" + this.eventNamespace, function() {
                    t.buttonElement.addClass(h)
                }).bind("blur" + this.eventNamespace, function() {
                    t.buttonElement.removeClass(h)
                }), a && (this.element.bind("change" + this.eventNamespace, function() {
                    if (s) return;
                    t.refresh()
                }), this.buttonElement.bind("mousedown" + this.eventNamespace, function(e) {
                    if (u.disabled) return;
                    s = !1, r = e.pageX, i = e.pageY
                }).bind("mouseup" + this.eventNamespace, function(e) {
                    if (u.disabled) return;
                    if (r !== e.pageX || i !== e.pageY) s = !0
                })), this.type === "checkbox" ? this.buttonElement.bind("click" + this.eventNamespace, function() {
                    if (u.disabled || s) return !1
                }) : this.type === "radio" ? this.buttonElement.bind("click" + this.eventNamespace, function() {
                    if (u.disabled || s) return !1;
                    e(this).addClass("ui-state-active"), t.buttonElement.attr("aria-pressed", "true");
                    var n = t.element[0];
                    l(n).not(n).map(function() {
                        return e(this).button("widget")[0]
                    }).removeClass("ui-state-active").attr("aria-pressed", "false")
                }) : (this.buttonElement.bind("mousedown" + this.eventNamespace, function() {
                    if (u.disabled) return !1;
                    e(this).addClass("ui-state-active"), n = this, t.document.one("mouseup", function() {
                        n = null
                    })
                }).bind("mouseup" + this.eventNamespace, function() {
                    if (u.disabled) return !1;
                    e(this).removeClass("ui-state-active")
                }).bind("keydown" + this.eventNamespace, function(t) {
                    if (u.disabled) return !1;
                    (t.keyCode === e.ui.keyCode.SPACE || t.keyCode === e.ui.keyCode.ENTER) && e(this).addClass("ui-state-active")
                }).bind("keyup" + this.eventNamespace + " blur" + this.eventNamespace, function() {
                    e(this).removeClass("ui-state-active")
                }), this.buttonElement.is("a") && this.buttonElement.keyup(function(t) {
                    t.keyCode === e.ui.keyCode.SPACE && e(this).click()
                })), this._setOption("disabled", u.disabled), this._resetButton()
            },
            _determineButtonType: function() {
                var e, t, n;
                this.element.is("[type=checkbox]") ? this.type = "checkbox" : this.element.is("[type=radio]") ? this.type = "radio" : this.element.is("input") ? this.type = "input" : this.type = "button", this.type === "checkbox" || this.type === "radio" ? (e = this.element.parents().last(), t = "label[for='" + this.element.attr("id") + "']", this.buttonElement = e.find(t), this.buttonElement.length || (e = e.length ? e.siblings() : this.element.siblings(), this.buttonElement = e.filter(t), this.buttonElement.length || (this.buttonElement = e.find(t))), this.element.addClass("ui-helper-hidden-accessible"), n = this.element.is(":checked"), n && this.buttonElement.addClass("ui-state-active"), this.buttonElement.prop("aria-pressed", n)) : this.buttonElement = this.element
            },
            widget: function() {
                return this.buttonElement
            },
            _destroy: function() {
                this.element.removeClass("ui-helper-hidden-accessible"), this.buttonElement.removeClass(o + " " + u + " " + a).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()), this.hasTitle || this.buttonElement.removeAttr("title")
            },
            _setOption: function(e, t) {
                this._super(e, t);
                if (e === "disabled") {
                    t ? this.element.prop("disabled", !0) : this.element.prop("disabled", !1);
                    return
                }
                this._resetButton()
            },
            refresh: function() {
                var t = this.element.is("input, button") ? this.element.is(":disabled") : this.element.hasClass("ui-button-disabled");
                t !== this.options.disabled && this._setOption("disabled", t), this.type === "radio" ? l(this.element[0]).each(function() {
                    e(this).is(":checked") ? e(this).button("widget").addClass("ui-state-active").attr("aria-pressed", "true") : e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed", "false")
                }) : this.type === "checkbox" && (this.element.is(":checked") ? this.buttonElement.addClass("ui-state-active").attr("aria-pressed", "true") : this.buttonElement.removeClass("ui-state-active").attr("aria-pressed", "false"))
            },
            _resetButton: function() {
                if (this.type === "input") {
                    this.options.label && this.element.val(this.options.label);
                    return
                }
                var t = this.buttonElement.removeClass(a),
                    n = e("<span></span>", this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),
                    r = this.options.icons,
                    i = r.primary && r.secondary,
                    s = [];
                r.primary || r.secondary ? (this.options.text && s.push("ui-button-text-icon" + (i ? "s" : r.primary ? "-primary" : "-secondary")), r.primary && t.prepend("<span class='ui-button-icon-primary ui-icon " + r.primary + "'></span>"), r.secondary && t.append("<span class='ui-button-icon-secondary ui-icon " + r.secondary + "'></span>"), this.options.text || (s.push(i ? "ui-button-icons-only" : "ui-button-icon-only"), this.hasTitle || t.attr("title", e.trim(n)))) : s.push("ui-button-text-only"), t.addClass(s.join(" "))
            }
        }), e.widget("ui.buttonset", {
            version: "1.10.0",
            options: {
                items: "button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"
            },
            _create: function() {
                this.element.addClass("ui-buttonset")
            },
            _init: function() {
                this.refresh()
            },
            _setOption: function(e, t) {
                e === "disabled" && this.buttons.button("option", e, t), this._super(e, t)
            },
            refresh: function() {
                var t = this.element.css("direction") === "rtl";
                this.buttons = this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function() {
                    return e(this).button("widget")[0]
                }).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t ? "ui-corner-right" : "ui-corner-left").end().filter(":last").addClass(t ? "ui-corner-left" : "ui-corner-right").end().end()
            },
            _destroy: function() {
                this.element.removeClass("ui-buttonset"), this.buttons.map(function() {
                    return e(this).button("widget")[0]
                }).removeClass("ui-corner-left ui-corner-right").end().button("destroy")
            }
        })
    }(jQuery),
    function(e, t) {
        function s() {
            this._curInst = null, this._keyEvent = !1, this._disabledInputs = [], this._datepickerShowing = !1, this._inDialog = !1, this._mainDivId = "ui-datepicker-div", this._inlineClass = "ui-datepicker-inline", this._appendClass = "ui-datepicker-append", this._triggerClass = "ui-datepicker-trigger", this._dialogClass = "ui-datepicker-dialog", this._disableClass = "ui-datepicker-disabled", this._unselectableClass = "ui-datepicker-unselectable", this._currentClass = "ui-datepicker-current-day", this._dayOverClass = "ui-datepicker-days-cell-over", this.regional = [], this.regional[""] = {
                closeText: "Done",
                prevText: "Prev",
                nextText: "Next",
                currentText: "Today",
                monthNames: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
                monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                dayNames: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
                dayNamesShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
                dayNamesMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
                weekHeader: "Wk",
                dateFormat: "mm/dd/yy",
                firstDay: 0,
                isRTL: !1,
                showMonthAfterYear: !1,
                yearSuffix: ""
            }, this._defaults = {
                showOn: "focus",
                showAnim: "fadeIn",
                showOptions: {},
                defaultDate: null,
                appendText: "",
                buttonText: "...",
                buttonImage: "",
                buttonImageOnly: !1,
                hideIfNoPrevNext: !1,
                navigationAsDateFormat: !1,
                gotoCurrent: !1,
                changeMonth: !1,
                changeYear: !1,
                yearRange: "c-10:c+10",
                showOtherMonths: !1,
                selectOtherMonths: !1,
                showWeek: !1,
                calculateWeek: this.iso8601Week,
                shortYearCutoff: "+10",
                minDate: null,
                maxDate: null,
                duration: "fast",
                beforeShowDay: null,
                beforeShow: null,
                onSelect: null,
                onChangeMonthYear: null,
                onClose: null,
                numberOfMonths: 1,
                showCurrentAtPos: 0,
                stepMonths: 1,
                stepBigMonths: 12,
                altField: "",
                altFormat: "",
                constrainInput: !0,
                showButtonPanel: !1,
                autoSize: !1,
                disabled: !1
            }, e.extend(this._defaults, this.regional[""]), this.dpDiv = o(e("<div id='" + this._mainDivId + "' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))
        }

        function o(t) {
            var n = "button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";
            return t.delegate(n, "mouseout", function() {
                e(this).removeClass("ui-state-hover"), this.className.indexOf("ui-datepicker-prev") !== -1 && e(this).removeClass("ui-datepicker-prev-hover"), this.className.indexOf("ui-datepicker-next") !== -1 && e(this).removeClass("ui-datepicker-next-hover")
            }).delegate(n, "mouseover", function() {
                e.datepicker._isDisabledDatepicker(i.inline ? t.parent()[0] : i.input[0]) || (e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"), e(this).addClass("ui-state-hover"), this.className.indexOf("ui-datepicker-prev") !== -1 && e(this).addClass("ui-datepicker-prev-hover"), this.className.indexOf("ui-datepicker-next") !== -1 && e(this).addClass("ui-datepicker-next-hover"))
            })
        }

        function u(t, n) {
            e.extend(t, n);
            for (var r in n) n[r] == null && (t[r] = n[r]);
            return t
        }
        e.extend(e.ui, {
            datepicker: {
                version: "1.10.0"
            }
        });
        var n = "datepicker",
            r = (new Date).getTime(),
            i;
        e.extend(s.prototype, {
            markerClassName: "hasDatepicker",
            maxRows: 4,
            _widgetDatepicker: function() {
                return this.dpDiv
            },
            setDefaults: function(e) {
                return u(this._defaults, e || {}), this
            },
            _attachDatepicker: function(t, n) {
                var r, i, s;
                r = t.nodeName.toLowerCase(), i = r === "div" || r === "span", t.id || (this.uuid += 1, t.id = "dp" + this.uuid), s = this._newInst(e(t), i), s.settings = e.extend({}, n || {}), r === "input" ? this._connectDatepicker(t, s) : i && this._inlineDatepicker(t, s)
            },
            _newInst: function(t, n) {
                var r = t[0].id.replace(/([^A-Za-z0-9_\-])/g, "\\\\$1");
                return {
                    id: r,
                    input: t,
                    selectedDay: 0,
                    selectedMonth: 0,
                    selectedYear: 0,
                    drawMonth: 0,
                    drawYear: 0,
                    inline: n,
                    dpDiv: n ? o(e("<div class='" + this._inlineClass + " ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")) : this.dpDiv
                }
            },
            _connectDatepicker: function(t, r) {
                var i = e(t);
                r.append = e([]), r.trigger = e([]);
                if (i.hasClass(this.markerClassName)) return;
                this._attachments(i, r), i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp), this._autoSize(r), e.data(t, n, r), r.settings.disabled && this._disableDatepicker(t)
            },
            _attachments: function(t, n) {
                var r, i, s, o = this._get(n, "appendText"),
                    u = this._get(n, "isRTL");
                n.append && n.append.remove(), o && (n.append = e("<span class='" + this._appendClass + "'>" + o + "</span>"), t[u ? "before" : "after"](n.append)), t.unbind("focus", this._showDatepicker), n.trigger && n.trigger.remove(), r = this._get(n, "showOn"), (r === "focus" || r === "both") && t.focus(this._showDatepicker);
                if (r === "button" || r === "both") i = this._get(n, "buttonText"), s = this._get(n, "buttonImage"), n.trigger = e(this._get(n, "buttonImageOnly") ? e("<img/>").addClass(this._triggerClass).attr({
                    src: s,
                    alt: i,
                    title: i
                }) : e("<button type='button'></button>").addClass(this._triggerClass).html(s ? e("<img/>").attr({
                    src: s,
                    alt: i,
                    title: i
                }) : i)), t[u ? "before" : "after"](n.trigger), n.trigger.click(function() {
                    return e.datepicker._datepickerShowing && e.datepicker._lastInput === t[0] ? e.datepicker._hideDatepicker() : e.datepicker._datepickerShowing && e.datepicker._lastInput !== t[0] ? (e.datepicker._hideDatepicker(), e.datepicker._showDatepicker(t[0])) : e.datepicker._showDatepicker(t[0]), !1
                })
            },
            _autoSize: function(e) {
                if (this._get(e, "autoSize") && !e.inline) {
                    var t, n, r, i, s = new Date(2009, 11, 20),
                        o = this._get(e, "dateFormat");
                    o.match(/[DM]/) && (t = function(e) {
                        n = 0, r = 0;
                        for (i = 0; i < e.length; i++) e[i].length > n && (n = e[i].length, r = i);
                        return r
                    }, s.setMonth(t(this._get(e, o.match(/MM/) ? "monthNames" : "monthNamesShort"))), s.setDate(t(this._get(e, o.match(/DD/) ? "dayNames" : "dayNamesShort")) + 20 - s.getDay())), e.input.attr("size", this._formatDate(e, s).length)
                }
            },
            _inlineDatepicker: function(t, r) {
                var i = e(t);
                if (i.hasClass(this.markerClassName)) return;
                i.addClass(this.markerClassName).append(r.dpDiv), e.data(t, n, r), this._setDate(r, this._getDefaultDate(r), !0), this._updateDatepicker(r), this._updateAlternate(r), r.settings.disabled && this._disableDatepicker(t), r.dpDiv.css("display", "block")
            },
            _dialogDatepicker: function(t, r, i, s, o) {
                var a, f, l, c, h, p = this._dialogInst;
                return p || (this.uuid += 1, a = "dp" + this.uuid, this._dialogInput = e("<input type='text' id='" + a + "' style='position: absolute; top: -100px; width: 0px;'/>"), this._dialogInput.keydown(this._doKeyDown), e("body").append(this._dialogInput), p = this._dialogInst = this._newInst(this._dialogInput, !1), p.settings = {}, e.data(this._dialogInput[0], n, p)), u(p.settings, s || {}), r = r && r.constructor === Date ? this._formatDate(p, r) : r, this._dialogInput.val(r), this._pos = o ? o.length ? o : [o.pageX, o.pageY] : null, this._pos || (f = document.documentElement.clientWidth, l = document.documentElement.clientHeight, c = document.documentElement.scrollLeft || document.body.scrollLeft, h = document.documentElement.scrollTop || document.body.scrollTop, this._pos = [f / 2 - 100 + c, l / 2 - 150 + h]), this._dialogInput.css("left", this._pos[0] + 20 + "px").css("top", this._pos[1] + "px"), p.settings.onSelect = i, this._inDialog = !0, this.dpDiv.addClass(this._dialogClass), this._showDatepicker(this._dialogInput[0]), e.blockUI && e.blockUI(this.dpDiv), e.data(this._dialogInput[0], n, p), this
            },
            _destroyDatepicker: function(t) {
                var r, i = e(t),
                    s = e.data(t, n);
                if (!i.hasClass(this.markerClassName)) return;
                r = t.nodeName.toLowerCase(), e.removeData(t, n), r === "input" ? (s.append.remove(), s.trigger.remove(), i.removeClass(this.markerClassName).unbind("focus", this._showDatepicker).unbind("keydown", this._doKeyDown).unbind("keypress", this._doKeyPress).unbind("keyup", this._doKeyUp)) : (r === "div" || r === "span") && i.removeClass(this.markerClassName).empty()
            },
            _enableDatepicker: function(t) {
                var r, i, s = e(t),
                    o = e.data(t, n);
                if (!s.hasClass(this.markerClassName)) return;
                r = t.nodeName.toLowerCase();
                if (r === "input") t.disabled = !1, o.trigger.filter("button").each(function() {
                    this.disabled = !1
                }).end().filter("img").css({
                    opacity: "1.0",
                    cursor: ""
                });
                else if (r === "div" || r === "span") i = s.children("." + this._inlineClass), i.children().removeClass("ui-state-disabled"), i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !1);
                this._disabledInputs = e.map(this._disabledInputs, function(e) {
                    return e === t ? null : e
                })
            },
            _disableDatepicker: function(t) {
                var r, i, s = e(t),
                    o = e.data(t, n);
                if (!s.hasClass(this.markerClassName)) return;
                r = t.nodeName.toLowerCase();
                if (r === "input") t.disabled = !0, o.trigger.filter("button").each(function() {
                    this.disabled = !0
                }).end().filter("img").css({
                    opacity: "0.5",
                    cursor: "default"
                });
                else if (r === "div" || r === "span") i = s.children("." + this._inlineClass), i.children().addClass("ui-state-disabled"), i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !0);
                this._disabledInputs = e.map(this._disabledInputs, function(e) {
                    return e === t ? null : e
                }), this._disabledInputs[this._disabledInputs.length] = t
            },
            _isDisabledDatepicker: function(e) {
                if (!e) return !1;
                for (var t = 0; t < this._disabledInputs.length; t++)
                    if (this._disabledInputs[t] === e) return !0;
                return !1
            },
            _getInst: function(t) {
                try {
                    return e.data(t, n)
                } catch (r) {
                    throw "Missing instance data for this datepicker"
                }
            },
            _optionDatepicker: function(n, r, i) {
                var s, o, a, f, l = this._getInst(n);
                if (arguments.length === 2 && typeof r == "string") return r === "defaults" ? e.extend({}, e.datepicker._defaults) : l ? r === "all" ? e.extend({}, l.settings) : this._get(l, r) : null;
                s = r || {}, typeof r == "string" && (s = {}, s[r] = i), l && (this._curInst === l && this._hideDatepicker(), o = this._getDateDatepicker(n, !0), a = this._getMinMaxDate(l, "min"), f = this._getMinMaxDate(l, "max"), u(l.settings, s), a !== null && s.dateFormat !== t && s.minDate === t && (l.settings.minDate = this._formatDate(l, a)), f !== null && s.dateFormat !== t && s.maxDate === t && (l.settings.maxDate = this._formatDate(l, f)), "disabled" in s && (s.disabled ? this._disableDatepicker(n) : this._enableDatepicker(n)), this._attachments(e(n), l), this._autoSize(l), this._setDate(l, o), this._updateAlternate(l), this._updateDatepicker(l))
            },
            _changeDatepicker: function(e, t, n) {
                this._optionDatepicker(e, t, n)
            },
            _refreshDatepicker: function(e) {
                var t = this._getInst(e);
                t && this._updateDatepicker(t)
            },
            _setDateDatepicker: function(e, t) {
                var n = this._getInst(e);
                n && (this._setDate(n, t), this._updateDatepicker(n), this._updateAlternate(n))
            },
            _getDateDatepicker: function(e, t) {
                var n = this._getInst(e);
                return n && !n.inline && this._setDateFromField(n, t), n ? this._getDate(n) : null
            },
            _doKeyDown: function(t) {
                var n, r, i, s = e.datepicker._getInst(t.target),
                    o = !0,
                    u = s.dpDiv.is(".ui-datepicker-rtl");
                s._keyEvent = !0;
                if (e.datepicker._datepickerShowing) switch (t.keyCode) {
                    case 9:
                        e.datepicker._hideDatepicker(), o = !1;
                        break;
                    case 13:
                        return i = e("td." + e.datepicker._dayOverClass + ":not(." + e.datepicker._currentClass + ")", s.dpDiv), i[0] && e.datepicker._selectDay(t.target, s.selectedMonth, s.selectedYear, i[0]), n = e.datepicker._get(s, "onSelect"), n ? (r = e.datepicker._formatDate(s), n.apply(s.input ? s.input[0] : null, [r, s])) : e.datepicker._hideDatepicker(), !1;
                    case 27:
                        e.datepicker._hideDatepicker();
                        break;
                    case 33:
                        e.datepicker._adjustDate(t.target, t.ctrlKey ? -e.datepicker._get(s, "stepBigMonths") : -e.datepicker._get(s, "stepMonths"), "M");
                        break;
                    case 34:
                        e.datepicker._adjustDate(t.target, t.ctrlKey ? +e.datepicker._get(s, "stepBigMonths") : +e.datepicker._get(s, "stepMonths"), "M");
                        break;
                    case 35:
                        (t.ctrlKey || t.metaKey) && e.datepicker._clearDate(t.target), o = t.ctrlKey || t.metaKey;
                        break;
                    case 36:
                        (t.ctrlKey || t.metaKey) && e.datepicker._gotoToday(t.target), o = t.ctrlKey || t.metaKey;
                        break;
                    case 37:
                        (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, u ? 1 : -1, "D"), o = t.ctrlKey || t.metaKey, t.originalEvent.altKey && e.datepicker._adjustDate(t.target, t.ctrlKey ? -e.datepicker._get(s, "stepBigMonths") : -e.datepicker._get(s, "stepMonths"), "M");
                        break;
                    case 38:
                        (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, -7, "D"), o = t.ctrlKey || t.metaKey;
                        break;
                    case 39:
                        (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, u ? -1 : 1, "D"), o = t.ctrlKey || t.metaKey, t.originalEvent.altKey && e.datepicker._adjustDate(t.target, t.ctrlKey ? +e.datepicker._get(s, "stepBigMonths") : +e.datepicker._get(s, "stepMonths"), "M");
                        break;
                    case 40:
                        (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, 7, "D"), o = t.ctrlKey || t.metaKey;
                        break;
                    default:
                        o = !1
                } else t.keyCode === 36 && t.ctrlKey ? e.datepicker._showDatepicker(this) : o = !1;
                o && (t.preventDefault(), t.stopPropagation())
            },
            _doKeyPress: function(t) {
                var n, r, i = e.datepicker._getInst(t.target);
                if (e.datepicker._get(i, "constrainInput")) return n = e.datepicker._possibleChars(e.datepicker._get(i, "dateFormat")), r = String.fromCharCode(t.charCode == null ? t.keyCode : t.charCode), t.ctrlKey || t.metaKey || r < " " || !n || n.indexOf(r) > -1
            },
            _doKeyUp: function(t) {
                var n, r = e.datepicker._getInst(t.target);
                if (r.input.val() !== r.lastVal) try {
                    n = e.datepicker.parseDate(e.datepicker._get(r, "dateFormat"), r.input ? r.input.val() : null, e.datepicker._getFormatConfig(r)), n && (e.datepicker._setDateFromField(r), e.datepicker._updateAlternate(r), e.datepicker._updateDatepicker(r))
                } catch (i) {}
                return !0
            },
            _showDatepicker: function(t) {
                t = t.target || t, t.nodeName.toLowerCase() !== "input" && (t = e("input", t.parentNode)[0]);
                if (e.datepicker._isDisabledDatepicker(t) || e.datepicker._lastInput === t) return;
                var n, r, i, s, o, a, f;
                n = e.datepicker._getInst(t), e.datepicker._curInst && e.datepicker._curInst !== n && (e.datepicker._curInst.dpDiv.stop(!0, !0), n && e.datepicker._datepickerShowing && e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])), r = e.datepicker._get(n, "beforeShow"), i = r ? r.apply(t, [t, n]) : {};
                if (i === !1) return;
                u(n.settings, i), n.lastVal = null, e.datepicker._lastInput = t, e.datepicker._setDateFromField(n), e.datepicker._inDialog && (t.value = ""), e.datepicker._pos || (e.datepicker._pos = e.datepicker._findPos(t), e.datepicker._pos[1] += t.offsetHeight), s = !1, e(t).parents().each(function() {
                    return s |= e(this).css("position") === "fixed", !s
                }), o = {
                    left: e.datepicker._pos[0],
                    top: e.datepicker._pos[1]
                }, e.datepicker._pos = null, n.dpDiv.empty(), n.dpDiv.css({
                    position: "absolute",
                    display: "block",
                    top: "-1000px"
                }), e.datepicker._updateDatepicker(n), o = e.datepicker._checkOffset(n, o, s), n.dpDiv.css({
                    position: e.datepicker._inDialog && e.blockUI ? "static" : s ? "fixed" : "absolute",
                    display: "none",
                    left: o.left + "px",
                    top: o.top + "px"
                }), n.inline || (a = e.datepicker._get(n, "showAnim"), f = e.datepicker._get(n, "duration"), n.dpDiv.zIndex(e(t).zIndex() + 1), e.datepicker._datepickerShowing = !0, e.effects && e.effects.effect[a] ? n.dpDiv.show(a, e.datepicker._get(n, "showOptions"), f) : n.dpDiv[a || "show"](a ? f : null), n.input.is(":visible") && !n.input.is(":disabled") && n.input.focus(), e.datepicker._curInst = n)
            },
            _updateDatepicker: function(t) {
                this.maxRows = 4, i = t, t.dpDiv.empty().append(this._generateHTML(t)), this._attachHandlers(t), t.dpDiv.find("." + this._dayOverClass + " a").mouseover();
                var n, r = this._getNumberOfMonths(t),
                    s = r[1],
                    o = 17;
                t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""), s > 1 && t.dpDiv.addClass("ui-datepicker-multi-" + s).css("width", o * s + "em"), t.dpDiv[(r[0] !== 1 || r[1] !== 1 ? "add" : "remove") + "Class"]("ui-datepicker-multi"), t.dpDiv[(this._get(t, "isRTL") ? "add" : "remove") + "Class"]("ui-datepicker-rtl"), t === e.datepicker._curInst && e.datepicker._datepickerShowing && t.input && t.input.is(":visible") && !t.input.is(":disabled") && t.input[0] !== document.activeElement && t.input.focus(), t.yearshtml && (n = t.yearshtml, setTimeout(function() {
                    n === t.yearshtml && t.yearshtml && t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml), n = t.yearshtml = null
                }, 0))
            },
            _getBorders: function(e) {
                var t = function(e) {
                    return {
                        thin: 1,
                        medium: 2,
                        thick: 3
                    }[e] || e
                };
                return [parseFloat(t(e.css("border-left-width"))), parseFloat(t(e.css("border-top-width")))]
            },
            _checkOffset: function(t, n, r) {
                var i = t.dpDiv.outerWidth(),
                    s = t.dpDiv.outerHeight(),
                    o = t.input ? t.input.outerWidth() : 0,
                    u = t.input ? t.input.outerHeight() : 0,
                    a = document.documentElement.clientWidth + (r ? 0 : e(document).scrollLeft()),
                    f = document.documentElement.clientHeight + (r ? 0 : e(document).scrollTop());
                return n.left -= this._get(t, "isRTL") ? i - o : 0, n.left -= r && n.left === t.input.offset().left ? e(document).scrollLeft() : 0, n.top -= r && n.top === t.input.offset().top + u ? e(document).scrollTop() : 0, n.left -= Math.min(n.left, n.left + i > a && a > i ? Math.abs(n.left + i - a) : 0), n.top -= Math.min(n.top, n.top + s > f && f > s ? Math.abs(s + u) : 0), n
            },
            _findPos: function(t) {
                var n, r = this._getInst(t),
                    i = this._get(r, "isRTL");
                while (t && (t.type === "hidden" || t.nodeType !== 1 || e.expr.filters.hidden(t))) t = t[i ? "previousSibling" : "nextSibling"];
                return n = e(t).offset(), [n.left, n.top]
            },
            _hideDatepicker: function(t) {
                var r, i, s, o, u = this._curInst;
                if (!u || t && u !== e.data(t, n)) return;
                this._datepickerShowing && (r = this._get(u, "showAnim"), i = this._get(u, "duration"), s = function() {
                    e.datepicker._tidyDialog(u)
                }, e.effects && (e.effects.effect[r] || e.effects[r]) ? u.dpDiv.hide(r, e.datepicker._get(u, "showOptions"), i, s) : u.dpDiv[r === "slideDown" ? "slideUp" : r === "fadeIn" ? "fadeOut" : "hide"](r ? i : null, s), r || s(), this._datepickerShowing = !1, o = this._get(u, "onClose"), o && o.apply(u.input ? u.input[0] : null, [u.input ? u.input.val() : "", u]), this._lastInput = null, this._inDialog && (this._dialogInput.css({
                    position: "absolute",
                    left: "0",
                    top: "-100px"
                }), e.blockUI && (e.unblockUI(), e("body").append(this.dpDiv))), this._inDialog = !1)
            },
            _tidyDialog: function(e) {
                e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")
            },
            _checkExternalClick: function(t) {
                if (!e.datepicker._curInst) return;
                var n = e(t.target),
                    r = e.datepicker._getInst(n[0]);
                (n[0].id !== e.datepicker._mainDivId && n.parents("#" + e.datepicker._mainDivId).length === 0 && !n.hasClass(e.datepicker.markerClassName) && !n.closest("." + e.datepicker._triggerClass).length && e.datepicker._datepickerShowing && (!e.datepicker._inDialog || !e.blockUI) || n.hasClass(e.datepicker.markerClassName) && e.datepicker._curInst !== r) && e.datepicker._hideDatepicker()
            },
            _adjustDate: function(t, n, r) {
                var i = e(t),
                    s = this._getInst(i[0]);
                if (this._isDisabledDatepicker(i[0])) return;
                this._adjustInstDate(s, n + (r === "M" ? this._get(s, "showCurrentAtPos") : 0), r), this._updateDatepicker(s)
            },
            _gotoToday: function(t) {
                var n, r = e(t),
                    i = this._getInst(r[0]);
                this._get(i, "gotoCurrent") && i.currentDay ? (i.selectedDay = i.currentDay, i.drawMonth = i.selectedMonth = i.currentMonth, i.drawYear = i.selectedYear = i.currentYear) : (n = new Date, i.selectedDay = n.getDate(), i.drawMonth = i.selectedMonth = n.getMonth(), i.drawYear = i.selectedYear = n.getFullYear()), this._notifyChange(i), this._adjustDate(r)
            },
            _selectMonthYear: function(t, n, r) {
                var i = e(t),
                    s = this._getInst(i[0]);
                s["selected" + (r === "M" ? "Month" : "Year")] = s["draw" + (r === "M" ? "Month" : "Year")] = parseInt(n.options[n.selectedIndex].value, 10), this._notifyChange(s), this._adjustDate(i)
            },
            _selectDay: function(t, n, r, i) {
                var s, o = e(t);
                if (e(i).hasClass(this._unselectableClass) || this._isDisabledDatepicker(o[0])) return;
                s = this._getInst(o[0]), s.selectedDay = s.currentDay = e("a", i).html(), s.selectedMonth = s.currentMonth = n, s.selectedYear = s.currentYear = r, this._selectDate(t, this._formatDate(s, s.currentDay, s.currentMonth, s.currentYear))
            },
            _clearDate: function(t) {
                var n = e(t);
                this._selectDate(n, "")
            },
            _selectDate: function(t, n) {
                var r, i = e(t),
                    s = this._getInst(i[0]);
                n = n != null ? n : this._formatDate(s), s.input && s.input.val(n), this._updateAlternate(s), r = this._get(s, "onSelect"), r ? r.apply(s.input ? s.input[0] : null, [n, s]) : s.input && s.input.trigger("change"), s.inline ? this._updateDatepicker(s) : (this._hideDatepicker(), this._lastInput = s.input[0], typeof s.input[0] != "object" && s.input.focus(), this._lastInput = null)
            },
            _updateAlternate: function(t) {
                var n, r, i, s = this._get(t, "altField");
                s && (n = this._get(t, "altFormat") || this._get(t, "dateFormat"), r = this._getDate(t), i = this.formatDate(n, r, this._getFormatConfig(t)), e(s).each(function() {
                    e(this).val(i)
                }))
            },
            noWeekends: function(e) {
                var t = e.getDay();
                return [t > 0 && t < 6, ""]
            },
            iso8601Week: function(e) {
                var t, n = new Date(e.getTime());
                return n.setDate(n.getDate() + 4 - (n.getDay() || 7)), t = n.getTime(), n.setMonth(0), n.setDate(1), Math.floor(Math.round((t - n) / 864e5) / 7) + 1
            },
            parseDate: function(t, n, r) {
                if (t == null || n == null) throw "Invalid arguments";
                n = typeof n == "object" ? n.toString() : n + "";
                if (n === "") return null;
                var i, s, o, u = 0,
                    a = (r ? r.shortYearCutoff : null) || this._defaults.shortYearCutoff,
                    f = typeof a != "string" ? a : (new Date).getFullYear() % 100 + parseInt(a, 10),
                    l = (r ? r.dayNamesShort : null) || this._defaults.dayNamesShort,
                    c = (r ? r.dayNames : null) || this._defaults.dayNames,
                    h = (r ? r.monthNamesShort : null) || this._defaults.monthNamesShort,
                    p = (r ? r.monthNames : null) || this._defaults.monthNames,
                    d = -1,
                    v = -1,
                    m = -1,
                    g = -1,
                    y = !1,
                    b, w = function(e) {
                        var n = i + 1 < t.length && t.charAt(i + 1) === e;
                        return n && i++, n
                    },
                    E = function(e) {
                        var t = w(e),
                            r = e === "@" ? 14 : e === "!" ? 20 : e === "y" && t ? 4 : e === "o" ? 3 : 2,
                            i = new RegExp("^\\d{1," + r + "}"),
                            s = n.substring(u).match(i);
                        if (!s) throw "Missing number at position " + u;
                        return u += s[0].length, parseInt(s[0], 10)
                    },
                    S = function(t, r, i) {
                        var s = -1,
                            o = e.map(w(t) ? i : r, function(e, t) {
                                return [
                                    [t, e]
                                ]
                            }).sort(function(e, t) {
                                return -(e[1].length - t[1].length)
                            });
                        e.each(o, function(e, t) {
                            var r = t[1];
                            if (n.substr(u, r.length).toLowerCase() === r.toLowerCase()) return s = t[0], u += r.length, !1
                        });
                        if (s !== -1) return s + 1;
                        throw "Unknown name at position " + u
                    },
                    x = function() {
                        if (n.charAt(u) !== t.charAt(i)) throw "Unexpected literal at position " + u;
                        u++
                    };
                for (i = 0; i < t.length; i++)
                    if (y) t.charAt(i) === "'" && !w("'") ? y = !1 : x();
                    else switch (t.charAt(i)) {
                        case "d":
                            m = E("d");
                            break;
                        case "D":
                            S("D", l, c);
                            break;
                        case "o":
                            g = E("o");
                            break;
                        case "m":
                            v = E("m");
                            break;
                        case "M":
                            v = S("M", h, p);
                            break;
                        case "y":
                            d = E("y");
                            break;
                        case "@":
                            b = new Date(E("@")), d = b.getFullYear(), v = b.getMonth() + 1, m = b.getDate();
                            break;
                        case "!":
                            b = new Date((E("!") - this._ticksTo1970) / 1e4), d = b.getFullYear(), v = b.getMonth() + 1, m = b.getDate();
                            break;
                        case "'":
                            w("'") ? x() : y = !0;
                            break;
                        default:
                            x()
                    }
                if (u < n.length) {
                    o = n.substr(u);
                    if (!/^\s+/.test(o)) throw "Extra/unparsed characters found in date: " + o
                }
                d === -1 ? d = (new Date).getFullYear() : d < 100 && (d += (new Date).getFullYear() - (new Date).getFullYear() % 100 + (d <= f ? 0 : -100));
                if (g > -1) {
                    v = 1, m = g;
                    do {
                        s = this._getDaysInMonth(d, v - 1);
                        if (m <= s) break;
                        v++, m -= s
                    } while (!0)
                }
                b = this._daylightSavingAdjust(new Date(d, v - 1, m));
                if (b.getFullYear() !== d || b.getMonth() + 1 !== v || b.getDate() !== m) throw "Invalid date";
                return b
            },
            ATOM: "yy-mm-dd",
            COOKIE: "D, dd M yy",
            ISO_8601: "yy-mm-dd",
            RFC_822: "D, d M y",
            RFC_850: "DD, dd-M-y",
            RFC_1036: "D, d M y",
            RFC_1123: "D, d M yy",
            RFC_2822: "D, d M yy",
            RSS: "D, d M y",
            TICKS: "!",
            TIMESTAMP: "@",
            W3C: "yy-mm-dd",
            _ticksTo1970: (718685 + Math.floor(492.5) - Math.floor(19.7) + Math.floor(4.925)) * 24 * 60 * 60 * 1e7,
            formatDate: function(e, t, n) {
                if (!t) return "";
                var r, i = (n ? n.dayNamesShort : null) || this._defaults.dayNamesShort,
                    s = (n ? n.dayNames : null) || this._defaults.dayNames,
                    o = (n ? n.monthNamesShort : null) || this._defaults.monthNamesShort,
                    u = (n ? n.monthNames : null) || this._defaults.monthNames,
                    a = function(t) {
                        var n = r + 1 < e.length && e.charAt(r + 1) === t;
                        return n && r++, n
                    },
                    f = function(e, t, n) {
                        var r = "" + t;
                        if (a(e))
                            while (r.length < n) r = "0" + r;
                        return r
                    },
                    l = function(e, t, n, r) {
                        return a(e) ? r[t] : n[t]
                    },
                    c = "",
                    h = !1;
                if (t)
                    for (r = 0; r < e.length; r++)
                        if (h) e.charAt(r) === "'" && !a("'") ? h = !1 : c += e.charAt(r);
                        else switch (e.charAt(r)) {
                            case "d":
                                c += f("d", t.getDate(), 2);
                                break;
                            case "D":
                                c += l("D", t.getDay(), i, s);
                                break;
                            case "o":
                                c += f("o", Math.round(((new Date(t.getFullYear(), t.getMonth(), t.getDate())).getTime() - (new Date(t.getFullYear(), 0, 0)).getTime()) / 864e5), 3);
                                break;
                            case "m":
                                c += f("m", t.getMonth() + 1, 2);
                                break;
                            case "M":
                                c += l("M", t.getMonth(), o, u);
                                break;
                            case "y":
                                c += a("y") ? t.getFullYear() : (t.getYear() % 100 < 10 ? "0" : "") + t.getYear() % 100;
                                break;
                            case "@":
                                c += t.getTime();
                                break;
                            case "!":
                                c += t.getTime() * 1e4 + this._ticksTo1970;
                                break;
                            case "'":
                                a("'") ? c += "'" : h = !0;
                                break;
                            default:
                                c += e.charAt(r)
                        }
                return c
            },
            _possibleChars: function(e) {
                var t, n = "",
                    r = !1,
                    i = function(n) {
                        var r = t + 1 < e.length && e.charAt(t + 1) === n;
                        return r && t++, r
                    };
                for (t = 0; t < e.length; t++)
                    if (r) e.charAt(t) === "'" && !i("'") ? r = !1 : n += e.charAt(t);
                    else switch (e.charAt(t)) {
                        case "d":
                        case "m":
                        case "y":
                        case "@":
                            n += "0123456789";
                            break;
                        case "D":
                        case "M":
                            return null;
                        case "'":
                            i("'") ? n += "'" : r = !0;
                            break;
                        default:
                            n += e.charAt(t)
                    }
                return n
            },
            _get: function(e, n) {
                return e.settings[n] !== t ? e.settings[n] : this._defaults[n]
            },
            _setDateFromField: function(e, t) {
                if (e.input.val() === e.lastVal) return;
                var n = this._get(e, "dateFormat"),
                    r = e.lastVal = e.input ? e.input.val() : null,
                    i = this._getDefaultDate(e),
                    s = i,
                    o = this._getFormatConfig(e);
                try {
                    s = this.parseDate(n, r, o) || i
                } catch (u) {
                    r = t ? "" : r
                }
                e.selectedDay = s.getDate(), e.drawMonth = e.selectedMonth = s.getMonth(), e.drawYear = e.selectedYear = s.getFullYear(), e.currentDay = r ? s.getDate() : 0, e.currentMonth = r ? s.getMonth() : 0, e.currentYear = r ? s.getFullYear() : 0, this._adjustInstDate(e)
            },
            _getDefaultDate: function(e) {
                return this._restrictMinMax(e, this._determineDate(e, this._get(e, "defaultDate"), new Date))
            },
            _determineDate: function(t, n, r) {
                var i = function(e) {
                        var t = new Date;
                        return t.setDate(t.getDate() + e), t
                    },
                    s = function(n) {
                        try {
                            return e.datepicker.parseDate(e.datepicker._get(t, "dateFormat"), n, e.datepicker._getFormatConfig(t))
                        } catch (r) {}
                        var i = (n.toLowerCase().match(/^c/) ? e.datepicker._getDate(t) : null) || new Date,
                            s = i.getFullYear(),
                            o = i.getMonth(),
                            u = i.getDate(),
                            a = /([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,
                            f = a.exec(n);
                        while (f) {
                            switch (f[2] || "d") {
                                case "d":
                                case "D":
                                    u += parseInt(f[1], 10);
                                    break;
                                case "w":
                                case "W":
                                    u += parseInt(f[1], 10) * 7;
                                    break;
                                case "m":
                                case "M":
                                    o += parseInt(f[1], 10), u = Math.min(u, e.datepicker._getDaysInMonth(s, o));
                                    break;
                                case "y":
                                case "Y":
                                    s += parseInt(f[1], 10), u = Math.min(u, e.datepicker._getDaysInMonth(s, o))
                            }
                            f = a.exec(n)
                        }
                        return new Date(s, o, u)
                    },
                    o = n == null || n === "" ? r : typeof n == "string" ? s(n) : typeof n == "number" ? isNaN(n) ? r : i(n) : new Date(n.getTime());
                return o = o && o.toString() === "Invalid Date" ? r : o, o && (o.setHours(0), o.setMinutes(0), o.setSeconds(0), o.setMilliseconds(0)), this._daylightSavingAdjust(o)
            },
            _daylightSavingAdjust: function(e) {
                return e ? (e.setHours(e.getHours() > 12 ? e.getHours() + 2 : 0), e) : null
            },
            _setDate: function(e, t, n) {
                var r = !t,
                    i = e.selectedMonth,
                    s = e.selectedYear,
                    o = this._restrictMinMax(e, this._determineDate(e, t, new Date));
                e.selectedDay = e.currentDay = o.getDate(), e.drawMonth = e.selectedMonth = e.currentMonth = o.getMonth(), e.drawYear = e.selectedYear = e.currentYear = o.getFullYear(), (i !== e.selectedMonth || s !== e.selectedYear) && !n && this._notifyChange(e), this._adjustInstDate(e), e.input && e.input.val(r ? "" : this._formatDate(e))
            },
            _getDate: function(e) {
                var t = !e.currentYear || e.input && e.input.val() === "" ? null : this._daylightSavingAdjust(new Date(e.currentYear, e.currentMonth, e.currentDay));
                return t
            },
            _attachHandlers: function(t) {
                var n = this._get(t, "stepMonths"),
                    i = "#" + t.id.replace(/\\\\/g, "\\");
                t.dpDiv.find("[data-handler]").map(function() {
                    var t = {
                        prev: function() {
                            window["DP_jQuery_" + r].datepicker._adjustDate(i, -n, "M")
                        },
                        next: function() {
                            window["DP_jQuery_" + r].datepicker._adjustDate(i, +n, "M")
                        },
                        hide: function() {
                            window["DP_jQuery_" + r].datepicker._hideDatepicker()
                        },
                        today: function() {
                            window["DP_jQuery_" + r].datepicker._gotoToday(i)
                        },
                        selectDay: function() {
                            return window["DP_jQuery_" + r].datepicker._selectDay(i, +this.getAttribute("data-month"), +this.getAttribute("data-year"), this), !1
                        },
                        selectMonth: function() {
                            return window["DP_jQuery_" + r].datepicker._selectMonthYear(i, this, "M"), !1
                        },
                        selectYear: function() {
                            return window["DP_jQuery_" + r].datepicker._selectMonthYear(i, this, "Y"), !1
                        }
                    };
                    e(this).bind(this.getAttribute("data-event"), t[this.getAttribute("data-handler")])
                })
            },
            _generateHTML: function(e) {
                var t, n, r, i, s, o, u, a, f, l, c, h, p, d, v, m, g, y, b, w, E, S, x, T, N, C, k, L, A, O, M, _, D, P, H, B, j, F, I, q = new Date,
                    R = this._daylightSavingAdjust(new Date(q.getFullYear(), q.getMonth(), q.getDate())),
                    U = this._get(e, "isRTL"),
                    z = this._get(e, "showButtonPanel"),
                    W = this._get(e, "hideIfNoPrevNext"),
                    X = this._get(e, "navigationAsDateFormat"),
                    V = this._getNumberOfMonths(e),
                    $ = this._get(e, "showCurrentAtPos"),
                    J = this._get(e, "stepMonths"),
                    K = V[0] !== 1 || V[1] !== 1,
                    Q = this._daylightSavingAdjust(e.currentDay ? new Date(e.currentYear, e.currentMonth, e.currentDay) : new Date(9999, 9, 9)),
                    G = this._getMinMaxDate(e, "min"),
                    Y = this._getMinMaxDate(e, "max"),
                    Z = e.drawMonth - $,
                    et = e.drawYear;
                Z < 0 && (Z += 12, et--);
                if (Y) {
                    t = this._daylightSavingAdjust(new Date(Y.getFullYear(), Y.getMonth() - V[0] * V[1] + 1, Y.getDate())), t = G && t < G ? G : t;
                    while (this._daylightSavingAdjust(new Date(et, Z, 1)) > t) Z--, Z < 0 && (Z = 11, et--)
                }
                e.drawMonth = Z, e.drawYear = et, n = this._get(e, "prevText"), n = X ? this.formatDate(n, this._daylightSavingAdjust(new Date(et, Z - J, 1)), this._getFormatConfig(e)) : n, r = this._canAdjustMonth(e, -1, et, Z) ? "<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='" + n + "'><span class='ui-icon ui-icon-circle-triangle-" + (U ? "e" : "w") + "'>" + n + "</span></a>" : W ? "" : "<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='" + n + "'><span class='ui-icon ui-icon-circle-triangle-" + (U ? "e" : "w") + "'>" + n + "</span></a>", i = this._get(e, "nextText"), i = X ? this.formatDate(i, this._daylightSavingAdjust(new Date(et, Z + J, 1)), this._getFormatConfig(e)) : i, s = this._canAdjustMonth(e, 1, et, Z) ? "<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='" + i + "'><span class='ui-icon ui-icon-circle-triangle-" + (U ? "w" : "e") + "'>" + i + "</span></a>" : W ? "" : "<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='" + i + "'><span class='ui-icon ui-icon-circle-triangle-" + (U ? "w" : "e") + "'>" + i + "</span></a>", o = this._get(e, "currentText"), u = this._get(e, "gotoCurrent") && e.currentDay ? Q : R, o = X ? this.formatDate(o, u, this._getFormatConfig(e)) : o, a = e.inline ? "" : "<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>" + this._get(e, "closeText") + "</button>", f = z ? "<div class='ui-datepicker-buttonpane ui-widget-content'>" + (U ? a : "") + (this._isInRange(e, u) ? "<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>" + o + "</button>" : "") + (U ? "" : a) + "</div>" : "", l = parseInt(this._get(e, "firstDay"), 10), l = isNaN(l) ? 0 : l, c = this._get(e, "showWeek"), h = this._get(e, "dayNames"), p = this._get(e, "dayNamesMin"), d = this._get(e, "monthNames"), v = this._get(e, "monthNamesShort"), m = this._get(e, "beforeShowDay"), g = this._get(e, "showOtherMonths"), y = this._get(e, "selectOtherMonths"), b = this._getDefaultDate(e), w = "", E;
                for (S = 0; S < V[0]; S++) {
                    x = "", this.maxRows = 4;
                    for (T = 0; T < V[1]; T++) {
                        N = this._daylightSavingAdjust(new Date(et, Z, e.selectedDay)), C = " ui-corner-all", k = "";
                        if (K) {
                            k += "<div class='ui-datepicker-group";
                            if (V[1] > 1) switch (T) {
                                case 0:
                                    k += " ui-datepicker-group-first", C = " ui-corner-" + (U ? "right" : "left");
                                    break;
                                case V[1] - 1:
                                    k += " ui-datepicker-group-last", C = " ui-corner-" + (U ? "left" : "right");
                                    break;
                                default:
                                    k += " ui-datepicker-group-middle", C = ""
                            }
                            k += "'>"
                        }
                        k += "<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix" + C + "'>" + (/all|left/.test(C) && S === 0 ? U ? s : r : "") + (/all|right/.test(C) && S === 0 ? U ? r : s : "") + this._generateMonthYearHeader(e, Z, et, G, Y, S > 0 || T > 0, d, v) + "</div><table class='ui-datepicker-calendar'><thead>" + "<tr>", L = c ? "<th class='ui-datepicker-week-col'>" + this._get(e, "weekHeader") + "</th>" : "";
                        for (E = 0; E < 7; E++) A = (E + l) % 7, L += "<th" + ((E + l + 6) % 7 >= 5 ? " class='ui-datepicker-week-end'" : "") + ">" + "<span title='" + h[A] + "'>" + p[A] + "</span></th>";
                        k += L + "</tr></thead><tbody>", O = this._getDaysInMonth(et, Z), et === e.selectedYear && Z === e.selectedMonth && (e.selectedDay = Math.min(e.selectedDay, O)), M = (this._getFirstDayOfMonth(et, Z) - l + 7) % 7, _ = Math.ceil((M + O) / 7), D = K ? this.maxRows > _ ? this.maxRows : _ : _, this.maxRows = D, P = this._daylightSavingAdjust(new Date(et, Z, 1 - M));
                        for (H = 0; H < D; H++) {
                            k += "<tr>", B = c ? "<td class='ui-datepicker-week-col'>" + this._get(e, "calculateWeek")(P) + "</td>" : "";
                            for (E = 0; E < 7; E++) j = m ? m.apply(e.input ? e.input[0] : null, [P]) : [!0, ""], F = P.getMonth() !== Z, I = F && !y || !j[0] || G && P < G || Y && P > Y, B += "<td class='" + ((E + l + 6) % 7 >= 5 ? " ui-datepicker-week-end" : "") + (F ? " ui-datepicker-other-month" : "") + (P.getTime() === N.getTime() && Z === e.selectedMonth && e._keyEvent || b.getTime() === P.getTime() && b.getTime() === N.getTime() ? " " + this._dayOverClass : "") + (I ? " " + this._unselectableClass + " ui-state-disabled" : "") + (F && !g ? "" : " " + j[1] + (P.getTime() === Q.getTime() ? " " + this._currentClass : "") + (P.getTime() === R.getTime() ? " ui-datepicker-today" : "")) + "'" + ((!F || g) && j[2] ? " title='" + j[2] + "'" : "") + (I ? "" : " data-handler='selectDay' data-event='click' data-month='" + P.getMonth() + "' data-year='" + P.getFullYear() + "'") + ">" + (F && !g ? "&#xa0;" : I ? "<span class='ui-state-default'>" + P.getDate() + "</span>" : "<a class='ui-state-default" + (P.getTime() === R.getTime() ? " ui-state-highlight" : "") + (P.getTime() === Q.getTime() ? " ui-state-active" : "") + (F ? " ui-priority-secondary" : "") + "' href='#'>" + P.getDate() + "</a>") + "</td>", P.setDate(P.getDate() + 1), P = this._daylightSavingAdjust(P);
                            k += B + "</tr>"
                        }
                        Z++, Z > 11 && (Z = 0, et++), k += "</tbody></table>" + (K ? "</div>" + (V[0] > 0 && T === V[1] - 1 ? "<div class='ui-datepicker-row-break'></div>" : "") : ""), x += k
                    }
                    w += x
                }
                return w += f, e._keyEvent = !1, w
            },
            _generateMonthYearHeader: function(e, t, n, r, i, s, o, u) {
                var a, f, l, c, h, p, d, v, m = this._get(e, "changeMonth"),
                    g = this._get(e, "changeYear"),
                    y = this._get(e, "showMonthAfterYear"),
                    b = "<div class='ui-datepicker-title'>",
                    w = "";
                if (s || !m) w += "<span class='ui-datepicker-month'>" + o[t] + "</span>";
                else {
                    a = r && r.getFullYear() === n, f = i && i.getFullYear() === n, w += "<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";
                    for (l = 0; l < 12; l++)(!a || l >= r.getMonth()) && (!f || l <= i.getMonth()) && (w += "<option value='" + l + "'" + (l === t ? " selected='selected'" : "") + ">" + u[l] + "</option>");
                    w += "</select>"
                }
                y || (b += w + (s || !m || !g ? "&#xa0;" : ""));
                if (!e.yearshtml) {
                    e.yearshtml = "";
                    if (s || !g) b += "<span class='ui-datepicker-year'>" + n + "</span>";
                    else {
                        c = this._get(e, "yearRange").split(":"), h = (new Date).getFullYear(), p = function(e) {
                            var t = e.match(/c[+\-].*/) ? n + parseInt(e.substring(1), 10) : e.match(/[+\-].*/) ? h + parseInt(e, 10) : parseInt(e, 10);
                            return isNaN(t) ? h : t
                        }, d = p(c[0]), v = Math.max(d, p(c[1] || "")), d = r ? Math.max(d, r.getFullYear()) : d, v = i ? Math.min(v, i.getFullYear()) : v, e.yearshtml += "<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";
                        for (; d <= v; d++) e.yearshtml += "<option value='" + d + "'" + (d === n ? " selected='selected'" : "") + ">" + d + "</option>";
                        e.yearshtml += "</select>", b += e.yearshtml, e.yearshtml = null
                    }
                }
                return b += this._get(e, "yearSuffix"), y && (b += (s || !m || !g ? "&#xa0;" : "") + w), b += "</div>", b
            },
            _adjustInstDate: function(e, t, n) {
                var r = e.drawYear + (n === "Y" ? t : 0),
                    i = e.drawMonth + (n === "M" ? t : 0),
                    s = Math.min(e.selectedDay, this._getDaysInMonth(r, i)) + (n === "D" ? t : 0),
                    o = this._restrictMinMax(e, this._daylightSavingAdjust(new Date(r, i, s)));
                e.selectedDay = o.getDate(), e.drawMonth = e.selectedMonth = o.getMonth(), e.drawYear = e.selectedYear = o.getFullYear(), (n === "M" || n === "Y") && this._notifyChange(e)
            },
            _restrictMinMax: function(e, t) {
                var n = this._getMinMaxDate(e, "min"),
                    r = this._getMinMaxDate(e, "max"),
                    i = n && t < n ? n : t;
                return r && i > r ? r : i
            },
            _notifyChange: function(e) {
                var t = this._get(e, "onChangeMonthYear");
                t && t.apply(e.input ? e.input[0] : null, [e.selectedYear, e.selectedMonth + 1, e])
            },
            _getNumberOfMonths: function(e) {
                var t = this._get(e, "numberOfMonths");
                return t == null ? [1, 1] : typeof t == "number" ? [1, t] : t
            },
            _getMinMaxDate: function(e, t) {
                return this._determineDate(e, this._get(e, t + "Date"), null)
            },
            _getDaysInMonth: function(e, t) {
                return 32 - this._daylightSavingAdjust(new Date(e, t, 32)).getDate()
            },
            _getFirstDayOfMonth: function(e, t) {
                return (new Date(e, t, 1)).getDay()
            },
            _canAdjustMonth: function(e, t, n, r) {
                var i = this._getNumberOfMonths(e),
                    s = this._daylightSavingAdjust(new Date(n, r + (t < 0 ? t : i[0] * i[1]), 1));
                return t < 0 && s.setDate(this._getDaysInMonth(s.getFullYear(), s.getMonth())), this._isInRange(e, s)
            },
            _isInRange: function(e, t) {
                var n, r, i = this._getMinMaxDate(e, "min"),
                    s = this._getMinMaxDate(e, "max"),
                    o = null,
                    u = null,
                    a = this._get(e, "yearRange");
                return a && (n = a.split(":"), r = (new Date).getFullYear(), o = parseInt(n[0], 10) + r, u = parseInt(n[1], 10) + r), (!i || t.getTime() >= i.getTime()) && (!s || t.getTime() <= s.getTime()) && (!o || t.getFullYear() >= o) && (!u || t.getFullYear() <= u)
            },
            _getFormatConfig: function(e) {
                var t = this._get(e, "shortYearCutoff");
                return t = typeof t != "string" ? t : (new Date).getFullYear() % 100 + parseInt(t, 10), {
                    shortYearCutoff: t,
                    dayNamesShort: this._get(e, "dayNamesShort"),
                    dayNames: this._get(e, "dayNames"),
                    monthNamesShort: this._get(e, "monthNamesShort"),
                    monthNames: this._get(e, "monthNames")
                }
            },
            _formatDate: function(e, t, n, r) {
                t || (e.currentDay = e.selectedDay, e.currentMonth = e.selectedMonth, e.currentYear = e.selectedYear);
                var i = t ? typeof t == "object" ? t : this._daylightSavingAdjust(new Date(r, n, t)) : this._daylightSavingAdjust(new Date(e.currentYear, e.currentMonth, e.currentDay));
                return this.formatDate(this._get(e, "dateFormat"), i, this._getFormatConfig(e))
            }
        }), e.fn.datepicker = function(t) {
            if (!this.length) return this;
            e.datepicker.initialized || (e(document).mousedown(e.datepicker._checkExternalClick), e.datepicker.initialized = !0), e("#" + e.datepicker._mainDivId).length === 0 && e("body").append(e.datepicker.dpDiv);
            var n = Array.prototype.slice.call(arguments, 1);
            return typeof t != "string" || t !== "isDisabled" && t !== "getDate" && t !== "widget" ? t === "option" && arguments.length === 2 && typeof arguments[1] == "string" ? e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this[0]].concat(n)) : this.each(function() {
                typeof t == "string" ? e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this].concat(n)) : e.datepicker._attachDatepicker(this, t)
            }) : e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this[0]].concat(n))
        }, e.datepicker = new s, e.datepicker.initialized = !1, e.datepicker.uuid = (new Date).getTime(), e.datepicker.version = "1.10.0", window["DP_jQuery_" + r] = e
    }(jQuery),
    function(e, t) {
        var n = {
                buttons: !0,
                height: !0,
                maxHeight: !0,
                maxWidth: !0,
                minHeight: !0,
                minWidth: !0,
                width: !0
            },
            r = {
                maxHeight: !0,
                maxWidth: !0,
                minHeight: !0,
                minWidth: !0
            };
        e.widget("ui.dialog", {
            version: "1.10.0",
            options: {
                appendTo: "body",
                autoOpen: !0,
                buttons: [],
                closeOnEscape: !0,
                closeText: "close",
                dialogClass: "",
                draggable: !0,
                hide: null,
                height: "auto",
                maxHeight: null,
                maxWidth: null,
                minHeight: 150,
                minWidth: 150,
                modal: !1,
                position: {
                    my: "center",
                    at: "center",
                    of: window,
                    collision: "fit",
                    using: function(t) {
                        var n = e(this).css(t).offset().top;
                        n < 0 && e(this).css("top", t.top - n)
                    }
                },
                resizable: !0,
                show: null,
                title: null,
                width: 300,
                beforeClose: null,
                close: null,
                drag: null,
                dragStart: null,
                dragStop: null,
                focus: null,
                open: null,
                resize: null,
                resizeStart: null,
                resizeStop: null
            },
            _create: function() {
                this.originalCss = {
                    display: this.element[0].style.display,
                    width: this.element[0].style.width,
                    minHeight: this.element[0].style.minHeight,
                    maxHeight: this.element[0].style.maxHeight,
                    height: this.element[0].style.height
                }, this.originalPosition = {
                    parent: this.element.parent(),
                    index: this.element.parent().children().index(this.element)
                }, this.originalTitle = this.element.attr("title"), this.options.title = this.options.title || this.originalTitle, this._createWrapper(), this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog), this._createTitlebar(), this._createButtonPane(), this.options.draggable && e.fn.draggable && this._makeDraggable(), this.options.resizable && e.fn.resizable && this._makeResizable(), this._isOpen = !1
            },
            _init: function() {
                this.options.autoOpen && this.open()
            },
            _appendTo: function() {
                var t = this.options.appendTo;
                return t && (t.jquery || t.nodeType) ? e(t) : this.document.find(t || "body").eq(0)
            },
            _destroy: function() {
                var e, t = this.originalPosition;
                this._destroyOverlay(), this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(), this.uiDialog.stop(!0, !0).remove(), this.originalTitle && this.element.attr("title", this.originalTitle), e = t.parent.children().eq(t.index), e.length && e[0] !== this.element[0] ? e.before(this.element) : t.parent.append(this.element)
            },
            widget: function() {
                return this.uiDialog
            },
            disable: e.noop,
            enable: e.noop,
            close: function(t) {
                var n = this;
                if (!this._isOpen || this._trigger("beforeClose", t) === !1) return;
                this._isOpen = !1, this._destroyOverlay(), this.opener.filter(":focusable").focus().length || e(this.document[0].activeElement).blur(), this._hide(this.uiDialog, this.options.hide, function() {
                    n._trigger("close", t)
                })
            },
            isOpen: function() {
                return this._isOpen
            },
            moveToTop: function() {
                this._moveToTop()
            },
            _moveToTop: function(e, t) {
                var n = !!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;
                return n && !t && this._trigger("focus", e), n
            },
            open: function() {
                if (this._isOpen) {
                    this._moveToTop() && this._focusTabbable();
                    return
                }
                this.opener = e(this.document[0].activeElement), this._size(), this._position(), this._createOverlay(), this._moveToTop(null, !0), this._show(this.uiDialog, this.options.show), this._focusTabbable(), this._isOpen = !0, this._trigger("open"), this._trigger("focus")
            },
            _focusTabbable: function() {
                var e = this.element.find("[autofocus]");
                e.length || (e = this.element.find(":tabbable")), e.length || (e = this.uiDialogButtonPane.find(":tabbable")), e.length || (e = this.uiDialogTitlebarClose.filter(":tabbable")), e.length || (e = this.uiDialog), e.eq(0).focus()
            },
            _keepFocus: function(t) {
                function n() {
                    var t = this.document[0].activeElement,
                        n = this.uiDialog[0] === t || e.contains(this.uiDialog[0], t);
                    n || this._focusTabbable()
                }
                t.preventDefault(), n.call(this), this._delay(n)
            },
            _createWrapper: function() {
                this.uiDialog = e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front " + this.options.dialogClass).hide().attr({
                    tabIndex: -1,
                    role: "dialog"
                }).appendTo(this._appendTo()), this._on(this.uiDialog, {
                    keydown: function(t) {
                        if (this.options.closeOnEscape && !t.isDefaultPrevented() && t.keyCode && t.keyCode === e.ui.keyCode.ESCAPE) {
                            t.preventDefault(), this.close(t);
                            return
                        }
                        if (t.keyCode !== e.ui.keyCode.TAB) return;
                        var n = this.uiDialog.find(":tabbable"),
                            r = n.filter(":first"),
                            i = n.filter(":last");
                        t.target !== i[0] && t.target !== this.uiDialog[0] || !!t.shiftKey ? (t.target === r[0] || t.target === this.uiDialog[0]) && t.shiftKey && (i.focus(1), t.preventDefault()) : (r.focus(1), t.preventDefault())
                    },
                    mousedown: function(e) {
                        this._moveToTop(e) && this._focusTabbable()
                    }
                }), this.element.find("[aria-describedby]").length || this.uiDialog.attr({
                    "aria-describedby": this.element.uniqueId().attr("id")
                })
            },
            _createTitlebar: function() {
                var t;
                this.uiDialogTitlebar = e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog), this._on(this.uiDialogTitlebar, {
                    mousedown: function(t) {
                        e(t.target).closest(".ui-dialog-titlebar-close") || this.uiDialog.focus()
                    }
                }), this.uiDialogTitlebarClose = e("<button></button>").button({
                    label: this.options.closeText,
                    icons: {
                        primary: "ui-icon-closethick"
                    },
                    text: !1
                }).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar), this._on(this.uiDialogTitlebarClose, {
                    click: function(e) {
                        e.preventDefault(), this.close(e)
                    }
                }), t = e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar), this._title(t), this.uiDialog.attr({
                    "aria-labelledby": t.attr("id")
                })
            },
            _title: function(e) {
                this.options.title || e.html("&#160;"), e.text(this.options.title)
            },
            _createButtonPane: function() {
                this.uiDialogButtonPane = e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"), this.uiButtonSet = e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane), this._createButtons()
            },
            _createButtons: function() {
                var t = this,
                    n = this.options.buttons;
                this.uiDialogButtonPane.remove(), this.uiButtonSet.empty();
                if (e.isEmptyObject(n)) {
                    this.uiDialog.removeClass("ui-dialog-buttons");
                    return
                }
                e.each(n, function(n, r) {
                    var i, s;
                    r = e.isFunction(r) ? {
                        click: r,
                        text: n
                    } : r, r = e.extend({
                        type: "button"
                    }, r), i = r.click, r.click = function() {
                        i.apply(t.element[0], arguments)
                    }, s = {
                        icons: r.icons,
                        text: r.showText
                    }, delete r.icons, delete r.showText, e("<button></button>", r).button(s).appendTo(t.uiButtonSet)
                }), this.uiDialog.addClass("ui-dialog-buttons"), this.uiDialogButtonPane.appendTo(this.uiDialog)
            },
            _makeDraggable: function() {
                function r(e) {
                    return {
                        position: e.position,
                        offset: e.offset
                    }
                }
                var t = this,
                    n = this.options;
                this.uiDialog.draggable({
                    cancel: ".ui-dialog-content, .ui-dialog-titlebar-close",
                    handle: ".ui-dialog-titlebar",
                    containment: "document",
                    start: function(n, i) {
                        e(this).addClass("ui-dialog-dragging"), t._trigger("dragStart", n, r(i))
                    },
                    drag: function(e, n) {
                        t._trigger("drag", e, r(n))
                    },
                    stop: function(i, s) {
                        n.position = [s.position.left - t.document.scrollLeft(), s.position.top - t.document.scrollTop()], e(this).removeClass("ui-dialog-dragging"), t._trigger("dragStop", i, r(s))
                    }
                })
            },
            _makeResizable: function() {
                function o(e) {
                    return {
                        originalPosition: e.originalPosition,
                        originalSize: e.originalSize,
                        position: e.position,
                        size: e.size
                    }
                }
                var t = this,
                    n = this.options,
                    r = n.resizable,
                    i = this.uiDialog.css("position"),
                    s = typeof r == "string" ? r : "n,e,s,w,se,sw,ne,nw";
                this.uiDialog.resizable({
                    cancel: ".ui-dialog-content",
                    containment: "document",
                    alsoResize: this.element,
                    maxWidth: n.maxWidth,
                    maxHeight: n.maxHeight,
                    minWidth: n.minWidth,
                    minHeight: this._minHeight(),
                    handles: s,
                    start: function(n, r) {
                        e(this).addClass("ui-dialog-resizing"), t._trigger("resizeStart", n, o(r))
                    },
                    resize: function(e, n) {
                        t._trigger("resize", e, o(n))
                    },
                    stop: function(r, i) {
                        n.height = e(this).height(), n.width = e(this).width(), e(this).removeClass("ui-dialog-resizing"), t._trigger("resizeStop", r, o(i))
                    }
                }).css("position", i)
            },
            _minHeight: function() {
                var e = this.options;
                return e.height === "auto" ? e.minHeight : Math.min(e.minHeight, e.height)
            },
            _position: function() {
                var e = this.uiDialog.is(":visible");
                e || this.uiDialog.show(), this.uiDialog.position(this.options.position), e || this.uiDialog.hide()
            },
            _setOptions: function(t) {
                var i = this,
                    s = !1,
                    o = {};
                e.each(t, function(e, t) {
                    i._setOption(e, t), e in n && (s = !0), e in r && (o[e] = t)
                }), s && (this._size(), this._position()), this.uiDialog.is(":data(ui-resizable)") && this.uiDialog.resizable("option", o)
            },
            _setOption: function(e, t) {
                var n, r, i = this.uiDialog;
                e === "dialogClass" && i.removeClass(this.options.dialogClass).addClass(t);
                if (e === "disabled") return;
                this._super(e, t), e === "appendTo" && this.uiDialog.appendTo(this._appendTo()), e === "buttons" && this._createButtons(), e === "closeText" && this.uiDialogTitlebarClose.button({
                    label: "" + t
                }), e === "draggable" && (n = i.is(":data(ui-draggable)"), n && !t && i.draggable("destroy"), !n && t && this._makeDraggable()), e === "position" && this._position(), e === "resizable" && (r = i.is(":data(ui-resizable)"), r && !t && i.resizable("destroy"), r && typeof t == "string" && i.resizable("option", "handles", t), !r && t !== !1 && this._makeResizable()), e === "title" && this._title(this.uiDialogTitlebar.find(".ui-dialog-title"))
            },
            _size: function() {
                var e, t, n, r = this.options;
                this.element.show().css({
                    width: "auto",
                    minHeight: 0,
                    maxHeight: "none",
                    height: 0
                }), r.minWidth > r.width && (r.width = r.minWidth), e = this.uiDialog.css({
                    height: "auto",
                    width: r.width
                }).outerHeight(), t = Math.max(0, r.minHeight - e), n = typeof r.maxHeight == "number" ? Math.max(0, r.maxHeight - e) : "none", r.height === "auto" ? this.element.css({
                    minHeight: t,
                    maxHeight: n,
                    height: "auto"
                }) : this.element.height(Math.max(0, r.height - e)), this.uiDialog.is(":data(ui-resizable)") && this.uiDialog.resizable("option", "minHeight", this._minHeight())
            },
            _createOverlay: function() {
                if (!this.options.modal) return;
                e.ui.dialog.overlayInstances || this._delay(function() {
                    e.ui.dialog.overlayInstances && this._on(this.document, {
                        focusin: function(t) {
                            e(t.target).closest(".ui-dialog").length || (t.preventDefault(), e(".ui-dialog:visible:last .ui-dialog-content").data("ui-dialog")._focusTabbable())
                        }
                    })
                }), this.overlay = e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this.document[0].body), this._on(this.overlay, {
                    mousedown: "_keepFocus"
                }), e.ui.dialog.overlayInstances++
            },
            _destroyOverlay: function() {
                if (!this.options.modal) return;
                e.ui.dialog.overlayInstances--, e.ui.dialog.overlayInstances || this._off(this.document, "focusin"), this.overlay.remove()
            }
        }), e.ui.dialog.overlayInstances = 0, e.uiBackCompat !== !1 && e.widget("ui.dialog", e.ui.dialog, {
            _position: function() {
                var t = this.options.position,
                    n = [],
                    r = [0, 0],
                    i;
                if (t) {
                    if (typeof t == "string" || typeof t == "object" && "0" in t) n = t.split ? t.split(" ") : [t[0], t[1]], n.length === 1 && (n[1] = n[0]), e.each(["left", "top"], function(e, t) {
                        +n[e] === n[e] && (r[e] = n[e], n[e] = t)
                    }), t = {
                        my: n[0] + (r[0] < 0 ? r[0] : "+" + r[0]) + " " + n[1] + (r[1] < 0 ? r[1] : "+" + r[1]),
                        at: n.join(" ")
                    };
                    t = e.extend({}, e.ui.dialog.prototype.options.position, t)
                } else t = e.ui.dialog.prototype.options.position;
                i = this.uiDialog.is(":visible"), i || this.uiDialog.show(), this.uiDialog.position(t), i || this.uiDialog.hide()
            }
        })
    }(jQuery),
    function(e, t) {
        var n = /up|down|vertical/,
            r = /up|left|vertical|horizontal/;
        e.effects.effect.blind = function(t, i) {
            var s = e(this),
                o = ["position", "top", "bottom", "left", "right", "height", "width"],
                u = e.effects.setMode(s, t.mode || "hide"),
                a = t.direction || "up",
                f = n.test(a),
                l = f ? "height" : "width",
                c = f ? "top" : "left",
                h = r.test(a),
                p = {},
                d = u === "show",
                v, m, g;
            s.parent().is(".ui-effects-wrapper") ? e.effects.save(s.parent(), o) : e.effects.save(s, o), s.show(), v = e.effects.createWrapper(s).css({
                overflow: "hidden"
            }), m = v[l](), g = parseFloat(v.css(c)) || 0, p[l] = d ? m : 0, h || (s.css(f ? "bottom" : "right", 0).css(f ? "top" : "left", "auto").css({
                position: "absolute"
            }), p[c] = d ? g : m + g), d && (v.css(l, 0), h || v.css(c, g + m)), v.animate(p, {
                duration: t.duration,
                easing: t.easing,
                queue: !1,
                complete: function() {
                    u === "hide" && s.hide(), e.effects.restore(s, o), e.effects.removeWrapper(s), i()
                }
            })
        }
    }(jQuery),
    function(e, t) {
        e.effects.effect.bounce = function(t, n) {
            var r = e(this),
                i = ["position", "top", "bottom", "left", "right", "height", "width"],
                s = e.effects.setMode(r, t.mode || "effect"),
                o = s === "hide",
                u = s === "show",
                a = t.direction || "up",
                f = t.distance,
                l = t.times || 5,
                c = l * 2 + (u || o ? 1 : 0),
                h = t.duration / c,
                p = t.easing,
                d = a === "up" || a === "down" ? "top" : "left",
                v = a === "up" || a === "left",
                m, g, y, b = r.queue(),
                w = b.length;
            (u || o) && i.push("opacity"), e.effects.save(r, i), r.show(), e.effects.createWrapper(r), f || (f = r[d === "top" ? "outerHeight" : "outerWidth"]() / 3), u && (y = {
                opacity: 1
            }, y[d] = 0, r.css("opacity", 0).css(d, v ? -f * 2 : f * 2).animate(y, h, p)), o && (f /= Math.pow(2, l - 1)), y = {}, y[d] = 0;
            for (m = 0; m < l; m++) g = {}, g[d] = (v ? "-=" : "+=") + f, r.animate(g, h, p).animate(y, h, p), f = o ? f * 2 : f / 2;
            o && (g = {
                opacity: 0
            }, g[d] = (v ? "-=" : "+=") + f, r.animate(g, h, p)), r.queue(function() {
                o && r.hide(), e.effects.restore(r, i), e.effects.removeWrapper(r), n()
            }), w > 1 && b.splice.apply(b, [1, 0].concat(b.splice(w, c + 1))), r.dequeue()
        }
    }(jQuery),
    function(e, t) {
        e.effects.effect.clip = function(t, n) {
            var r = e(this),
                i = ["position", "top", "bottom", "left", "right", "height", "width"],
                s = e.effects.setMode(r, t.mode || "hide"),
                o = s === "show",
                u = t.direction || "vertical",
                a = u === "vertical",
                f = a ? "height" : "width",
                l = a ? "top" : "left",
                c = {},
                h, p, d;
            e.effects.save(r, i), r.show(), h = e.effects.createWrapper(r).css({
                overflow: "hidden"
            }), p = r[0].tagName === "IMG" ? h : r, d = p[f](), o && (p.css(f, 0), p.css(l, d / 2)), c[f] = o ? d : 0, c[l] = o ? 0 : d / 2, p.animate(c, {
                queue: !1,
                duration: t.duration,
                easing: t.easing,
                complete: function() {
                    o || r.hide(), e.effects.restore(r, i), e.effects.removeWrapper(r), n()
                }
            })
        }
    }(jQuery),
    function(e, t) {
        e.effects.effect.drop = function(t, n) {
            var r = e(this),
                i = ["position", "top", "bottom", "left", "right", "opacity", "height", "width"],
                s = e.effects.setMode(r, t.mode || "hide"),
                o = s === "show",
                u = t.direction || "left",
                a = u === "up" || u === "down" ? "top" : "left",
                f = u === "up" || u === "left" ? "pos" : "neg",
                l = {
                    opacity: o ? 1 : 0
                },
                c;
            e.effects.save(r, i), r.show(), e.effects.createWrapper(r), c = t.distance || r[a === "top" ? "outerHeight" : "outerWidth"](!0) / 2, o && r.css("opacity", 0).css(a, f === "pos" ? -c : c), l[a] = (o ? f === "pos" ? "+=" : "-=" : f === "pos" ? "-=" : "+=") + c, r.animate(l, {
                queue: !1,
                duration: t.duration,
                easing: t.easing,
                complete: function() {
                    s === "hide" && r.hide(), e.effects.restore(r, i), e.effects.removeWrapper(r), n()
                }
            })
        }
    }(jQuery),
    function(e, t) {
        e.effects.effect.explode = function(t, n) {
            function y() {
                c.push(this), c.length === r * i && b()
            }

            function b() {
                s.css({
                    visibility: "visible"
                }), e(c).remove(), u || s.hide(), n()
            }
            var r = t.pieces ? Math.round(Math.sqrt(t.pieces)) : 3,
                i = r,
                s = e(this),
                o = e.effects.setMode(s, t.mode || "hide"),
                u = o === "show",
                a = s.show().css("visibility", "hidden").offset(),
                f = Math.ceil(s.outerWidth() / i),
                l = Math.ceil(s.outerHeight() / r),
                c = [],
                h, p, d, v, m, g;
            for (h = 0; h < r; h++) {
                v = a.top + h * l, g = h - (r - 1) / 2;
                for (p = 0; p < i; p++) d = a.left + p * f, m = p - (i - 1) / 2, s.clone().appendTo("body").wrap("<div></div>").css({
                    position: "absolute",
                    visibility: "visible",
                    left: -p * f,
                    top: -h * l
                }).parent().addClass("ui-effects-explode").css({
                    position: "absolute",
                    overflow: "hidden",
                    width: f,
                    height: l,
                    left: d + (u ? m * f : 0),
                    top: v + (u ? g * l : 0),
                    opacity: u ? 0 : 1
                }).animate({
                    left: d + (u ? 0 : m * f),
                    top: v + (u ? 0 : g * l),
                    opacity: u ? 1 : 0
                }, t.duration || 500, t.easing, y)
            }
        }
    }(jQuery),
    function(e, t) {
        e.effects.effect.fade = function(t, n) {
            var r = e(this),
                i = e.effects.setMode(r, t.mode || "toggle");
            r.animate({
                opacity: i
            }, {
                queue: !1,
                duration: t.duration,
                easing: t.easing,
                complete: n
            })
        }
    }(jQuery),
    function(e, t) {
        e.effects.effect.fold = function(t, n) {
            var r = e(this),
                i = ["position", "top", "bottom", "left", "right", "height", "width"],
                s = e.effects.setMode(r, t.mode || "hide"),
                o = s === "show",
                u = s === "hide",
                a = t.size || 15,
                f = /([0-9]+)%/.exec(a),
                l = !!t.horizFirst,
                c = o !== l,
                h = c ? ["width", "height"] : ["height", "width"],
                p = t.duration / 2,
                d, v, m = {},
                g = {};
            e.effects.save(r, i), r.show(), d = e.effects.createWrapper(r).css({
                overflow: "hidden"
            }), v = c ? [d.width(), d.height()] : [d.height(), d.width()], f && (a = parseInt(f[1], 10) / 100 * v[u ? 0 : 1]), o && d.css(l ? {
                height: 0,
                width: a
            } : {
                height: a,
                width: 0
            }), m[h[0]] = o ? v[0] : a, g[h[1]] = o ? v[1] : 0, d.animate(m, p, t.easing).animate(g, p, t.easing, function() {
                u && r.hide(), e.effects.restore(r, i), e.effects.removeWrapper(r), n()
            })
        }
    }(jQuery),
    function(e, t) {
        e.effects.effect.highlight = function(t, n) {
            var r = e(this),
                i = ["backgroundImage", "backgroundColor", "opacity"],
                s = e.effects.setMode(r, t.mode || "show"),
                o = {
                    backgroundColor: r.css("backgroundColor")
                };
            s === "hide" && (o.opacity = 0), e.effects.save(r, i), r.show().css({
                backgroundImage: "none",
                backgroundColor: t.color || "#ffff99"
            }).animate(o, {
                queue: !1,
                duration: t.duration,
                easing: t.easing,
                complete: function() {
                    s === "hide" && r.hide(), e.effects.restore(r, i), n()
                }
            })
        }
    }(jQuery),
    function(e, t) {
        e.effects.effect.pulsate = function(t, n) {
            var r = e(this),
                i = e.effects.setMode(r, t.mode || "show"),
                s = i === "show",
                o = i === "hide",
                u = s || i === "hide",
                a = (t.times || 5) * 2 + (u ? 1 : 0),
                f = t.duration / a,
                l = 0,
                c = r.queue(),
                h = c.length,
                p;
            if (s || !r.is(":visible")) r.css("opacity", 0).show(), l = 1;
            for (p = 1; p < a; p++) r.animate({
                opacity: l
            }, f, t.easing), l = 1 - l;
            r.animate({
                opacity: l
            }, f, t.easing), r.queue(function() {
                o && r.hide(), n()
            }), h > 1 && c.splice.apply(c, [1, 0].concat(c.splice(h, a + 1))), r.dequeue()
        }
    }(jQuery),
    function(e, t) {
        e.effects.effect.puff = function(t, n) {
            var r = e(this),
                i = e.effects.setMode(r, t.mode || "hide"),
                s = i === "hide",
                o = parseInt(t.percent, 10) || 150,
                u = o / 100,
                a = {
                    height: r.height(),
                    width: r.width(),
                    outerHeight: r.outerHeight(),
                    outerWidth: r.outerWidth()
                };
            e.extend(t, {
                effect: "scale",
                queue: !1,
                fade: !0,
                mode: i,
                complete: n,
                percent: s ? o : 100,
                from: s ? a : {
                    height: a.height * u,
                    width: a.width * u,
                    outerHeight: a.outerHeight * u,
                    outerWidth: a.outerWidth * u
                }
            }), r.effect(t)
        }, e.effects.effect.scale = function(t, n) {
            var r = e(this),
                i = e.extend(!0, {}, t),
                s = e.effects.setMode(r, t.mode || "effect"),
                o = parseInt(t.percent, 10) || (parseInt(t.percent, 10) === 0 ? 0 : s === "hide" ? 0 : 100),
                u = t.direction || "both",
                a = t.origin,
                f = {
                    height: r.height(),
                    width: r.width(),
                    outerHeight: r.outerHeight(),
                    outerWidth: r.outerWidth()
                },
                l = {
                    y: u !== "horizontal" ? o / 100 : 1,
                    x: u !== "vertical" ? o / 100 : 1
                };
            i.effect = "size", i.queue = !1, i.complete = n, s !== "effect" && (i.origin = a || ["middle", "center"], i.restore = !0), i.from = t.from || (s === "show" ? {
                height: 0,
                width: 0,
                outerHeight: 0,
                outerWidth: 0
            } : f), i.to = {
                height: f.height * l.y,
                width: f.width * l.x,
                outerHeight: f.outerHeight * l.y,
                outerWidth: f.outerWidth * l.x
            }, i.fade && (s === "show" && (i.from.opacity = 0, i.to.opacity = 1), s === "hide" && (i.from.opacity = 1, i.to.opacity = 0)), r.effect(i)
        }, e.effects.effect.size = function(t, n) {
            var r, i, s, o = e(this),
                u = ["position", "top", "bottom", "left", "right", "width", "height", "overflow", "opacity"],
                a = ["position", "top", "bottom", "left", "right", "overflow", "opacity"],
                f = ["width", "height", "overflow"],
                l = ["fontSize"],
                c = ["borderTopWidth", "borderBottomWidth", "paddingTop", "paddingBottom"],
                h = ["borderLeftWidth", "borderRightWidth", "paddingLeft", "paddingRight"],
                p = e.effects.setMode(o, t.mode || "effect"),
                d = t.restore || p !== "effect",
                v = t.scale || "both",
                m = t.origin || ["middle", "center"],
                g = o.css("position"),
                y = d ? u : a,
                b = {
                    height: 0,
                    width: 0,
                    outerHeight: 0,
                    outerWidth: 0
                };
            p === "show" && o.show(), r = {
                height: o.height(),
                width: o.width(),
                outerHeight: o.outerHeight(),
                outerWidth: o.outerWidth()
            }, t.mode === "toggle" && p === "show" ? (o.from = t.to || b, o.to = t.from || r) : (o.from = t.from || (p === "show" ? b : r), o.to = t.to || (p === "hide" ? b : r)), s = {
                from: {
                    y: o.from.height / r.height,
                    x: o.from.width / r.width
                },
                to: {
                    y: o.to.height / r.height,
                    x: o.to.width / r.width
                }
            };
            if (v === "box" || v === "both") s.from.y !== s.to.y && (y = y.concat(c), o.from = e.effects.setTransition(o, c, s.from.y, o.from), o.to = e.effects.setTransition(o, c, s.to.y, o.to)), s.from.x !== s.to.x && (y = y.concat(h), o.from = e.effects.setTransition(o, h, s.from.x, o.from), o.to = e.effects.setTransition(o, h, s.to.x, o.to));
            (v === "content" || v === "both") && s.from.y !== s.to.y && (y = y.concat(l).concat(f), o.from = e.effects.setTransition(o, l, s.from.y, o.from), o.to = e.effects.setTransition(o, l, s.to.y, o.to)), e.effects.save(o, y), o.show(), e.effects.createWrapper(o), o.css("overflow", "hidden").css(o.from), m && (i = e.effects.getBaseline(m, r), o.from.top = (r.outerHeight - o.outerHeight()) * i.y, o.from.left = (r.outerWidth - o.outerWidth()) * i.x, o.to.top = (r.outerHeight - o.to.outerHeight) * i.y, o.to.left = (r.outerWidth - o.to.outerWidth) * i.x), o.css(o.from);
            if (v === "content" || v === "both") c = c.concat(["marginTop", "marginBottom"]).concat(l), h = h.concat(["marginLeft", "marginRight"]), f = u.concat(c).concat(h), o.find("*[width]").each(function() {
                var n = e(this),
                    r = {
                        height: n.height(),
                        width: n.width(),
                        outerHeight: n.outerHeight(),
                        outerWidth: n.outerWidth()
                    };
                d && e.effects.save(n, f), n.from = {
                    height: r.height * s.from.y,
                    width: r.width * s.from.x,
                    outerHeight: r.outerHeight * s.from.y,
                    outerWidth: r.outerWidth * s.from.x
                }, n.to = {
                    height: r.height * s.to.y,
                    width: r.width * s.to.x,
                    outerHeight: r.height * s.to.y,
                    outerWidth: r.width * s.to.x
                }, s.from.y !== s.to.y && (n.from = e.effects.setTransition(n, c, s.from.y, n.from), n.to = e.effects.setTransition(n, c, s.to.y, n.to)), s.from.x !== s.to.x && (n.from = e.effects.setTransition(n, h, s.from.x, n.from), n.to = e.effects.setTransition(n, h, s.to.x, n.to)), n.css(n.from), n.animate(n.to, t.duration, t.easing, function() {
                    d && e.effects.restore(n, f)
                })
            });
            o.animate(o.to, {
                queue: !1,
                duration: t.duration,
                easing: t.easing,
                complete: function() {
                    o.to.opacity === 0 && o.css("opacity", o.from.opacity), p === "hide" && o.hide(), e.effects.restore(o, y), d || (g === "static" ? o.css({
                        position: "relative",
                        top: o.to.top,
                        left: o.to.left
                    }) : e.each(["top", "left"], function(e, t) {
                        o.css(t, function(t, n) {
                            var r = parseInt(n, 10),
                                i = e ? o.to.left : o.to.top;
                            return n === "auto" ? i + "px" : r + i + "px"
                        })
                    })), e.effects.removeWrapper(o), n()
                }
            })
        }
    }(jQuery),
    function(e, t) {
        e.effects.effect.shake = function(t, n) {
            var r = e(this),
                i = ["position", "top", "bottom", "left", "right", "height", "width"],
                s = e.effects.setMode(r, t.mode || "effect"),
                o = t.direction || "left",
                u = t.distance || 20,
                a = t.times || 3,
                f = a * 2 + 1,
                l = Math.round(t.duration / f),
                c = o === "up" || o === "down" ? "top" : "left",
                h = o === "up" || o === "left",
                p = {},
                d = {},
                v = {},
                m, g = r.queue(),
                y = g.length;
            e.effects.save(r, i), r.show(), e.effects.createWrapper(r), p[c] = (h ? "-=" : "+=") + u, d[c] = (h ? "+=" : "-=") + u * 2, v[c] = (h ? "-=" : "+=") + u * 2, r.animate(p, l, t.easing);
            for (m = 1; m < a; m++) r.animate(d, l, t.easing).animate(v, l, t.easing);
            r.animate(d, l, t.easing).animate(p, l / 2, t.easing).queue(function() {
                s === "hide" && r.hide(), e.effects.restore(r, i), e.effects.removeWrapper(r), n()
            }), y > 1 && g.splice.apply(g, [1, 0].concat(g.splice(y, f + 1))), r.dequeue()
        }
    }(jQuery),
    function(e, t) {
        e.effects.effect.slide = function(t, n) {
            var r = e(this),
                i = ["position", "top", "bottom", "left", "right", "width", "height"],
                s = e.effects.setMode(r, t.mode || "show"),
                o = s === "show",
                u = t.direction || "left",
                a = u === "up" || u === "down" ? "top" : "left",
                f = u === "up" || u === "left",
                l, c = {};
            e.effects.save(r, i), r.show(), l = t.distance || r[a === "top" ? "outerHeight" : "outerWidth"](!0), e.effects.createWrapper(r).css({
                overflow: "hidden"
            }), o && r.css(a, f ? isNaN(l) ? "-" + l : -l : l), c[a] = (o ? f ? "+=" : "-=" : f ? "-=" : "+=") + l, r.animate(c, {
                queue: !1,
                duration: t.duration,
                easing: t.easing,
                complete: function() {
                    s === "hide" && r.hide(), e.effects.restore(r, i), e.effects.removeWrapper(r), n()
                }
            })
        }
    }(jQuery),
    function(e, t) {
        e.effects.effect.transfer = function(t, n) {
            var r = e(this),
                i = e(t.to),
                s = i.css("position") === "fixed",
                o = e("body"),
                u = s ? o.scrollTop() : 0,
                a = s ? o.scrollLeft() : 0,
                f = i.offset(),
                l = {
                    top: f.top - u,
                    left: f.left - a,
                    height: i.innerHeight(),
                    width: i.innerWidth()
                },
                c = r.offset(),
                h = e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({
                    top: c.top - u,
                    left: c.left - a,
                    height: r.innerHeight(),
                    width: r.innerWidth(),
                    position: s ? "fixed" : "absolute"
                }).animate(l, t.duration, t.easing, function() {
                    h.remove(), n()
                })
        }
    }(jQuery),
    function(e, t) {
        e.widget("ui.menu", {
            version: "1.10.0",
            defaultElement: "<ul>",
            delay: 300,
            options: {
                icons: {
                    submenu: "ui-icon-carat-1-e"
                },
                menus: "ul",
                position: {
                    my: "left top",
                    at: "right top"
                },
                role: "menu",
                blur: null,
                focus: null,
                select: null
            },
            _create: function() {
                this.activeMenu = this.element, this.mouseHandled = !1, this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons", !!this.element.find(".ui-icon").length).attr({
                    role: this.options.role,
                    tabIndex: 0
                }).bind("click" + this.eventNamespace, e.proxy(function(e) {
                    this.options.disabled && e.preventDefault()
                }, this)), this.options.disabled && this.element.addClass("ui-state-disabled").attr("aria-disabled", "true"), this._on({
                    "mousedown .ui-menu-item > a": function(e) {
                        e.preventDefault()
                    },
                    "click .ui-state-disabled > a": function(e) {
                        e.preventDefault()
                    },
                    "click .ui-menu-item:has(a)": function(t) {
                        var n = e(t.target).closest(".ui-menu-item");
                        !this.mouseHandled && n.not(".ui-state-disabled").length && (this.mouseHandled = !0, this.select(t), n.has(".ui-menu").length ? this.expand(t) : this.element.is(":focus") || (this.element.trigger("focus", [!0]), this.active && this.active.parents(".ui-menu").length === 1 && clearTimeout(this.timer)))
                    },
                    "mouseenter .ui-menu-item": function(t) {
                        var n = e(t.currentTarget);
                        n.siblings().children(".ui-state-active").removeClass("ui-state-active"), this.focus(t, n)
                    },
                    mouseleave: "collapseAll",
                    "mouseleave .ui-menu": "collapseAll",
                    focus: function(e, t) {
                        var n = this.active || this.element.children(".ui-menu-item").eq(0);
                        t || this.focus(e, n)
                    },
                    blur: function(t) {
                        this._delay(function() {
                            e.contains(this.element[0], this.document[0].activeElement) || this.collapseAll(t)
                        })
                    },
                    keydown: "_keydown"
                }), this.refresh(), this._on(this.document, {
                    click: function(t) {
                        e(t.target).closest(".ui-menu").length || this.collapseAll(t), this.mouseHandled = !1
                    }
                })
            },
            _destroy: function() {
                this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(), this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function() {
                    var t = e(this);
                    t.data("ui-menu-submenu-carat") && t.remove()
                }), this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")
            },
            _keydown: function(t) {
                function a(e) {
                    return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&")
                }
                var n, r, i, s, o, u = !0;
                switch (t.keyCode) {
                    case e.ui.keyCode.PAGE_UP:
                        this.previousPage(t);
                        break;
                    case e.ui.keyCode.PAGE_DOWN:
                        this.nextPage(t);
                        break;
                    case e.ui.keyCode.HOME:
                        this._move("first", "first", t);
                        break;
                    case e.ui.keyCode.END:
                        this._move("last", "last", t);
                        break;
                    case e.ui.keyCode.UP:
                        this.previous(t);
                        break;
                    case e.ui.keyCode.DOWN:
                        this.next(t);
                        break;
                    case e.ui.keyCode.LEFT:
                        this.collapse(t);
                        break;
                    case e.ui.keyCode.RIGHT:
                        this.active && !this.active.is(".ui-state-disabled") && this.expand(t);
                        break;
                    case e.ui.keyCode.ENTER:
                    case e.ui.keyCode.SPACE:
                        this._activate(t);
                        break;
                    case e.ui.keyCode.ESCAPE:
                        this.collapse(t);
                        break;
                    default:
                        u = !1, r = this.previousFilter || "", i = String.fromCharCode(t.keyCode), s = !1, clearTimeout(this.filterTimer), i === r ? s = !0 : i = r + i, o = new RegExp("^" + a(i), "i"), n = this.activeMenu.children(".ui-menu-item").filter(function() {
                            return o.test(e(this).children("a").text())
                        }), n = s && n.index(this.active.next()) !== -1 ? this.active.nextAll(".ui-menu-item") : n, n.length || (i = String.fromCharCode(t.keyCode), o = new RegExp("^" + a(i), "i"), n = this.activeMenu.children(".ui-menu-item").filter(function() {
                            return o.test(e(this).children("a").text())
                        })), n.length ? (this.focus(t, n), n.length > 1 ? (this.previousFilter = i, this.filterTimer = this._delay(function() {
                            delete this.previousFilter
                        }, 1e3)) : delete this.previousFilter) : delete this.previousFilter
                }
                u && t.preventDefault()
            },
            _activate: function(e) {
                this.active.is(".ui-state-disabled") || (this.active.children("a[aria-haspopup='true']").length ? this.expand(e) : this.select(e))
            },
            refresh: function() {
                var t, n = this.options.icons.submenu,
                    r = this.element.find(this.options.menus);
                r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({
                    role: this.options.role,
                    "aria-hidden": "true",
                    "aria-expanded": "false"
                }).each(function() {
                    var t = e(this),
                        r = t.prev("a"),
                        i = e("<span>").addClass("ui-menu-icon ui-icon " + n).data("ui-menu-submenu-carat", !0);
                    r.attr("aria-haspopup", "true").prepend(i), t.attr("aria-labelledby", r.attr("id"))
                }), t = r.add(this.element), t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role", "presentation").children("a").uniqueId().addClass("ui-corner-all").attr({
                    tabIndex: -1,
                    role: this._itemRole()
                }), t.children(":not(.ui-menu-item)").each(function() {
                    var t = e(this);
                    /[^\-\s]/.test(t.text()) || t.addClass("ui-widget-content ui-menu-divider")
                }), t.children(".ui-state-disabled").attr("aria-disabled", "true"), this.active && !e.contains(this.element[0], this.active[0]) && this.blur()
            },
            _itemRole: function() {
                return {
                    menu: "menuitem",
                    listbox: "option"
                }[this.options.role]
            },
            _setOption: function(e, t) {
                e === "icons" && this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu), this._super(e, t)
            },
            focus: function(e, t) {
                var n, r;
                this.blur(e, e && e.type === "focus"), this._scrollIntoView(t), this.active = t.first(), r = this.active.children("a").addClass("ui-state-focus"), this.options.role && this.element.attr("aria-activedescendant", r.attr("id")), this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"), e && e.type === "keydown" ? this._close() : this.timer = this._delay(function() {
                    this._close()
                }, this.delay), n = t.children(".ui-menu"), n.length && /^mouse/.test(e.type) && this._startOpening(n), this.activeMenu = t.parent(), this._trigger("focus", e, {
                    item: t
                })
            },
            _scrollIntoView: function(t) {
                var n, r, i, s, o, u;
                this._hasScroll() && (n = parseFloat(e.css(this.activeMenu[0], "borderTopWidth")) || 0, r = parseFloat(e.css(this.activeMenu[0], "paddingTop")) || 0, i = t.offset().top - this.activeMenu.offset().top - n - r, s = this.activeMenu.scrollTop(), o = this.activeMenu.height(), u = t.height(), i < 0 ? this.activeMenu.scrollTop(s + i) : i + u > o && this.activeMenu.scrollTop(s + i - o + u))
            },
            blur: function(e, t) {
                t || clearTimeout(this.timer);
                if (!this.active) return;
                this.active.children("a").removeClass("ui-state-focus"), this.active = null, this._trigger("blur", e, {
                    item: this.active
                })
            },
            _startOpening: function(e) {
                clearTimeout(this.timer);
                if (e.attr("aria-hidden") !== "true") return;
                this.timer = this._delay(function() {
                    this._close(), this._open(e)
                }, this.delay)
            },
            _open: function(t) {
                var n = e.extend({ of: this.active
                }, this.options.position);
                clearTimeout(this.timer), this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden", "true"), t.show().removeAttr("aria-hidden").attr("aria-expanded", "true").position(n)
            },
            collapseAll: function(t, n) {
                clearTimeout(this.timer), this.timer = this._delay(function() {
                    var r = n ? this.element : e(t && t.target).closest(this.element.find(".ui-menu"));
                    r.length || (r = this.element), this._close(r), this.blur(t), this.activeMenu = r
                }, this.delay)
            },
            _close: function(e) {
                e || (e = this.active ? this.active.parent() : this.element), e.find(".ui-menu").hide().attr("aria-hidden", "true").attr("aria-expanded", "false").end().find("a.ui-state-active").removeClass("ui-state-active")
            },
            collapse: function(e) {
                var t = this.active && this.active.parent().closest(".ui-menu-item", this.element);
                t && t.length && (this._close(), this.focus(e, t))
            },
            expand: function(e) {
                var t = this.active && this.active.children(".ui-menu ").children(".ui-menu-item").first();
                t && t.length && (this._open(t.parent()), this._delay(function() {
                    this.focus(e, t)
                }))
            },
            next: function(e) {
                this._move("next", "first", e)
            },
            previous: function(e) {
                this._move("prev", "last", e)
            },
            isFirstItem: function() {
                return this.active && !this.active.prevAll(".ui-menu-item").length
            },
            isLastItem: function() {
                return this.active && !this.active.nextAll(".ui-menu-item").length
            },
            _move: function(e, t, n) {
                var r;
                this.active && (e === "first" || e === "last" ? r = this.active[e === "first" ? "prevAll" : "nextAll"](".ui-menu-item").eq(-1) : r = this.active[e + "All"](".ui-menu-item").eq(0));
                if (!r || !r.length || !this.active) r = this.activeMenu.children(".ui-menu-item")[t]();
                this.focus(n, r)
            },
            nextPage: function(t) {
                var n, r, i;
                if (!this.active) {
                    this.next(t);
                    return
                }
                if (this.isLastItem()) return;
                this._hasScroll() ? (r = this.active.offset().top, i = this.element.height(), this.active.nextAll(".ui-menu-item").each(function() {
                    return n = e(this), n.offset().top - r - i < 0
                }), this.focus(t, n)) : this.focus(t, this.activeMenu.children(".ui-menu-item")[this.active ? "last" : "first"]())
            },
            previousPage: function(t) {
                var n, r, i;
                if (!this.active) {
                    this.next(t);
                    return
                }
                if (this.isFirstItem()) return;
                this._hasScroll() ? (r = this.active.offset().top, i = this.element.height(), this.active.prevAll(".ui-menu-item").each(function() {
                    return n = e(this), n.offset().top - r + i > 0
                }), this.focus(t, n)) : this.focus(t, this.activeMenu.children(".ui-menu-item").first())
            },
            _hasScroll: function() {
                return this.element.outerHeight() < this.element.prop("scrollHeight")
            },
            select: function(t) {
                this.active = this.active || e(t.target).closest(".ui-menu-item");
                var n = {
                    item: this.active
                };
                this.active.has(".ui-menu").length || this.collapseAll(t, !0), this._trigger("select", t, n)
            }
        })
    }(jQuery),
    function(e, t) {
        function h(e, t, n) {
            return [parseInt(e[0], 10) * (l.test(e[0]) ? t / 100 : 1), parseInt(e[1], 10) * (l.test(e[1]) ? n / 100 : 1)]
        }

        function p(t, n) {
            return parseInt(e.css(t, n), 10) || 0
        }

        function d(t) {
            var n = t[0];
            return n.nodeType === 9 ? {
                width: t.width(),
                height: t.height(),
                offset: {
                    top: 0,
                    left: 0
                }
            } : e.isWindow(n) ? {
                width: t.width(),
                height: t.height(),
                offset: {
                    top: t.scrollTop(),
                    left: t.scrollLeft()
                }
            } : n.preventDefault ? {
                width: 0,
                height: 0,
                offset: {
                    top: n.pageY,
                    left: n.pageX
                }
            } : {
                width: t.outerWidth(),
                height: t.outerHeight(),
                offset: t.offset()
            }
        }
        e.ui = e.ui || {};
        var n, r = Math.max,
            i = Math.abs,
            s = Math.round,
            o = /left|center|right/,
            u = /top|center|bottom/,
            a = /[\+\-]\d+%?/,
            f = /^\w+/,
            l = /%$/,
            c = e.fn.position;
        e.position = {
                scrollbarWidth: function() {
                    if (n !== t) return n;
                    var r, i, s = e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),
                        o = s.children()[0];
                    return e("body").append(s), r = o.offsetWidth, s.css("overflow", "scroll"), i = o.offsetWidth, r === i && (i = s[0].clientWidth), s.remove(), n = r - i
                },
                getScrollInfo: function(t) {
                    var n = t.isWindow ? "" : t.element.css("overflow-x"),
                        r = t.isWindow ? "" : t.element.css("overflow-y"),
                        i = n === "scroll" || n === "auto" && t.width < t.element[0].scrollWidth,
                        s = r === "scroll" || r === "auto" && t.height < t.element[0].scrollHeight;
                    return {
                        width: i ? e.position.scrollbarWidth() : 0,
                        height: s ? e.position.scrollbarWidth() : 0
                    }
                },
                getWithinInfo: function(t) {
                    var n = e(t || window),
                        r = e.isWindow(n[0]);
                    return {
                        element: n,
                        isWindow: r,
                        offset: n.offset() || {
                            left: 0,
                            top: 0
                        },
                        scrollLeft: n.scrollLeft(),
                        scrollTop: n.scrollTop(),
                        width: r ? n.width() : n.outerWidth(),
                        height: r ? n.height() : n.outerHeight()
                    }
                }
            }, e.fn.position = function(t) {
                if (!t || !t.of) return c.apply(this, arguments);
                t = e.extend({}, t);
                var n, l, v, m, g, y, b = e(t.of),
                    w = e.position.getWithinInfo(t.within),
                    E = e.position.getScrollInfo(w),
                    S = (t.collision || "flip").split(" "),
                    x = {};
                return y = d(b), b[0].preventDefault && (t.at = "left top"), l = y.width, v = y.height, m = y.offset, g = e.extend({}, m), e.each(["my", "at"], function() {
                    var e = (t[this] || "").split(" "),
                        n, r;
                    e.length === 1 && (e = o.test(e[0]) ? e.concat(["center"]) : u.test(e[0]) ? ["center"].concat(e) : ["center", "center"]), e[0] = o.test(e[0]) ? e[0] : "center", e[1] = u.test(e[1]) ? e[1] : "center", n = a.exec(e[0]), r = a.exec(e[1]), x[this] = [n ? n[0] : 0, r ? r[0] : 0], t[this] = [f.exec(e[0])[0], f.exec(e[1])[0]]
                }), S.length === 1 && (S[1] = S[0]), t.at[0] === "right" ? g.left += l : t.at[0] === "center" && (g.left += l / 2), t.at[1] === "bottom" ? g.top += v : t.at[1] === "center" && (g.top += v / 2), n = h(x.at, l, v), g.left += n[0], g.top += n[1], this.each(function() {
                    var o, u, a = e(this),
                        f = a.outerWidth(),
                        c = a.outerHeight(),
                        d = p(this, "marginLeft"),
                        y = p(this, "marginTop"),
                        T = f + d + p(this, "marginRight") + E.width,
                        N = c + y + p(this, "marginBottom") + E.height,
                        C = e.extend({}, g),
                        k = h(x.my, a.outerWidth(), a.outerHeight());
                    t.my[0] === "right" ? C.left -= f : t.my[0] === "center" && (C.left -= f / 2), t.my[1] === "bottom" ? C.top -= c : t.my[1] === "center" && (C.top -= c / 2), C.left += k[0], C.top += k[1], e.support.offsetFractions || (C.left = s(C.left), C.top = s(C.top)), o = {
                        marginLeft: d,
                        marginTop: y
                    }, e.each(["left", "top"], function(r, i) {
                        e.ui.position[S[r]] && e.ui.position[S[r]][i](C, {
                            targetWidth: l,
                            targetHeight: v,
                            elemWidth: f,
                            elemHeight: c,
                            collisionPosition: o,
                            collisionWidth: T,
                            collisionHeight: N,
                            offset: [n[0] + k[0], n[1] + k[1]],
                            my: t.my,
                            at: t.at,
                            within: w,
                            elem: a
                        })
                    }), t.using && (u = function(e) {
                        var n = m.left - C.left,
                            s = n + l - f,
                            o = m.top - C.top,
                            u = o + v - c,
                            h = {
                                target: {
                                    element: b,
                                    left: m.left,
                                    top: m.top,
                                    width: l,
                                    height: v
                                },
                                element: {
                                    element: a,
                                    left: C.left,
                                    top: C.top,
                                    width: f,
                                    height: c
                                },
                                horizontal: s < 0 ? "left" : n > 0 ? "right" : "center",
                                vertical: u < 0 ? "top" : o > 0 ? "bottom" : "middle"
                            };
                        l < f && i(n + s) < l && (h.horizontal = "center"), v < c && i(o + u) < v && (h.vertical = "middle"), r(i(n), i(s)) > r(i(o), i(u)) ? h.important = "horizontal" : h.important = "vertical", t.using.call(this, e, h)
                    }), a.offset(e.extend(C, {
                        using: u
                    }))
                })
            }, e.ui.position = {
                fit: {
                    left: function(e, t) {
                        var n = t.within,
                            i = n.isWindow ? n.scrollLeft : n.offset.left,
                            s = n.width,
                            o = e.left - t.collisionPosition.marginLeft,
                            u = i - o,
                            a = o + t.collisionWidth - s - i,
                            f;
                        t.collisionWidth > s ? u > 0 && a <= 0 ? (f = e.left + u + t.collisionWidth - s - i, e.left += u - f) : a > 0 && u <= 0 ? e.left = i : u > a ? e.left = i + s - t.collisionWidth : e.left = i : u > 0 ? e.left += u : a > 0 ? e.left -= a : e.left = r(e.left - o, e.left)
                    },
                    top: function(e, t) {
                        var n = t.within,
                            i = n.isWindow ? n.scrollTop : n.offset.top,
                            s = t.within.height,
                            o = e.top - t.collisionPosition.marginTop,
                            u = i - o,
                            a = o + t.collisionHeight - s - i,
                            f;
                        t.collisionHeight > s ? u > 0 && a <= 0 ? (f = e.top + u + t.collisionHeight - s - i, e.top += u - f) : a > 0 && u <= 0 ? e.top = i : u > a ? e.top = i + s - t.collisionHeight : e.top = i : u > 0 ? e.top += u : a > 0 ? e.top -= a : e.top = r(e.top - o, e.top)
                    }
                },
                flip: {
                    left: function(e, t) {
                        var n = t.within,
                            r = n.offset.left + n.scrollLeft,
                            s = n.width,
                            o = n.isWindow ? n.scrollLeft : n.offset.left,
                            u = e.left - t.collisionPosition.marginLeft,
                            a = u - o,
                            f = u + t.collisionWidth - s - o,
                            l = t.my[0] === "left" ? -t.elemWidth : t.my[0] === "right" ? t.elemWidth : 0,
                            c = t.at[0] === "left" ? t.targetWidth : t.at[0] === "right" ? -t.targetWidth : 0,
                            h = -2 * t.offset[0],
                            p, d;
                        if (a < 0) {
                            p = e.left + l + c + h + t.collisionWidth - s - r;
                            if (p < 0 || p < i(a)) e.left += l + c + h
                        } else if (f > 0) {
                            d = e.left - t.collisionPosition.marginLeft + l + c + h - o;
                            if (d > 0 || i(d) < f) e.left += l + c + h
                        }
                    },
                    top: function(e, t) {
                        var n = t.within,
                            r = n.offset.top + n.scrollTop,
                            s = n.height,
                            o = n.isWindow ? n.scrollTop : n.offset.top,
                            u = e.top - t.collisionPosition.marginTop,
                            a = u - o,
                            f = u + t.collisionHeight - s - o,
                            l = t.my[1] === "top",
                            c = l ? -t.elemHeight : t.my[1] === "bottom" ? t.elemHeight : 0,
                            h = t.at[1] === "top" ? t.targetHeight : t.at[1] === "bottom" ? -t.targetHeight : 0,
                            p = -2 * t.offset[1],
                            d, v;
                        a < 0 ? (v = e.top + c + h + p + t.collisionHeight - s - r, e.top + c + h + p > a && (v < 0 || v < i(a)) && (e.top += c + h + p)) : f > 0 && (d = e.top - t.collisionPosition.marginTop + c + h + p - o, e.top + c + h + p > f && (d > 0 || i(d) < f) && (e.top += c + h + p))
                    }
                },
                flipfit: {
                    left: function() {
                        e.ui.position.flip.left.apply(this, arguments), e.ui.position.fit.left.apply(this, arguments)
                    },
                    top: function() {
                        e.ui.position.flip.top.apply(this, arguments), e.ui.position.fit.top.apply(this, arguments)
                    }
                }
            },
            function() {
                var t, n, r, i, s, o = document.getElementsByTagName("body")[0],
                    u = document.createElement("div");
                t = document.createElement(o ? "div" : "body"), r = {
                    visibility: "hidden",
                    width: 0,
                    height: 0,
                    border: 0,
                    margin: 0,
                    background: "none"
                }, o && e.extend(r, {
                    position: "absolute",
                    left: "-1000px",
                    top: "-1000px"
                });
                for (s in r) t.style[s] = r[s];
                t.appendChild(u), n = o || document.documentElement, n.insertBefore(t, n.firstChild), u.style.cssText = "position: absolute; left: 10.7432222px;", i = e(u).offset().left, e.support.offsetFractions = i > 10 && i < 11, t.innerHTML = "", n.removeChild(t)
            }()
    }(jQuery),
    function(e, t) {
        e.widget("ui.progressbar", {
            version: "1.10.0",
            options: {
                max: 100,
                value: 0,
                change: null,
                complete: null
            },
            min: 0,
            _create: function() {
                this.oldValue = this.options.value = this._constrainedValue(), this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({
                    role: "progressbar",
                    "aria-valuemin": this.min
                }), this.valueDiv = e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element), this._refreshValue()
            },
            _destroy: function() {
                this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"), this.valueDiv.remove()
            },
            value: function(e) {
                if (e === t) return this.options.value;
                this.options.value = this._constrainedValue(e), this._refreshValue()
            },
            _constrainedValue: function(e) {
                return e === t && (e = this.options.value), this.indeterminate = e === !1, typeof e != "number" && (e = 0), this.indeterminate ? !1 : Math.min(this.options.max, Math.max(this.min, e))
            },
            _setOptions: function(e) {
                var t = e.value;
                delete e.value, this._super(e), this.options.value = this._constrainedValue(t), this._refreshValue()
            },
            _setOption: function(e, t) {
                e === "max" && (t = Math.max(this.min, t)), this._super(e, t)
            },
            _percentage: function() {
                return this.indeterminate ? 100 : 100 * (this.options.value - this.min) / (this.options.max - this.min)
            },
            _refreshValue: function() {
                var t = this.options.value,
                    n = this._percentage();
                this.valueDiv.toggle(this.indeterminate || t > this.min).toggleClass("ui-corner-right", t === this.options.max).width(n.toFixed(0) + "%"), this.element.toggleClass("ui-progressbar-indeterminate", this.indeterminate), this.indeterminate ? (this.element.removeAttr("aria-valuenow"), this.overlayDiv || (this.overlayDiv = e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))) : (this.element.attr({
                    "aria-valuemax": this.options.max,
                    "aria-valuenow": t
                }), this.overlayDiv && (this.overlayDiv.remove(), this.overlayDiv = null)), this.oldValue !== t && (this.oldValue = t, this._trigger("change")), t === this.options.max && this._trigger("complete")
            }
        })
    }(jQuery),
    function(e, t) {
        var n = 5;
        e.widget("ui.slider", e.ui.mouse, {
            version: "1.10.0",
            widgetEventPrefix: "slide",
            options: {
                animate: !1,
                distance: 0,
                max: 100,
                min: 0,
                orientation: "horizontal",
                range: !1,
                step: 1,
                value: 0,
                values: null,
                change: null,
                slide: null,
                start: null,
                stop: null
            },
            _create: function() {
                var t, n, r = this.options,
                    i = this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),
                    s = "<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",
                    o = [];
                this._keySliding = !1, this._mouseSliding = !1, this._animateOff = !0, this._handleIndex = null, this._detectOrientation(), this._mouseInit(), this.element.addClass("ui-slider ui-slider-" + this.orientation + " ui-widget" + " ui-widget-content" + " ui-corner-all"), this.range = e([]), r.range && (r.range === !0 && (r.values ? r.values.length && r.values.length !== 2 ? r.values = [r.values[0], r.values[0]] : e.isArray(r.values) && (r.values = r.values.slice(0)) : r.values = [this._valueMin(), this._valueMin()]), this.range = e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header" + (r.range === "min" || r.range === "max" ? " ui-slider-range-" + r.range : ""))), n = r.values && r.values.length || 1;
                for (t = i.length; t < n; t++) o.push(s);
                this.handles = i.add(e(o.join("")).appendTo(this.element)), this.handle = this.handles.eq(0), this.handles.add(this.range).filter("a").click(function(e) {
                    e.preventDefault()
                }).mouseenter(function() {
                    r.disabled || e(this).addClass("ui-state-hover")
                }).mouseleave(function() {
                    e(this).removeClass("ui-state-hover")
                }).focus(function() {
                    r.disabled ? e(this).blur() : (e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"), e(this).addClass("ui-state-focus"))
                }).blur(function() {
                    e(this).removeClass("ui-state-focus")
                }), this.handles.each(function(t) {
                    e(this).data("ui-slider-handle-index", t)
                }), this._setOption("disabled", r.disabled), this._on(this.handles, this._handleEvents), this._refreshValue(), this._animateOff = !1
            },
            _destroy: function() {
                this.handles.remove(), this.range.remove(), this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"), this._mouseDestroy()
            },
            _mouseCapture: function(t) {
                var n, r, i, s, o, u, a, f, l = this,
                    c = this.options;
                return c.disabled ? !1 : (this.elementSize = {
                    width: this.element.outerWidth(),
                    height: this.element.outerHeight()
                }, this.elementOffset = this.element.offset(), n = {
                    x: t.pageX,
                    y: t.pageY
                }, r = this._normValueFromMouse(n), i = this._valueMax() - this._valueMin() + 1, this.handles.each(function(t) {
                    var n = Math.abs(r - l.values(t));
                    if (i > n || i === n && (t === l._lastChangedValue || l.values(t) === c.min)) i = n, s = e(this), o = t
                }), u = this._start(t, o), u === !1 ? !1 : (this._mouseSliding = !0, this._handleIndex = o, s.addClass("ui-state-active").focus(), a = s.offset(), f = !e(t.target).parents().addBack().is(".ui-slider-handle"), this._clickOffset = f ? {
                    left: 0,
                    top: 0
                } : {
                    left: t.pageX - a.left - s.width() / 2,
                    top: t.pageY - a.top - s.height() / 2 - (parseInt(s.css("borderTopWidth"), 10) || 0) - (parseInt(s.css("borderBottomWidth"), 10) || 0) + (parseInt(s.css("marginTop"), 10) || 0)
                }, this.handles.hasClass("ui-state-hover") || this._slide(t, o, r), this._animateOff = !0, !0))
            },
            _mouseStart: function() {
                return !0
            },
            _mouseDrag: function(e) {
                var t = {
                        x: e.pageX,
                        y: e.pageY
                    },
                    n = this._normValueFromMouse(t);
                return this._slide(e, this._handleIndex, n), !1
            },
            _mouseStop: function(e) {
                return this.handles.removeClass("ui-state-active"), this._mouseSliding = !1, this._stop(e, this._handleIndex), this._change(e, this._handleIndex), this._handleIndex = null, this._clickOffset = null, this._animateOff = !1, !1
            },
            _detectOrientation: function() {
                this.orientation = this.options.orientation === "vertical" ? "vertical" : "horizontal"
            },
            _normValueFromMouse: function(e) {
                var t, n, r, i, s;
                return this.orientation === "horizontal" ? (t = this.elementSize.width, n = e.x - this.elementOffset.left - (this._clickOffset ? this._clickOffset.left : 0)) : (t = this.elementSize.height, n = e.y - this.elementOffset.top - (this._clickOffset ? this._clickOffset.top : 0)), r = n / t, r > 1 && (r = 1), r < 0 && (r = 0), this.orientation === "vertical" && (r = 1 - r), i = this._valueMax() - this._valueMin(), s = this._valueMin() + r * i, this._trimAlignValue(s)
            },
            _start: function(e, t) {
                var n = {
                    handle: this.handles[t],
                    value: this.value()
                };
                return this.options.values && this.options.values.length && (n.value = this.values(t), n.values = this.values()), this._trigger("start", e, n)
            },
            _slide: function(e, t, n) {
                var r, i, s;
                this.options.values && this.options.values.length ? (r = this.values(t ? 0 : 1), this.options.values.length === 2 && this.options.range === !0 && (t === 0 && n > r || t === 1 && n < r) && (n = r), n !== this.values(t) && (i = this.values(), i[t] = n, s = this._trigger("slide", e, {
                    handle: this.handles[t],
                    value: n,
                    values: i
                }), r = this.values(t ? 0 : 1), s !== !1 && this.values(t, n, !0))) : n !== this.value() && (s = this._trigger("slide", e, {
                    handle: this.handles[t],
                    value: n
                }), s !== !1 && this.value(n))
            },
            _stop: function(e, t) {
                var n = {
                    handle: this.handles[t],
                    value: this.value()
                };
                this.options.values && this.options.values.length && (n.value = this.values(t), n.values = this.values()), this._trigger("stop", e, n)
            },
            _change: function(e, t) {
                if (!this._keySliding && !this._mouseSliding) {
                    var n = {
                        handle: this.handles[t],
                        value: this.value()
                    };
                    this.options.values && this.options.values.length && (n.value = this.values(t), n.values = this.values()), this._lastChangedValue = t, this._trigger("change", e, n)
                }
            },
            value: function(e) {
                if (arguments.length) {
                    this.options.value = this._trimAlignValue(e), this._refreshValue(), this._change(null, 0);
                    return
                }
                return this._value()
            },
            values: function(t, n) {
                var r, i, s;
                if (arguments.length > 1) {
                    this.options.values[t] = this._trimAlignValue(n), this._refreshValue(), this._change(null, t);
                    return
                }
                if (!arguments.length) return this._values();
                if (!e.isArray(arguments[0])) return this.options.values && this.options.values.length ? this._values(t) : this.value();
                r = this.options.values, i = arguments[0];
                for (s = 0; s < r.length; s += 1) r[s] = this._trimAlignValue(i[s]), this._change(null, s);
                this._refreshValue()
            },
            _setOption: function(t, n) {
                var r, i = 0;
                e.isArray(this.options.values) && (i = this.options.values.length), e.Widget.prototype._setOption.apply(this, arguments);
                switch (t) {
                    case "disabled":
                        n ? (this.handles.filter(".ui-state-focus").blur(), this.handles.removeClass("ui-state-hover"), this.handles.prop("disabled", !0)) : this.handles.prop("disabled", !1);
                        break;
                    case "orientation":
                        this._detectOrientation(), this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-" + this.orientation), this._refreshValue();
                        break;
                    case "value":
                        this._animateOff = !0, this._refreshValue(), this._change(null, 0), this._animateOff = !1;
                        break;
                    case "values":
                        this._animateOff = !0, this._refreshValue();
                        for (r = 0; r < i; r += 1) this._change(null, r);
                        this._animateOff = !1;
                        break;
                    case "min":
                    case "max":
                        this._animateOff = !0, this._refreshValue(), this._animateOff = !1
                }
            },
            _value: function() {
                var e = this.options.value;
                return e = this._trimAlignValue(e), e
            },
            _values: function(e) {
                var t, n, r;
                if (arguments.length) return t = this.options.values[e], t = this._trimAlignValue(t), t;
                n = this.options.values.slice();
                for (r = 0; r < n.length; r += 1) n[r] = this._trimAlignValue(n[r]);
                return n
            },
            _trimAlignValue: function(e) {
                if (e <= this._valueMin()) return this._valueMin();
                if (e >= this._valueMax()) return this._valueMax();
                var t = this.options.step > 0 ? this.options.step : 1,
                    n = (e - this._valueMin()) % t,
                    r = e - n;
                return Math.abs(n) * 2 >= t && (r += n > 0 ? t : -t), parseFloat(r.toFixed(5))
            },
            _valueMin: function() {
                return this.options.min
            },
            _valueMax: function() {
                return this.options.max
            },
            _refreshValue: function() {
                var t, n, r, i, s, o = this.options.range,
                    u = this.options,
                    a = this,
                    f = this._animateOff ? !1 : u.animate,
                    l = {};
                this.options.values && this.options.values.length ? this.handles.each(function(r) {
                    n = (a.values(r) - a._valueMin()) / (a._valueMax() - a._valueMin()) * 100, l[a.orientation === "horizontal" ? "left" : "bottom"] = n + "%", e(this).stop(1, 1)[f ? "animate" : "css"](l, u.animate), a.options.range === !0 && (a.orientation === "horizontal" ? (r === 0 && a.range.stop(1, 1)[f ? "animate" : "css"]({
                        left: n + "%"
                    }, u.animate), r === 1 && a.range[f ? "animate" : "css"]({
                        width: n - t + "%"
                    }, {
                        queue: !1,
                        duration: u.animate
                    })) : (r === 0 && a.range.stop(1, 1)[f ? "animate" : "css"]({
                        bottom: n + "%"
                    }, u.animate), r === 1 && a.range[f ? "animate" : "css"]({
                        height: n - t + "%"
                    }, {
                        queue: !1,
                        duration: u.animate
                    }))), t = n
                }) : (r = this.value(), i = this._valueMin(), s = this._valueMax(), n = s !== i ? (r - i) / (s - i) * 100 : 0, l[this.orientation === "horizontal" ? "left" : "bottom"] = n + "%", this.handle.stop(1, 1)[f ? "animate" : "css"](l, u.animate), o === "min" && this.orientation === "horizontal" && this.range.stop(1, 1)[f ? "animate" : "css"]({
                    width: n + "%"
                }, u.animate), o === "max" && this.orientation === "horizontal" && this.range[f ? "animate" : "css"]({
                    width: 100 - n + "%"
                }, {
                    queue: !1,
                    duration: u.animate
                }), o === "min" && this.orientation === "vertical" && this.range.stop(1, 1)[f ? "animate" : "css"]({
                    height: n + "%"
                }, u.animate), o === "max" && this.orientation === "vertical" && this.range[f ? "animate" : "css"]({
                    height: 100 - n + "%"
                }, {
                    queue: !1,
                    duration: u.animate
                }))
            },
            _handleEvents: {
                keydown: function(t) {
                    var r, i, s, o, u = e(t.target).data("ui-slider-handle-index");
                    switch (t.keyCode) {
                        case e.ui.keyCode.HOME:
                        case e.ui.keyCode.END:
                        case e.ui.keyCode.PAGE_UP:
                        case e.ui.keyCode.PAGE_DOWN:
                        case e.ui.keyCode.UP:
                        case e.ui.keyCode.RIGHT:
                        case e.ui.keyCode.DOWN:
                        case e.ui.keyCode.LEFT:
                            t.preventDefault();
                            if (!this._keySliding) {
                                this._keySliding = !0, e(t.target).addClass("ui-state-active"), r = this._start(t, u);
                                if (r === !1) return
                            }
                    }
                    o = this.options.step, this.options.values && this.options.values.length ? i = s = this.values(u) : i = s = this.value();
                    switch (t.keyCode) {
                        case e.ui.keyCode.HOME:
                            s = this._valueMin();
                            break;
                        case e.ui.keyCode.END:
                            s = this._valueMax();
                            break;
                        case e.ui.keyCode.PAGE_UP:
                            s = this._trimAlignValue(i + (this._valueMax() - this._valueMin()) / n);
                            break;
                        case e.ui.keyCode.PAGE_DOWN:
                            s = this._trimAlignValue(i - (this._valueMax() - this._valueMin()) / n);
                            break;
                        case e.ui.keyCode.UP:
                        case e.ui.keyCode.RIGHT:
                            if (i === this._valueMax()) return;
                            s = this._trimAlignValue(i + o);
                            break;
                        case e.ui.keyCode.DOWN:
                        case e.ui.keyCode.LEFT:
                            if (i === this._valueMin()) return;
                            s = this._trimAlignValue(i - o)
                    }
                    this._slide(t, u, s)
                },
                keyup: function(t) {
                    var n = e(t.target).data("ui-slider-handle-index");
                    this._keySliding && (this._keySliding = !1, this._stop(t, n), this._change(t, n), e(t.target).removeClass("ui-state-active"))
                }
            }
        })
    }(jQuery),
    function(e) {
        function t(e) {
            return function() {
                var t = this.element.val();
                e.apply(this, arguments), this._refresh(), t !== this.element.val() && this._trigger("change")
            }
        }
        e.widget("ui.spinner", {
            version: "1.10.0",
            defaultElement: "<input>",
            widgetEventPrefix: "spin",
            options: {
                culture: null,
                icons: {
                    down: "ui-icon-triangle-1-s",
                    up: "ui-icon-triangle-1-n"
                },
                incremental: !0,
                max: null,
                min: null,
                numberFormat: null,
                page: 10,
                step: 1,
                change: null,
                spin: null,
                start: null,
                stop: null
            },
            _create: function() {
                this._setOption("max", this.options.max), this._setOption("min", this.options.min), this._setOption("step", this.options.step), this._value(this.element.val(), !0), this._draw(), this._on(this._events), this._refresh(), this._on(this.window, {
                    beforeunload: function() {
                        this.element.removeAttr("autocomplete")
                    }
                })
            },
            _getCreateOptions: function() {
                var t = {},
                    n = this.element;
                return e.each(["min", "max", "step"], function(e, r) {
                    var i = n.attr(r);
                    i !== undefined && i.length && (t[r] = i)
                }), t
            },
            _events: {
                keydown: function(e) {
                    this._start(e) && this._keydown(e) && e.preventDefault()
                },
                keyup: "_stop",
                focus: function() {
                    this.previous = this.element.val()
                },
                blur: function(e) {
                    if (this.cancelBlur) {
                        delete this.cancelBlur;
                        return
                    }
                    this._refresh(), this.previous !== this.element.val() && this._trigger("change", e)
                },
                mousewheel: function(e, t) {
                    if (!t) return;
                    if (!this.spinning && !this._start(e)) return !1;
                    this._spin((t > 0 ? 1 : -1) * this.options.step, e), clearTimeout(this.mousewheelTimer), this.mousewheelTimer = this._delay(function() {
                        this.spinning && this._stop(e)
                    }, 100), e.preventDefault()
                },
                "mousedown .ui-spinner-button": function(t) {
                    function r() {
                        var e = this.element[0] === this.document[0].activeElement;
                        e || (this.element.focus(), this.previous = n, this._delay(function() {
                            this.previous = n
                        }))
                    }
                    var n;
                    n = this.element[0] === this.document[0].activeElement ? this.previous : this.element.val(), t.preventDefault(), r.call(this), this.cancelBlur = !0, this._delay(function() {
                        delete this.cancelBlur, r.call(this)
                    });
                    if (this._start(t) === !1) return;
                    this._repeat(null, e(t.currentTarget).hasClass("ui-spinner-up") ? 1 : -1, t)
                },
                "mouseup .ui-spinner-button": "_stop",
                "mouseenter .ui-spinner-button": function(t) {
                    if (!e(t.currentTarget).hasClass("ui-state-active")) return;
                    if (this._start(t) === !1) return !1;
                    this._repeat(null, e(t.currentTarget).hasClass("ui-spinner-up") ? 1 : -1, t)
                },
                "mouseleave .ui-spinner-button": "_stop"
            },
            _draw: function() {
                var e = this.uiSpinner = this.element.addClass("ui-spinner-input").attr("autocomplete", "off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());
                this.element.attr("role", "spinbutton"), this.buttons = e.find(".ui-spinner-button").attr("tabIndex", -1).button().removeClass("ui-corner-all"), this.buttons.height() > Math.ceil(e.height() * .5) && e.height() > 0 && e.height(e.height()), this.options.disabled && this.disable()
            },
            _keydown: function(t) {
                var n = this.options,
                    r = e.ui.keyCode;
                switch (t.keyCode) {
                    case r.UP:
                        return this._repeat(null, 1, t), !0;
                    case r.DOWN:
                        return this._repeat(null, -1, t), !0;
                    case r.PAGE_UP:
                        return this._repeat(null, n.page, t), !0;
                    case r.PAGE_DOWN:
                        return this._repeat(null, -n.page, t), !0
                }
                return !1
            },
            _uiSpinnerHtml: function() {
                return "<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"
            },
            _buttonHtml: function() {
                return "<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon " + this.options.icons.up + "'>&#9650;</span>" + "</a>" + "<a class='ui-spinner-button ui-spinner-down ui-corner-br'>" + "<span class='ui-icon " + this.options.icons.down + "'>&#9660;</span>" + "</a>"
            },
            _start: function(e) {
                return !this.spinning && this._trigger("start", e) === !1 ? !1 : (this.counter || (this.counter = 1), this.spinning = !0, !0)
            },
            _repeat: function(e, t, n) {
                e = e || 500, clearTimeout(this.timer), this.timer = this._delay(function() {
                    this._repeat(40, t, n)
                }, e), this._spin(t * this.options.step, n)
            },
            _spin: function(e, t) {
                var n = this.value() || 0;
                this.counter || (this.counter = 1), n = this._adjustValue(n + e * this._increment(this.counter));
                if (!this.spinning || this._trigger("spin", t, {
                        value: n
                    }) !== !1) this._value(n), this.counter++
            },
            _increment: function(t) {
                var n = this.options.incremental;
                return n ? e.isFunction(n) ? n(t) : Math.floor(t * t * t / 5e4 - t * t / 500 + 17 * t / 200 + 1) : 1
            },
            _precision: function() {
                var e = this._precisionOf(this.options.step);
                return this.options.min !== null && (e = Math.max(e, this._precisionOf(this.options.min))), e
            },
            _precisionOf: function(e) {
                var t = e.toString(),
                    n = t.indexOf(".");
                return n === -1 ? 0 : t.length - n - 1
            },
            _adjustValue: function(e) {
                var t, n, r = this.options;
                return t = r.min !== null ? r.min : 0, n = e - t, n = Math.round(n / r.step) * r.step, e = t + n, e = parseFloat(e.toFixed(this._precision())), r.max !== null && e > r.max ? r.max : r.min !== null && e < r.min ? r.min : e
            },
            _stop: function(e) {
                if (!this.spinning) return;
                clearTimeout(this.timer), clearTimeout(this.mousewheelTimer), this.counter = 0, this.spinning = !1, this._trigger("stop", e)
            },
            _setOption: function(e, t) {
                if (e === "culture" || e === "numberFormat") {
                    var n = this._parse(this.element.val());
                    this.options[e] = t, this.element.val(this._format(n));
                    return
                }(e === "max" || e === "min" || e === "step") && typeof t == "string" && (t = this._parse(t)), e === "icons" && (this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up), this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)), this._super(e, t), e === "disabled" && (t ? (this.element.prop("disabled", !0), this.buttons.button("disable")) : (this.element.prop("disabled", !1), this.buttons.button("enable")))
            },
            _setOptions: t(function(e) {
                this._super(e), this._value(this.element.val())
            }),
            _parse: function(e) {
                return typeof e == "string" && e !== "" && (e = window.Globalize && this.options.numberFormat ? Globalize.parseFloat(e, 10, this.options.culture) : +e), e === "" || isNaN(e) ? null : e
            },
            _format: function(e) {
                return e === "" ? "" : window.Globalize && this.options.numberFormat ? Globalize.format(e, this.options.numberFormat, this.options.culture) : e
            },
            _refresh: function() {
                this.element.attr({
                    "aria-valuemin": this.options.min,
                    "aria-valuemax": this.options.max,
                    "aria-valuenow": this._parse(this.element.val())
                })
            },
            _value: function(e, t) {
                var n;
                e !== "" && (n = this._parse(e), n !== null && (t || (n = this._adjustValue(n)), e = this._format(n))), this.element.val(e), this._refresh()
            },
            _destroy: function() {
                this.element.removeClass("ui-spinner-input").prop("disabled", !1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"), this.uiSpinner.replaceWith(this.element)
            },
            stepUp: t(function(e) {
                this._stepUp(e)
            }),
            _stepUp: function(e) {
                this._start() && (this._spin((e || 1) * this.options.step), this._stop())
            },
            stepDown: t(function(e) {
                this._stepDown(e)
            }),
            _stepDown: function(e) {
                this._start() && (this._spin((e || 1) * -this.options.step), this._stop())
            },
            pageUp: t(function(e) {
                this._stepUp((e || 1) * this.options.page)
            }),
            pageDown: t(function(e) {
                this._stepDown((e || 1) * this.options.page)
            }),
            value: function(e) {
                if (!arguments.length) return this._parse(this.element.val());
                t(this._value).call(this, e)
            },
            widget: function() {
                return this.uiSpinner
            }
        })
    }(jQuery),
    function(e, t) {
        function i() {
            return ++n
        }

        function s(e) {
            return e.hash.length > 1 && decodeURIComponent(e.href.replace(r, "")) === decodeURIComponent(location.href.replace(r, ""))
        }
        var n = 0,
            r = /#.*$/;
        e.widget("ui.tabs", {
            version: "1.10.0",
            delay: 300,
            options: {
                active: null,
                collapsible: !1,
                event: "click",
                heightStyle: "content",
                hide: null,
                show: null,
                activate: null,
                beforeActivate: null,
                beforeLoad: null,
                load: null
            },
            _create: function() {
                var t = this,
                    n = this.options;
                this.running = !1, this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible", n.collapsible).delegate(".ui-tabs-nav > li", "mousedown" + this.eventNamespace, function(t) {
                    e(this).is(".ui-state-disabled") && t.preventDefault()
                }).delegate(".ui-tabs-anchor", "focus" + this.eventNamespace, function() {
                    e(this).closest("li").is(".ui-state-disabled") && this.blur()
                }), this._processTabs(), n.active = this._initialActive(), e.isArray(n.disabled) && (n.disabled = e.unique(n.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"), function(e) {
                    return t.tabs.index(e)
                }))).sort()), this.options.active !== !1 && this.anchors.length ? this.active = this._findActive(n.active) : this.active = e(), this._refresh(), this.active.length && this.load(n.active)
            },
            _initialActive: function() {
                var t = this.options.active,
                    n = this.options.collapsible,
                    r = location.hash.substring(1);
                if (t === null) {
                    r && this.tabs.each(function(n, i) {
                        if (e(i).attr("aria-controls") === r) return t = n, !1
                    }), t === null && (t = this.tabs.index(this.tabs.filter(".ui-tabs-active")));
                    if (t === null || t === -1) t = this.tabs.length ? 0 : !1
                }
                return t !== !1 && (t = this.tabs.index(this.tabs.eq(t)), t === -1 && (t = n ? !1 : 0)), !n && t === !1 && this.anchors.length && (t = 0), t
            },
            _getCreateEventData: function() {
                return {
                    tab: this.active,
                    panel: this.active.length ? this._getPanelForTab(this.active) : e()
                }
            },
            _tabKeydown: function(t) {
                var n = e(this.document[0].activeElement).closest("li"),
                    r = this.tabs.index(n),
                    i = !0;
                if (this._handlePageNav(t)) return;
                switch (t.keyCode) {
                    case e.ui.keyCode.RIGHT:
                    case e.ui.keyCode.DOWN:
                        r++;
                        break;
                    case e.ui.keyCode.UP:
                    case e.ui.keyCode.LEFT:
                        i = !1, r--;
                        break;
                    case e.ui.keyCode.END:
                        r = this.anchors.length - 1;
                        break;
                    case e.ui.keyCode.HOME:
                        r = 0;
                        break;
                    case e.ui.keyCode.SPACE:
                        t.preventDefault(), clearTimeout(this.activating), this._activate(r);
                        return;
                    case e.ui.keyCode.ENTER:
                        t.preventDefault(), clearTimeout(this.activating), this._activate(r === this.options.active ? !1 : r);
                        return;
                    default:
                        return
                }
                t.preventDefault(), clearTimeout(this.activating), r = this._focusNextTab(r, i), t.ctrlKey || (n.attr("aria-selected", "false"), this.tabs.eq(r).attr("aria-selected", "true"), this.activating = this._delay(function() {
                    this.option("active", r)
                }, this.delay))
            },
            _panelKeydown: function(t) {
                if (this._handlePageNav(t)) return;
                t.ctrlKey && t.keyCode === e.ui.keyCode.UP && (t.preventDefault(), this.active.focus())
            },
            _handlePageNav: function(t) {
                if (t.altKey && t.keyCode === e.ui.keyCode.PAGE_UP) return this._activate(this._focusNextTab(this.options.active - 1, !1)), !0;
                if (t.altKey && t.keyCode === e.ui.keyCode.PAGE_DOWN) return this._activate(this._focusNextTab(this.options.active + 1, !0)), !0
            },
            _findNextTab: function(t, n) {
                function i() {
                    return t > r && (t = 0), t < 0 && (t = r), t
                }
                var r = this.tabs.length - 1;
                while (e.inArray(i(), this.options.disabled) !== -1) t = n ? t + 1 : t - 1;
                return t
            },
            _focusNextTab: function(e, t) {
                return e = this._findNextTab(e, t), this.tabs.eq(e).focus(), e
            },
            _setOption: function(e, t) {
                if (e === "active") {
                    this._activate(t);
                    return
                }
                if (e === "disabled") {
                    this._setupDisabled(t);
                    return
                }
                this._super(e, t), e === "collapsible" && (this.element.toggleClass("ui-tabs-collapsible", t), !t && this.options.active === !1 && this._activate(0)), e === "event" && this._setupEvents(t), e === "heightStyle" && this._setupHeightStyle(t)
            },
            _tabId: function(e) {
                return e.attr("aria-controls") || "ui-tabs-" + i()
            },
            _sanitizeSelector: function(e) {
                return e ? e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g, "\\$&") : ""
            },
            refresh: function() {
                var t = this.options,
                    n = this.tablist.children(":has(a[href])");
                t.disabled = e.map(n.filter(".ui-state-disabled"), function(e) {
                    return n.index(e)
                }), this._processTabs(), t.active === !1 || !this.anchors.length ? (t.active = !1, this.active = e()) : this.active.length && !e.contains(this.tablist[0], this.active[0]) ? this.tabs.length === t.disabled.length ? (t.active = !1, this.active = e()) : this._activate(this._findNextTab(Math.max(0, t.active - 1), !1)) : t.active = this.tabs.index(this.active), this._refresh()
            },
            _refresh: function() {
                this._setupDisabled(this.options.disabled), this._setupEvents(this.options.event), this._setupHeightStyle(this.options.heightStyle), this.tabs.not(this.active).attr({
                    "aria-selected": "false",
                    tabIndex: -1
                }), this.panels.not(this._getPanelForTab(this.active)).hide().attr({
                    "aria-expanded": "false",
                    "aria-hidden": "true"
                }), this.active.length ? (this.active.addClass("ui-tabs-active ui-state-active").attr({
                    "aria-selected": "true",
                    tabIndex: 0
                }), this._getPanelForTab(this.active).show().attr({
                    "aria-expanded": "true",
                    "aria-hidden": "false"
                })) : this.tabs.eq(0).attr("tabIndex", 0)
            },
            _processTabs: function() {
                var t = this;
                this.tablist = this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role", "tablist"), this.tabs = this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({
                    role: "tab",
                    tabIndex: -1
                }), this.anchors = this.tabs.map(function() {
                    return e("a", this)[0]
                }).addClass("ui-tabs-anchor").attr({
                    role: "presentation",
                    tabIndex: -1
                }), this.panels = e(), this.anchors.each(function(n, r) {
                    var i, o, u, a = e(r).uniqueId().attr("id"),
                        f = e(r).closest("li"),
                        l = f.attr("aria-controls");
                    s(r) ? (i = r.hash, o = t.element.find(t._sanitizeSelector(i))) : (u = t._tabId(f), i = "#" + u, o = t.element.find(i), o.length || (o = t._createPanel(u), o.insertAfter(t.panels[n - 1] || t.tablist)), o.attr("aria-live", "polite")), o.length && (t.panels = t.panels.add(o)), l && f.data("ui-tabs-aria-controls", l), f.attr({
                        "aria-controls": i.substring(1),
                        "aria-labelledby": a
                    }), o.attr("aria-labelledby", a)
                }), this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role", "tabpanel")
            },
            _getList: function() {
                return this.element.find("ol,ul").eq(0)
            },
            _createPanel: function(t) {
                return e("<div>").attr("id", t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy", !0)
            },
            _setupDisabled: function(t) {
                e.isArray(t) && (t.length ? t.length === this.anchors.length && (t = !0) : t = !1);
                for (var n = 0, r; r = this.tabs[n]; n++) t === !0 || e.inArray(n, t) !== -1 ? e(r).addClass("ui-state-disabled").attr("aria-disabled", "true") : e(r).removeClass("ui-state-disabled").removeAttr("aria-disabled");
                this.options.disabled = t
            },
            _setupEvents: function(t) {
                var n = {
                    click: function(e) {
                        e.preventDefault()
                    }
                };
                t && e.each(t.split(" "), function(e, t) {
                    n[t] = "_eventHandler"
                }), this._off(this.anchors.add(this.tabs).add(this.panels)), this._on(this.anchors, n), this._on(this.tabs, {
                    keydown: "_tabKeydown"
                }), this._on(this.panels, {
                    keydown: "_panelKeydown"
                }), this._focusable(this.tabs), this._hoverable(this.tabs)
            },
            _setupHeightStyle: function(t) {
                var n, r = this.element.parent();
                t === "fill" ? (n = r.height(), n -= this.element.outerHeight() - this.element.height(), this.element.siblings(":visible").each(function() {
                    var t = e(this),
                        r = t.css("position");
                    if (r === "absolute" || r === "fixed") return;
                    n -= t.outerHeight(!0)
                }), this.element.children().not(this.panels).each(function() {
                    n -= e(this).outerHeight(!0)
                }), this.panels.each(function() {
                    e(this).height(Math.max(0, n - e(this).innerHeight() + e(this).height()))
                }).css("overflow", "auto")) : t === "auto" && (n = 0, this.panels.each(function() {
                    n = Math.max(n, e(this).height("").height())
                }).height(n))
            },
            _eventHandler: function(t) {
                var n = this.options,
                    r = this.active,
                    i = e(t.currentTarget),
                    s = i.closest("li"),
                    o = s[0] === r[0],
                    u = o && n.collapsible,
                    a = u ? e() : this._getPanelForTab(s),
                    f = r.length ? this._getPanelForTab(r) : e(),
                    l = {
                        oldTab: r,
                        oldPanel: f,
                        newTab: u ? e() : s,
                        newPanel: a
                    };
                t.preventDefault();
                if (s.hasClass("ui-state-disabled") || s.hasClass("ui-tabs-loading") || this.running || o && !n.collapsible || this._trigger("beforeActivate", t, l) === !1) return;
                n.active = u ? !1 : this.tabs.index(s), this.active = o ? e() : s, this.xhr && this.xhr.abort(), !f.length && !a.length && e.error("jQuery UI Tabs: Mismatching fragment identifier."), a.length && this.load(this.tabs.index(s), t), this._toggle(t, l)
            },
            _toggle: function(t, n) {
                function o() {
                    r.running = !1, r._trigger("activate", t, n)
                }

                function u() {
                    n.newTab.closest("li").addClass("ui-tabs-active ui-state-active"), i.length && r.options.show ? r._show(i, r.options.show, o) : (i.show(), o())
                }
                var r = this,
                    i = n.newPanel,
                    s = n.oldPanel;
                this.running = !0, s.length && this.options.hide ? this._hide(s, this.options.hide, function() {
                    n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"), u()
                }) : (n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"), s.hide(), u()), s.attr({
                    "aria-expanded": "false",
                    "aria-hidden": "true"
                }), n.oldTab.attr("aria-selected", "false"), i.length && s.length ? n.oldTab.attr("tabIndex", -1) : i.length && this.tabs.filter(function() {
                    return e(this).attr("tabIndex") === 0
                }).attr("tabIndex", -1), i.attr({
                    "aria-expanded": "true",
                    "aria-hidden": "false"
                }), n.newTab.attr({
                    "aria-selected": "true",
                    tabIndex: 0
                })
            },
            _activate: function(t) {
                var n, r = this._findActive(t);
                if (r[0] === this.active[0]) return;
                r.length || (r = this.active), n = r.find(".ui-tabs-anchor")[0], this._eventHandler({
                    target: n,
                    currentTarget: n,
                    preventDefault: e.noop
                })
            },
            _findActive: function(t) {
                return t === !1 ? e() : this.tabs.eq(t)
            },
            _getIndex: function(e) {
                return typeof e == "string" && (e = this.anchors.index(this.anchors.filter("[href$='" + e + "']"))), e
            },
            _destroy: function() {
                this.xhr && this.xhr.abort(), this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"), this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"), this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(), this.tabs.add(this.panels).each(function() {
                    e.data(this, "ui-tabs-destroy") ? e(this).remove() : e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")
                }), this.tabs.each(function() {
                    var t = e(this),
                        n = t.data("ui-tabs-aria-controls");
                    n ? t.attr("aria-controls", n).removeData("ui-tabs-aria-controls") : t.removeAttr("aria-controls")
                }), this.panels.show(), this.options.heightStyle !== "content" && this.panels.css("height", "")
            },
            enable: function(n) {
                var r = this.options.disabled;
                if (r === !1) return;
                n === t ? r = !1 : (n = this._getIndex(n), e.isArray(r) ? r = e.map(r, function(e) {
                    return e !== n ? e : null
                }) : r = e.map(this.tabs, function(e, t) {
                    return t !== n ? t : null
                })), this._setupDisabled(r)
            },
            disable: function(n) {
                var r = this.options.disabled;
                if (r === !0) return;
                if (n === t) r = !0;
                else {
                    n = this._getIndex(n);
                    if (e.inArray(n, r) !== -1) return;
                    e.isArray(r) ? r = e.merge([n], r).sort() : r = [n]
                }
                this._setupDisabled(r)
            },
            load: function(t, n) {
                t = this._getIndex(t);
                var r = this,
                    i = this.tabs.eq(t),
                    o = i.find(".ui-tabs-anchor"),
                    u = this._getPanelForTab(i),
                    a = {
                        tab: i,
                        panel: u
                    };
                if (s(o[0])) return;
                this.xhr = e.ajax(this._ajaxSettings(o, n, a)), this.xhr && this.xhr.statusText !== "canceled" && (i.addClass("ui-tabs-loading"), u.attr("aria-busy", "true"), this.xhr.success(function(e) {
                    setTimeout(function() {
                        u.html(e), r._trigger("load", n, a)
                    }, 1)
                }).complete(function(e, t) {
                    setTimeout(function() {
                        t === "abort" && r.panels.stop(!1, !0), i.removeClass("ui-tabs-loading"), u.removeAttr("aria-busy"), e === r.xhr && delete r.xhr
                    }, 1)
                }))
            },
            _ajaxSettings: function(t, n, r) {
                var i = this;
                return {
                    url: t.attr("href"),
                    beforeSend: function(t, s) {
                        return i._trigger("beforeLoad", n, e.extend({
                            jqXHR: t,
                            ajaxSettings: s
                        }, r))
                    }
                }
            },
            _getPanelForTab: function(t) {
                var n = e(t).attr("aria-controls");
                return this.element.find(this._sanitizeSelector("#" + n))
            }
        })
    }(jQuery),
    function(e) {
        function n(t, n) {
            var r = (t.attr("aria-describedby") || "").split(/\s+/);
            r.push(n), t.data("ui-tooltip-id", n).attr("aria-describedby", e.trim(r.join(" ")))
        }

        function r(t) {
            var n = t.data("ui-tooltip-id"),
                r = (t.attr("aria-describedby") || "").split(/\s+/),
                i = e.inArray(n, r);
            i !== -1 && r.splice(i, 1), t.removeData("ui-tooltip-id"), r = e.trim(r.join(" ")), r ? t.attr("aria-describedby", r) : t.removeAttr("aria-describedby")
        }
        var t = 0;
        e.widget("ui.tooltip", {
            version: "1.10.0",
            options: {
                content: function() {
                    var t = e(this).attr("title") || "";
                    return e("<a>").text(t).html()
                },
                hide: !0,
                items: "[title]:not([disabled])",
                position: {
                    my: "left top+15",
                    at: "left bottom",
                    collision: "flipfit flip"
                },
                show: !0,
                tooltipClass: null,
                track: !1,
                close: null,
                open: null
            },
            _create: function() {
                this._on({
                    mouseover: "open",
                    focusin: "open"
                }), this.tooltips = {}, this.parents = {}, this.options.disabled && this._disable()
            },
            _setOption: function(t, n) {
                var r = this;
                if (t === "disabled") {
                    this[n ? "_disable" : "_enable"](), this.options[t] = n;
                    return
                }
                this._super(t, n), t === "content" && e.each(this.tooltips, function(e, t) {
                    r._updateContent(t)
                })
            },
            _disable: function() {
                var t = this;
                e.each(this.tooltips, function(n, r) {
                    var i = e.Event("blur");
                    i.target = i.currentTarget = r[0], t.close(i, !0)
                }), this.element.find(this.options.items).addBack().each(function() {
                    var t = e(this);
                    t.is("[title]") && t.data("ui-tooltip-title", t.attr("title")).attr("title", "")
                })
            },
            _enable: function() {
                this.element.find(this.options.items).addBack().each(function() {
                    var t = e(this);
                    t.data("ui-tooltip-title") && t.attr("title", t.data("ui-tooltip-title"))
                })
            },
            open: function(t) {
                var n = this,
                    r = e(t ? t.target : this.element).closest(this.options.items);
                if (!r.length || r.data("ui-tooltip-id")) return;
                r.attr("title") && r.data("ui-tooltip-title", r.attr("title")), r.data("ui-tooltip-open", !0), t && t.type === "mouseover" && r.parents().each(function() {
                    var t = e(this),
                        r;
                    t.data("ui-tooltip-open") && (r = e.Event("blur"), r.target = r.currentTarget = this, n.close(r, !0)), t.attr("title") && (t.uniqueId(), n.parents[this.id] = {
                        element: this,
                        title: t.attr("title")
                    }, t.attr("title", ""))
                }), this._updateContent(r, t)
            },
            _updateContent: function(e, t) {
                var n, r = this.options.content,
                    i = this,
                    s = t ? t.type : null;
                if (typeof r == "string") return this._open(t, e, r);
                n = r.call(e[0], function(n) {
                    if (!e.data("ui-tooltip-open")) return;
                    i._delay(function() {
                        t && (t.type = s), this._open(t, e, n)
                    })
                }), n && this._open(t, e, n)
            },
            _open: function(t, r, i) {
                function f(e) {
                    a.of = e;
                    if (s.is(":hidden")) return;
                    s.position(a)
                }
                var s, o, u, a = e.extend({}, this.options.position);
                if (!i) return;
                s = this._find(r);
                if (s.length) {
                    s.find(".ui-tooltip-content").html(i);
                    return
                }
                r.is("[title]") && (t && t.type === "mouseover" ? r.attr("title", "") : r.removeAttr("title")), s = this._tooltip(r), n(r, s.attr("id")), s.find(".ui-tooltip-content").html(i), this.options.track && t && /^mouse/.test(t.type) ? (this._on(this.document, {
                    mousemove: f
                }), f(t)) : s.position(e.extend({ of: r
                }, this.options.position)), s.hide(), this._show(s, this.options.show), this.options.show && this.options.show.delay && (u = this.delayedShow = setInterval(function() {
                    s.is(":visible") && (f(a.of), clearInterval(u))
                }, e.fx.interval)), this._trigger("open", t, {
                    tooltip: s
                }), o = {
                    keyup: function(t) {
                        if (t.keyCode === e.ui.keyCode.ESCAPE) {
                            var n = e.Event(t);
                            n.currentTarget = r[0], this.close(n, !0)
                        }
                    },
                    remove: function() {
                        this._removeTooltip(s)
                    }
                };
                if (!t || t.type === "mouseover") o.mouseleave = "close";
                if (!t || t.type === "focusin") o.focusout = "close";
                this._on(!0, r, o)
            },
            close: function(t) {
                var n = this,
                    i = e(t ? t.currentTarget : this.element),
                    s = this._find(i);
                if (this.closing) return;
                clearInterval(this.delayedShow), i.data("ui-tooltip-title") && i.attr("title", i.data("ui-tooltip-title")), r(i), s.stop(!0), this._hide(s, this.options.hide, function() {
                    n._removeTooltip(e(this))
                }), i.removeData("ui-tooltip-open"), this._off(i, "mouseleave focusout keyup"), i[0] !== this.element[0] && this._off(i, "remove"), this._off(this.document, "mousemove"), t && t.type === "mouseleave" && e.each(this.parents, function(t, r) {
                    e(r.element).attr("title", r.title), delete n.parents[t]
                }), this.closing = !0, this._trigger("close", t, {
                    tooltip: s
                }), this.closing = !1
            },
            _tooltip: function(n) {
                var r = "ui-tooltip-" + t++,
                    i = e("<div>").attr({
                        id: r,
                        role: "tooltip"
                    }).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content " + (this.options.tooltipClass || ""));
                return e("<div>").addClass("ui-tooltip-content").appendTo(i), i.appendTo(this.document[0].body), this.tooltips[r] = n, i
            },
            _find: function(t) {
                var n = t.data("ui-tooltip-id");
                return n ? e("#" + n) : e()
            },
            _removeTooltip: function(e) {
                e.remove(), delete this.tooltips[e.attr("id")]
            },
            _destroy: function() {
                var t = this;
                e.each(this.tooltips, function(n, r) {
                    var i = e.Event("blur");
                    i.target = i.currentTarget = r[0], t.close(i, !0), e("#" + n).remove(), r.data("ui-tooltip-title") && (r.attr("title", r.data("ui-tooltip-title")), r.removeData("ui-tooltip-title"))
                })
            }
        })
    }(jQuery);
/*!---- backtotop-----*/
/**
 * Copyright (c) 2007-2012 Ariel Flesler - aflesler(at)gmail(dot)com | http://flesler.blogspot.com
 * Dual licensed under MIT and GPL.
 * @author Ariel Flesler
 * @version 1.4.3.1
 */
;
(function($j) {
    var h = $j.scrollTo = function(a, b, c) {
        $j(window).scrollTo(a, b, c)
    };
    h.defaults = {
        axis: 'xy',
        duration: parseFloat($j.fn.jquery) >= 1.3 ? 0 : 1,
        limit: true
    };
    h.window = function(a) {
        return $j(window)._scrollable()
    };
    $j.fn._scrollable = function() {
        return this.map(function() {
            var a = this,
                isWin = !a.nodeName || $j.inArray(a.nodeName.toLowerCase(), ['iframe', '#document', 'html', 'body']) != -1;
            if (!isWin) return a;
            var b = (a.contentWindow || a).document || a.ownerDocument || a;
            return /webkit/i.test(navigator.userAgent) || b.compatMode == 'BackCompat' ? b.body : b.documentElement
        })
    };
    $j.fn.scrollTo = function(e, f, g) {
        if (typeof f == 'object') {
            g = f;
            f = 0
        }
        if (typeof g == 'function') g = {
            onAfter: g
        };
        if (e == 'max') e = 9e9;
        g = $j.extend({}, h.defaults, g);
        f = f || g.duration;
        g.queue = g.queue && g.axis.length > 1;
        if (g.queue) f /= 2;
        g.offset = both(g.offset);
        g.over = both(g.over);
        return this._scrollable().each(function() {
            if (e == null) return;
            var d = this,
                $elem = $j(d),
                targ = e,
                toff, attr = {},
                win = $elem.is('html,body');
            switch (typeof targ) {
                case 'number':
                case 'string':
                    if (/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(targ)) {
                        targ = both(targ);
                        break
                    }
                    targ = $j(targ, this);
                    if (!targ.length) return;
                case 'object':
                    if (targ.is || targ.style) toff = (targ = $j(targ)).offset()
            }
            $j.each(g.axis.split(''), function(i, a) {
                var b = a == 'x' ? 'Left' : 'Top',
                    pos = b.toLowerCase(),
                    key = 'scroll' + b,
                    old = d[key],
                    max = h.max(d, a);
                if (toff) {
                    attr[key] = toff[pos] + (win ? 0 : old - $elem.offset()[pos]);
                    if (g.margin) {
                        attr[key] -= parseInt(targ.css('margin' + b)) || 0;
                        attr[key] -= parseInt(targ.css('border' + b + 'Width')) || 0
                    }
                    attr[key] += g.offset[pos] || 0;
                    if (g.over[pos]) attr[key] += targ[a == 'x' ? 'width' : 'height']() * g.over[pos]
                } else {
                    var c = targ[pos];
                    attr[key] = c.slice && c.slice(-1) == '%' ? parseFloat(c) / 100 * max : c
                }
                if (g.limit && /^\d+$/.test(attr[key])) attr[key] = attr[key] <= 0 ? 0 : Math.min(attr[key], max);
                if (!i && g.queue) {
                    if (old != attr[key]) animate(g.onAfterFirst);
                    delete attr[key]
                }
            });
            animate(g.onAfter);

            function animate(a) {
                $elem.animate(attr, f, g.easing, a && function() {
                    a.call(this, e, g)
                })
            }
        }).end()
    };
    h.max = function(a, b) {
        var c = b == 'x' ? 'Width' : 'Height',
            scroll = 'scroll' + c;
        if (!$j(a).is('html,body')) return a[scroll] - $j(a)[c.toLowerCase()]();
        var d = 'client' + c,
            html = a.ownerDocument.documentElement,
            body = a.ownerDocument.body;
        return Math.max(html[scroll], body[scroll]) - Math.min(html[d], body[d])
    };

    function both(a) {
        return typeof a == 'object' ? a : {
            top: a,
            left: a
        }
    }
})($j);

$j.fn.topLink = function(settings) {
    settings = jQuery.extend({
        min: 1,
        fadeSpeed: 200,
        ieOffset: 50
    }, settings);
    return this.each(function() {
        //listen for scroll
        var el = $j(this);
        el.css('display', 'none'); //in case the user forgot
        $j(window).scroll(function() {
            //console.log($j(window).scrollTop());
            if ($j(window).scrollTop() > 0) {
                el.fadeIn(settings.fadeSpeed);
            } else {
                el.fadeOut(settings.fadeSpeed);

            }


        });
    });
};

$j(document).ready(function() {


    $j(".fw-footer-outer").append('<a href="#MainForm" id="auto-top-link"><span class="fa fa-angle-right"><strong>Back to Top</strong></span></a>');
    $j('#auto-top-link').topLink({
        min: 400,
        fadeSpeed: 500
    });

    //smoothscroll
    $j('#auto-top-link').click(function(e) {
        e.preventDefault();
        //   $j.scrollTo(0, 300);

        if (!($j('body').hasClass('ip3-edit'))) {
            $j('html, body').animate({
                scrollTop: 0
            }, 500);
        }

    });

});
/*!---- podcast-player-----*/
(function(f) {
    if (typeof exports === "object" && typeof module !== "undefined") {
        module.exports = f()
    } else if (typeof define === "function" && define.amd) {
        define([], f)
    } else {
        var g;
        if (typeof window !== "undefined") {
            g = window
        } else if (typeof global !== "undefined") {
            g = global
        } else if (typeof self !== "undefined") {
            g = self
        } else {
            g = this
        }
        g.GreenAudioPlayer = f()
    }
})(function() {
    var define, module, exports;
    return (function() {
        function r(e, n, t) {
            function o(i, f) {
                if (!n[i]) {
                    if (!e[i]) {
                        var c = "function" == typeof require && require;
                        if (!f && c) return c(i, !0);
                        if (u) return u(i, !0);
                        var a = new Error("Cannot find module '" + i + "'");
                        throw a.code = "MODULE_NOT_FOUND", a
                    }
                    var p = n[i] = {
                        exports: {}
                    };
                    e[i][0].call(p.exports, function(r) {
                        var n = e[i][1][r];
                        return o(n || r)
                    }, p, p.exports, r, e, n, t)
                }
                return n[i].exports
            }
            for (var u = "function" == typeof require && require, i = 0; i < t.length; i++) o(t[i]);
            return o
        }
        return r
    })()({
        1: [function(require, module, exports) {
            "use strict";

            module.exports = require('/javascripts/podcast-player-main').default;

        }, {
            "/javascripts/podcast-player-main": 2
        }],
        2: [function(require, module, exports) {
            "use strict";

            Object.defineProperty(exports, "__esModule", {
                value: true
            });
            exports.default = void 0;

            function _slicedToArray(arr, i) {
                return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();
            }

            function _nonIterableRest() {
                throw new TypeError("Invalid attempt to destructure non-iterable instance");
            }

            function _iterableToArrayLimit(arr, i) {
                if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) {
                    return;
                }
                var _arr = [];
                var _n = true;
                var _d = false;
                var _e = undefined;
                try {
                    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
                        _arr.push(_s.value);
                        if (i && _arr.length === i) break;
                    }
                } catch (err) {
                    _d = true;
                    _e = err;
                } finally {
                    try {
                        if (!_n && _i["return"] != null) _i["return"]();
                    } finally {
                        if (_d) throw _e;
                    }
                }
                return _arr;
            }

            function _arrayWithHoles(arr) {
                if (Array.isArray(arr)) return arr;
            }

            function _classCallCheck(instance, Constructor) {
                if (!(instance instanceof Constructor)) {
                    throw new TypeError("Cannot call a class as a function");
                }
            }

            function _defineProperties(target, props) {
                for (var i = 0; i < props.length; i++) {
                    var descriptor = props[i];
                    descriptor.enumerable = descriptor.enumerable || false;
                    descriptor.configurable = true;
                    if ("value" in descriptor) descriptor.writable = true;
                    Object.defineProperty(target, descriptor.key, descriptor);
                }
            }

            function _createClass(Constructor, protoProps, staticProps) {
                if (protoProps) _defineProperties(Constructor.prototype, protoProps);
                if (staticProps) _defineProperties(Constructor, staticProps);
                return Constructor;
            }

            var GreenAudioPlayer = /*#__PURE__*/ function() {
                function GreenAudioPlayer(player, options) {
                    _classCallCheck(this, GreenAudioPlayer);

                    this.audioPlayer = typeof player === 'string' ? document.querySelector(player) : player;
                    var opts = options || {};
                    var audioElement = this.audioPlayer.innerHTML;
                    this.audioPlayer.classList.add('green-audio-player');
                    this.audioPlayer.innerHTML = GreenAudioPlayer.getTemplate() + audioElement;
                    this.isDevice = /ipad|iphone|ipod|android/i.test(window.navigator.userAgent.toLowerCase()) && !window.MSStream;
                    this.playPauseBtn = this.audioPlayer.querySelector('.play-pause-btn');
                    this.loading = this.audioPlayer.querySelector('.loading');
                    this.sliders = this.audioPlayer.querySelectorAll('.slider');
                    this.progress = this.audioPlayer.querySelector('.controls__progress');
                    this.volumeBtn = this.audioPlayer.querySelector('.volume__button');
                    this.volumeControls = this.audioPlayer.querySelector('.volume__controls');
                    this.volumeProgress = this.volumeControls.querySelector('.volume__progress');
                    this.player = this.audioPlayer.querySelector('audio');
                    this.currentTime = this.audioPlayer.querySelector('.controls__current-time');
                    this.totalTime = this.audioPlayer.querySelector('.controls__total-time');
                    this.speaker = this.audioPlayer.querySelector('.volume__speaker');
                    this.download = this.audioPlayer.querySelector('.download');
                    this.downloadLink = this.audioPlayer.querySelector('.download__link');
                    this.span = this.audioPlayer.querySelectorAll('.message__offscreen');
                    this.svg = this.audioPlayer.getElementsByTagName('svg');
                    this.img = this.audioPlayer.getElementsByTagName('img');
                    this.draggableClasses = ['pin'];
                    this.currentlyDragged = null;
                    this.stopOthersOnPlay = opts.stopOthersOnPlay || false;
                    this.enableKeystrokes = opts.enableKeystrokes || false;
                    this.showTooltips = opts.showTooltips || false;
                    var self = this;
                    this.labels = {
                        volume: {
                            open: 'Open Volume Controls',
                            close: 'Close Volume Controls'
                        },
                        pause: 'Pause',
                        play: 'Play',
                        download: 'Download'
                    };

                    if (!this.enableKeystrokes) {
                        for (var i = 0; i < this.span.length; i++) {
                            this.span[i].outerHTML = '';
                        }
                    } else {
                        window.addEventListener('keydown', this.pressKb.bind(self), false);
                        window.addEventListener('keyup', this.unPressKb.bind(self), false);
                        this.sliders[0].setAttribute('tabindex', 0);
                        this.sliders[1].setAttribute('tabindex', 0);
                        this.download.setAttribute('tabindex', -1);
                        this.downloadLink.setAttribute('tabindex', -1);

                        for (var j = 0; j < this.svg.length; j++) {
                            this.svg[j].setAttribute('tabindex', 0);
                            this.svg[j].setAttribute('focusable', true);
                        }

                        for (var k = 0; k < this.img.length; k++) {
                            this.img[k].setAttribute('tabindex', 0);
                        }
                    }

                    if (this.showTooltips) {
                        this.playPauseBtn.setAttribute('title', this.labels.play);
                        this.volumeBtn.setAttribute('title', this.labels.volume.open);
                        this.downloadLink.setAttribute('title', this.labels.download);
                    }

                    if (opts.outlineControls || false) {
                        this.audioPlayer.classList.add('player-accessible');
                    }

                    if (opts.showDownloadButton || false) {
                        this.showDownload();
                    }

                    this.initEvents();
                    this.directionAware();
                    this.overcomeIosLimitations();

                    if ('autoplay' in this.player.attributes) {
                        var promise = this.player.play();

                        if (promise !== undefined) {
                            promise.then(function() {
                                var playPauseButton = self.player.parentElement.querySelector('.play-pause-btn__icon');
                                playPauseButton.attributes.d.value = 'M0 0h6v24H0zM12 0h6v24h-6z';
                                self.playPauseBtn.setAttribute('aria-label', self.labels.pause);
                                self.hasSetAttribute(self.playPauseBtn, 'title', self.labels.pause);
                            }).catch(function() {
                                // eslint-disable-next-line no-console
                                console.error('Green Audio Player Error: Autoplay has been prevented, because it is not allowed by this browser.');
                            });
                        }
                    }

                    if ('preload' in this.player.attributes && this.player.attributes.preload.value === 'none') {
                        this.playPauseBtn.style.visibility = 'visible';
                        this.loading.style.visibility = 'hidden';
                    }
                }

                _createClass(GreenAudioPlayer, [{
                    key: "initEvents",
                    value: function initEvents() {
                        var self = this;
                        self.audioPlayer.addEventListener('mousedown', function(event) {
                            if (self.isDraggable(event.target)) {
                                self.currentlyDragged = event.target;
                                var handleMethod = self.currentlyDragged.dataset.method;
                                var listener = self[handleMethod].bind(self);
                                window.addEventListener('mousemove', listener, false);

                                if (self.currentlyDragged.parentElement.parentElement === self.sliders[0]) {
                                    self.paused = self.player.paused;
                                    if (self.paused === false) self.togglePlay();
                                }

                                window.addEventListener('mouseup', function() {
                                    if (self.currentlyDragged !== false && self.currentlyDragged.parentElement.parentElement === self.sliders[0] && self.paused !== self.player.paused) {
                                        self.togglePlay();
                                    }

                                    self.currentlyDragged = false;
                                    window.removeEventListener('mousemove', listener, false);
                                }, false);
                            }
                        }); // for mobile touches

                        self.audioPlayer.addEventListener('touchstart', function(event) {
                            if (self.isDraggable(event.target)) {
                                var _event$targetTouches = _slicedToArray(event.targetTouches, 1);

                                self.currentlyDragged = _event$targetTouches[0];
                                var handleMethod = self.currentlyDragged.target.dataset.method;
                                var listener = self[handleMethod].bind(self);
                                window.addEventListener('touchmove', listener, false);

                                if (self.currentlyDragged.parentElement.parentElement === self.sliders[0]) {
                                    self.paused = self.player.paused;
                                    if (self.paused === false) self.togglePlay();
                                }

                                window.addEventListener('touchend', function() {
                                    if (self.currentlyDragged !== false && self.currentlyDragged.parentElement.parentElement === self.sliders[0] && self.paused !== self.player.paused) {
                                        self.togglePlay();
                                    }

                                    self.currentlyDragged = false;
                                    window.removeEventListener('touchmove', listener, false);
                                }, false);
                                event.preventDefault();
                            }
                        });
                        this.playPauseBtn.addEventListener('click', this.togglePlay.bind(self));
                        this.player.addEventListener('timeupdate', this.updateProgress.bind(self));
                        this.player.addEventListener('volumechange', this.updateVolume.bind(self));
                        this.player.volume = 0.81;
                        this.player.addEventListener('loadedmetadata', function() {
                            self.totalTime.textContent = GreenAudioPlayer.formatTime(self.player.duration);
                        });
                        this.player.addEventListener('seeking', this.showLoadingIndicator.bind(self));
                        this.player.addEventListener('seeked', this.hideLoadingIndicator.bind(self));
                        this.player.addEventListener('canplay', this.hideLoadingIndicator.bind(self));
                        this.player.addEventListener('ended', function() {
                            GreenAudioPlayer.pausePlayer(self.player, 'ended');
                            self.player.currentTime = 0;
                            self.playPauseBtn.setAttribute('aria-label', self.labels.play);
                            self.hasSetAttribute(self.playPauseBtn, 'title', self.labels.play);
                        });
                        this.volumeBtn.addEventListener('click', this.showHideVolume.bind(self));
                        window.addEventListener('resize', self.directionAware.bind(self));
                        window.addEventListener('scroll', self.directionAware.bind(self));

                        for (var i = 0; i < this.sliders.length; i++) {
                            var pin = this.sliders[i].querySelector('.pin');
                            this.sliders[i].addEventListener('click', self[pin.dataset.method].bind(self));
                        }

                        this.downloadLink.addEventListener('click', this.downloadAudio.bind(self));
                    }
                }, {
                    key: "overcomeIosLimitations",
                    value: function overcomeIosLimitations() {
                        var self = this;

                        if (this.isDevice) {
                            // iOS does not support "canplay" event
                            this.player.addEventListener('loadedmetadata', this.hideLoadingIndicator.bind(self)); // iOS does not let "volume" property to be set programmatically

                            this.audioPlayer.querySelector('.volume').style.display = 'none';
                            this.audioPlayer.querySelector('.controls').style.marginRight = '0';
                        }
                    }
                }, {
                    key: "isDraggable",
                    value: function isDraggable(el) {
                        var canDrag = false;
                        if (typeof el.classList === 'undefined') return false; // fix for IE 11 not supporting classList on SVG elements

                        for (var i = 0; i < this.draggableClasses.length; i++) {
                            if (el.classList.contains(this.draggableClasses[i])) {
                                canDrag = true;
                            }
                        }

                        return canDrag;
                    }
                }, {
                    key: "inRange",
                    value: function inRange(event) {
                        var touch = 'touches' in event; // instanceof TouchEvent may also be used

                        var rangeBox = this.getRangeBox(event);
                        var sliderPositionAndDimensions = rangeBox.getBoundingClientRect();
                        var direction = rangeBox.dataset.direction;
                        var min = null;
                        var max = null;

                        if (direction === 'horizontal') {
                            min = sliderPositionAndDimensions.x;
                            max = min + sliderPositionAndDimensions.width;
                            var clientX = touch ? event.touches[0].clientX : event.clientX;
                            if (clientX < min || clientX > max) return false;
                        } else {
                            min = sliderPositionAndDimensions.top;
                            max = min + sliderPositionAndDimensions.height;
                            var clientY = touch ? event.touches[0].clientY : event.clientY;
                            if (clientY < min || clientY > max) return false;
                        }

                        return true;
                    }
                }, {
                    key: "updateProgress",
                    value: function updateProgress() {
                        var current = this.player.currentTime;
                        var percent = current / this.player.duration * 100;
                        this.progress.setAttribute('aria-valuenow', percent);
                        this.progress.style.width = "".concat(percent, "%");
                        this.currentTime.textContent = GreenAudioPlayer.formatTime(current);
                    }
                }, {
                    key: "updateVolume",
                    value: function updateVolume() {
                        this.volumeProgress.setAttribute('aria-valuenow', this.player.volume * 100);
                        this.volumeProgress.style.height = "".concat(this.player.volume * 100, "%");

                        if (this.player.volume >= 0.5) {
                            this.speaker.attributes.d.value = 'M19.64 5.23a1 1 0 1 0-1.28 1.54A6.8 6.8 0 0 1 21 12a6.8 6.8 0 0 1-2.64 5.23 1 1 0 0 0-.13 1.41A1 1 0 0 0 19 19a1 1 0 0 0 .64-.23A8.75 8.75 0 0 0 23 12a8.75 8.75 0 0 0-3.36-6.77zM15 3.12a1 1 0 0 0-1 0L7.52 7.57h-5a1 1 0 0 0-1 1v6.86a1 1 0 0 0 1 1h5l6.41 4.4a1.06 1.06 0 0 0 .57.17 1 1 0 0 0 1-1V4a1 1 0 0 0-.5-.88zm-1.47 15L8.4 14.6a1 1 0 0 0-.57-.17H3.5V9.57h4.33a1 1 0 0 0 .57-.17l5.1-3.5z M18.28 8.37a1 1 0 1 0-1.56 1.26 4 4 0 0 1 0 4.74A1 1 0 0 0 17.5 16a1 1 0 0 0 .78-.37 6 6 0 0 0 0-7.26z';
                        } else if (this.player.volume < 0.5 && this.player.volume > 0.05) {
                            this.speaker.attributes.d.value = 'm 17 18 z M 15 3.12 a 1 1 0 0 0 -1 0 L 7.52 7.57 h -5 a 1 1 0 0 0 -1 1 v 6.86 a 1 1 0 0 0 1 1 h 5 l 6.41 4.4 a 1.06 1.06 0 0 0 0.57 0.17 a 1 1 0 0 0 1 -1 V 4 a 1 1 0 0 0 -0.5 -0.88 z m -1.47 15 L 8.4 14.6 a 1 1 0 0 0 -0.57 -0.17 H 3.5 V 9.57 h 4.33 a 1 1 0 0 0 0.57 -0.17 l 5.1 -3.5 z M 18.28 8.37 a 1 1 0 1 0 -1.56 1.26 a 4 4 0 0 1 0 4.74 A 1 1 0 0 0 17.5 16 a 1 1 0 0 0 0.78 -0.37 a 6 6 0 0 0 0 -7.26 z';
                        } else if (this.player.volume <= 0.05) {
                            this.speaker.attributes.d.value = 'm 17 18 z M 15 3.12 a 1 1 0 0 0 -1 0 L 7.52 7.57 h -5 a 1 1 0 0 0 -1 1 v 6.86 a 1 1 0 0 0 1 1 h 5 l 6.41 4.4 a 1.06 1.06 0 0 0 0.57 0.17 a 1 1 0 0 0 1 -1 V 4 a 1 1 0 0 0 -0.5 -0.88 z m -1.47 15 L 8.4 14.6 a 1 1 0 0 0 -0.57 -0.17 H 3.5 V 9.57 h 4.33 a 1 1 0 0 0 0.57 -0.17 l 5.1 -3.5 z z';
                        }
                    }
                }, {
                    key: "getRangeBox",
                    value: function getRangeBox(event) {
                        var rangeBox = event.target;
                        var el = this.currentlyDragged;

                        if (event.type === 'click' && this.isDraggable(event.target)) {
                            rangeBox = event.target.parentElement.parentElement;
                        }

                        if (event.type === 'mousemove') {
                            rangeBox = el.parentElement.parentElement;
                        }

                        if (event.type === 'touchmove') {
                            rangeBox = el.target.parentElement.parentElement;
                        }

                        return rangeBox;
                    }
                }, {
                    key: "getCoefficient",
                    value: function getCoefficient(event) {
                        var touch = 'touches' in event; // instanceof TouchEvent may also be used

                        var slider = this.getRangeBox(event);
                        var sliderPositionAndDimensions = slider.getBoundingClientRect();
                        var K = 0;

                        if (slider.dataset.direction === 'horizontal') {
                            // if event is touch
                            var clientX = touch ? event.touches[0].clientX : event.clientX;
                            var offsetX = clientX - sliderPositionAndDimensions.left;
                            var width = sliderPositionAndDimensions.width;
                            K = offsetX / width;
                        } else if (slider.dataset.direction === 'vertical') {
                            var height = sliderPositionAndDimensions.height;
                            var clientY = touch ? event.touches[0].clientY : event.clientY;
                            var offsetY = clientY - sliderPositionAndDimensions.top;
                            K = 1 - offsetY / height;
                        }

                        return K;
                    }
                }, {
                    key: "rewind",
                    value: function rewind(event) {
                        if (this.player.seekable && this.player.seekable.length) {
                            // no seek if not (pre)loaded
                            if (this.inRange(event)) {
                                this.player.currentTime = this.player.duration * this.getCoefficient(event);
                            }
                        }
                    }
                }, {
                    key: "showVolume",
                    value: function showVolume() {
                        if (this.volumeBtn.getAttribute('aria-attribute') === this.labels.volume.open) {
                            this.volumeControls.classList.remove('hidden');
                            this.volumeBtn.classList.add('open');
                            this.volumeBtn.setAttribute('aria-label', this.labels.volume.close);
                            this.hasSetAttribute(this.volumeBtn, 'title', this.labels.volume.close);
                        }
                    }
                }, {
                    key: "showHideVolume",
                    value: function showHideVolume() {
                        this.volumeControls.classList.toggle('hidden');

                        if (this.volumeBtn.getAttribute('aria-label') === this.labels.volume.open) {
                            this.volumeBtn.setAttribute('aria-label', this.labels.volume.close);
                            this.hasSetAttribute(this.volumeBtn, 'title', this.labels.volume.close);
                            this.volumeBtn.classList.add('open');
                        } else {
                            this.volumeBtn.setAttribute('aria-label', this.labels.volume.open);
                            this.hasSetAttribute(this.volumeBtn, 'title', this.labels.volume.open);
                            this.volumeBtn.classList.remove('open');
                        }
                    }
                }, {
                    key: "changeVolume",
                    value: function changeVolume(event) {
                        if (this.inRange(event)) {
                            this.player.volume = Math.round(this.getCoefficient(event) * 50) / 50;
                        }
                    }
                }, {
                    key: "preloadNone",
                    value: function preloadNone() {
                        var self = this;

                        if (!this.player.duration) {
                            self.playPauseBtn.style.visibility = 'hidden';
                            self.loading.style.visibility = 'visible';
                        }
                    }
                }, {
                    key: "togglePlay",
                    value: function togglePlay() {
                        this.preloadNone();

                        if (this.player.paused) {
                            if (this.stopOthersOnPlay) {
                                GreenAudioPlayer.stopOtherPlayers();
                            }

                            GreenAudioPlayer.playPlayer(this.player);
                            this.playPauseBtn.setAttribute('aria-label', this.labels.pause);
                            this.hasSetAttribute(this.playPauseBtn, 'title', this.labels.pause);
                        } else {
                            GreenAudioPlayer.pausePlayer(this.player, 'toggle');
                            this.playPauseBtn.setAttribute('aria-label', this.labels.play);
                            this.hasSetAttribute(this.playPauseBtn, 'title', this.labels.play);
                        }
                    }
                }, {
                    key: "hasSetAttribute",
                    value: function hasSetAttribute(el, a, v) {
                        if (this.showTooltips) {
                            if (el.hasAttribute(a)) {
                                el.setAttribute(a, v);
                            }
                        }
                    }
                }, {
                    key: "setCurrentTime",
                    value: function setCurrentTime(time) {
                        var pos = this.player.currentTime;
                        var end = Math.floor(this.player.duration);

                        if (pos + time < 0 && pos === 0) {
                            this.player.currentTime = this.player.currentTime;
                        } else if (pos + time < 0) {
                            this.player.currentTime = 0;
                        } else if (pos + time > end) {
                            this.player.currentTime = end;
                        } else {
                            this.player.currentTime += time;
                        }
                    }
                }, {
                    key: "setVolume",
                    value: function setVolume(volume) {
                        if (this.isDevice) return;
                        var vol = this.player.volume;

                        if (vol + volume >= 0 && vol + volume < 1) {
                            this.player.volume += volume;
                        } else if (vol + volume <= 0) {
                            this.player.volume = 0;
                        } else {
                            this.player.volume = 1;
                        }
                    }
                }, {
                    key: "unPressKb",
                    value: function unPressKb(event) {
                        var evt = event || window.event;

                        if (this.seeking && (evt.keyCode === 37 || evt.keyCode === 39)) {
                            this.togglePlay();
                            this.seeking = false;
                        }
                    }
                }, {
                    key: "pressKb",
                    value: function pressKb(event) {
                        var evt = event || window.event;

                        switch (evt.keyCode) {
                            case 13: // Enter

                            case 32:
                                // Spacebar
                                if (document.activeElement.parentNode === this.playPauseBtn) {
                                    this.togglePlay();
                                } else if (document.activeElement.parentNode === this.volumeBtn || document.activeElement === this.sliders[1]) {
                                    if (document.activeElement === this.sliders[1]) {
                                        try {
                                            // IE 11 not supporting programmatic focus on svg elements
                                            this.volumeBtn.children[0].focus();
                                        } catch (error) {
                                            this.volumeBtn.focus();
                                        }
                                    }

                                    this.showHideVolume();
                                }

                                if (evt.keyCode === 13 && this.showDownload && document.activeElement.parentNode === this.downloadLink) {
                                    this.downloadLink.focus();
                                }

                                break;

                            case 37:
                            case 39:
                                // horizontal Arrows
                                if (document.activeElement === this.sliders[0]) {
                                    if (evt.keyCode === 37) {
                                        this.setCurrentTime(-5);
                                    } else {
                                        this.setCurrentTime(+5);
                                    }

                                    if (!this.player.paused && this.player.seeking) {
                                        this.togglePlay();
                                        this.seeking = true;
                                    }
                                }

                                break;

                            case 38:
                            case 40:
                                // vertical Arrows
                                if (document.activeElement.parentNode === this.volumeBtn || document.activeElement === this.sliders[1]) {
                                    if (evt.keyCode === 38) {
                                        this.setVolume(0.05);
                                    } else {
                                        this.setVolume(-0.05);
                                    }
                                }

                                if (document.activeElement.parentNode === this.volumeBtn) {
                                    this.showVolume();
                                }

                                break;

                            default:
                                break;
                        }
                    }
                }, {
                    key: "showLoadingIndicator",
                    value: function showLoadingIndicator() {
                        this.playPauseBtn.style.visibility = 'hidden';
                        this.loading.style.visibility = 'visible';
                    }
                }, {
                    key: "hideLoadingIndicator",
                    value: function hideLoadingIndicator() {
                        this.playPauseBtn.style.visibility = 'visible';
                        this.loading.style.visibility = 'hidden';
                    }
                }, {
                    key: "showDownload",
                    value: function showDownload() {
                        this.download.style.display = 'block';
                    }
                }, {
                    key: "downloadAudio",
                    value: function downloadAudio() {
                        var src = this.player.currentSrc;
                        var name = src.split('/').reverse()[0];
                        this.downloadLink.setAttribute('href', src);
                        this.downloadLink.setAttribute('download', name);
                    }
                }, {
                    key: "directionAware",
                    value: function directionAware() {
                        this.volumeControls.classList.remove('top', 'middle', 'bottom');

                        if (window.innerHeight < 250) {
                            this.volumeControls.classList.add('middle');
                        } else if (this.audioPlayer.getBoundingClientRect().top < 180) {
                            this.volumeControls.classList.add('bottom');
                        } else {
                            this.volumeControls.classList.add('top');
                        }
                    }
                }], [{
                    key: "init",
                    value: function init(options) {
                        var players = document.querySelectorAll(options.selector);
                        players.forEach(function(player) {
                            /* eslint-disable no-new */
                            new GreenAudioPlayer(player, options);
                        });
                    }
                }, {
                    key: "getTemplate",
                    value: function getTemplate() {
                        return "\n            <div class=\"holder\">\n                <div class=\"loading\">\n                    <div class=\"loading__spinner\"></div>\n                </div>\n\n                <div class=\"play-pause-btn\" aria-label=\"Play\" role=\"button\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"24\" viewBox=\"0 0 18 24\">\n                        <path fill=\"none\" stroke=\"#fff\" stroke-width=\"2\" d=\"m1 1 14 9-14 9z\" class=\"play-pause-btn__icon\"/>\n                    </svg>\n                </div>\n            </div>\n\n            <div class=\"controls\">\n                               <div class=\"controls__slider slider\" data-direction=\"horizontal\">\n                    <div class=\"controls__progress gap-progress\" aria-label=\"Time Slider\" aria-valuemin=\"0\" aria-valuemax=\"100\" aria-valuenow=\"0\" role=\"slider\">\n                        <div class=\"pin progress__pin\" data-method=\"rewind\"></div>\n                    </div>\n                </div>\n    <span class=\"controls__current-time\" aria-live=\"off\" role=\"timer\">00:00</span>\n    <span>&nbsp; &#47; &nbsp;</span>\n         <span class=\"controls__total-time\">00:00</span>\n            </div>\n\n            <div class=\"volume\">\n                <div class=\"volume__button\" aria-label=\"Open Volume Controls\" role=\"button\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                        <path class=\"volume__speaker\" fill=\"#ffffff\" fill-rule=\"evenodd\" d=\"M14.667 0v2.747c3.853 1.146 6.666 4.72 6.666 8.946 0 4.227-2.813 7.787-6.666 8.934v2.76C20 22.173 24 17.4 24 11.693 24 5.987 20 1.213 14.667 0zM18 11.693c0-2.36-1.333-4.386-3.333-5.373v10.707c2-.947 3.333-2.987 3.333-5.334zm-18-4v8h5.333L12 22.36V1.027L5.333 7.693H0z\"/>\n                    </svg>\n                    <span class=\"message__offscreen\">Press Enter or Space to show volume slider.</span>\n                </div>\n                <div class=\"volume__controls hidden\">\n                    <div class=\"volume__slider slider\" data-direction=\"vertical\">\n                        <div class=\"volume__progress gap-progress\" aria-label=\"Volume Slider\" aria-valuemin=\"0\" aria-valuemax=\"100\" aria-valuenow=\"81\" role=\"slider\">\n                            <div class=\"pin volume__pin\" data-method=\"changeVolume\"></div>\n                        </div>\n                        <span class=\"message__offscreen\">Use Up/Down Arrow keys to increase or decrease volume.</span>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"download\">\n                <a class=\"download__link\" href=\"\" download=\"\" aria-label=\"Download\" role=\"button\">\n                    <svg width=\"24\" height=\"24\" fill=\"#ffffff\" enable-background=\"new 0 0 29.978 29.978\" version=\"1.1\" viewBox=\"0 0 29.978 29.978\" xml:space=\"preserve\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path d=\"m25.462 19.105v6.848h-20.947v-6.848h-4.026v8.861c0 1.111 0.9 2.012 2.016 2.012h24.967c1.115 0 2.016-0.9 2.016-2.012v-8.861h-4.026z\"/>\n                        <path d=\"m14.62 18.426l-5.764-6.965s-0.877-0.828 0.074-0.828 3.248 0 3.248 0 0-0.557 0-1.416v-8.723s-0.129-0.494 0.615-0.494h4.572c0.536 0 0.524 0.416 0.524 0.416v8.742 1.266s1.842 0 2.998 0c1.154 0 0.285 0.867 0.285 0.867s-4.904 6.51-5.588 7.193c-0.492 0.495-0.964-0.058-0.964-0.058z\"/>\n                    </svg>\n                </a>\n            </div>\n        ";
                    }
                }, {
                    key: "formatTime",
                    value: function formatTime(time) {
                        var min = Math.floor(time / 60);
                        var sec = Math.floor(time % 60);
                        return "".concat(min < 10 ? "0".concat(min) : min, ":").concat(sec < 10 ? "0".concat(sec) : sec);
                    }
                }, {
                    key: "pausePlayer",
                    value: function pausePlayer(player) {
                        var playPauseButton = player.parentElement.querySelector('.play-pause-btn__icon');
                        playPauseButton.attributes.d.value = 'm1 1 14 9-14 9z';
                        player.pause();
                    }
                }, {
                    key: "playPlayer",
                    value: function playPlayer(player) {
                        var playPauseButton = player.parentElement.querySelector('.play-pause-btn__icon');
                        playPauseButton.attributes.d.value = 'M0 0h6v24H0zM12 0h6v24h-6z';
                        player.play();
                    }
                }, {
                    key: "stopOtherPlayers",
                    value: function stopOtherPlayers() {
                        var players = document.querySelectorAll('.green-audio-player audio');

                        for (var i = 0; i < players.length; i++) {
                            GreenAudioPlayer.pausePlayer(players[i]);
                        }
                    }
                }]);

                return GreenAudioPlayer;
            }();

            var _default = GreenAudioPlayer;
            exports.default = _default;

        }, {}]
    }, {}, [1])(1)
});


document.addEventListener('DOMContentLoaded', function() {
    new GreenAudioPlayer('.ready-player-1', {
        showTooltips: true,
        showDownloadButton: false,
        enableKeystrokes: true
    });
});
/*!---- share-tag-icon-----*/
/*--- Share Tag Starts ---*/


/*----------- Search & apply sticky link ------------*/

$j(document).ready(function() {
    $j('.sticky-link-v1').addClass('fixed');
    //tabsOnReady();
});

$j(window).scroll(function() {
    if (($j(window).scrollTop() + $j(window).innerHeight()) > $j('footer').offset().top) {
        $j('.sticky-link-v1').removeClass('fixed');
    } else {
        $j('.sticky-link-v1').addClass('fixed');
    }
});
$j('.share-icons').hide();
$j(document).on('click', '.share-tag a', function(e) {
    if (!$j(this).parents('.share-wrapper').hasClass('active')) {
        $j(this).parents('.share-wrapper').addClass('active');
        $j('.share-icons').slideDown(500);
    } else {
        $j(this).parents('.share-wrapper').removeClass('active');
        $j('.share-icons').slideUp(500);
    }
});
/*--- Share Tag Ends ---*/
/*!---- country-snapdown-----*/
$j(document).ready(function() {
    /*------------------ Snapdown Starts -------------------*/
    ///*
    $j(".country-snapdown-content").hide();

    $j(document).on('click', ".country-snapdown-title-container", function() {
        if ($j(this).hasClass("country-snapopen")) {
            $j(this).removeClass("country-snapopen");
            $j(this).children(".country-snapdown-right").css("background-image", "url('/~/media/Images/R/Rolls-Royce/css/plus-icon.png')");
            $j(this).siblings(".country-snapdown-item .country-snapdown-content").slideUp();
        } else {

            $j(this).parent().parent().find(".country-snapdown-title-container.country-snapopen").next(".country-snapdown-content").slideUp();
            $j(this).parent().parent().find(".country-snapdown-title-container.country-snapopen").children(".country-snapdown-right").css("background-image", "url('/~/media/Images/R/Rolls-Royce/css/plus-icon.png')");
            $j(this).parent().parent().find(".country-snapdown-title-container.country-snapopen").removeClass("country-snapopen");
            $j(this).addClass("country-snapopen");
            $j(this).children(".country-snapdown-right").css("background-image", "url('/~/media/Images/R/Rolls-Royce/css/minus-icon.png')");
            $j(this).siblings(".country-snapdown-content").slideDown();
            var thisSnap = $j(this);
            setTimeout(function() {
                $j("html,body").animate({
                    scrollTop: thisSnap.offset().top
                }, "slow");
            }, 700);
        }
        //*/
    });

    $j(document).on('click', "#alphabet-all", function() {
        $j(".country-snapdown-container .alphabet-filter-content .country-snapdown-item .country-snapdown-content").slideUp();
        $j(".country-snapdown-container .alphabet-filter-content .country-snapdown-item .country-snapdown-title-container").children(".country-snapdown-right").css("background-image", "url('/~/media/Images/R/Rolls-Royce/css/plus-icon.png')");
    });



    /*------------------ Snapdown Ends -------------------*/


    $j('#alphabet-category .alphabet-filter').each(function() {
        if (!$j(this).hasClass('all-filter')) {
            var chk_html = $j.trim($j('.alphabet-content #' + $j(this).attr('id') + '-content').html());
            //alert(chk_html);
            if (chk_html) {
                $j(this).addClass('haschildren');
            }
        }
    });


    // $j('#alphabet-category .alphabet-filter.haschildren').last().addClass('selected');
    $j('.alphabet-content #' + $j('#alphabet-category .alphabet-filter.haschildren').last().attr('id') + '-content').show();

    $j('.alphabet-filter.haschildren').on('click', function(e) {
        e.preventDefault();
        $j('.alphabet-filter.haschildren').removeClass('selected');
        $j(this).addClass('selected');
        $j(".country-snapdown-container .alphabet-filter-content .country-snapdown-item .country-snapdown-content").slideUp();
        $j(".country-snapdown-container .alphabet-filter-content .country-snapdown-item .country-snapdown-title-container").children(".country-snapdown-right").css("background-image", "url('/~/media/Images/R/Rolls-Royce/css/plus-icon.png')");
        if ($j(this).hasClass('all-filter')) {
            $j('.alphabet-filter-content').show();

        } else {
            $j('.alphabet-filter-content').hide();
            $j('.alphabet-content #' + $j(this).attr('id') + '-content').show();
        }

    });

});
/*!---- Japan-translation-----*/
$j(window).load(function() {
    setTimeout(function() {
        if ($j('body').hasClass('ip3-korea') || $j('body').attr('id') == 'korea') {
            $j('body#korea #headerlinks > ul > li > a > span').text($j('body#korea #headerlinks > ul > li > ul li:nth-child(8) a').text());

            if ($j('body#korea #headerlinks > ul > li > ul li:nth-child(8) a').text() == 'Korea') {
                $j('body#korea #headerlinks > ul > li > ul li:nth-child(8)').addClass('hide invisible');
            }

            $j('body.ip3-korea #headerlinks > ul > li > a > span').text($j('body.ip3-korea #headerlinks > ul > li > ul li:nth-child(8) a').text());

            if ($j('body.ip3-korea #headerlinks > ul > li > ul li:nth-child(8) a').text() == 'Korea') {
                $j('body.ip3-korea #headerlinks > ul > li > ul li:nth-child(8)').addClass('hide invisible');
            }

            $j('body#korea #headerlinksmobi > ul > li > a > span').text($j('body#korea #headerlinksmobi > ul > li > ul li:nth-child(8) a').text());

            if ($j('body#korea #headerlinksmobi > ul > li > ul li:nth-child(8) a').text() == 'Korea') {
                $j('body#korea #headerlinksmobi > ul > li > ul li:nth-child(8)').addClass('hide invisible');
            }

            $j('body.ip3-korea #headerlinksmobi > ul > li > a > span').text($j('body.ip3-korea #headerlinksmobi > ul > li > ul li:nth-child(8) a').text());

            if ($j('body.ip3-korea #headerlinksmobi > ul > li > ul li:nth-child(8) a').text() == 'Korea') {
                $j('body.ip3-korea #headerlinksmobi > ul > li > ul li:nth-child(8)').addClass('hide invisible');
            }


            $j('body.ip3-korea .fw-downloads-sld a.fw-dwld-link span').text('');
            $j('body.ip3-korea .fw-downloads-sld a.fw-dwld-link').css('display', 'block');



            $j('.category-filter li a').each(function() {
                if ($j(this).text() == "Defence Aerospace") {
                    $j(this).text(' ');
                }
                if ($j(this).text() == "Civil Aerospace") {
                    $j(this).text(' ');
                }
                if ($j(this).text() == "Nuclear") {
                    $j(this).text('Nuclear');
                }
                if ($j(this).text() == "Marine") {
                    $j(this).text('Marine');
                }
                if ($j(this).text() == "Power Systems") {
                    $j(this).text(' ');
                }
                if ($j(this).text() == "Investors") {
                    $j(this).text('Investors');
                }
                if ($j(this).text() == "Sustainability") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Careers") {
                    $j(this).text('Careers');
                }
                /*New addition of categories*/

                if ($j(this).text() == "Defence") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Electrification") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Electrical generator set") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Shipboard electrical power generator") {
                    $j(this).text(' ');
                }
                if ($j(this).text() == "Marine propulsion engine") {
                    $j(this).text('  ');
                }
                if ($j(this).text() == "Electrical") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Electrical power") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Electrical distribution") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Innovation") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Engines") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Gas Turbines") {
                    $j(this).text('');
                }
                if ($j(this).text() == "MT30") {
                    $j(this).text('MT30');
                }
                if ($j(this).text() == "Naval handling") {
                    $j(this).text('  ');
                }
                if ($j(this).text() == "Mission Bay Handling System") {
                    $j(this).text('   ');
                }
                if ($j(this).text() == "Winches") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Automation") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Mechanical propulsion") {
                    $j(this).text(' ');
                }
                if ($j(this).text() == "Hybrid propulsion") {
                    $j(this).text(' ');
                }
                if ($j(this).text() == "Electric propulsion") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Energy management") {
                    $j(this).text(' ');
                }
                if ($j(this).text() == "Controllable pitch propellers") {
                    $j(this).text('  ');
                }
                if ($j(this).text() == "Fixed pitch propellers") {
                    $j(this).text('  ');
                }
                if ($j(this).text() == "Propellers") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Naval") {
                    $j(this).text('');
                }
                if ($j(this).text() == "MTU") {
                    $j(this).text('MTU');
                }
                if ($j(this).text() == "Global") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Asia Pacific") {
                    $j(this).text(' ');
                }
                if ($j(this).text() == "South Korea") {
                    $j(this).text('');
                }

            });

            $j('.type-filter li a').each(function() {
                if ($j(this).text() == "Insights") {
                    $j(this).text('');
                }
                if ($j(this).text() == "News") {
                    $j(this).text('');
                }
            });

            $j('.differpagination .hsp-main .hsp-section-name').each(function() {
                if ($j(this).text() == "Insights") {
                    $j(this).text('');
                }
                if ($j(this).text() == "News") {
                    $j(this).text('');
                }
            });
            $j('#_cookieConsentWrapper span.cWrapInner').first().text('          .       .');
            $j('#_cookieConsentWrapper span.cWrapInner.cWrapInnerLast a').text('  ');
            $j('#_cookieConsentWrapper span.cWrapInner.cWrapInnerLast #cookie-agree').val('');


            $j('.insights-after-select-total').find('.open-mobi-selected-tags').text(' ');
            $j('.insights-after-select-total').find('.clearALLfilter').text(' ');

            $j('ul.mm-list li.mm-subtitle').find('a.mm-subclose').text('');

            $j('.insights-filter-wrap').find('.filter-close').text('Close');
            if ($j('.mobi-Filter-Done').find('a').text() == "") {
                $j('.mobi-Filter-Done').find('a').text('');
            }
            if ($j('.mobi-Filter-Done').find('a').text() == "Done") {
                $j('.mobi-Filter-Done').find('a').text('');
            }


            var mMenumatch = 'home';
            $j(".landingItem a:contains(" + mMenumatch + ")").each(function() {
                var mMenuhome = $j(this);
                mMenuhome.html(function() {
                    return mMenuhome.html().replace(mMenumatch, "");
                });
            });


        }
        if ($j('body').hasClass('ip3-sea') || $j('body').attr('id') == 'sea') {
            $j('body#sea #headerlinks > ul > li > a > span').text($j('body#sea #headerlinks > ul > li > ul li:nth-child(5) a').text());
            $j('body.ip3-sea #headerlinks > ul > li > a > span').text($j('body.ip3-sea #headerlinks > ul > li > ul li:nth-child(5) a').text());
            if ($j('body#sea #headerlinks > ul > li > ul li:nth-child(5) a').text() == 'South East Asia') {
                $j('body#sea #headerlinks > ul > li > ul li:nth-child(5)').addClass('hide invisible');
            }
            $j('body#sea #headerlinksmobi > ul > li > a > span').text($j('body#sea #headerlinksmobi > ul > li > ul li:nth-child(5) a').text());
            $j('body.ip3-sea #headerlinksmobi > ul > li > a > span').text($j('body.ip3-sea #headerlinksmobi > ul > li > ul li:nth-child(5) a').text());
            if ($j('body#sea #headerlinksmobi > ul > li > ul li:nth-child(5) a').text() == 'South East Asia') {
                $j('body#sea #headerlinksmobi > ul > li > ul li:nth-child(5)').addClass('hide invisible');
            }
            if ($j('body.ip3-sea #headerlinks > ul > li > ul li:nth-child(5) a').text() == 'South East Asia') {
                $j('body.ip3-sea #headerlinks > ul > li > ul li:nth-child(5)').addClass('hide invisible');
            }
            if ($j('body.ip3-sea #headerlinksmobi > ul > li > ul li:nth-child(5) a').text() == 'South East Asia') {
                $j('body.ip3-sea #headerlinksmobi > ul > li > ul li:nth-child(5)').addClass('hide invisible');
            }
        }


        if ($j('body').hasClass('ip3-india') || $j('body').attr('id') == 'india') {
            $j('body#india #headerlinks > ul > li > a > span').text($j('body#india #headerlinks > ul > li > ul li:nth-child(7) a').text());
            $j('body.ip3-india #headerlinks > ul > li > a > span').text($j('body.ip3-india #headerlinks > ul > li > ul li:nth-child(7) a').text());
            if ($j('body#india #headerlinks > ul > li > ul li:nth-child(7) a').text() == 'India') {
                $j('body#india #headerlinks > ul > li > ul li:nth-child(7)').addClass('hide invisible');
            }
            $j('body#india #headerlinksmobi > ul > li > a > span').text($j('body#india #headerlinksmobi > ul > li > ul li:nth-child(7) a').text());
            $j('body.ip3-india #headerlinksmobi > ul > li > a > span').text($j('body.ip3-india #headerlinksmobi > ul > li > ul li:nth-child(7) a').text());
            if ($j('body#india #headerlinksmobi > ul > li > ul li:nth-child(7) a').text() == 'India') {
                $j('body#india #headerlinksmobi > ul > li > ul li:nth-child(7)').addClass('hide invisible');
            }
            if ($j('body.ip3-india #headerlinks > ul > li > ul li:nth-child(7) a').text() == 'India') {
                $j('body.ip3-india #headerlinks > ul > li > ul li:nth-child(7)').addClass('hide invisible');
            }
            if ($j('body.ip3-india #headerlinksmobi > ul > li > ul li:nth-child(7) a').text() == 'India') {
                $j('body.ip3-india #headerlinksmobi > ul > li > ul li:nth-child(7)').addClass('hide invisible');
            }
        }


        if ($j('body').hasClass('ip3-northamerica') || $j('body').attr('id') == 'northamerica') {
            $j('body#northamerica #headerlinks > ul > li > a > span').text($j('body#northamerica #headerlinks > ul > li > ul li:nth-child(4) a').text());
            $j('body.ip3-northamerica #headerlinks > ul > li > a > span').text($j('body.ip3-northamerica #headerlinks > ul > li > ul li:nth-child(4) a').text());
            if ($j('body#northamerica #headerlinks > ul > li > ul li:nth-child(4) a').text() == 'North America') {
                $j('body#northamerica #headerlinks > ul > li > ul li:nth-child(4)').addClass('hide invisible');
            }
            $j('body#northamerica #headerlinksmobi > ul > li > a > span').text($j('body#northamerica #headerlinksmobi > ul > li > ul li:nth-child(4) a').text());
            $j('body.ip3-northamerica #headerlinksmobi > ul > li > a > span').text($j('body.ip3-northamerica #headerlinksmobi > ul > li > ul li:nth-child(4) a').text());
            if ($j('body#northamerica #headerlinksmobi > ul > li > ul li:nth-child(4) a').text() == 'North America') {
                $j('body#northamerica #headerlinksmobi > ul > li > ul li:nth-child(4)').addClass('hide invisible');
            }
            if ($j('body.ip3-northamerica #headerlinks > ul > li > ul li:nth-child(4) a').text() == 'North America') {
                $j('body.ip3-northamerica #headerlinks > ul > li > ul li:nth-child(4)').addClass('hide invisible');
            }
            if ($j('body.ip3-northamerica #headerlinksmobi > ul > li > ul li:nth-child(4) a').text() == 'North America') {
                $j('body.ip3-northamerica #headerlinksmobi > ul > li > ul li:nth-child(4)').addClass('hide invisible');
            }
        }

        if ($j('body').hasClass('ip3-hungary-en') || $j('body').attr('id') == 'hungary-en') {
            $j('body#hungary-en #headerlinks > ul > li > a > span').text($j('body#hungary-en #headerlinks > ul > li > ul li:nth-child(9) a').text());
            $j('body.ip3-hungary-en #headerlinks > ul > li > a > span').text($j('body.ip3-hungary-en #headerlinks > ul > li > ul li:nth-child(9) a').text());
            if ($j('body#hungary-en #headerlinks > ul > li > ul li:nth-child(9) a').text() == 'Hungary') {
                $j('body#hungary-en #headerlinks > ul > li > ul li:nth-child(9)').addClass('hide invisible');
            }
            $j('body#hungary-en #headerlinksmobi > ul > li > a > span').text($j('body#hungary-en #headerlinksmobi > ul > li > ul li:nth-child(9) a').text());
            $j('body.ip3-hungary-en #headerlinksmobi > ul > li > a > span').text($j('body.ip3-hungary-en #headerlinksmobi > ul > li > ul li:nth-child(9) a').text());
            if ($j('body#hungary-en #headerlinksmobi > ul > li > ul li:nth-child(9) a').text() == 'Hungary') {
                $j('body#hungary-en #headerlinksmobi > ul > li > ul li:nth-child(9)').addClass('hide invisible');
            }
            if ($j('body.ip3-hungary-en #headerlinks > ul > li > ul li:nth-child(9) a').text() == 'Hungary') {
                $j('body.ip3-hungary-en #headerlinks > ul > li > ul li:nth-child(9)').addClass('hide invisible');
            }
            if ($j('body.ip3-hungary-en #headerlinksmobi > ul > li > ul li:nth-child(9) a').text() == 'Hungary') {
                $j('body.ip3-hungary-en #headerlinksmobi > ul > li > ul li:nth-child(9)').addClass('hide invisible');
            }
        }

        if ($j('body').hasClass('ip3-hungary-hu') || $j('body').attr('id') == 'hungary-hu') {
            $j('body#hungary-hu #headerlinks > ul > li > a > span').text($j('body#hungary-hu #headerlinks > ul > li > ul li:nth-child(9) a').text());
            $j('body.ip3-hungary-hu #headerlinks > ul > li > a > span').text($j('body.ip3-hungary-hu #headerlinks > ul > li > ul li:nth-child(9) a').text());
            if ($j('body#hungary-hu #headerlinks > ul > li > ul li:nth-child(9) a').text() == 'Hungary') {
                $j('body#hungary-hu #headerlinks > ul > li > ul li:nth-child(9)').addClass('hide invisible');
            }
            $j('body#hungary-hu #headerlinksmobi > ul > li > a > span').text($j('body#hungary-hu #headerlinksmobi > ul > li > ul li:nth-child(9) a').text());
            $j('body.ip3-hungary-hu #headerlinksmobi > ul > li > a > span').text($j('body.ip3-hungary-hu #headerlinksmobi > ul > li > ul li:nth-child(9) a').text());
            if ($j('body#hungary-hu #headerlinksmobi > ul > li > ul li:nth-child(9) a').text() == 'Hungary') {
                $j('body#hungary-hu #headerlinksmobi > ul > li > ul li:nth-child(9)').addClass('hide invisible');
            }
            if ($j('body.ip3-hungary-hu #headerlinks > ul > li > ul li:nth-child(9) a').text() == 'Hungary') {
                $j('body.ip3-hungary-hu #headerlinks > ul > li > ul li:nth-child(9)').addClass('hide invisible');
            }
            if ($j('body.ip3-hungary-hu #headerlinksmobi > ul > li > ul li:nth-child(9) a').text() == 'Hungary') {
                $j('body.ip3-hungary-hu #headerlinksmobi > ul > li > ul li:nth-child(9)').addClass('hide invisible');
            }
        }


        if ($j('body').hasClass('ip3-uk') || $j('body').attr('id') == 'uk') {
            $j('body#uk #headerlinks > ul > li > a > span').text($j('body#uk #headerlinks > ul > li > ul li:nth-child(6) a').text());
            $j('body.ip3-uk #headerlinks > ul > li > a > span').text($j('body.ip3-uk #headerlinks > ul > li > ul li:nth-child(6) a').text());
            if ($j('body#uk #headerlinks > ul > li > ul li:nth-child(6) a').text() == 'United Kingdom') {
                $j('body#uk #headerlinks > ul > li > ul li:nth-child(6)').addClass('hide invisible');
            }
            $j('body#uk #headerlinksmobi > ul > li > a > span').text($j('body#uk #headerlinksmobi > ul > li > ul li:nth-child(6) a').text());
            $j('body.ip3-uk #headerlinksmobi > ul > li > a > span').text($j('body.ip3-uk #headerlinksmobi > ul > li > ul li:nth-child(6) a').text());
            if ($j('body#uk #headerlinksmobi > ul > li > ul li:nth-child(6) a').text() == 'United Kingdom') {
                $j('body#uk #headerlinksmobi > ul > li > ul li:nth-child(6)').addClass('hide invisible');
            }
            if ($j('body.ip3-uk #headerlinks > ul > li > ul li:nth-child(6) a').text() == 'United Kingdom') {
                $j('body.ip3-uk #headerlinks > ul > li > ul li:nth-child(6)').addClass('hide invisible');
            }
            if ($j('body.ip3-uk #headerlinksmobi > ul > li > ul li:nth-child(6) a').text() == 'United Kingdom') {
                $j('body.ip3-uk #headerlinksmobi > ul > li > ul li:nth-child(6)').addClass('hide invisible');
            }
        }



        if ($j('body').hasClass('ip3-japan') || $j('body').attr('id') == 'japan') {

            /* Replaced Global with Japan */

            $j('body#japan #headerlinks > ul > li > a > span').text($j('body#japan #headerlinks > ul > li > ul li:nth-child(2) a').text());

            if ($j('body#japan #headerlinks > ul > li > ul li:nth-child(2) a').text() == 'Japan') {
                $j('body#japan #headerlinks > ul > li > ul li:nth-child(2)').addClass('hide invisible');
            }

            $j('body.ip3-japan #headerlinks > ul > li > a > span').text($j('body.ip3-japan #headerlinks > ul > li > ul li:nth-child(2) a').text());

            if ($j('body.ip3-japan #headerlinks > ul > li > ul li:nth-child(2) a').text() == 'Japan') {
                $j('body.ip3-japan #headerlinks > ul > li > ul li:nth-child(2)').addClass('hide invisible');
            }

            $j('body#japan #headerlinksmobi > ul > li > a > span').text($j('body#japan #headerlinksmobi > ul > li > ul li:nth-child(2) a').text());

            if ($j('body#japan #headerlinksmobi > ul > li > ul li:nth-child(2) a').text() == 'Japan') {
                $j('body#japan #headerlinksmobi > ul > li > ul li:nth-child(2)').addClass('hide invisible');
            }

            $j('body.ip3-japan #headerlinksmobi > ul > li > a > span').text($j('body.ip3-japan #headerlinksmobi > ul > li > ul li:nth-child(2) a').text());

            if ($j('body.ip3-japan #headerlinksmobi > ul > li > ul li:nth-child(2) a').text() == 'Japan') {
                $j('body.ip3-japan #headerlinksmobi > ul > li > ul li:nth-child(2)').addClass('hide invisible');
            }

            /* Replaced Global with Japan */



            $j('.category-filter li a').each(function() {
                if ($j(this).text() == "Defence Aerospace") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Civil Aerospace") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Nuclear") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Marine") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Power Systems") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Investors") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Sustainability") {
                    $j(this).text('');
                }
                if ($j(this).text() == "Careers") {
                    $j(this).text('');
                }
            });

            $j('.type-filter li a').each(function() {
                if ($j(this).text() == "Insights") {
                    $j(this).text('');
                }
                if ($j(this).text() == "News") {
                    $j(this).text('');
                }
            });

            $j('.differpagination .hsp-main .hsp-section-name').each(function() {
                if ($j(this).text() == "Insights") {
                    $j(this).text('');
                }
                if ($j(this).text() == "News") {
                    $j(this).text('');
                }
            });
            $j('#_cookieConsentWrapper span.cWrapInner').first().text('(Cookie)');
            $j('#_cookieConsentWrapper span.cWrapInner.cWrapInnerLast a').text('');
            $j('#_cookieConsentWrapper span.cWrapInner.cWrapInnerLast #cookie-agree').val('');


            $j('.insights-after-select-total').find('.open-mobi-selected-tags').text('');
            $j('.insights-after-select-total').find('.clearALLfilter').text('');

            $j('ul.mm-list li.mm-subtitle').find('a.mm-subclose').text('');

            $j('.insights-filter-wrap').find('.filter-close').text('');
            if ($j('.mobi-Filter-Done').find('a').text() == "Apply") {
                $j('.mobi-Filter-Done').find('a').text('');
            }
            if ($j('.mobi-Filter-Done').find('a').text() == "Done") {
                $j('.mobi-Filter-Done').find('a').text('');
            }


            var mMenumatch = 'home';
            $j(".landingItem a:contains(" + mMenumatch + ")").each(function() {
                var mMenuhome = $j(this);
                mMenuhome.html(function() {
                    return mMenuhome.html().replace(mMenumatch, "");
                });
            });
        }
    }, 1000);
});
$j(document).ajaxComplete(function() {
    if ($j('body').hasClass('ip3-japan') || $j('body').attr('id') == 'japan') {
        $j('.differpagination .hsp-main .hsp-section-name').each(function() {
            if ($j(this).text() == "Insights") {
                $j(this).text('');
            }
            if ($j(this).text() == "News") {
                $j(this).text('');
            }
        });
        $j('.insights-after-select-total').find('.open-mobi-selected-tags').text('');
        $j('.insights-after-select-total').find('.clearALLfilter').text('');

        /*if($j('.mobi-Filter-Done').find('a').text() == "Apply"){
		$j('.mobi-Filter-Done').find('a').text('');
	  } 
	  if($j('.mobi-Filter-Done').find('a').text() == "Done"){
		$j('.mobi-Filter-Done').find('a').text('');
	  } */
    }

    if ($j('body').hasClass('ip3-korea') || $j('body').attr('id') == 'korea') {
        $j('.differpagination .hsp-main .hsp-section-name').each(function() {
            if ($j(this).text() == "Insights") {
                $j(this).text('');
            }
            if ($j(this).text() == "News") {
                $j(this).text('');
            }
        });
        $j('.insights-after-select-total').find('.open-mobi-selected-tags').text(' ');
        $j('.insights-after-select-total').find('.clearALLfilter').text(' ');

        /*if($j('.mobi-Filter-Done').find('a').text() == "Apply"){
		$j('.mobi-Filter-Done').find('a').text('Apply');
	  } 
	  if($j('.mobi-Filter-Done').find('a').text() == "Done"){
		$j('.mobi-Filter-Done').find('a').text('Done');
	  } */
    }
});

function checkLang() {
    if ($j('body').hasClass('ip3-japan') || $j('body').attr('id') == 'japan') {

        $j('.filter-mobi-panel-text').text('');
        //console.log('c');
        $j('.insights-mobi-filter-active .mobi-Filter-Done a').text('');
        $j('.insights-mobi-filter-active .mobi-Filter-Done a.apply').text('');
    }

    if ($j('body').hasClass('ip3-korea') || $j('body').attr('id') == 'ip3-korea') {

        $j('.filter-mobi-panel-text').text('');
        //console.log('c');
        $j('.insights-mobi-filter-active .mobi-Filter-Done a').text('');
        $j('.insights-mobi-filter-active .mobi-Filter-Done a.apply').text('');
    }
}
/*!---- bxslider-----*/
/**
 * BxSlider v4.1 - Fully loaded, responsive content slider
 * http://bxslider.com
 *
 * Copyright 2012, Steven Wanderski - http://stevenwanderski.com - http://bxcreative.com
 * Written while drinking Belgian ales and listening to jazz
 *
 * Released under the WTFPL license - http://sam.zoy.org/wtfpl/
 */

;
(function($j) {

    var plugin = {};

    var defaults = {

        // GENERAL
        mode: 'horizontal',
        slideSelector: '',
        infiniteLoop: true,
        hideControlOnEnd: false,
        speed: 500,
        easing: null,
        slideMargin: 0,
        startSlide: 0,
        randomStart: false,
        captions: false,
        ticker: false,
        tickerHover: false,
        adaptiveHeight: false,
        adaptiveHeightSpeed: 500,
        video: false,
        useCSS: true,
        preloadImages: 'visible',

        // TOUCH
        touchEnabled: true,
        swipeThreshold: 50,
        oneToOneTouch: true,
        preventDefaultSwipeX: true,
        preventDefaultSwipeY: false,

        // PAGER
        pager: true,
        pagerType: 'full',
        pagerShortSeparator: ' / ',
        pagerSelector: null,
        buildPager: null,
        pagerCustom: null,

        // CONTROLS
        controls: true,
        nextText: 'Next',
        prevText: 'Prev',
        nextSelector: null,
        prevSelector: null,
        autoControls: false,
        startText: 'Start',
        stopText: 'Stop',
        autoControlsCombine: false,
        autoControlsSelector: null,

        // AUTO
        auto: false,
        pause: 4000,
        autoStart: true,
        autoDirection: 'next',
        autoHover: false,
        autoDelay: 0,

        // CAROUSEL
        minSlides: 1,
        maxSlides: 1,
        moveSlides: 0,
        slideWidth: 0,

        // CALLBACKS
        onSliderLoad: function() {},
        onSlideBefore: function() {},
        onSlideAfter: function() {},
        onSlideNext: function() {},
        onSlidePrev: function() {}
    }

    $j.fn.bxSlider = function(options) {

        if (this.length == 0) return this;

        // support mutltiple elements
        if (this.length > 1) {
            this.each(function() {
                $j(this).bxSlider(options)
            });
            return this;
        }

        // create a namespace to be used throughout the plugin
        var slider = {};
        // set a reference to our slider element
        var el = this;
        plugin.el = this;

        /**
         * Makes slideshow responsive
         */
        // first get the original window dimens (thanks alot IE)
        var windowWidth = $j(window).width();
        var windowHeight = $j(window).height();



        /**
         * ===================================================================================
         * = PRIVATE FUNCTIONS
         * ===================================================================================
         */

        /**
         * Initializes namespace settings to be used throughout plugin
         */
        var init = function() {
            // merge user-supplied options with the defaults
            slider.settings = $j.extend({}, defaults, options);
            // parse slideWidth setting
            slider.settings.slideWidth = parseInt(slider.settings.slideWidth);
            // store the original children
            slider.children = el.children(slider.settings.slideSelector);
            // check if actual number of slides is less than minSlides / maxSlides
            if (slider.children.length < slider.settings.minSlides) slider.settings.minSlides = slider.children.length;
            if (slider.children.length < slider.settings.maxSlides) slider.settings.maxSlides = slider.children.length;
            // if random start, set the startSlide setting to random number
            if (slider.settings.randomStart) slider.settings.startSlide = Math.floor(Math.random() * slider.children.length);
            // store active slide information
            slider.active = {
                index: slider.settings.startSlide
            }
            // store if the slider is in carousel mode (displaying / moving multiple slides)
            slider.carousel = slider.settings.minSlides > 1 || slider.settings.maxSlides > 1;
            // if carousel, force preloadImages = 'all'
            if (slider.carousel) slider.settings.preloadImages = 'all';
            // calculate the min / max width thresholds based on min / max number of slides
            // used to setup and update carousel slides dimensions
            slider.minThreshold = (slider.settings.minSlides * slider.settings.slideWidth) + ((slider.settings.minSlides - 1) * slider.settings.slideMargin);
            slider.maxThreshold = (slider.settings.maxSlides * slider.settings.slideWidth) + ((slider.settings.maxSlides - 1) * slider.settings.slideMargin);
            // store the current state of the slider (if currently animating, working is true)
            slider.working = false;
            // initialize the controls object
            slider.controls = {};
            // initialize an auto interval
            slider.interval = null;
            // determine which property to use for transitions
            slider.animProp = slider.settings.mode == 'vertical' ? 'top' : 'left';
            // determine if hardware acceleration can be used
            slider.usingCSS = slider.settings.useCSS && slider.settings.mode != 'fade' && (function() {
                // create our test div element
                var div = document.createElement('div');
                // css transition properties
                var props = ['WebkitPerspective', 'MozPerspective', 'OPerspective', 'msPerspective'];
                // test for each property
                for (var i in props) {
                    if (div.style[props[i]] !== undefined) {
                        slider.cssPrefix = props[i].replace('Perspective', '').toLowerCase();
                        slider.animProp = '-' + slider.cssPrefix + '-transform';
                        return true;
                    }
                }
                return false;
            }());
            // if vertical mode always make maxSlides and minSlides equal
            if (slider.settings.mode == 'vertical') slider.settings.maxSlides = slider.settings.minSlides;
            // perform all DOM / CSS modifications
            setup();
        }

        /**
         * Performs all DOM and CSS modifications
         */
        var setup = function() {
            // wrap el in a wrapper
            el.wrap('<div class="bx-wrapper"><div class="bx-viewport"></div></div>');
            // store a namspace reference to .bx-viewport
            slider.viewport = el.parent();
            // add a loading div to display while images are loading
            slider.loader = $j('<div class="bx-loading" />');
            slider.viewport.prepend(slider.loader);
            // set el to a massive width, to hold any needed slides
            // also strip any margin and padding from el
            el.css({
                width: slider.settings.mode == 'horizontal' ? slider.children.length * 215 + '%' : 'auto',
                position: 'relative'
            });
            // if using CSS, add the easing property
            if (slider.usingCSS && slider.settings.easing) {
                el.css('-' + slider.cssPrefix + '-transition-timing-function', slider.settings.easing);
                // if not using CSS and no easing value was supplied, use the default JS animation easing (swing)
            } else if (!slider.settings.easing) {
                slider.settings.easing = 'swing';
            }
            var slidesShowing = getNumberSlidesShowing();
            // make modifications to the viewport (.bx-viewport)
            slider.viewport.css({
                width: '100%',
                overflow: 'hidden',
                position: 'relative'
            });
            slider.viewport.parent().css({
                maxWidth: getViewportMaxWidth()
            });
            // apply css to all slider children
            slider.children.css({
                'float': slider.settings.mode == 'horizontal' ? 'left' : 'none',
                listStyle: 'none',
                position: 'relative'
            });
            // apply the calculated width after the float is applied to prevent scrollbar interference
            slider.children.width(getSlideWidth());
            // if slideMargin is supplied, add the css
            if (slider.settings.mode == 'horizontal' && slider.settings.slideMargin > 0) slider.children.css('marginRight', slider.settings.slideMargin);
            if (slider.settings.mode == 'vertical' && slider.settings.slideMargin > 0) slider.children.css('marginBottom', slider.settings.slideMargin);
            // if "fade" mode, add positioning and z-index CSS
            if (slider.settings.mode == 'fade') {
                slider.children.css({
                    position: 'absolute',
                    zIndex: 0,
                    display: 'none'
                });
                // prepare the z-index on the showing element
                slider.children.eq(slider.settings.startSlide).css({
                    zIndex: 50,
                    display: 'block'
                });
            }
            // create an element to contain all slider controls (pager, start / stop, etc)
            slider.controls.el = $j('<div class="bx-controls" />');
            // if captions are requested, add them
            if (slider.settings.captions) appendCaptions();
            // if infinite loop, prepare additional slides
            if (slider.settings.infiniteLoop && slider.settings.mode != 'fade' && !slider.settings.ticker) {
                var slice = slider.settings.mode == 'vertical' ? slider.settings.minSlides : slider.settings.maxSlides;
                var sliceAppend = slider.children.slice(0, slice).clone().addClass('bx-clone');
                var slicePrepend = slider.children.slice(-slice).clone().addClass('bx-clone');
                el.append(sliceAppend).prepend(slicePrepend);
            }
            // check if startSlide is last slide
            slider.active.last = slider.settings.startSlide == getPagerQty() - 1;
            // if video is true, set up the fitVids plugin
            if (slider.settings.video) el.fitVids();
            // set the default preload selector (visible)
            var preloadSelector = slider.children.eq(slider.settings.startSlide);
            if (slider.settings.preloadImages == "all") preloadSelector = el.children();
            // only check for control addition if not in "ticker" mode
            if (!slider.settings.ticker) {
                // if pager is requested, add it
                if (slider.settings.pager) appendPager();
                // if controls are requested, add them
                if (slider.settings.controls) appendControls();
                // if auto is true, and auto controls are requested, add them
                if (slider.settings.auto && slider.settings.autoControls) appendControlsAuto();
                // if any control option is requested, add the controls wrapper
                if (slider.settings.controls || slider.settings.autoControls || slider.settings.pager) slider.viewport.after(slider.controls.el);
                // if ticker mode, do not allow a pager
            } else {
                slider.settings.pager = false;
            }
            // preload all images, then perform final DOM / CSS modifications that depend on images being loaded
            preloadSelector.imagesLoaded(start);
        }

        /**
         * Start the slider
         */
        var start = function() {
            // remove the loading DOM element
            slider.loader.remove();
            // set the left / top position of "el"
            setSlidePosition();
            // if "vertical" mode, always use adaptiveHeight to prevent odd behavior
            if (slider.settings.mode == 'vertical') slider.settings.adaptiveHeight = true;
            // set the viewport height
            slider.viewport.height(getViewportHeight());
            // make sure everything is positioned just right (same as a window resize)
            el.redrawSlider();
            // onSliderLoad callback
            slider.settings.onSliderLoad(slider.active.index);
            // slider has been fully initialized
            slider.initialized = true;
            // bind the resize call to the window
            $j(window).bind('resize', resizeWindow);
            // if auto is true, start the show
            if (slider.settings.auto && slider.settings.autoStart) initAuto();
            // if ticker is true, start the ticker
            if (slider.settings.ticker) initTicker();
            // if pager is requested, make the appropriate pager link active
            if (slider.settings.pager) updatePagerActive(slider.settings.startSlide);
            // check for any updates to the controls (like hideControlOnEnd updates)
            if (slider.settings.controls) updateDirectionControls();
            // if touchEnabled is true, setup the touch events
            if (slider.settings.touchEnabled && !slider.settings.ticker) initTouch();
        }

        /**
         * Returns the calculated height of the viewport, used to determine either adaptiveHeight or the maxHeight value
         */
        var getViewportHeight = function() {
            var height = 0;
            // first determine which children (slides) should be used in our height calculation
            var children = $j();
            // if mode is not "vertical" and adaptiveHeight is false, include all children
            if (slider.settings.mode != 'vertical' && !slider.settings.adaptiveHeight) {
                children = slider.children;
            } else {
                // if not carousel, return the single active child
                if (!slider.carousel) {
                    children = slider.children.eq(slider.active.index);
                    // if carousel, return a slice of children
                } else {
                    // get the individual slide index
                    var currentIndex = slider.settings.moveSlides == 1 ? slider.active.index : slider.active.index * getMoveBy();
                    // add the current slide to the children
                    children = slider.children.eq(currentIndex);
                    // cycle through the remaining "showing" slides
                    for (i = 1; i <= slider.settings.maxSlides - 1; i++) {
                        // if looped back to the start
                        if (currentIndex + i >= slider.children.length) {
                            children = children.add(slider.children.eq(i - 1));
                        } else {
                            children = children.add(slider.children.eq(currentIndex + i));
                        }
                    }
                }
            }
            // if "vertical" mode, calculate the sum of the heights of the children
            if (slider.settings.mode == 'vertical') {
                children.each(function(index) {
                    height += $j(this).outerHeight();
                });
                // add user-supplied margins
                if (slider.settings.slideMargin > 0) {
                    height += slider.settings.slideMargin * (slider.settings.minSlides - 1);
                }
                // if not "vertical" mode, calculate the max height of the children
            } else {
                height = Math.max.apply(Math, children.map(function() {
                    return $j(this).outerHeight(false);
                }).get());
            }
            return height;
        }

        /**
         * Returns the calculated width to be used for the outer wrapper / viewport
         */
        var getViewportMaxWidth = function() {
            var width = '100%';
            if (slider.settings.slideWidth > 0) {
                if (slider.settings.mode == 'horizontal') {
                    width = (slider.settings.maxSlides * slider.settings.slideWidth) + ((slider.settings.maxSlides - 1) * slider.settings.slideMargin);
                } else {
                    width = slider.settings.slideWidth;
                }
            }
            return width;
        }

        /**
         * Returns the calculated width to be applied to each slide
         */
        var getSlideWidth = function() {
            // start with any user-supplied slide width
            var newElWidth = slider.settings.slideWidth;
            // get the current viewport width
            var wrapWidth = slider.viewport.width();
            // if slide width was not supplied, or is larger than the viewport use the viewport width
            if (slider.settings.slideWidth == 0 ||
                (slider.settings.slideWidth > wrapWidth && !slider.carousel) ||
                slider.settings.mode == 'vertical') {
                newElWidth = wrapWidth;
                // if carousel, use the thresholds to determine the width
            } else if (slider.settings.maxSlides > 1 && slider.settings.mode == 'horizontal') {
                if (wrapWidth > slider.maxThreshold) {
                    // newElWidth = (wrapWidth - (slider.settings.slideMargin * (slider.settings.maxSlides - 1))) / slider.settings.maxSlides;
                } else if (wrapWidth < slider.minThreshold) {
                    newElWidth = (wrapWidth - (slider.settings.slideMargin * (slider.settings.minSlides - 1))) / slider.settings.minSlides;
                }
            }
            return newElWidth;
        }

        /**
         * Returns the number of slides currently visible in the viewport (includes partially visible slides)
         */
        var getNumberSlidesShowing = function() {
            var slidesShowing = 1;
            if (slider.settings.mode == 'horizontal' && slider.settings.slideWidth > 0) {
                // if viewport is smaller than minThreshold, return minSlides
                if (slider.viewport.width() < slider.minThreshold) {
                    slidesShowing = slider.settings.minSlides;
                    // if viewport is larger than minThreshold, return maxSlides
                } else if (slider.viewport.width() > slider.maxThreshold) {
                    slidesShowing = slider.settings.maxSlides;
                    // if viewport is between min / max thresholds, divide viewport width by first child width
                } else {
                    var childWidth = slider.children.first().width();
                    slidesShowing = Math.floor(slider.viewport.width() / childWidth);
                }
                // if "vertical" mode, slides showing will always be minSlides
            } else if (slider.settings.mode == 'vertical') {
                slidesShowing = slider.settings.minSlides;
            }
            return slidesShowing;
        }

        /**
         * Returns the number of pages (one full viewport of slides is one "page")
         */
        var getPagerQty = function() {
            var pagerQty = 0;
            // if moveSlides is specified by the user
            if (slider.settings.moveSlides > 0) {
                if (slider.settings.infiniteLoop) {
                    pagerQty = slider.children.length / getMoveBy();
                } else {
                    // use a while loop to determine pages
                    var breakPoint = 0;
                    var counter = 0
                    // when breakpoint goes above children length, counter is the number of pages
                    while (breakPoint < slider.children.length) {
                        ++pagerQty;
                        breakPoint = counter + getNumberSlidesShowing();
                        counter += slider.settings.moveSlides <= getNumberSlidesShowing() ? slider.settings.moveSlides : getNumberSlidesShowing();
                    }
                }
                // if moveSlides is 0 (auto) divide children length by sides showing, then round up
            } else {
                pagerQty = Math.ceil(slider.children.length / getNumberSlidesShowing());
            }
            return pagerQty;
        }

        /**
         * Returns the number of indivual slides by which to shift the slider
         */
        var getMoveBy = function() {
            // if moveSlides was set by the user and moveSlides is less than number of slides showing
            if (slider.settings.moveSlides > 0 && slider.settings.moveSlides <= getNumberSlidesShowing()) {
                return slider.settings.moveSlides;
            }
            // if moveSlides is 0 (auto)
            return getNumberSlidesShowing();
        }

        /**
         * Sets the slider's (el) left or top position
         */
        var setSlidePosition = function() {
            // if last slide, not infinite loop, and number of children is larger than specified maxSlides
            if (slider.children.length > slider.settings.maxSlides && slider.active.last && !slider.settings.infiniteLoop) {
                if (slider.settings.mode == 'horizontal') {
                    // get the last child's position
                    var lastChild = slider.children.last();
                    var position = lastChild.position();
                    // set the left position
                    setPositionProperty(-(position.left - (slider.viewport.width() - lastChild.width())), 'reset', 0);
                } else if (slider.settings.mode == 'vertical') {
                    // get the last showing index's position
                    var lastShowingIndex = slider.children.length - slider.settings.minSlides;
                    var position = slider.children.eq(lastShowingIndex).position();
                    // set the top position
                    setPositionProperty(-position.top, 'reset', 0);
                }
                // if not last slide
            } else {
                // get the position of the first showing slide
                var position = slider.children.eq(slider.active.index * getMoveBy()).position();
                // check for last slide
                if (slider.active.index == getPagerQty() - 1) slider.active.last = true;
                // set the repective position
                if (position != undefined) {
                    if (slider.settings.mode == 'horizontal') setPositionProperty(-position.left, 'reset', 0);
                    else if (slider.settings.mode == 'vertical') setPositionProperty(-position.top, 'reset', 0);
                }
            }
        }

        /**
         * Sets the el's animating property position (which in turn will sometimes animate el).
         * If using CSS, sets the transform property. If not using CSS, sets the top / left property.
         *
         * @param value (int) 
         *  - the animating property's value
         *
         * @param type (string) 'slider', 'reset', 'ticker'
         *  - the type of instance for which the function is being
         *
         * @param duration (int) 
         *  - the amount of time (in ms) the transition should occupy
         *
         * @param params (array) optional
         *  - an optional parameter containing any variables that need to be passed in
         */
        var setPositionProperty = function(value, type, duration, params) {
            // use CSS transform
            if (slider.usingCSS) {
                // determine the translate3d value
                var propValue = slider.settings.mode == 'vertical' ? 'translate3d(0, ' + value + 'px, 0)' : 'translate3d(' + value + 'px, 0, 0)';
                // add the CSS transition-duration
                el.css('-' + slider.cssPrefix + '-transition-duration', duration / 1000 + 's');
                if (type == 'slide') {
                    // set the property value
                    el.css(slider.animProp, propValue);
                    // bind a callback method - executes when CSS transition completes
                    el.bind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd', function() {
                        // unbind the callback
                        el.unbind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd');
                        updateAfterSlideTransition();
                    });
                } else if (type == 'reset') {
                    el.css(slider.animProp, propValue);
                } else if (type == 'ticker') {
                    // make the transition use 'linear'
                    el.css('-' + slider.cssPrefix + '-transition-timing-function', 'linear');
                    el.css(slider.animProp, propValue);
                    // bind a callback method - executes when CSS transition completes
                    el.bind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd', function() {
                        // unbind the callback
                        el.unbind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd');
                        // reset the position
                        setPositionProperty(params['resetValue'], 'reset', 0);
                        // start the loop again
                        tickerLoop();
                    });
                }
                // use JS animate
            } else {
                var animateObj = {};
                animateObj[slider.animProp] = value;
                if (type == 'slide') {
                    el.animate(animateObj, duration, slider.settings.easing, function() {
                        updateAfterSlideTransition();
                    });
                } else if (type == 'reset') {
                    el.css(slider.animProp, value)
                } else if (type == 'ticker') {
                    el.animate(animateObj, speed, 'linear', function() {
                        setPositionProperty(params['resetValue'], 'reset', 0);
                        // run the recursive loop after animation
                        tickerLoop();
                    });
                }
            }
        }

        /**
         * Populates the pager with proper amount of pages
         */
        var populatePager = function() {
            var pagerHtml = '';
            var pagerQty = getPagerQty();
            // loop through each pager item
            for (var i = 0; i < pagerQty; i++) {
                var linkContent = '';
                // if a buildPager function is supplied, use it to get pager link value, else use index + 1
                if (slider.settings.buildPager && $j.isFunction(slider.settings.buildPager)) {
                    linkContent = slider.settings.buildPager(i);
                    slider.pagerEl.addClass('bx-custom-pager');
                } else {
                    linkContent = i + 1;
                    slider.pagerEl.addClass('bx-default-pager');
                }
                // var linkContent = slider.settings.buildPager && $j.isFunction(slider.settings.buildPager) ? slider.settings.buildPager(i) : i + 1;
                // add the markup to the string
                pagerHtml += '<div class="bx-pager-item"><a href="" data-slide-index="' + i + '" class="bx-pager-link">' + linkContent + '</a></div>';
            };
            // populate the pager element with pager links
            slider.pagerEl.html(pagerHtml);
        }

        /**
         * Appends the pager to the controls element
         */
        var appendPager = function() {
            if (!slider.settings.pagerCustom) {
                // create the pager DOM element
                slider.pagerEl = $j('<div class="bx-pager" />');
                // if a pager selector was supplied, populate it with the pager
                if (slider.settings.pagerSelector) {
                    $j(slider.settings.pagerSelector).html(slider.pagerEl);
                    // if no pager selector was supplied, add it after the wrapper
                } else {
                    slider.controls.el.addClass('bx-has-pager').append(slider.pagerEl);
                }
                // populate the pager
                populatePager();
            } else {
                slider.pagerEl = $j(slider.settings.pagerCustom);
            }
            // assign the pager click binding
            slider.pagerEl.delegate('a', 'click', clickPagerBind);
        }

        /**
         * Appends prev / next controls to the controls element
         */
        var appendControls = function() {
            slider.controls.next = $j('<a class="bx-next" href="">' + slider.settings.nextText + '</a>');
            slider.controls.prev = $j('<a class="bx-prev" href="">' + slider.settings.prevText + '</a>');
            // bind click actions to the controls
            slider.controls.next.bind('click', clickNextBind);
            slider.controls.prev.bind('click', clickPrevBind);
            // if nextSlector was supplied, populate it
            if (slider.settings.nextSelector) {
                $j(slider.settings.nextSelector).append(slider.controls.next);
            }
            // if prevSlector was supplied, populate it
            if (slider.settings.prevSelector) {
                $j(slider.settings.prevSelector).append(slider.controls.prev);
            }
            // if no custom selectors were supplied
            if (!slider.settings.nextSelector && !slider.settings.prevSelector) {
                // add the controls to the DOM
                slider.controls.directionEl = $j('<div class="bx-controls-direction" />');
                // add the control elements to the directionEl
                slider.controls.directionEl.append(slider.controls.prev).append(slider.controls.next);
                // slider.viewport.append(slider.controls.directionEl);
                slider.controls.el.addClass('bx-has-controls-direction').append(slider.controls.directionEl);
            }
        }

        /**
         * Appends start / stop auto controls to the controls element
         */
        var appendControlsAuto = function() {
            slider.controls.start = $j('<div class="bx-controls-auto-item"><a class="bx-start" href="">' + slider.settings.startText + '</a></div>');
            slider.controls.stop = $j('<div class="bx-controls-auto-item"><a class="bx-stop" href="">' + slider.settings.stopText + '</a></div>');
            // add the controls to the DOM
            slider.controls.autoEl = $j('<div class="bx-controls-auto" />');
            // bind click actions to the controls
            slider.controls.autoEl.delegate('.bx-start', 'click', clickStartBind);
            slider.controls.autoEl.delegate('.bx-stop', 'click', clickStopBind);
            // if autoControlsCombine, insert only the "start" control
            if (slider.settings.autoControlsCombine) {
                slider.controls.autoEl.append(slider.controls.start);
                // if autoControlsCombine is false, insert both controls
            } else {
                slider.controls.autoEl.append(slider.controls.start).append(slider.controls.stop);
            }
            // if auto controls selector was supplied, populate it with the controls
            if (slider.settings.autoControlsSelector) {
                $j(slider.settings.autoControlsSelector).html(slider.controls.autoEl);
                // if auto controls selector was not supplied, add it after the wrapper
            } else {
                slider.controls.el.addClass('bx-has-controls-auto').append(slider.controls.autoEl);
            }
            // update the auto controls
            updateAutoControls(slider.settings.autoStart ? 'stop' : 'start');
        }

        /**
         * Appends image captions to the DOM
         */
        var appendCaptions = function() {
            // cycle through each child
            slider.children.each(function(index) {
                // get the image title attribute
                var title = $j(this).find('img:first').attr('title');
                // append the caption
                if (title != undefined) $j(this).append('<div class="bx-caption"><span>' + title + '</span></div>');
            });
        }

        /**
         * Click next binding
         *
         * @param e (event) 
         *  - DOM event object
         */
        var clickNextBind = function(e) {
            // if auto show is running, stop it
            if (slider.settings.auto) el.stopAuto();
            el.goToNextSlide();
            e.preventDefault();
        }

        /**
         * Click prev binding
         *
         * @param e (event) 
         *  - DOM event object
         */
        var clickPrevBind = function(e) {
            // if auto show is running, stop it
            if (slider.settings.auto) el.stopAuto();
            el.goToPrevSlide();
            e.preventDefault();
        }

        /**
         * Click start binding
         *
         * @param e (event) 
         *  - DOM event object
         */
        var clickStartBind = function(e) {
            el.startAuto();
            e.preventDefault();
        }

        /**
         * Click stop binding
         *
         * @param e (event) 
         *  - DOM event object
         */
        var clickStopBind = function(e) {
            el.stopAuto();
            e.preventDefault();
        }

        /**
         * Click pager binding
         *
         * @param e (event) 
         *  - DOM event object
         */
        var clickPagerBind = function(e) {
            // if auto show is running, stop it
            if (slider.settings.auto) el.stopAuto();
            var pagerLink = $j(e.currentTarget);
            var pagerIndex = parseInt(pagerLink.attr('data-slide-index'));
            // if clicked pager link is not active, continue with the goToSlide call
            if (pagerIndex != slider.active.index) el.goToSlide(pagerIndex);
            e.preventDefault();
        }

        /**
         * Updates the pager links with an active class
         *
         * @param slideIndex (int) 
         *  - index of slide to make active
         */
        var updatePagerActive = function(slideIndex) {
            // if "short" pager type
            if (slider.settings.pagerType == 'short') {
                slider.pagerEl.html((slideIndex + 1) + slider.settings.pagerShortSeparator + slider.children.length);
                return;
            }
            // remove all pager active classes
            slider.pagerEl.find('a').removeClass('active');
            // apply the active class for all pagers
            slider.pagerEl.each(function(i, el) {
                $j(el).find('a').eq(slideIndex).addClass('active');
            });
        }

        /**
         * Performs needed actions after a slide transition
         */
        var updateAfterSlideTransition = function() {
            // if infinte loop is true
            if (slider.settings.infiniteLoop) {
                var position = '';
                // first slide
                if (slider.active.index == 0) {
                    // set the new position
                    position = slider.children.eq(0).position();
                    // carousel, last slide
                } else if (slider.active.index == getPagerQty() - 1 && slider.carousel) {
                    position = slider.children.eq((getPagerQty() - 1) * getMoveBy()).position();
                    // last slide
                } else if (slider.active.index == slider.children.length - 1) {
                    position = slider.children.eq(slider.children.length - 1).position();
                }
                if (slider.settings.mode == 'horizontal') {
                    setPositionProperty(-position.left, 'reset', 0);;
                } else if (slider.settings.mode == 'vertical') {
                    setPositionProperty(-position.top, 'reset', 0);;
                }
            }
            // declare that the transition is complete
            slider.working = false;
            // onSlideAfter callback
            slider.settings.onSlideAfter(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index);
        }

        /**
         * Updates the auto controls state (either active, or combined switch)
         *
         * @param state (string) "start", "stop"
         *  - the new state of the auto show
         */
        var updateAutoControls = function(state) {
            // if autoControlsCombine is true, replace the current control with the new state 
            if (slider.settings.autoControlsCombine) {
                slider.controls.autoEl.html(slider.controls[state]);
                // if autoControlsCombine is false, apply the "active" class to the appropriate control 
            } else {
                slider.controls.autoEl.find('a').removeClass('active');
                slider.controls.autoEl.find('a:not(.bx-' + state + ')').addClass('active');
            }
        }

        /**
         * Updates the direction controls (checks if either should be hidden)
         */
        var updateDirectionControls = function() {
            if (getPagerQty() == 1) {
                slider.controls.prev.addClass('disabled');
                slider.controls.next.addClass('disabled');
            } else if (!slider.settings.infiniteLoop && slider.settings.hideControlOnEnd) {
                // if first slide
                if (slider.active.index == 0) {
                    slider.controls.prev.addClass('disabled');
                    slider.controls.next.removeClass('disabled');
                    // if last slide
                } else if (slider.active.index == getPagerQty() - 1) {
                    slider.controls.next.addClass('disabled');
                    slider.controls.prev.removeClass('disabled');
                    // if any slide in the middle
                } else {
                    slider.controls.prev.removeClass('disabled');
                    slider.controls.next.removeClass('disabled');
                }
            }
        }

        /**
         * Initialzes the auto process
         */
        var initAuto = function() {
            // if autoDelay was supplied, launch the auto show using a setTimeout() call
            if (slider.settings.autoDelay > 0) {
                var timeout = setTimeout(el.startAuto, slider.settings.autoDelay);
                // if autoDelay was not supplied, start the auto show normally
            } else {
                el.startAuto();
            }
            // if autoHover is requested
            if (slider.settings.autoHover) {
                // on el hover
                el.hover(function() {
                    // if the auto show is currently playing (has an active interval)
                    if (slider.interval) {
                        // stop the auto show and pass true agument which will prevent control update
                        el.stopAuto(true);
                        // create a new autoPaused value which will be used by the relative "mouseout" event
                        slider.autoPaused = true;
                    }
                }, function() {
                    // if the autoPaused value was created be the prior "mouseover" event
                    if (slider.autoPaused) {
                        // start the auto show and pass true agument which will prevent control update
                        el.startAuto(true);
                        // reset the autoPaused value
                        slider.autoPaused = null;
                    }
                });
            }
        }

        /**
         * Initialzes the ticker process
         */
        var initTicker = function() {
            var startPosition = 0;
            // if autoDirection is "next", append a clone of the entire slider
            if (slider.settings.autoDirection == 'next') {
                el.append(slider.children.clone().addClass('bx-clone'));
                // if autoDirection is "prev", prepend a clone of the entire slider, and set the left position
            } else {
                el.prepend(slider.children.clone().addClass('bx-clone'));
                var position = slider.children.first().position();
                startPosition = slider.settings.mode == 'horizontal' ? -position.left : -position.top;
            }
            setPositionProperty(startPosition, 'reset', 0);
            // do not allow controls in ticker mode
            slider.settings.pager = false;
            slider.settings.controls = false;
            slider.settings.autoControls = false;
            // if autoHover is requested
            if (slider.settings.tickerHover && !slider.usingCSS) {
                // on el hover
                slider.viewport.hover(function() {
                    el.stop();
                }, function() {
                    // calculate the total width of children (used to calculate the speed ratio)
                    var totalDimens = 0;
                    slider.children.each(function(index) {
                        totalDimens += slider.settings.mode == 'horizontal' ? $j(this).outerWidth(true) : $j(this).outerHeight(true);
                    });
                    // calculate the speed ratio (used to determine the new speed to finish the paused animation)
                    var ratio = slider.settings.speed / totalDimens;
                    // determine which property to use
                    var property = slider.settings.mode == 'horizontal' ? 'left' : 'top';
                    // calculate the new speed
                    var newSpeed = ratio * (totalDimens - (Math.abs(parseInt(el.css(property)))));
                    tickerLoop(newSpeed);
                });
            }
            // start the ticker loop
            tickerLoop();
        }

        /**
         * Runs a continuous loop, news ticker-style
         */
        var tickerLoop = function(resumeSpeed) {
            speed = resumeSpeed ? resumeSpeed : slider.settings.speed;
            var position = {
                left: 0,
                top: 0
            };
            var reset = {
                left: 0,
                top: 0
            };
            // if "next" animate left position to last child, then reset left to 0
            if (slider.settings.autoDirection == 'next') {
                position = el.find('.bx-clone').first().position();
                // if "prev" animate left position to 0, then reset left to first non-clone child
            } else {
                reset = slider.children.first().position();
            }
            var animateProperty = slider.settings.mode == 'horizontal' ? -position.left : -position.top;
            var resetValue = slider.settings.mode == 'horizontal' ? -reset.left : -reset.top;
            var params = {
                resetValue: resetValue
            };
            setPositionProperty(animateProperty, 'ticker', speed, params);
        }

        /**
         * Initializes touch events
         */
        var initTouch = function() {
            // initialize object to contain all touch values
            slider.touch = {
                start: {
                    x: 0,
                    y: 0
                },
                end: {
                    x: 0,
                    y: 0
                }
            }
            slider.viewport.bind('touchstart', onTouchStart);
        }

        /**
         * Event handler for "touchstart"
         *
         * @param e (event) 
         *  - DOM event object
         */
        var onTouchStart = function(e) {
            if (slider.working) {
                e.preventDefault();
            } else {
                // record the original position when touch starts
                slider.touch.originalPos = el.position();
                var orig = e.originalEvent;
                // record the starting touch x, y coordinates
                slider.touch.start.x = orig.changedTouches[0].pageX;
                slider.touch.start.y = orig.changedTouches[0].pageY;
                // bind a "touchmove" event to the viewport
                slider.viewport.bind('touchmove', onTouchMove);
                // bind a "touchend" event to the viewport
                slider.viewport.bind('touchend', onTouchEnd);
            }
        }

        /**
         * Event handler for "touchmove"
         *
         * @param e (event) 
         *  - DOM event object
         */
        var onTouchMove = function(e) {
            var orig = e.originalEvent;
            // if scrolling on y axis, do not prevent default
            var xMovement = Math.abs(orig.changedTouches[0].pageX - slider.touch.start.x);
            var yMovement = Math.abs(orig.changedTouches[0].pageY - slider.touch.start.y);
            // x axis swipe
            if ((xMovement * 3) > yMovement && slider.settings.preventDefaultSwipeX) {
                e.preventDefault();
                // y axis swipe
            } else if ((yMovement * 3) > xMovement && slider.settings.preventDefaultSwipeY) {
                e.preventDefault();
            }
            if (slider.settings.mode != 'fade' && slider.settings.oneToOneTouch) {
                var value = 0;
                // if horizontal, drag along x axis
                if (slider.settings.mode == 'horizontal') {
                    var change = orig.changedTouches[0].pageX - slider.touch.start.x;
                    value = slider.touch.originalPos.left + change;
                    // if vertical, drag along y axis
                } else {
                    var change = orig.changedTouches[0].pageY - slider.touch.start.y;
                    value = slider.touch.originalPos.top + change;
                }
                setPositionProperty(value, 'reset', 0);
            }
        }

        /**
         * Event handler for "touchend"
         *
         * @param e (event) 
         *  - DOM event object
         */
        var onTouchEnd = function(e) {
            slider.viewport.unbind('touchmove', onTouchMove);
            var orig = e.originalEvent;
            var value = 0;
            // record end x, y positions
            slider.touch.end.x = orig.changedTouches[0].pageX;
            slider.touch.end.y = orig.changedTouches[0].pageY;
            // if fade mode, check if absolute x distance clears the threshold
            if (slider.settings.mode == 'fade') {
                var distance = Math.abs(slider.touch.start.x - slider.touch.end.x);
                if (distance >= slider.settings.swipeThreshold) {
                    slider.touch.start.x > slider.touch.end.x ? el.goToNextSlide() : el.goToPrevSlide();
                    el.stopAuto();
                }
                // not fade mode
            } else {
                var distance = 0;
                // calculate distance and el's animate property
                if (slider.settings.mode == 'horizontal') {
                    distance = slider.touch.end.x - slider.touch.start.x;
                    value = slider.touch.originalPos.left;
                } else {
                    distance = slider.touch.end.y - slider.touch.start.y;
                    value = slider.touch.originalPos.top;
                }
                // if not infinite loop and first / last slide, do not attempt a slide transition
                if (!slider.settings.infiniteLoop && ((slider.active.index == 0 && distance > 0) || (slider.active.last && distance < 0))) {
                    setPositionProperty(value, 'reset', 200);
                } else {
                    // check if distance clears threshold
                    if (Math.abs(distance) >= slider.settings.swipeThreshold) {
                        distance < 0 ? el.goToNextSlide() : el.goToPrevSlide();
                        el.stopAuto();
                    } else {
                        // el.animate(property, 200);
                        setPositionProperty(value, 'reset', 200);
                    }
                }
            }
            slider.viewport.unbind('touchend', onTouchEnd);
        }

        /**
         * Window resize event callback
         */
        var resizeWindow = function(e) {
            // get the new window dimens (again, thank you IE)
            var windowWidthNew = $j(window).width();
            var windowHeightNew = $j(window).height();
            // make sure that it is a true window resize
            // *we must check this because our dinosaur friend IE fires a window resize event when certain DOM elements
            // are resized. Can you just die already?*
            if (windowWidth != windowWidthNew || windowHeight != windowHeightNew) {
                // set the new window dimens
                windowWidth = windowWidthNew;
                windowHeight = windowHeightNew;
                // update all dynamic elements
                el.redrawSlider();
            }
        }

        /**
         * ===================================================================================
         * = PUBLIC FUNCTIONS
         * ===================================================================================
         */

        /**
         * Performs slide transition to the specified slide
         *
         * @param slideIndex (int) 
         *  - the destination slide's index (zero-based)
         *
         * @param direction (string) 
         *  - INTERNAL USE ONLY - the direction of travel ("prev" / "next")
         */
        el.goToSlide = function(slideIndex, direction) {
            // if plugin is currently in motion, ignore request
            if (slider.working || slider.active.index == slideIndex) return;
            // declare that plugin is in motion
            slider.working = true;
            // store the old index
            slider.oldIndex = slider.active.index;
            // if slideIndex is less than zero, set active index to last child (this happens during infinite loop)
            if (slideIndex < 0) {
                slider.active.index = getPagerQty() - 1;
                // if slideIndex is greater than children length, set active index to 0 (this happens during infinite loop)
            } else if (slideIndex >= getPagerQty()) {
                slider.active.index = 0;
                // set active index to requested slide
            } else {
                slider.active.index = slideIndex;
            }
            // onSlideBefore, onSlideNext, onSlidePrev callbacks
            slider.settings.onSlideBefore(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index);
            if (direction == 'next') {
                slider.settings.onSlideNext(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index);
            } else if (direction == 'prev') {
                slider.settings.onSlidePrev(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index);
            }
            // check if last slide
            slider.active.last = slider.active.index >= getPagerQty() - 1;
            // update the pager with active class
            if (slider.settings.pager) updatePagerActive(slider.active.index);
            // // check for direction control update
            if (slider.settings.controls) updateDirectionControls();
            // if slider is set to mode: "fade"
            if (slider.settings.mode == 'fade') {
                // if adaptiveHeight is true and next height is different from current height, animate to the new height
                if (slider.settings.adaptiveHeight && slider.viewport.height() != getViewportHeight()) {
                    slider.viewport.animate({
                        height: getViewportHeight()
                    }, slider.settings.adaptiveHeightSpeed);
                }
                // fade out the visible child and reset its z-index value
                slider.children.filter(':visible').fadeOut(slider.settings.speed).css({
                    zIndex: 0
                });
                // fade in the newly requested slide
                slider.children.eq(slider.active.index).css('zIndex', 51).fadeIn(slider.settings.speed, function() {
                    $j(this).css('zIndex', 50);
                    updateAfterSlideTransition();
                });
                // slider mode is not "fade"
            } else {
                // if adaptiveHeight is true and next height is different from current height, animate to the new height
                if (slider.settings.adaptiveHeight && slider.viewport.height() != getViewportHeight()) {
                    slider.viewport.animate({
                        height: getViewportHeight()
                    }, slider.settings.adaptiveHeightSpeed);
                }
                var moveBy = 0;
                var position = {
                    left: 0,
                    top: 0
                };
                // if carousel and not infinite loop
                if (!slider.settings.infiniteLoop && slider.carousel && slider.active.last) {
                    if (slider.settings.mode == 'horizontal') {
                        // get the last child position
                        var lastChild = slider.children.eq(slider.children.length - 1);
                        position = lastChild.position();
                        // calculate the position of the last slide
                        moveBy = slider.viewport.width() - lastChild.width();
                    } else {
                        // get last showing index position
                        var lastShowingIndex = slider.children.length - slider.settings.minSlides;
                        position = slider.children.eq(lastShowingIndex).position();
                    }
                    // horizontal carousel, going previous while on first slide (infiniteLoop mode)
                } else if (slider.carousel && slider.active.last && direction == 'prev') {
                    // get the last child position
                    var eq = slider.settings.moveSlides == 1 ? slider.settings.maxSlides - getMoveBy() : ((getPagerQty() - 1) * getMoveBy()) - (slider.children.length - slider.settings.maxSlides);
                    var lastChild = el.children('.bx-clone').eq(eq);
                    position = lastChild.position();
                    // if infinite loop and "Next" is clicked on the last slide
                } else if (direction == 'next' && slider.active.index == 0) {
                    // get the last clone position
                    position = el.find('> .bx-clone').eq(slider.settings.maxSlides).position();
                    slider.active.last = false;
                    // normal non-zero requests
                } else if (slideIndex >= 0) {
                    var requestEl = slideIndex * getMoveBy();
                    position = slider.children.eq(requestEl).position();
                }

                /* If the position doesn't exist 
                 * (e.g. if you destroy the slider on a next click),
                 * it doesn't throw an error.
                 */
                if ("undefined" !== typeof(position)) {
                    var value = slider.settings.mode == 'horizontal' ? -(position.left - moveBy) : -position.top;
                    // plugin values to be animated
                    setPositionProperty(value, 'slide', slider.settings.speed);
                }
            }
        }

        /**
         * Transitions to the next slide in the show
         */
        el.goToNextSlide = function() {
            // if infiniteLoop is false and last page is showing, disregard call
            if (!slider.settings.infiniteLoop && slider.active.last) return;
            var pagerIndex = parseInt(slider.active.index) + 1;
            el.goToSlide(pagerIndex, 'next');
        }

        /**
         * Transitions to the prev slide in the show
         */
        el.goToPrevSlide = function() {
            // if infiniteLoop is false and last page is showing, disregard call
            if (!slider.settings.infiniteLoop && slider.active.index == 0) return;
            var pagerIndex = parseInt(slider.active.index) - 1;
            el.goToSlide(pagerIndex, 'prev');
        }

        /**
         * Starts the auto show
         *
         * @param preventControlUpdate (boolean) 
         *  - if true, auto controls state will not be updated
         */
        el.startAuto = function(preventControlUpdate) {
            // if an interval already exists, disregard call
            if (slider.interval) return;
            // create an interval
            slider.interval = setInterval(function() {
                slider.settings.autoDirection == 'next' ? el.goToNextSlide() : el.goToPrevSlide();
            }, slider.settings.pause);
            // if auto controls are displayed and preventControlUpdate is not true
            if (slider.settings.autoControls && preventControlUpdate != true) updateAutoControls('stop');
        }

        /**
         * Stops the auto show
         *
         * @param preventControlUpdate (boolean) 
         *  - if true, auto controls state will not be updated
         */
        el.stopAuto = function(preventControlUpdate) {
            // if no interval exists, disregard call
            if (!slider.interval) return;
            // clear the interval
            clearInterval(slider.interval);
            slider.interval = null;
            // if auto controls are displayed and preventControlUpdate is not true
            if (slider.settings.autoControls && preventControlUpdate != true) updateAutoControls('start');
        }

        /**
         * Returns current slide index (zero-based)
         */
        el.getCurrentSlide = function() {
            return slider.active.index;
        }

        /**
         * Returns number of slides in show
         */
        el.getSlideCount = function() {
            return slider.children.length;
        }

        /**
         * Update all dynamic slider elements
         */
        el.redrawSlider = function() {
            // resize all children in ratio to new screen size
            slider.children.add(el.find('.bx-clone')).width(getSlideWidth());
            // adjust the height
            slider.viewport.css('height', getViewportHeight());
            // update the slide position
            if (!slider.settings.ticker) setSlidePosition();
            // if active.last was true before the screen resize, we want
            // to keep it last no matter what screen size we end on
            if (slider.active.last) slider.active.index = getPagerQty() - 1;
            // if the active index (page) no longer exists due to the resize, simply set the index as last
            if (slider.active.index >= getPagerQty()) slider.active.last = true;
            // if a pager is being displayed and a custom pager is not being used, update it
            if (slider.settings.pager && !slider.settings.pagerCustom) {
                populatePager();
                updatePagerActive(slider.active.index);
            }
        }

        /**
         * Destroy the current instance of the slider (revert everything back to original state)
         */
        el.destroySlider = function() {
            // don't do anything if slider has already been destroyed
            if (!slider.initialized) return;
            slider.initialized = false;
            $j('.bx-clone', this).remove();
            slider.children.removeAttr('style');
            this.removeAttr('style').unwrap().unwrap();
            if (slider.controls.el) slider.controls.el.remove();
            if (slider.controls.next) slider.controls.next.remove();
            if (slider.controls.prev) slider.controls.prev.remove();
            if (slider.pagerEl) slider.pagerEl.remove();
            $j('.bx-caption', this).remove();
            if (slider.controls.autoEl) slider.controls.autoEl.remove();
            clearInterval(slider.interval);
            $j(window).unbind('resize', resizeWindow);
        }

        /**
         * Reload the slider (revert all DOM changes, and re-initialize)
         */
        el.reloadSlider = function(settings) {
            if (settings != undefined) options = settings;
            el.destroySlider();
            init();
        }

        init();

        // returns the current jQuery object
        return this;
    }

})($j);

/*!
 * jQuery imagesLoaded plugin v2.1.0
 * http://github.com/desandro/imagesloaded
 *
 * MIT License. by Paul Irish et al.
 */

/*jshint curly: true, eqeqeq: true, noempty: true, strict: true, undef: true, browser: true */
/*global jQuery: false */

(function(c, n) {
    var l = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";
    c.fn.imagesLoaded = function(f) {
        function m() {
            var b = c(i),
                a = c(h);
            d && (h.length ? d.reject(e, b, a) : d.resolve(e));
            c.isFunction(f) && f.call(g, e, b, a)
        }

        function j(b, a) {
            b.src === l || -1 !== c.inArray(b, k) || (k.push(b), a ? h.push(b) : i.push(b), c.data(b, "imagesLoaded", {
                isBroken: a,
                src: b.src
            }), o && d.notifyWith(c(b), [a, e, c(i), c(h)]), e.length === k.length && (setTimeout(m), e.unbind(".imagesLoaded")))
        }
        var g = this,
            d = c.isFunction(c.Deferred) ? c.Deferred() :
            0,
            o = c.isFunction(d.notify),
            e = g.find("img").add(g.filter("img")),
            k = [],
            i = [],
            h = [];
        c.isPlainObject(f) && c.each(f, function(b, a) {
            if ("callback" === b) f = a;
            else if (d) d[b](a)
        });
        e.length ? e.bind("load.imagesLoaded error.imagesLoaded", function(b) {
            j(b.target, "error" === b.type)
        }).each(function(b, a) {
            var d = a.src,
                e = c.data(a, "imagesLoaded");
            if (e && e.src === d) j(a, e.isBroken);
            else if (a.complete && a.naturalWidth !== n) j(a, 0 === a.naturalWidth || 0 === a.naturalHeight);
            else if (a.readyState || a.complete) a.src = l, a.src = d
        }) : m();
        return d ? d.promise(g) :
            g
    }
})($j);

var susCarousal;

$j(document).ready(function() {


    if ($j(".blue-slider .slide-item").length > 1) {
        $j('.blue-slider').bxSlider({
            infiniteLoop: false,
            pager: false,
            hideControlOnEnd: true,
            touchEnabled: false,
            auto: false
        });
    }
    if ($j(".white-slider .slide-item").length > 1) {
        $j('.white-slider').bxSlider({
            infiniteLoop: false,
            pager: false,
            hideControlOnEnd: true,
            touchEnabled: false,
            auto: true
        });
    }

    if ($j(".customer-banner-item").length > 1) {
        $j('.customer-banner-container').bxSlider({
            infiniteLoop: false,
            pager: true,
            controls: false,
            mode: 'fade',
            hideControlOnEnd: true,
            touchEnabled: false,
            auto: true
        });
    }
    $j('.cutomer-news-container').bxSlider({
        infiniteLoop: true,
        pager: true,
        controls: true,
        hideControlOnEnd: true,
        touchEnabled: false,
        auto: true
    });














    if ($j(".banner-container").length > 1) {
        $j(".banner-container").show();
        $j("#bannerwrapper").bxSlider({
            infinteLoop: false,
            touchEnabled: false,
            mode: 'fade',
            controls: false,
            auto: true,
            adaptiveHeight: true,
            onSliderLoad: function() {
                // do funky JS stuff here
                //alert('Slider has finished loading. Click OK to continue!');
                var slide = parseInt($j(".bx-pager-link.active").attr("data-slide-index")) + 1;
                if ($j(".banner-container:nth-child(" + slide + ")").children(".bottom-banner-text").length > 0) {
                    $j(".bx-pager").css({
                        'top': '5px'
                    });
                    $j(".bx-pager").css({
                        'bottom': 'auto'
                    });
                } else {
                    $j(".bx-pager").css({
                        'bottom': '5px'
                    });
                    $j(".bx-pager").css({
                        'top': 'auto'
                    });
                }
            },
            onSlideAfter: function() {

                // do mind-blowing JS stuff here
                //alert('A slide has finished transitioning. Bravo. Click OK to continue!');
                //checkBannerPager();
                var slide = parseInt($j(".bx-pager-link.active").attr("data-slide-index")) + 1;
                if ($j(".banner-container:nth-child(" + slide + ")").children(".bottom-banner-text").length > 0) {
                    $j(".bx-pager").css({
                        'top': '5px'
                    });
                    $j(".bx-pager").css({
                        'bottom': 'auto'
                    });
                } else {
                    $j(".bx-pager").css({
                        'bottom': '5px'
                    });
                    $j(".bx-pager").css({
                        'top': 'auto'
                    });
                }
                //alert(slide);
            }
        });
    }


});
/*!---- autocomplete-----*/
$j(document).ready(function() {
    //main search textbox
    if ($j("#searchTextbox").length > 0) {
        $j("#searchTextbox").autocomplete({
            source: function(request, response) {

                $j.ajax({
                    url: "/Investis/AdvancedSearch/PredictiveSearch.aspx",
                    data: {
                        ps_lang: 'en',
                        PS_HOSTNAME: autoCompleteDomain,
                        PS_SEARCHTERM: encodeURIComponent(request.term),
                        PS_MAXSUGGESTIONCOUNT: 7
                    },
                    async: true,
                    success: function(data) {


                        response(data);
                    },
                    error: function(result) {
                        //alert("Error loading the data" + result.responseText);
                    }
                });
            },
            minLength: 1,
            select: function(event, ui) {
                $j("#searchTextbox").val(ui.item.value);
                $j("#searchButton").trigger("click");
            }
        }).data("ui-autocomplete")._renderItem = function(ul, item) {
            return $j("<li class='ui-corner-all'>")
                .append("<a> <span style='float:left;'>" + item.label + "</span><span style='float:right;'>(" + item.count + ")</span></a>").appendTo(ul);
        };


    }

    if ($j("#msearchTextbox").length > 0) {
        $j("#msearchTextbox").autocomplete({
            appendTo: "#msearchTextboxContainer",
            source: function(request, response) {

                $j.ajax({
                    url: "/Investis/AdvancedSearch/PredictiveSearch.aspx",
                    data: {
                        ps_lang: 'en',
                        PS_HOSTNAME: autoCompleteDomain,
                        PS_SEARCHTERM: encodeURIComponent(request.term),
                        PS_MAXSUGGESTIONCOUNT: 5
                    },
                    async: true,
                    success: function(data) {


                        response(data);
                    },
                    error: function(result) {
                        //alert("Error loading the data" + result.responseText);
                    }
                });
            },
            minLength: 1,
            select: function(event, ui) {
                $j("#msearchTextbox").val(ui.item.value);
                $j("#msearchButton").trigger("click");
            }
        }).data("ui-autocomplete")._renderItem = function(ul, item) {
            return $j("<li class='ui-corner-all'>")
                .append("<a> <span style='float:left;'>" + item.label + "</span><span style='float:right;'>(" + item.count + ")</span></a>").appendTo(ul);
        };


    }


    // Search result page textbox
    if ($j("#SearchTextboxRP").length > 0) {
        $j("#SearchTextboxRP").autocomplete({
            source: function(request, response) {
                $j.ajax({
                    url: "/Investis/AdvancedSearch/PredictiveSearch.aspx",
                    data: {
                        ps_lang: 'en',
                        PS_HOSTNAME: autoCompleteDomain,
                        PS_SEARCHTERM: encodeURIComponent(request.term),
                        PS_MAXSUGGESTIONCOUNT: 7
                    },
                    async: true,
                    success: function(data) {
                        response(data);
                    },
                    error: function(result) {
                        //alert("Error loading the data" + result.responseText);
                    }
                });
            },
            minLength: 1,
            select: function(event, ui) {
                $j("#SearchTextboxRP").val(ui.item.value);
                $j("#SearchbuttonRP").trigger("click");
            }
        }).data("ui-autocomplete")._renderItem = function(ul, item) {
            return $j("<li class='ui-corner-all'>")
                .append("<a> <span style='float:left;'>" + item.label + "</span><span style='float:right;'>(" + item.count + ")</span></a>").appendTo(ul);
        };
    }
});
/*!---- stories-popup-----*/
var DisplayTileNo;
var CoountryUKsite;

$j(document).ready(function() {

    CoountryUKsite = $j("body#insights").hasClass("ip3-uk");

    $j("body#insights .main-modular-landing.new-site-fw .hsp-insights .hsp-section-name").text("Insights");
    $j("body#media .main-modular-landing.new-site-fw #inner-meet-the-experts.popup-story-module .hsp-insights .hsp-section-name").text("Insights");

    DisplayTileNo = $j('.story-popup-wrapper .scrollable-container .dynamic-popup-story-module.popup-story-module span.displaytile.hide').text();
    //console.log("DisplayTileNo= "+DisplayTileNo);
    original_title = $j('title').text();

    /*---------- Open innovation stories in new window starts here -------------*/

    /*if(!$j('.our-stories-hub')[0]){
      	$j('.innovation-story').each(function(e){
      		$j(this).find('>a').removeAttr('title target');
      	});
      }*/

    /*---------- Open innovation stories in new window ends here -------------*/

    if ($j(window).width() > '767') {
        $j('.scrollable-container').height($j(window).innerHeight() - 100);
    } else {
        $j('.scrollable-container').height($j(window).innerHeight() - 60);
    }


    top_position = 0;
    currBrowserTitle1 = '';
    currBrowserTitle2 = '';


    originalBrowserTitle = $j('html title').text();

    var thisSelec, prevSelec = '';
    if ($j('.our-stories-hub')[0]) {
        var History = window.History; // do not forget to use "H", instead of "h"
        var State = History.getState();
        var url = State.url;
    }

    currBrowserTitle1 = $j('html title').text().split('  ')[0];
    currBrowserTitle2 = $j('html title').text().split('  ')[1];


    if (localStorage.getItem('redirectedId') != '' && localStorage.getItem('redirectedId') != undefined && window.location.href.indexOf('#') < 0 && $j('.our-stories-hub')[0]) { // if url is redirected from inner itempage

        begin = location.href.split('#')[0];
        //var hash = location.hash.split('#')[1];
        var hash = localStorage.getItem('redirectedId');
        var fullstoryurl = localStorage.getItem('URLquerystring');
        //console.log(hash);
        var original = location.href.split('#')[0].split('?')[0];

        if ($j('.our-stories-hub')[0]) {
            History.pushState({
                "state": original,
                "rand": Math.random()
            }, originalBrowserTitle, original);
        }

        if (hash != '' && hash != undefined) {
            var link = $j('.all-article-links a[data-id="' + hash + '"]').attr('href');
            var id = $j('.all-article-links a[data-id="' + hash + '"]').attr('data-id');

            chngBrowserTitle = currBrowserTitle1 + ' - ' + $j('.all-article-links a[data-id="' + hash + '"]').text();
            History.pushState(null, chngBrowserTitle, fullstoryurl);
            ajax_request(link);
            //console.log(link);/*NM*/            
            $j('#MainWrapper').addClass('popup-open');

            localStorage.removeItem('redirectedId');
            localStorage.removeItem('URLquerystring');
            $j('.links-trail').html($j('.links-trail').html() + '<span><a data-title="' + $j('.all-article-links a[data-id="' + hash + '"]').text() + '" href="' + link + '">Back to last article</a></span>');
        }
    } else if (window.location.href.indexOf('#') > -1) {

        var hash = location.hash.split('#')[1];


        if (hash != '' && hash != undefined) {
            var link = $j('.all-article-links a[data-id="' + hash + '"]').attr('href');
            var id = $j('.all-article-links a[data-id="' + hash + '"]').attr('data-id');

            if (link != undefined) {
                ajax_request(link);
                $j('.links-trail').html($j('.links-trail').html() + '<span><a data-title="' + $j('.all-article-links a[data-id="' + hash + '"]').text() + '" href="' + link + '">Back to last article</a></span>');

            }
        }
    } else {
        begin = location.href.split('?')[0];
    }

    /*------ Avoid duplicate years in filter starts --------*/

    var seen = {};

    $j('.month-year .year-filter li a').each(function() {
        var txt = $j(this).attr('data-category-name');
        if (seen[txt])
            $j(this).parent().remove();
        else
            seen[txt] = true;
    });

    /*------ Avoid duplicate years in filter ends --------*/

    $j('.story-popup-wrapper').appendTo('body');
    $j(".story-popup-wrapper:gt(0)").remove();
    $j('.story-popup-wrapper .story-popup-wrapper').css('top', $j(window).height());


    if ($j('.our-stories-hub')[0]) {
        History.Adapter.bind(window, 'statechange', function() {

            var State = History.getState();
            var url = State.url;
            //alert(url);
            thisSelec = $j('.hsp-main:not(.innovation-story) a[href*="' + url.split("/").pop() + '"]');

            var StoriesURi = url.split("/").pop().indexOf('our-stories');
            var PrURi = url.split("/").pop().indexOf('press-releases');
            //$j('.hsp-main a.active')[0] || $j('.inoStoryBox a.active')[0]
            if ($j(".new-press-releases-wrapper").length > 0) {
                if (url.split("/").pop().indexOf('press-releases') < 0) {
                    ajax_request(thisSelec.attr('href'));
                    //$j('.desk-tab-with-icon-normal li a#'+localStorage.getItem('storeTABid')).trigger('click');/*NM*/
                } else {
                    $j('.story-popup-wrapper.open #close-popup').click();
                }
            } else {


                if (url.split("/").pop().indexOf('our-stories') < 0) {

                    ajax_request(thisSelec.attr('href'));
                } else {
                    $j('.story-popup-wrapper.open #close-popup').click();
                }

            }

            /*else if(url.split("/").pop().indexOf('press-releases-new-do-not-publish') < 0){
        ajax_request(thisSelec.attr('href'));
        }
        else{
          $j('.story-popup-wrapper.open #close-popup').click();
        }
*/



        });
    }


});

deeplinkid = '';

/*----------Deeplink tag click------------*/

$j(document).on('click', '.assigned-filter-section ul li a', function(e) {
    e.preventDefault();

    if ($j('.our-stories-hub')[0]) {
        $j('#close-popup').click();

        deeplinkid = $j(this).attr('data-id');

        $j('.filter-tab-content').each(function() {
            $j(this).find('ul li a.selected').not('a[data-filter="' + deeplinkid + '"]').click();
        });
        $j('.filter-click li a span').each(function() {
            $j(this).html('');
        });
        $j('.filter-click li.active').click();

        if (!$j('.insights-filter-title .insights-filter-inner ul li a[data-filter="' + deeplinkid + '"]').hasClass('selected')) {
            $j('.insights-filter-title .insights-filter-inner ul li a[data-filter="' + deeplinkid + '"]').click();
            if ($j(window).width() < '768') {
                $j('.mobi-Filter-Done a').addClass('apply').click();
            }
        }

    } else {
        localStorage.setItem('deeplinkid', $j(this).attr('data-id'));
        location.href = $j(this).attr('href');
    }
});

$j(window).load(function() {

    $j("body#insights .main-modular-landing.new-site-fw .hsp-insights .hsp-section-name").text("Insights");
    $j("body#media .main-modular-landing.new-site-fw #inner-meet-the-experts.popup-story-module .hsp-insights .hsp-section-name").text("Insights");
    DisplayTileNo = $j('.story-popup-wrapper .scrollable-container .dynamic-popup-story-module.popup-story-module span.displaytile.hide').text();
    //console.log("DisplayTileNo2= "+DisplayTileNo);
    if ($j('.discover-landing-page')[0]) {
        $j('#MainWrapper').addClass('taxonomy');
    }

    deeplinkstorageid = localStorage.getItem("deeplinkid");

    if (deeplinkstorageid != '' && deeplinkstorageid != undefined) {
        $j('.insights-filter-title .insights-filter-inner ul li a[data-filter="' + deeplinkstorageid + '"]').click();
        localStorage.removeItem("deeplinkid");
    }

    setTimeout(function() {
        $j('.insights-mid-fw .hsp-main').css('height', 'auto');
        setEqualHeight_CommonClass('.insights-mid-fw .hsp-main');
    }, 500);

    setTimeout(function() {
        $j(".fw-tabs-with-text-downloads .fw-dwld-top,.fw-text-downloads .fw-dwld-top").height('auto');
        $j('.fw-tabs-with-text-downloads,.fw-text-downloads').each(function() {
            $j(this).find('.fw-tab-sld-outer').each(function() {
                if ($j(this).find(".fw-dwld-top").length > 0) {
                    setEqualHeight_CommonClass($j(this).find(".fw-dwld-top"));
                }
            });
        });
    }, 1000);
});

/*----------Deeplink tag click ends------------*/


/*---------- Open popup starts here -------------*/

$j(document).on('click', '.discover-landing-page:not(.flyer-landing) .insights-mid-fw .hsp-main:not(.innovation-story) a,.discover-landing-page:not(.flyer-landing) .insights-mid-fw .inoStoryBox:not(.innovation-story) a, .insight-boxes-with-images-item a.dynamic-signpost-link', function(e) {
    e.preventDefault();
    //console.log("Close 3");


    $this = $j(this);
    top_position = $j(window).scrollTop();

    if (!$j('body').hasClass('ip3-edit')) {
        //_gaq.push(["_trackEvent", "Global story", $j(this).parent().find('.hsp-text .hsp-section-name').text() + ' - ' + //$j(this).parent().find('.hsp-text h3').text(), $j(this).attr('href')]);

        //_gaq.push(['_trackPageview', $j(this).attr('href').split('.com')[1]]);
        //$j('title').text($this.parent().find('.hsp-text h3').text());
    }

    $j('.hsp-main a,.inoStoryBox a, .insight-boxes-with-images-item a.dynamic-signpost-link').removeClass('active');
    $j(this).addClass('active');

    if ($j('.our-stories-hub')[0]) {
        chngBrowserTitle = currBrowserTitle1 + ' - ' + $this.parent().find('.hsp-text h3').text();
        History.pushState(null, chngBrowserTitle, this.href);
    } else {
        if (!$j(this).closest('.popup-story-module')[0]) {
            console.log("P1");
            if (CoountryUKsite === true) {
                window.location.href = this.href;
            } else {
                location.hash = $this.attr('data-id');
                ajax_request(this.href);
            }


        }

    }

    $j('.links-trail').html($j('.links-trail').html() + '<span><a data-title="' + $this.parent().find('.hsp-text h3').text() + '" href="' + this.href + '">Back to last article</a></span>');
});

/*---------- Open popup ends here -------------*/

function ajax_request(link) {

    $j("body#insights .main-modular-landing.new-site-fw .hsp-insights .hsp-section-name").text("Insights");
    $j('.story-popup-wrapper .scrollable-container').html('<img src="~/media/Images/R/Rolls-Royce/css/loader.gif" alt="Loading..." style="margin: 50px auto;display: block;"/>');

    if ($j('.hsp-main a.active')[0] || window.location.href.indexOf('#') > -1) {
        $j('#MainWrapper').addClass('popup-open').removeClass('popup-close');

        if ($j('body').hasClass('ie9')) {
            $j('#MainWrapper').animate({
                scale: '0.9'
            }, 400);
        }
    } else if ($j('body .popup-story-module')[0]) {
        $j('#MainWrapper').addClass('popup-open').removeClass('popup-close');
    }

    if (!$j('.story-popup-wrapper').hasClass('open')) {
        $j('.story-popup-wrapper').show().addClass('open');
    }
    $j.ajax({
        url: link + '?async=1'
    }).done(function(data) {
        $j('.story-popup-wrapper .scrollable-container').html(data).promise().done(function() {
            $j('html,body').addClass('no-scroll');
            $j('.no-scroll .close-popup-wrapper').css('padding-right', getScrollbarWidth() + 'px');
            if ($j('.story-popup-wrapper .scrollable-container .dynamic-popup-story-module.popup-story-module').length > 0) {
                $j(".story-popup-wrapper .scrollable-container .dynamic-popup-story-module.popup-story-module .hsp-main").hide();

                DisplayTileNo = $j('.story-popup-wrapper .scrollable-container .dynamic-popup-story-module.popup-story-module span.displaytile.hide').text();

                var TargetPieces = link.split('/');
                var Targetid = TargetPieces[TargetPieces.length - 1];
                var currentStoryOnHome = Targetid.split('.aspx')[0];

                //$j('.story-popup-wrapper .scrollable-container .dynamic-popup-story-module.popup-story-module .hsp-main a[data-id="' + currentStoryOnHome + '"]').parent(".hsp-main").addClass("current");


                setTimeout(function() {
                    $j(".story-popup-wrapper .scrollable-container .dynamic-popup-story-module.popup-story-module .hsp-main").last().removeClass("show");
                    $j('.story-popup-wrapper .scrollable-container .dynamic-popup-story-module.popup-story-module .hsp-main a[data-id="' + currentStoryOnHome + '"]').parent(".hsp-main").remove();
                    $j('.story-popup-wrapper .scrollable-container .dynamic-popup-story-module.popup-story-module .hsp-main').removeClass("current hide");
                    var totalboxes = $j(".story-popup-wrapper .scrollable-container .dynamic-popup-story-module.popup-story-module .hsp-main").length;

                    if (totalboxes <= 4) {
                        $j(".story-popup-wrapper .scrollable-container .dynamic-popup-story-module.popup-story-module .hsp-main").slice(0, 4).show();
                        $j(".story-popup-wrapper.open #airline-loadmore-wrapper").fadeOut('fast');
                    } else {
                        $j(".story-popup-wrapper .scrollable-container .dynamic-popup-story-module.popup-story-module .hsp-main").slice(0, 4).show();
                        $j(".story-popup-wrapper.open #airline-loadmore-wrapper").fadeIn('fast');
                    }
                }, 600);

                //var HasCurrentBox = $j(".dynamic-popup-story-module.popup-story-module .hsp-main").hasClass("current");
                //console.log("HasCurrentBox"+HasCurrentBox);



                $j(".story-popup-wrapper.open #airline-loadmore-wrapper .airline-loadmore").on('click', function(e) {
                    e.preventDefault();

                    $j(".story-popup-wrapper .scrollable-container .dynamic-popup-story-module.popup-story-module .hsp-main:hidden").slice(0, 4).show();

                    /* if(DisplayTileNo==4){
                    	$j(".dynamic-popup-story-module.popup-story-module .hsp-main:hidden").slice(0, 5).show();
                    }
                    else
                    {
                    	$j(".dynamic-popup-story-module.popup-story-module .hsp-main:hidden").slice(0, 4).show();
                    } */

                    var vlviewport = viewport().width;
                    if (vlviewport <= 640) {
                        $j('.home-mid-fw-inner1 .hsp-main').height('361');
                        $j('.home-mid-fw-inner1 .hsp-main .hsp-img').height('361');
                        $j('.home-mid-fw-inner1 .hsp-main .hsp-img img').height('auto');
                    } else {

                        $j('.home-mid-fw-inner1 .hsp-main').height('auto');
                        $j('.home-mid-fw-inner1 .hsp-main .hsp-img').height('auto');
                        $j('.home-mid-fw-inner1 .hsp-main .hsp-img img').height('auto');
                    }
                    if ($j(".story-popup-wrapper .scrollable-container .dynamic-popup-story-module.popup-story-module .hsp-main:hidden").length === 0) {
                        $j(".story-popup-wrapper.open #airline-loadmore-wrapper").fadeOut('slow');
                    }
                });

            }


            setTimeout(function() {
                $j('.insights-loader').hide();
                $j('.full-width-banner-main').addClass('banner-done');
            }, 50);

            $j('.img-cnt-outer-bg').each(function() {

                var imgcntHt = $j(this).find('.img-cnt-txt').outerHeight() + 90;
                //console.log(imgcntHt);
                $j(this).css('height', imgcntHt);
                $j(this).find('.img-cnt-img').css('height', imgcntHt);

            });

            ajax_calls();
            /*setTimeout(function(){
                                  $j(".assigned-filter-section li").sort(function(a, b){return ($j(b).text()) < ($j(a).text()) ? 1 : -1;}).appendTo('.assigned-filter-section ul');
                                  $j(".assigned-filter-section ul").removeClass('hide');
                                  $j('.scrollable-container').scrollTo(0,0);
                              
                              */

            setTimeout(function() {
                $j('.story-popup-wrapper .scrollable-container').addClass('loaded');

                // for video gallery - start
                if (viewport().width > 767) {
                    if ($j('.tabbed-vid-img-wrapperA').outerWidth() > 1400) {
                        var height45 = parseInt((1400 * 45) / 100);
                    } else {
                        var height45 = parseInt(($j('.tabbed-vid-img-wrapperA').outerWidth() * 45) / 100);
                    }
                    $j('.VideoFullWidthParentCon,.VideoParentCon').height(height45);
                }

                $j('.new-video-play-list-item').each(function() {
                    if ($j('.new-video-play-list-item').length > 0) {
                        var vidListID = $j(this).attr('ID');
                        $j("#" + vidListID).InvPlayer({
                            onVideoComplete: function() {
                                //	console.log("video complete");	
                            }
                        });
                    }
                });
                // for video gallery - end

            }, 2000);
        });
    });
}

/*---------- Close popup starts here -------------*/

$j(document).on('click', '#close-popup,.bottom-close-wrapper a', function(e) {

    e.preventDefault();
    $j(".share-icons").css("display", "none");
    //console.log("Close 1");

    if (localStorage.getItem('referrerURLPath') != '' && localStorage.getItem('referrerURLPath') != undefined) {
        var GetReferrerURLPath = localStorage.getItem('referrerURLPath');
        var GetReferrerURLHash = localStorage.getItem('referrerURLHash');

        if (GetReferrerURLHash === null) {
            GetReferrerURLPath = GetReferrerURLPath;
        } else {
            GetReferrerURLPath = GetReferrerURLPath + GetReferrerURLHash;
        }



        console.log("referrerURLPath = " + GetReferrerURLPath);
        //   console.log("referrerURLPath = "+GetReferrerURLPath);
        var ActuallParentURL = "/media/our-stories.aspx";
        if (GetReferrerURLPath === undefined || GetReferrerURLPath === null || GetReferrerURLPath === "" || GetReferrerURLPath.indexOf("/search-results") > -1) {
            window.location.href = ActuallParentURL;
        } else {
            window.location.href = GetReferrerURLPath;
            localStorage.removeItem("referrerURLPath");
        }

    }


    $j('title').text(original_title);

    if (deeplinkid == '' || deeplinkid == undefined) {

    } else {
        top_position = $j('.insightscontentwrapper').offset().top;
    }

    //location.hash = '';
    $j('.hsp-main a').removeClass('active');

    if ($j('body').hasClass('ie9')) {
        $j('#MainWrapper').animate({
            scale: '1'
        }, 400);
    }

    $j('#MainWrapper').removeClass('popup-open').addClass('popup-close');
    $j('html,body').removeClass('no-scroll');
    $j('.close-popup-wrapper').css('padding-right', '0');
    $j('html,body').animate({
        scrollTop: top_position
    }, 5, function() {
        setTimeout(function() {
            //$j('.story-popup-wrapper .scrollable-container').css({'top':$j(window).height()/2});
        }, 200);

        $j('.insights-mid-fw .hsp-main').css('height', 'auto');
        setEqualHeight_CommonClass('.insights-mid-fw .hsp-main');
    });
    $j('.story-popup-wrapper').removeClass('open').find('.scrollable-container').html('').removeClass('loaded');
    setTimeout(function() {
        $j('.story-popup-wrapper').hide();
    }, 445);

    $j('.links-trail').html('');
    $j('.back-to-previous').html('');

    if ($j('.our-stories-hub')[0]) {
        History.pushState({
            "state": begin,
            "rand": Math.random()
        }, originalBrowserTitle, begin);
    } else {
        if ($j('body .popup-story-module')[0]) {}
        location.hash = '';
    }


});

/*---------- Close popup ends here -------------*/

/*---------- Module related link click starts here -------------*/

$j(document).on('click', '.story-popup-wrapper .fw-module-global-signpost:not(.popup-story-module) .hsp-main:not(.innovation-story) a[href*="our-stories"],.popup-story-module .hsp-main:not(.innovation-story) a,.popup-global-signpost-module .hsp-main:not(.innovation-story) a', function(e) {
    $j('.main-modular-landing.new-site-fw .fw-tabbed-wrap .tabs li').removeClass('current');
    //e.preventDefault();
    //  console.log("Close 2");
    var GetParentID = $j(this).closest(".sections-wrap, .dynamic-popup-story-module").attr("id");
    GetParentID = "#" + GetParentID;
    localStorage.setItem('referrerURLHash', GetParentID);
    $j('.scrollable-container.loaded').html('').removeClass('loaded');
    $j('.hsp-main a,.inoStoryBox a').removeClass('active');
    if (!$j(this).closest('.module-inside-popup')[0]) {
        top_position = $j(window).scrollTop();
    } else {
        $j('.popup-story-module .hsp-main.active').removeClass('active');
        $j(this).parent().addClass('active');
    }

    var pieces = $j(this).attr('href').split('/');
    var id = pieces[pieces.length - 1];


    //ajax_request($j(this).attr('href'));  
    if ($j('.our-stories-hub')[0]) {
        chngBrowserTitle = currBrowserTitle1 + ' - ' + $j(this).parent().find('.hsp-text h3').text();
        History.pushState(null, chngBrowserTitle, this.href);
    } else {
        if ($j(this).closest('.module-inside-popup')[0]) {
            location.hash = id.split('.aspx')[0];
        }

    }

    $j('.links-trail').html($j('.links-trail').html() + '<span><a data-title="' + $j(this).parent().find('.hsp-text h3').text() + '" href="' + this.href + '">Back to last article</a></span>');
    if ($j('.links-trail a')[0]) {
        $j('.back-to-previous').html($j('.links-trail span:last-child').prev().html());
    }
});

/*---------- Module related link click ends here -------------*/

/*---------- Back to previous starts here -------------*/

$j(document).on('click', '.back-to-previous a', function(e) {
    e.preventDefault();

    $j('.scrollable-container.loaded').removeClass('loaded');

    $j('.links-trail span:last-child').remove();
    if ($j('.links-trail a')[1]) {
        $j('.back-to-previous').html($j('.links-trail span:last-child').prev().html());
    } else {
        $j('.back-to-previous').empty();

        var pieces = $j(this).attr('href').split('/');
        var id = pieces[pieces.length - 1];

        $j('.hsp-main a[data-id="' + id + '"]').addClass('active');
    }

    var pieces = $j(this).attr('href').split('/');
    var id = pieces[pieces.length - 1];

    ajax_request($j(this).attr('href'));

    if ($j('.our-stories-hub')[0]) {
        chngBrowserTitle = currBrowserTitle1 + ' - ' + $j(this).attr('data-title');
        History.pushState(null, chngBrowserTitle, $j(this).attr('href'));
    } else {
        if (!$j('.popup-story-module')[0]) {
            location.hash = id.split('.aspx')[0];
        }
    }

});

/*---------- Back to previous ends here -------------*/

/*---------- Ajax complete for popup starts here -------------*/

function ajax_calls() {

    /*------------------ Add current class for Module global signposts --------------*/

    if ($j('.scrollable-container .popup-story-module')[0]) {
        $j('.scrollable-container .popup-story-module .hsp-main').each(function() {
            if ($j('.discover-landing-page')[0] && window.location.href.indexOf('#') < 0) { //Our stories Hub
                if ($j(this).find('>a').attr('href').split('/').pop() == window.location.href.split('/').pop()) {
                    $j(this).addClass('current hide');
                    $j(this).closest('.popup-story-module').find('.hsp-main').last().addClass('show');
                }
            } else if ($j('.discover-landing-page')[0] && window.location.href.indexOf('#') > -1) { //Discover landing
                var id = location.hash;
                if ($j(this).find('>a').attr('href').split('/').pop() == id) {
                    $j(this).addClass('current hide');
                    $j(this).closest('.popup-story-module').find('.hsp-main').last().addClass('show');
                }
            } else {
                var id = $j('.popup-story-module .hsp-main a').attr('href').split('/').pop();

                if ($j(this).find('>a').attr('href').split('/').pop() == id) {
                    $j(this).addClass('current hide');
                    $j(this).closest('.popup-story-module').find('.hsp-main').last().addClass('show');
                }
            }
        });
    }

    /*------------------ Add current class for Module global signposts --------------*/


    /*------------------ Module Downloads and Contacts 50-50 -------------------*/

    var options = {
        infinite: false,
        dots: true,
        prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
        nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
        slidesToShow: 1,
        slidesToScroll: 1,
        speed: 300,
        responsive: [{
                breakpoint: 992,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1,
                    dots: true
                }
            },
            {
                breakpoint: 768,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1,
                    dots: true
                }
            }
        ]
    };

    $j('.contacts-card-slider').each(function() {
        if ($j(this).find('.fw-sld-inner-box').length > 1) {
            $j(this).not('.slick-initialized').slick(options);
        }
    });

    $j('.downloads-list-slider').each(function() {
        if ($j(this).find('.downloads-bar').length > 3) {

            var divs = $j(this).find('.downloads-bar');
            for (var i = 0; i < divs.length; i += 3) {
                divs.slice(i, i + 3).wrapAll('<div class="downloads-list-slide"></div>');
            }
        }
    }).promise().done(function() {
        $j('.downloads-list-slider').each(function() {
            if ($j(this).find('.downloads-list-slide')[0]) {
                $j(this).not('.slick-initialized').slick(options);
            }
        });
    });

    slider_arrows_adjust('.contacts-card-slider');
    slider_arrows_adjust('.downloads-list-slider');


    setTimeout(function() {
        $j('.downloads-contacts-wrapper').each(function() {
            setEqualHeight_CommonClass($j(this).find('.equal-height'));
        });
    }, 200);



    /*----------------- Module Downloads and Contacts 50-50 ends -------------------*/


    $j('.tab-content-main > div:first-child').addClass('current');
    $j('ul.tabs li:first-child').addClass('current');

    /*------------- Downloads Slider -------------*/

    if ($j('.fw-downloads-sld-featured').length > 0) {
        $j('.fw-dwld-sld-outer').not('.slick-initialized').slick({
            infinite: false,
            dots: true,
            prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
            nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
            slidesToShow: 2,
            slidesToScroll: 2,
            speed: 300,
            responsive: [{
                breakpoint: 768,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1,
                    dots: true
                }
            }]
        });
    } else {
        if ($j('.fw-dwld-sld-outer').length > 0) {
            $j('.fw-dwld-sld-outer').not('.slick-initialized').slick({
                infinite: false,
                dots: true,
                prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                slidesToShow: 4,
                slidesToScroll: 4,
                speed: 300,
                responsive: [{
                        breakpoint: 992,
                        settings: {
                            slidesToShow: 2,
                            slidesToScroll: 2,
                            dots: true
                        }
                    },
                    {
                        breakpoint: 768,
                        settings: {
                            slidesToShow: 1,
                            slidesToScroll: 1,
                            dots: true
                        }
                    }
                ]
            });
        }
    }

    slider_arrows_adjust('.fw-dwld-sld-outer');


    /*------------- Downloads Slider -------------*/

    /*------------- Contact slider -------------*/

    setTimeout(function() {

        if ($j('.fw-sld-outer-contact-card .fw-sld-inner-box').length > 1) {
            $j('.fw-sld-outer-contact-card').not('.slick-initialized').slick({
                infinite: false,
                dots: true,
                prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                slidesToShow: 3,
                slidesToScroll: 3,
                speed: 300,
                responsive: [{
                        breakpoint: 992,
                        settings: {
                            slidesToShow: 2,
                            slidesToScroll: 2,
                            dots: true
                        }
                    },
                    {
                        breakpoint: 768,
                        settings: {
                            slidesToShow: 1,
                            slidesToScroll: 1,
                            dots: true
                        }
                    }
                ]
            });
        }
        slider_arrows_adjust('.fw-sld-outer-contact-card');


    }, 200);

    $j('.fw-tab-sld-outer').each(function() {
        if ($j(this).find(".fw-dwld-top").length > 0) {
            setEqualHeight_CommonClass($j(this).find(".fw-dwld-top"));
        }
    });

    $j('.fw-dwld-sld-outer').each(function() {
        if ($j(this).find(".fw-dwld-top").length > 0) {
            setEqualHeight_CommonClass($j(this).find(".fw-dwld-top"));
        }
    });

    if ($j(window).width >= 768) {
        if ($j('.fw-adrs-box').length > 0) {
            setEqualHeight_CommonClass(".fw-adrs-box");
        }
    }
    if ($j(window).width <= 991) {
        $j('.home-content-fw-inner').css('margin-top', '');
    }

    /*------------- Contacts slider ends -------------*/


    /*------------- Large SignPost -------------*/

    setEqualHeight_CommonClass(".fw-ls-content-wrapper");

    /*------------- Large SignPost -------------*/

    /*------------- Stats Module Start -------------*/
    if ($j('.fw-stats-section .max-width-stats').length > 0) {
        $j('.fw-stats-section .max-width-stats').each(function() {
            var noOfStats = $j(this).find(".fw-stats-box").length;
            $j(this).find(".fw-stats-box").outerWidth(($j(this).outerWidth() / noOfStats) + "px");
        });
    }
    /*------------- Stats Module End -------------*/

    /*------------- Single image text slider -------------*/

    $j('.fw-sld-outer').each(function() {
        if ($j(this).find('.fw-sld-inner-box').length > 1) {
            //console.log($j(this).find('.fw-sld-inner-box').length);
            $j(this).not('.slick-initialized').slick({
                infinite: false,
                dots: true,
                prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                slidesToShow: 1,
                slidesToScroll: 1,
                speed: 300
            });
        }
    });

    slider_arrows_adjust('.fw-sld-outer');



    /*------------- Single image text slider ends -------------*/

    /*------------- Related products -------------*/

    if (is_touch_device()) {
        $j('.discover-items-wrapper').addClass('touch');
    }

    if ($j(window).width > 767) {
        if ($j('.products-wrapper > div').length > 3) {

            $j('.products-wrapper.slick-initialized').slick('unslick');

            $j('.products-wrapper').not('.slick-initialized').slick({
                infinite: false,
                dots: true,
                prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                slidesToShow: 3,
                slidesToScroll: 3,
                speed: 300,
                responsive: [{
                        breakpoint: 992,
                        settings: {
                            slidesToShow: 2,
                            slidesToScroll: 2,
                            dots: true
                        }
                    },
                    {
                        breakpoint: 768,
                        settings: {
                            slidesToShow: 1,
                            slidesToScroll: 1,
                            dots: true
                        }
                    }
                ]
            });

        } else {
            $j('.products-wrapper').addClass('disabled-slick-space');
        }
    } else {
        if ($j('.products-wrapper > div').length > 1) {
            $j('.products-wrapper.slick-initialized').slick('unslick');
            $j('.products-wrapper').not('.slick-initialized').slick({
                infinite: false,
                dots: true,
                prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                slidesToShow: 3,
                slidesToScroll: 3,
                speed: 300,
                responsive: [{
                        breakpoint: 992,
                        settings: {
                            slidesToShow: 2,
                            slidesToScroll: 2,
                            dots: true
                        }
                    },
                    {
                        breakpoint: 768,
                        settings: {
                            slidesToShow: 1,
                            slidesToScroll: 1,
                            dots: true
                        }
                    }
                ]
            });
        } else {
            $j('.products-wrapper').addClass('disabled-slick-space');
        }
    }

    slider_arrows_adjust('.products-wrapper');


    /*------------- Related products ends -------------*/

    /*------------ Tabs Slider ------------*/

    if ($j('.do-slick').length > 0) {
        $j('.do-slick').not('.slick-initialized').slick({
            infinite: false,
            dots: false,
            prevArrow: "<span class='rr-icon-arrow-nav sl-prev slick-prev'></span>",
            nextArrow: "<span class='rr-icon-arrow-nav sl-next slick-next'></span>",
            slidesToShow: 5,
            slidesToScroll: 5,
            speed: 300,
            responsive: [{
                breakpoint: 992,
                settings: {
                    prevArrow: "<span class='rr-icon-arrow-nav sl-prev slick-prev'></span>",
                    nextArrow: "<span class='rr-icon-arrow-nav sl-next slick-next'></span>",
                    slidesToShow: 2,
                    slidesToScroll: 2
                }
            }]
        });
    }

    /* --------- New Tab Logic Starts -------- */
    $j(".fw-tabbed-wrap-inner .tabs").each(function() {
        var tabFlag = 0;
        if ($j(window).width() > 767) {
            $j('#twocolright .desktop-view, #twocolright .mobile-view').removeClass('forceSnap');
            var ulWidth = parseInt($j(this).width());
            var liWidth = 0;
            var liLength = parseInt($j(this).find("li").length);

            $j(this).find("li").each(function(i) {

                liWidth += parseInt($j(this).width()) + 3;

                if ((i + 1) == liLength) {
                    var marginGap = (liLength - 1) * 3;
                    if (liWidth > ulWidth) {
                        tabFlag = 1;
                    }
                }
            });
        }
        if (tabFlag === 1) {
            $j('#twocolright .desktop-view, #twocolright .mobile-view').addClass('forceSnap');
        } else {
            $j('#twocolright .desktop-view, #twocolright .mobile-view').removeClass('forceSnap');
        }
    });
    /* --------- New Tab Logic Ends -------- */

    /*------------ Tabs Slider ends ------------*/

    /* Aerospace Related Products Slider Start */

    $j('.tab-content').each(function() {
        if ($j(this).find('.product-item').length < 4) {
            $j(this).find('.show-3-8-filter').addClass('hide invisible');
        }
    });

    if ($j('.desk-tab-with-icon').length > 5) {
        $j('.desk-tab-with-icon').not('.slick-initialized').slick({

            infinite: false,
            dots: false,
            prevArrow: "<span class='rr-icon-arrow-nav sl-prev slick-prev'></span>",
            nextArrow: "<span class='rr-icon-arrow-nav sl-next slick-next'></span>",
            slidesToShow: 5,
            slidesToScroll: 5,
            speed: 300,
            responsive: [{
                breakpoint: 992,
                settings: {
                    prevArrow: "<span class='rr-icon-arrow-nav sl-prev slick-prev'></span>",
                    nextArrow: "<span class='rr-icon-arrow-nav sl-next slick-next'></span>",
                    slidesToShow: 2,
                    slidesToScroll: 2
                }
            }]
        });
    }


    if ($j('.fw-rp-sld-outer').length > 0) {
        $j('.fw-rp-sld-outer').not('.slick-initialized').slick({
            infinite: false,
            dots: true,
            prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
            nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
            slidesToShow: 3,
            slidesToScroll: 3,
            speed: 300,
            responsive: [
                /*{
                  breakpoint: 992,
                  settings: {
                    slidesToShow: 2,
                    slidesToScroll: 2,
                    dots: true
                  }
                },*/
                {
                    breakpoint: 768,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1,
                        dots: true
                    }
                }
            ]
        });
    }

    $j('.fw-rp-sld-outer').each(function() {

        if ($j(this).find('.slick-dots > li').length > 0) {
            var totalWidth1 = 0;
            $j(this).find('.slick-dots > li').each(function() {
                totalWidth1 = totalWidth1 + $j(this).width();
            });
            var newPrevNext1 = (totalWidth1 * 2) + 110;
            $j(this).find('.slick-arrow.slick-next').css('right', -newPrevNext1);
            $j(this).find('.slick-arrow.slick-prev').css('left', -(newPrevNext1));
        }
    });



    $j(document).on('click', 'a.show-8.active', function() {
        //$j('a.show-8.active').click(function(){
        /*$j(this).parent().find('.fw-rp-sld-outer .product-item').removeAttr('data-slick-index');  
        $j('.fw-rp-sld-outer .product-item').removeAttr('tabindex');
        $j('.fw-rp-sld-outer .product-item').removeAttr('role');
        $j('.fw-rp-sld-outer .product-item').removeAttr('aria-describedby');*/

        $j(this).removeClass('active');
        $j(this).parents('.fw-sld-wrapper').find('a.show-3').addClass('active');
        $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').addClass('show-8');

        $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').slick('unslick');

        var rpCntWrap = $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer .product-item');

        for (var i = 0; i < rpCntWrap.length; i += 4) {
            rpCntWrap.slice(i, i + 4).wrapAll("<div class='rp-show-8-container clearfix'></div>");
        }

        var rpCntWrapCnt = $j(this).parents('.fw-sld-wrapper').find('.rp-show-8-container');

        for (var j = 0; j < rpCntWrapCnt.length; j += 2) {
            rpCntWrapCnt.slice(j, j + 2).wrapAll("<div class='rp-show-8-container-slider'></div>");
        }

        $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').removeClass('show-3');
        $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').addClass('show-8');

        $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').not('.slick-initialized').slick({
            infinite: false,
            dots: true,
            prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
            nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
            slidesToShow: 1,
            slidesToScroll: 1,
            speed: 300,
            responsive: [{
                breakpoint: 768,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1,
                    dots: true
                }
            }]
        });

        $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').each(function() {

            if ($j(this).find('.slick-dots > li').length > 0) {
                var totalWidth1 = 0;
                $j(this).find('.slick-dots > li').each(function() {
                    totalWidth1 = totalWidth1 + $j(this).width();
                });
                var newPrevNext1 = (totalWidth1 * 2) + 50;
                $j(this).find('.slick-arrow.slick-next').css('right', -newPrevNext1);
                $j(this).find('.slick-arrow.slick-prev').css('left', -(newPrevNext1));
            }
        });

    });

    $j(document).on('click', 'a.show-3.active', function() {
        //$j('a.show-3.active').click(function(){

        $j(this).removeClass('active');
        $j(this).parents('.fw-sld-wrapper').find('a.show-8').addClass('active');
        $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').slick('unslick');

        /*$j('.fw-rp-sld-outer .product-item').removeAttr('data-slick-index');  
        $j('.fw-rp-sld-outer .product-item').removeAttr('tabindex');
        $j('.fw-rp-sld-outer .product-item').removeAttr('role');
        $j('.fw-rp-sld-outer .product-item').removeAttr('aria-describedby');*/

        $j(this).parents('.fw-sld-wrapper').find('.rp-show-8-container').unwrap();
        $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer .product-item').unwrap();

        $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').removeClass('show-8');
        $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').addClass('show-3');

        $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').slick({
            infinite: false,
            dots: true,
            prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
            nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
            slidesToShow: 3,
            slidesToScroll: 3,
            speed: 300,
            responsive: [{
                breakpoint: 768,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1,
                    dots: true
                }
            }]
        });
        $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').each(function() {

            if ($j(this).find('.slick-dots > li').length > 0) {
                var totalWidth1 = 0;
                $j(this).find('.slick-dots > li').each(function() {
                    totalWidth1 = totalWidth1 + $j(this).width();
                });
                var newPrevNext1 = (totalWidth1 * 2) + 50;
                $j(this).find('.slick-arrow.slick-next').css('right', -newPrevNext1);
                $j(this).find('.slick-arrow.slick-prev').css('left', -(newPrevNext1));
            }
        });
    });

    $j('.tabs-with-icon').each(function() {
        setEqualHeight_CommonClass($j(this).find('span.menu-img'));
        setEqualHeight_CommonClass($j(this).find('span.menu-ttl'));
    });

    /* Aerospace Related Products Slider End */

    /*---------- Gloabl signpost module ------------*/

    setTimeout(function() {
        $j('.fw-module-global-signpost').each(function() {
            $j(this).find('.hsp-main').each(function() {

                $j(this).find('.hsp-img').height($j(this).find('.hsp-img > img').height());
                $j(this).height($j(this).find('.hsp-img > img').height());

            });
        });
    }, 500);
    /*---------- Gloabl signpost module ends ------------*/

    /*----------- Tabs Listing Slider -----------*/

    //if($j('.fw-tabbed-wrap .do-slick.tabs li').length > 5){
    if ($j('.do-slick-listing').length > 0) {
        $j('.do-slick-listing').not('.slick-initialized').slick({
            infinite: false,
            dots: false,
            prevArrow: "<span class='rr-icon-arrow-nav sl-prev slick-prev'></span>",
            nextArrow: "<span class='rr-icon-arrow-nav sl-next slick-next'></span>",
            slidesToShow: 3,
            slidesToScroll: 3,
            speed: 300,
            responsive: [{
                    breakpoint: 992,
                    settings: {
                        prevArrow: "<span class='rr-icon-arrow-nav sl-prev slick-prev'></span>",
                        nextArrow: "<span class='rr-icon-arrow-nav sl-next slick-next'></span>",
                        slidesToShow: 2,
                        slidesToScroll: 2
                    }
                },
                {
                    breakpoint: 768,
                    settings: {
                        prevArrow: "<span class='rr-icon-arrow-nav sl-prev slick-prev'></span>",
                        nextArrow: "<span class='rr-icon-arrow-nav sl-next slick-next'></span>",
                        slidesToShow: 2,
                        slidesToScroll: 2
                    }
                }
            ]
        });

        $j('.prgm-view-all').click(function() {
            $j(this).parent().next().find('.tab-list-all-programme').slideDown('500', function() {
                $j('.tab-list-all-programme').css('overflow', '');
            });
            //$j('.all-programme-updates').get(0).slick.setPosition();

            $j('.all-programme-updates').each(function() {
                $j(this).get(0).slick.setPosition();
            });

            $j(this).addClass('active');

        });

        $j('.all-programme-updates').each(function() {

            $j(this).not('.slick-initialized').slick({
                infinite: false,
                dots: true,
                arrows: false,
                slidesToShow: 3,
                slidesToScroll: 3,
                speed: 300
            });

        });

        $j(document).on('click', '.tab-list-all-programme ul.slick-slide li', function() {
            $j('.tab-list-all-programme').slideUp();
            var clickMe = $j(this).attr('data-tab');
            var SlideMe = $j(this).attr('data-counter') - 1;
            //console.log(SlideMe);
            $j('.fw-tabbed-wrap .do-slick-listing li[data-tab="' + clickMe + '"] a').trigger('click');
            $j('.do-slick-listing').slick('slickGoTo', SlideMe);
        });

    }
    if ($j('.do-slick-listing .slick-list li').length < 3) {
        $j('.fw-tabbed-list-wrap-inner .do-slick-listing').addClass('makeListCenter');
    }
    //} 
    /*----------- Tabs Listing Slider -----------*/

    /*-------------  Module Tabs with text and downloads slider starts  -------------*/

    var myp2flag = 0;
    var mypflag = 0;

    if ($j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer .fw-dwld-inner-box').length > 0) {
        if (viewport1().width > 1399) {

            if ($j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer.slick-initialized').length > 0 && myp2flag == 0) {
                $j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer.slick-initialized').slick('unslick');
                myp2flag = 1;

                $j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer').not('.slick-initialized').slick({
                    infinite: false,
                    dots: true,
                    prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                    nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                    speed: 300,
                    rows: 2,
                    slidesPerRow: 3
                });

            } else {
                $j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer').not('.slick-initialized').slick({
                    infinite: false,
                    dots: true,
                    prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                    nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                    speed: 300,
                    rows: 2,
                    slidesPerRow: 3
                });
            }
        } else {

            if ($j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer.slick-initialized').length > 0 && mypflag == 0) {
                $j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer.slick-initialized').slick('unslick');
                mypflag = 1;

                $j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer').not('.slick-initialized').slick({
                    infinite: false,
                    dots: true,
                    prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                    nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                    slidesToShow: 3,
                    slidesToScroll: 3,
                    speed: 300,
                    responsive: [{
                            breakpoint: 992,
                            settings: {
                                slidesToShow: 2,
                                slidesToScroll: 2
                            }
                        },
                        {
                            breakpoint: 768,
                            settings: {
                                slidesToShow: 1,
                                slidesToScroll: 1
                            }
                        }
                    ]
                });

            } else {
                $j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer').not('.slick-initialized').slick({
                    infinite: false,
                    dots: true,
                    prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                    nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                    slidesToShow: 3,
                    slidesToScroll: 3,
                    speed: 300,
                    responsive: [{
                            breakpoint: 992,
                            settings: {
                                slidesToShow: 2,
                                slidesToScroll: 2
                            }
                        },
                        {
                            breakpoint: 768,
                            settings: {
                                slidesToShow: 1,
                                slidesToScroll: 1
                            }
                        }
                    ]
                });
            }

        }

        $j('.fw-tab-dwld-sld-outer .slick-prev').css('left', '0');
        $j('.fw-tab-dwld-sld-outer .slick-next').css('right', '0');
        slider_arrows_adjust('.fw-tab-dwld-sld-outer');

    }

    /*-------------  Module tabs with text and downloads slider ends  -------------*/

    /*-------------  Text and Download with Language  -------------*/

    $j('.fw-text-download-and-language .ar-languages-list .label').click(function() {
        $j(this).toggleClass('active').next().slideToggle();
    });

    if ($j(".fw-text-download-and-language .ar-languages-list ul li").length > 0) {

        $j('.fw-text-download-and-language .ar-languages-list ul li.first a').each(function() {
            var flb = $j(this).parent().parent().parent().parent().find('.label').text();

            var firsthrf = $j(this).attr('href');
            var dtttlf = $j(this).attr('dt-title').toUpperCase();
            $j(this).parent().parent().parent().next().find("a").attr('href', firsthrf);
            $j(this).parent().parent().parent().next().find("a").attr('download', "pdf-" + flb + ".pdf");
            $j(this).parent().parent().parent().next().find("a").attr('title', dtttlf);
        });
    }

    $j('.fw-text-download-and-language ul').mCustomScrollbar({
        advanced: {
            updateOnContentResize: true
        },
        mouseWheel: {
            scrollAmount: 100
        }
    });

    /*-------------  Text and Download with Language ends -------------*/

    /*------------- Tabs with image on top -------------*/
    $j('.desk-tab-with-icon-normal').each(function() {

        var noofTABSNORMAL = $j(this).find('> li').length;

        var getLiWidthOBNORMAL = 100 / noofTABSNORMAL;
        //console.log(getLiWidth);
        $j(this).find('> li').width((getLiWidthOBNORMAL) + "%");

    });

    /*------------- Tabs with image on top ends -------------*/

    /*--  Hide view all button for tabs modules if tabs less than 3 starts  --*/
    if (viewport1().width >= 768) {
        setTimeout(function() {
            $j('.prgm-view-all').each(function() {
                if ($j(this).next().find('.slick-arrow').length <= 0) {
                    $j(this).hide();
                } else {
                    $j(this).show();
                }
            });
        }, 200);
    }

    /*--  Hide view all button for tabs modules if tabs less than 3 ends  --*/

    /*--------- Trust module --------*/
    if ($j(window).width <= 991) {
        $j(document).off("click", ".trust-wrapper .trust-box .trust-box-inner");
        $j(document).on("click", ".trust-wrapper .trust-box .trust-box-inner", function() {
            if ($j(this).hasClass('active')) {
                $j(this).removeClass('active').next().slideUp();
            } else {
                $j(this).addClass('active').next().slideDown();
            }
            return false;
        });
    } else {
        $j(document).off("click", ".trust-wrapper .trust-box .trust-box-inner");
    }
    /*--------- Trust module ends --------*/

    /*--------- Video module --------*/

    /*if ($j('.img-cnt-on-img-with-video .img-cnt-on-img-content .img-cnt-txt').length > 0) {

          $j('.img-cnt-on-img.img-cnt-on-img-with-video').each(function() {

              var vdoCntHt = $j(this).find('.img-cnt-on-img-content .img-cnt-txt').outerHeight();
              //console.log(vdoCntHt);
              var vdoImgHt = $j(this).find('.img-cnt-img').outerHeight();
              //console.log(vdoImgHt);
              $j(this).find('.img-cnt-on-img-content .img-cnt-txt').css('margin-top', (vdoImgHt / 2) - (vdoCntHt / 2) + 15);

          });
      }*/

    /*-------- Flickr module -------------*/

    setTimeout(function() {
        $j('.scrollable-container #finalFlicker.slick-initialized').slick('unslick');
        slider_call('false');
        $j('.scrollable-container .fw-flickr').height('auto');


        $j('.scrollable-container #finalFlicker').on('afterChange', function(event, slick, currentSlide, nextSlide) {
            $j('.scrollable-container .flicker-module-section .fw-sld-wrapper,.scrollable-container .flicker-module-section .fw-sld-wrapper .slick-list').height($j('.scrollable-container .flicker-module-section .fw-sld-wrapper ul div.slick-track').outerHeight());
        });

    }, 1000);

    /*------------------- New Tabbed Video Start -------------------*/

    var flag_fullscreen_Fw = false;
    $j('.tabbed-vid-img-inner .margin-top-video-player').each(function() {
        $j(this).find('.inv_playerContainer').InvPlayer({
            onPlayerResize: function(mode) {
                if (mode == "fullscreen") {
                    $j('.inv_FullScreen').on('touchmove', function(e) {
                        e.preventDefault();
                    });
                    var stickyNavWrapHt1 = $j('.stickyNavWrap').outerHeight();
                    var off_top1 = $j('.inv_videoPlaying').closest('div').offset().top - stickyNavWrapHt1;
                    //console.log(off_top1);
                    setTimeout(function() {
                        $j('html, body').scrollTop(off_top1);
                        flag_fullscreen_Fw = true;
                    }, 200);
                } else {
                    $j('.inv_videoReady').unbind('touchmove');
                }
                if (flag_fullscreen_Fw == true) {
                    var stickyNavWrapHt2 = $j('.stickyNavWrap').outerHeight();
                    var off_top2 = $j('.inv_videoPlaying').closest('div').offset().top - stickyNavWrapHt2;
                    //console.log(off_top2);
                    setTimeout(function() {
                        $j('html, body').scrollTop(off_top2);
                        flag_fullscreen_Fw = false;
                    }, 200);
                }
            }

        });
    });

    /*------------------- New Tabbed Video End -------------------*/


    /* $j('.fw-global-signpost-wrapper .hsp-main a').each(function(){
    	if($j(this).attr('href').indexOf('our-stories') < 0){
      	$j(this).attr('target',"_blank");
          $j(this).attr('title',"Opens in a new window");
      }
    }); */



    /*----------------- Module Addresses starts -------------------*/

    if ($j(window).width() <= 767) {
        $j('.fw-adrs-box-wrap').each(function() {
            if ($j(this).find('.fw-adrs-box').length > 1) {
                $j('.fw-adrs-box-wrap').not('.slick-initialized').slick({
                    responsive: [{
                        breakpoint: 767,
                        settings: {
                            infinite: false,
                            prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                            nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                            speed: 300,
                            slidesToShow: 1,
                            slidesToScroll: 1,
                            dots: true
                        }
                    }]
                });
            }
        });

        slider_arrows_adjust('.fw-adrs-box-wrap');
    }
    if ($j(window).width() > 767) {
        if ($j('.fw-adrs-box-wrap.slick-initialized').length > 0) {
            $j('.fw-adrs-box-wrap.slick-initialized').slick('unslick');
        }
    }

    /*----------------- Module Addresses ends -------------------*/


    setTimeout(function() {
        $j('.story-popup-wrapper .fw-module-global-signpost .hsp-main').css('height', 'auto');
        $j('.story-popup-wrapper .fw-module-global-signpost .hsp-img').css('height', 'auto');
        $j('.story-popup-wrapper .fw-module-global-signpost').each(function() {
            setEqualHeight_CommonClass($j(this).find('.hsp-img'));
            setEqualHeight_CommonClass($j(this).find('.hsp-main'));
        });
    }, 1000);


    $j('.fw-tabbed-wrap-inner.fw-tabbed-list-wrap-inner').css('height', 'auto');
    $j('.fw-tabbed-wrap-inner.fw-tabbed-list-wrap-inner').css('overflow', 'visible');


    if ($j('.banner-cnt-right .home-content-fw-inner').length > 0) {
        if (viewport1().width > 991) {
            $j('.banner-cnt-right .home-content-fw-inner').css('right', $j('#logo').offset().left);
        }
    }


    /*====================Progressive Disclosure Starts===================*/
    var productdivs = $j(".updateChanges > div:not(.whiteBG,.pd-box-wrapper)");
    for (var i = 0; i < productdivs.length; i += 4) {
        productdivs.slice(i, i + 4).wrapAll('<div class="pd-box-wrapper clearfix"></div>');
    }

    $j('.pd-box-wrapper').each(function() {
        if ($j(this).find('.pd-box-snapdown-click').length < 2) {
            $j(this).addClass('pd-make-center');
        }
        if ($j(this).find('.pd-box-snapdown-click').length < 3) {
            $j(this).addClass('pd-make-center-two');

        }

    });
}




$j(window).resize(function() {

    if ($j(window).width() > '767') {
        $j('.scrollable-container').height($j(window).innerHeight() - 100);
    } else {
        $j('.scrollable-container').height($j(window).innerHeight() - 60);
    }


    $j('.downloads-contacts-wrapper').each(function() {
        setEqualHeight_CommonClass($j(this).find('.equal-height'));
    });

    setEqualHeight_CommonClass('.insights-mid-fw .hsp-main');
});


/*---------- IE9 support for css3 scale starts --------------*/

(function($j) {
    function initData($el) {
        var _ARS_data = $el.data('_ARS_data');
        if (!_ARS_data) {
            _ARS_data = {
                rotateUnits: 'deg',
                scale: 1,
                rotate: 0
            };

            $el.data('_ARS_data', _ARS_data);
        }

        return _ARS_data;
    }

    function setTransform($el, data) {
        $el.css('transform', 'rotate(' + data.rotate + data.rotateUnits + ') scale(' + data.scale + ',' + data.scale + ')');
    }

    $j.fn.rotate = function(val) {
        var $self = $j(this),
            m, data = initData($self);

        if (typeof val == 'undefined') {
            return data.rotate + data.rotateUnits;
        }

        m = val.toString().match(/^(-?\d+(\.\d+)?)(.+)?$/);
        if (m) {
            if (m[3]) {
                data.rotateUnits = m[3];
            }

            data.rotate = m[1];

            setTransform($self, data);
        }

        return this;
    };

    $j.fn.scale = function(val) {
        var $self = $j(this),
            data = initData($self);

        if (typeof val == 'undefined') {
            return data.scale;
        }

        data.scale = val;

        setTransform($self, data);

        return this;
    };
    var curProxied = $j.fx.prototype.cur;
    $j.fx.prototype.cur = function() {
        if (this.prop == 'rotate') {
            return parseFloat($j(this.elem).rotate());

        } else if (this.prop == 'scale') {
            return parseFloat($j(this.elem).scale());
        }

        return curProxied.apply(this, arguments);
    };

    $j.fx.step.rotate = function(fx) {
        var data = initData($j(fx.elem));
        $j(fx.elem).rotate(fx.now + data.rotateUnits);
    };

    $j.fx.step.scale = function(fx) {
        $j(fx.elem).scale(fx.now);
    };

    var animateProxied = $j.fn.animate;
    $j.fn.animate = function(prop) {
        if (typeof prop['rotate'] != 'undefined') {
            var $self, data, m = prop['rotate'].toString().match(/^(([+-]=)?(-?\d+(\.\d+)?))(.+)?$/);
            if (m && m[5]) {
                $self = $j(this);
                data = initData($self);
                data.rotateUnits = m[5];
            }

            prop['rotate'] = m[1];
        }

        return animateProxied.apply(this, arguments);
    };
})($j);

/*---------- IE9 support for css3 scale ends --------------*/

/*---------- Get scrollbar width starts --------------*/

function getScrollbarWidth() {
    var outer = document.createElement("div");
    outer.style.visibility = "hidden";
    outer.style.width = "100px";
    document.body.appendChild(outer);

    var widthNoScroll = outer.offsetWidth;
    // force scrollbars
    outer.style.overflow = "scroll";


    // add innerdiv
    var inner = document.createElement("div");
    inner.style.width = "100%";
    outer.appendChild(inner);

    var widthWithScroll = inner.offsetWidth;

    // remove divs
    outer.parentNode.removeChild(outer);

    return widthNoScroll - widthWithScroll;
}

/*---------- Get scrollbar width ends --------------*/

/*---------- Deeplinking for dynamic module title link starts ----------*/

$j('.popup-story-module .fw-section-ttl a').click(function() {
    if ($j(this).closest('.popup-story-module').find('.link-filters')[0]) {
        localStorage.setItem('link_filters', $j(this).closest('.popup-story-module').find('.link-filters').text());


        //$j('.desk-tab-with-icon-normal li a#'+localStorage.getItem('storeTABid')).trigger('click');

    }
});

/*---------- Deeplinking for dynamic module title link ends ----------*/

$j(document).ajaxComplete(function() {
    //$j('.desk-tab-with-icon-normal li a#'+localStorage.getItem('storeTABid')).trigger('click');
    //e.preventDefault();
});

//alert(localStorage.getItem('storeTABid'));

/*!---- magnefic-popup-----*/
/*! Magnific Popup - v0.9.9 - 2013-12-27
 * http://dimsemenov.com/plugins/magnific-popup/
 * Copyright (c) 2013 Dmitry Semenov; */
;
(function($j) {

    /*>>core*/
    /**
     * 
     * Magnific Popup Core JS file
     * 
     */


    /**
     * Private static constants
     */
    var CLOSE_EVENT = 'Close',
        BEFORE_CLOSE_EVENT = 'BeforeClose',
        AFTER_CLOSE_EVENT = 'AfterClose',
        BEFORE_APPEND_EVENT = 'BeforeAppend',
        MARKUP_PARSE_EVENT = 'MarkupParse',
        OPEN_EVENT = 'Open',
        CHANGE_EVENT = 'Change',
        NS = 'mfp',
        EVENT_NS = '.' + NS,
        READY_CLASS = 'mfp-ready',
        REMOVING_CLASS = 'mfp-removing',
        PREVENT_CLOSE_CLASS = 'mfp-prevent-close';


    /**
     * Private vars 
     */
    var mfp, // As we have only one instance of MagnificPopup object, we define it locally to not to use 'this'
        MagnificPopup = function() {},
        _isJQ = !!(window.$j),
        _prevStatus,
        _window = $j(window),
        _body,
        _document,
        _prevContentType,
        _wrapClasses,
        _currPopupType;


    /**
     * Private functions
     */
    var _mfpOn = function(name, f) {
            mfp.ev.on(NS + name + EVENT_NS, f);
        },
        _getEl = function(className, appendTo, html, raw) {
            var el = document.createElement('div');
            el.className = 'mfp-' + className;
            if (html) {
                el.innerHTML = html;
            }
            if (!raw) {
                el = $j(el);
                if (appendTo) {
                    el.appendTo(appendTo);
                }
            } else if (appendTo) {
                appendTo.appendChild(el);
            }
            return el;
        },
        _mfpTrigger = function(e, data) {
            mfp.ev.triggerHandler(NS + e, data);

            if (mfp.st.callbacks) {
                // converts "mfpEventName" to "eventName" callback and triggers it if it's present
                e = e.charAt(0).toLowerCase() + e.slice(1);
                if (mfp.st.callbacks[e]) {
                    mfp.st.callbacks[e].apply(mfp, $j.isArray(data) ? data : [data]);
                }
            }
        },
        _getCloseBtn = function(type) {
            if (type !== _currPopupType || !mfp.currTemplate.closeBtn) {
                mfp.currTemplate.closeBtn = $j(mfp.st.closeMarkup.replace('%title%', mfp.st.tClose));
                _currPopupType = type;
            }
            return mfp.currTemplate.closeBtn;
        },
        // Initialize Magnific Popup only when called at least once
        _checkInstance = function() {
            if (!$j.magnificPopup.instance) {
                mfp = new MagnificPopup();
                mfp.init();
                $j.magnificPopup.instance = mfp;
            }
        },
        // CSS transition detection, http://stackoverflow.com/questions/7264899/detect-css-transitions-using-javascript-and-without-modernizr
        supportsTransitions = function() {
            var s = document.createElement('p').style, // 's' for style. better to create an element if body yet to exist
                v = ['ms', 'O', 'Moz', 'Webkit']; // 'v' for vendor

            if (s['transition'] !== undefined) {
                return true;
            }

            while (v.length) {
                if (v.pop() + 'Transition' in s) {
                    return true;
                }
            }

            return false;
        };



    /**
     * Public functions
     */
    MagnificPopup.prototype = {

        constructor: MagnificPopup,

        /**
         * Initializes Magnific Popup plugin. 
         * This function is triggered only once when $j.fn.magnificPopup or $j.magnificPopup is executed
         */
        init: function() {
            var appVersion = navigator.appVersion;
            mfp.isIE7 = appVersion.indexOf("MSIE 7.") !== -1;
            mfp.isIE8 = appVersion.indexOf("MSIE 8.") !== -1;
            mfp.isLowIE = mfp.isIE7 || mfp.isIE8;
            mfp.isAndroid = (/android/gi).test(appVersion);
            mfp.isIOS = (/iphone|ipad|ipod/gi).test(appVersion);
            mfp.supportsTransition = supportsTransitions();

            // We disable fixed positioned lightbox on devices that don't handle it nicely.
            // If you know a better way of detecting this - let me know.
            mfp.probablyMobile = (mfp.isAndroid || mfp.isIOS || /(Opera Mini)|Kindle|webOS|BlackBerry|(Opera Mobi)|(Windows Phone)|IEMobile/i.test(navigator.userAgent));
            _document = $j(document);

            mfp.popupsCache = {};
        },

        /**
         * Opens popup
         * @param  data [description]
         */
        open: function(data) {

            if (!_body) {
                _body = $j(document.body);
            }

            var i;

            if (data.isObj === false) {
                // convert jQuery collection to array to avoid conflicts later
                mfp.items = data.items.toArray();

                mfp.index = 0;
                var items = data.items,
                    item;
                for (i = 0; i < items.length; i++) {
                    item = items[i];
                    if (item.parsed) {
                        item = item.el[0];
                    }
                    if (item === data.el[0]) {
                        mfp.index = i;
                        break;
                    }
                }
            } else {
                mfp.items = $j.isArray(data.items) ? data.items : [data.items];
                mfp.index = data.index || 0;
            }

            // if popup is already opened - we just update the content
            if (mfp.isOpen) {
                mfp.updateItemHTML();
                return;
            }

            mfp.types = [];
            _wrapClasses = '';
            if (data.mainEl && data.mainEl.length) {
                mfp.ev = data.mainEl.eq(0);
            } else {
                mfp.ev = _document;
            }

            if (data.key) {
                if (!mfp.popupsCache[data.key]) {
                    mfp.popupsCache[data.key] = {};
                }
                mfp.currTemplate = mfp.popupsCache[data.key];
            } else {
                mfp.currTemplate = {};
            }



            mfp.st = $j.extend(true, {}, $j.magnificPopup.defaults, data);
            mfp.fixedContentPos = mfp.st.fixedContentPos === 'auto' ? !mfp.probablyMobile : mfp.st.fixedContentPos;

            if (mfp.st.modal) {
                mfp.st.closeOnContentClick = false;
                mfp.st.closeOnBgClick = false;
                mfp.st.showCloseBtn = false;
                mfp.st.enableEscapeKey = false;
            }


            // Building markup
            // main containers are created only once
            if (!mfp.bgOverlay) {

                // Dark overlay
                mfp.bgOverlay = _getEl('bg').on('click' + EVENT_NS, function() {
                    mfp.close();
                });

                mfp.wrap = _getEl('wrap').attr('tabindex', -1).on('click' + EVENT_NS, function(e) {
                    if (mfp._checkIfClose(e.target)) {
                        mfp.close();
                    }
                });

                mfp.container = _getEl('container', mfp.wrap);
            }

            mfp.contentContainer = _getEl('content');
            if (mfp.st.preloader) {
                mfp.preloader = _getEl('preloader', mfp.container, mfp.st.tLoading);
            }


            // Initializing modules
            var modules = $j.magnificPopup.modules;
            for (i = 0; i < modules.length; i++) {
                var n = modules[i];
                n = n.charAt(0).toUpperCase() + n.slice(1);
                mfp['init' + n].call(mfp);
            }
            _mfpTrigger('BeforeOpen');


            if (mfp.st.showCloseBtn) {
                // Close button
                if (!mfp.st.closeBtnInside) {
                    mfp.wrap.append(_getCloseBtn());
                } else {
                    _mfpOn(MARKUP_PARSE_EVENT, function(e, template, values, item) {
                        values.close_replaceWith = _getCloseBtn(item.type);
                    });
                    _wrapClasses += ' mfp-close-btn-in';
                }
            }

            if (mfp.st.alignTop) {
                _wrapClasses += ' mfp-align-top';
            }



            if (mfp.fixedContentPos) {
                mfp.wrap.css({
                    overflow: mfp.st.overflowY,
                    overflowX: 'hidden',
                    overflowY: mfp.st.overflowY
                });
            } else {
                mfp.wrap.css({
                    top: _window.scrollTop(),
                    position: 'absolute'
                });
            }
            if (mfp.st.fixedBgPos === false || (mfp.st.fixedBgPos === 'auto' && !mfp.fixedContentPos)) {
                mfp.bgOverlay.css({
                    height: _document.height(),
                    position: 'absolute'
                });
            }



            if (mfp.st.enableEscapeKey) {
                // Close on ESC key
                _document.on('keyup' + EVENT_NS, function(e) {
                    if (e.keyCode === 27) {
                        mfp.close();
                    }
                });
            }

            _window.on('resize' + EVENT_NS, function() {
                mfp.updateSize();
            });


            if (!mfp.st.closeOnContentClick) {
                _wrapClasses += ' mfp-auto-cursor';
            }

            if (_wrapClasses)
                mfp.wrap.addClass(_wrapClasses);


            // this triggers recalculation of layout, so we get it once to not to trigger twice
            var windowHeight = mfp.wH = _window.height();


            var windowStyles = {};

            if (mfp.fixedContentPos) {
                if (mfp._hasScrollBar(windowHeight)) {
                    var s = mfp._getScrollbarSize();
                    if (s) {
                        windowStyles.marginRight = s;
                    }
                }
            }

            if (mfp.fixedContentPos) {
                if (!mfp.isIE7) {
                    windowStyles.overflow = 'hidden';
                } else {
                    // ie7 double-scroll bug
                    $j('body, html').css('overflow', 'hidden');
                }
            }



            var classesToadd = mfp.st.mainClass;
            if (mfp.isIE7) {
                classesToadd += ' mfp-ie7';
            }
            if (classesToadd) {
                mfp._addClassToMFP(classesToadd);
            }

            // add content
            mfp.updateItemHTML();

            _mfpTrigger('BuildControls');

            // remove scrollbar, add margin e.t.c
            $j('html').css(windowStyles);

            // add everything to DOM
            mfp.bgOverlay.add(mfp.wrap).prependTo(mfp.st.prependTo || _body);

            // Save last focused element
            mfp._lastFocusedEl = document.activeElement;

            // Wait for next cycle to allow CSS transition
            setTimeout(function() {

                if (mfp.content) {
                    mfp._addClassToMFP(READY_CLASS);
                    mfp._setFocus();
                } else {
                    // if content is not defined (not loaded e.t.c) we add class only for BG
                    mfp.bgOverlay.addClass(READY_CLASS);
                }

                // Trap the focus in popup
                _document.on('focusin' + EVENT_NS, mfp._onFocusIn);

            }, 16);

            mfp.isOpen = true;
            mfp.updateSize(windowHeight);
            _mfpTrigger(OPEN_EVENT);

            return data;
        },

        /**
         * Closes the popup
         */
        close: function() {
            if (!mfp.isOpen) return;
            _mfpTrigger(BEFORE_CLOSE_EVENT);

            mfp.isOpen = false;
            // for CSS3 animation
            if (mfp.st.removalDelay && !mfp.isLowIE && mfp.supportsTransition) {
                mfp._addClassToMFP(REMOVING_CLASS);
                setTimeout(function() {
                    mfp._close();
                }, mfp.st.removalDelay);
            } else {
                mfp._close();
            }
        },

        /**
         * Helper for close() function
         */
        _close: function() {
            _mfpTrigger(CLOSE_EVENT);

            var classesToRemove = REMOVING_CLASS + ' ' + READY_CLASS + ' ';

            mfp.bgOverlay.detach();
            mfp.wrap.detach();
            mfp.container.empty();

            if (mfp.st.mainClass) {
                classesToRemove += mfp.st.mainClass + ' ';
            }

            mfp._removeClassFromMFP(classesToRemove);

            if (mfp.fixedContentPos) {
                var windowStyles = {
                    marginRight: ''
                };
                if (mfp.isIE7) {
                    $j('body, html').css('overflow', '');
                } else {
                    windowStyles.overflow = '';
                }
                $j('html').css(windowStyles);
            }

            _document.off('keyup' + EVENT_NS + ' focusin' + EVENT_NS);
            mfp.ev.off(EVENT_NS);

            // clean up DOM elements that aren't removed
            mfp.wrap.attr('class', 'mfp-wrap').removeAttr('style');
            mfp.bgOverlay.attr('class', 'mfp-bg');
            mfp.container.attr('class', 'mfp-container');

            // remove close button from target element
            if (mfp.st.showCloseBtn &&
                (!mfp.st.closeBtnInside || mfp.currTemplate[mfp.currItem.type] === true)) {
                if (mfp.currTemplate.closeBtn)
                    mfp.currTemplate.closeBtn.detach();
            }


            if (mfp._lastFocusedEl) {
                $j(mfp._lastFocusedEl).focus(); // put tab focus back
            }
            mfp.currItem = null;
            mfp.content = null;
            mfp.currTemplate = null;
            mfp.prevHeight = 0;

            _mfpTrigger(AFTER_CLOSE_EVENT);
        },

        updateSize: function(winHeight) {

            if (mfp.isIOS) {
                // fixes iOS nav bars https://github.com/dimsemenov/Magnific-Popup/issues/2
                var zoomLevel = document.documentElement.clientWidth / window.innerWidth;
                var height = window.innerHeight * zoomLevel;
                mfp.wrap.css('height', height);
                mfp.wH = height;
            } else {
                mfp.wH = winHeight || _window.height();
            }
            // Fixes #84: popup incorrectly positioned with position:relative on body
            if (!mfp.fixedContentPos) {
                mfp.wrap.css('height', mfp.wH);
            }

            _mfpTrigger('Resize');

        },

        /**
         * Set content of popup based on current index
         */
        updateItemHTML: function() {
            var item = mfp.items[mfp.index];

            // Detach and perform modifications
            mfp.contentContainer.detach();

            if (mfp.content)
                mfp.content.detach();

            if (!item.parsed) {
                item = mfp.parseEl(mfp.index);
            }

            var type = item.type;

            _mfpTrigger('BeforeChange', [mfp.currItem ? mfp.currItem.type : '', type]);
            // BeforeChange event works like so:
            // _mfpOn('BeforeChange', function(e, prevType, newType) { });

            mfp.currItem = item;





            if (!mfp.currTemplate[type]) {
                var markup = mfp.st[type] ? mfp.st[type].markup : false;

                // allows to modify markup
                _mfpTrigger('FirstMarkupParse', markup);

                if (markup) {
                    mfp.currTemplate[type] = $j(markup);
                } else {
                    // if there is no markup found we just define that template is parsed
                    mfp.currTemplate[type] = true;
                }
            }

            if (_prevContentType && _prevContentType !== item.type) {
                mfp.container.removeClass('mfp-' + _prevContentType + '-holder');
            }

            var newContent = mfp['get' + type.charAt(0).toUpperCase() + type.slice(1)](item, mfp.currTemplate[type]);
            mfp.appendContent(newContent, type);

            item.preloaded = true;

            _mfpTrigger(CHANGE_EVENT, item);
            _prevContentType = item.type;

            // Append container back after its content changed
            mfp.container.prepend(mfp.contentContainer);

            _mfpTrigger('AfterChange');
        },


        /**
         * Set HTML content of popup
         */
        appendContent: function(newContent, type) {
            mfp.content = newContent;

            if (newContent) {
                if (mfp.st.showCloseBtn && mfp.st.closeBtnInside &&
                    mfp.currTemplate[type] === true) {
                    // if there is no markup, we just append close button element inside
                    if (!mfp.content.find('.mfp-close').length) {
                        mfp.content.append(_getCloseBtn());
                    }
                } else {
                    mfp.content = newContent;
                }
            } else {
                mfp.content = '';
            }

            _mfpTrigger(BEFORE_APPEND_EVENT);
            mfp.container.addClass('mfp-' + type + '-holder');

            mfp.contentContainer.append(mfp.content);
        },




        /**
         * Creates Magnific Popup data object based on given data
         * @param  {int} index Index of item to parse
         */
        parseEl: function(index) {
            var item = mfp.items[index],
                type;

            if (item.tagName) {
                item = {
                    el: $j(item)
                };
            } else {
                type = item.type;
                item = {
                    data: item,
                    src: item.src
                };
            }

            if (item.el) {
                var types = mfp.types;

                // check for 'mfp-TYPE' class
                for (var i = 0; i < types.length; i++) {
                    if (item.el.hasClass('mfp-' + types[i])) {
                        type = types[i];
                        break;
                    }
                }

                item.src = item.el.attr('data-mfp-src');
                if (!item.src) {
                    item.src = item.el.attr('href');
                }
            }

            item.type = type || mfp.st.type || 'inline';
            item.index = index;
            item.parsed = true;
            mfp.items[index] = item;
            _mfpTrigger('ElementParse', item);

            return mfp.items[index];
        },


        /**
         * Initializes single popup or a group of popups
         */
        addGroup: function(el, options) {
            var eHandler = function(e) {
                e.mfpEl = this;
                mfp._openClick(e, el, options);
            };

            if (!options) {
                options = {};
            }

            var eName = 'click.magnificPopup';
            options.mainEl = el;

            if (options.items) {
                options.isObj = true;
                el.off(eName).on(eName, eHandler);
            } else {
                options.isObj = false;
                if (options.delegate) {
                    el.off(eName).on(eName, options.delegate, eHandler);
                } else {
                    options.items = el;
                    el.off(eName).on(eName, eHandler);
                }
            }
        },
        _openClick: function(e, el, options) {
            var midClick = options.midClick !== undefined ? options.midClick : $j.magnificPopup.defaults.midClick;


            if (!midClick && (e.which === 2 || e.ctrlKey || e.metaKey)) {
                return;
            }

            var disableOn = options.disableOn !== undefined ? options.disableOn : $j.magnificPopup.defaults.disableOn;

            if (disableOn) {
                if ($j.isFunction(disableOn)) {
                    if (!disableOn.call(mfp)) {
                        return true;
                    }
                } else { // else it's number
                    if (_window.width() < disableOn) {
                        return true;
                    }
                }
            }

            if (e.type) {
                e.preventDefault();

                // This will prevent popup from closing if element is inside and popup is already opened
                if (mfp.isOpen) {
                    e.stopPropagation();
                }
            }


            options.el = $j(e.mfpEl);
            if (options.delegate) {
                options.items = el.find(options.delegate);
            }
            mfp.open(options);
        },


        /**
         * Updates text on preloader
         */
        updateStatus: function(status, text) {

            if (mfp.preloader) {
                if (_prevStatus !== status) {
                    mfp.container.removeClass('mfp-s-' + _prevStatus);
                }

                if (!text && status === 'loading') {
                    text = mfp.st.tLoading;
                }

                var data = {
                    status: status,
                    text: text
                };
                // allows to modify status
                _mfpTrigger('UpdateStatus', data);

                status = data.status;
                text = data.text;

                mfp.preloader.html(text);

                mfp.preloader.find('a').on('click', function(e) {
                    e.stopImmediatePropagation();
                });

                mfp.container.addClass('mfp-s-' + status);
                _prevStatus = status;
            }
        },


        /*
        	"Private" helpers that aren't private at all
         */
        // Check to close popup or not
        // "target" is an element that was clicked
        _checkIfClose: function(target) {

            if ($j(target).hasClass(PREVENT_CLOSE_CLASS)) {
                return;
            }

            var closeOnContent = mfp.st.closeOnContentClick;
            var closeOnBg = mfp.st.closeOnBgClick;

            if (closeOnContent && closeOnBg) {
                return true;
            } else {

                // We close the popup if click is on close button or on preloader. Or if there is no content.
                if (!mfp.content || $j(target).hasClass('mfp-close') || (mfp.preloader && target === mfp.preloader[0])) {
                    return true;
                }

                // if click is outside the content
                if ((target !== mfp.content[0] && !$j.contains(mfp.content[0], target))) {
                    if (closeOnBg) {
                        // last check, if the clicked element is in DOM, (in case it's removed onclick)
                        if ($j.contains(document, target)) {
                            return true;
                        }
                    }
                } else if (closeOnContent) {
                    return true;
                }

            }
            return false;
        },
        _addClassToMFP: function(cName) {
            mfp.bgOverlay.addClass(cName);
            mfp.wrap.addClass(cName);
        },
        _removeClassFromMFP: function(cName) {
            this.bgOverlay.removeClass(cName);
            mfp.wrap.removeClass(cName);
        },
        _hasScrollBar: function(winHeight) {
            return ((mfp.isIE7 ? _document.height() : document.body.scrollHeight) > (winHeight || _window.height()));
        },
        _setFocus: function() {
            (mfp.st.focus ? mfp.content.find(mfp.st.focus).eq(0) : mfp.wrap).focus();
        },
        _onFocusIn: function(e) {
            if (e.target !== mfp.wrap[0] && !$j.contains(mfp.wrap[0], e.target)) {
                mfp._setFocus();
                return false;
            }
        },
        _parseMarkup: function(template, values, item) {
            var arr;
            if (item.data) {
                values = $j.extend(item.data, values);
            }
            _mfpTrigger(MARKUP_PARSE_EVENT, [template, values, item]);

            $j.each(values, function(key, value) {
                if (value === undefined || value === false) {
                    return true;
                }
                arr = key.split('_');
                if (arr.length > 1) {
                    var el = template.find(EVENT_NS + '-' + arr[0]);

                    if (el.length > 0) {
                        var attr = arr[1];
                        if (attr === 'replaceWith') {
                            if (el[0] !== value[0]) {
                                el.replaceWith(value);
                            }
                        } else if (attr === 'img') {
                            if (el.is('img')) {
                                el.attr('src', value);
                            } else {
                                el.replaceWith('<img src="' + value + '" class="' + el.attr('class') + '" />');
                            }
                        } else {
                            el.attr(arr[1], value);
                        }
                    }

                } else {
                    template.find(EVENT_NS + '-' + key).html(value);
                }
            });
        },

        _getScrollbarSize: function() {
            // thx David
            if (mfp.scrollbarSize === undefined) {
                var scrollDiv = document.createElement("div");
                scrollDiv.id = "mfp-sbm";
                scrollDiv.style.cssText = 'width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;';
                document.body.appendChild(scrollDiv);
                mfp.scrollbarSize = scrollDiv.offsetWidth - scrollDiv.clientWidth;
                document.body.removeChild(scrollDiv);
            }
            return mfp.scrollbarSize;
        }

    }; /* MagnificPopup core prototype end */




    /**
     * Public static functions
     */
    $j.magnificPopup = {
        instance: null,
        proto: MagnificPopup.prototype,
        modules: [],

        open: function(options, index) {
            _checkInstance();

            if (!options) {
                options = {};
            } else {
                options = $j.extend(true, {}, options);
            }


            options.isObj = true;
            options.index = index || 0;
            return this.instance.open(options);
        },

        close: function() {
            return $j.magnificPopup.instance && $j.magnificPopup.instance.close();
        },

        registerModule: function(name, module) {
            if (module.options) {
                $j.magnificPopup.defaults[name] = module.options;
            }
            $j.extend(this.proto, module.proto);
            this.modules.push(name);
        },

        defaults: {

            // Info about options is in docs:
            // http://dimsemenov.com/plugins/magnific-popup/documentation.html#options

            disableOn: 0,

            key: null,

            midClick: false,

            mainClass: '',

            preloader: true,

            focus: '', // CSS selector of input to focus after popup is opened

            closeOnContentClick: false,

            closeOnBgClick: true,

            closeBtnInside: true,

            showCloseBtn: true,

            enableEscapeKey: true,

            modal: false,

            alignTop: false,

            removalDelay: 0,

            prependTo: null,

            fixedContentPos: 'auto',

            fixedBgPos: 'auto',

            overflowY: 'auto',

            closeMarkup: '<button title="%title%" type="button" class="mfp-close">&times;</button>',

            tClose: 'Close (Esc)',

            tLoading: 'Loading...'

        }
    };



    $j.fn.magnificPopup = function(options) {
        _checkInstance();

        var jqEl = $j(this);

        // We call some API method of first param is a string
        if (typeof options === "string") {

            if (options === 'open') {
                var items,
                    itemOpts = _isJQ ? jqEl.data('magnificPopup') : jqEl[0].magnificPopup,
                    index = parseInt(arguments[1], 10) || 0;

                if (itemOpts.items) {
                    items = itemOpts.items[index];
                } else {
                    items = jqEl;
                    if (itemOpts.delegate) {
                        items = items.find(itemOpts.delegate);
                    }
                    items = items.eq(index);
                }
                mfp._openClick({
                    mfpEl: items
                }, jqEl, itemOpts);
            } else {
                if (mfp.isOpen)
                    mfp[options].apply(mfp, Array.prototype.slice.call(arguments, 1));
            }

        } else {
            // clone options obj
            options = $j.extend(true, {}, options);

            /*
             * As Zepto doesn't support .data() method for objects 
             * and it works only in normal browsers
             * we assign "options" object directly to the DOM element. FTW!
             */
            if (_isJQ) {
                jqEl.data('magnificPopup', options);
            } else {
                jqEl[0].magnificPopup = options;
            }

            mfp.addGroup(jqEl, options);

        }
        return jqEl;
    };


    //Quick benchmark
    /*
    var start = performance.now(),
    	i,
    	rounds = 1000;

    for(i = 0; i < rounds; i++) {

    }
    console.log('Test #1:', performance.now() - start);

    start = performance.now();
    for(i = 0; i < rounds; i++) {

    }
    console.log('Test #2:', performance.now() - start);
    */


    /*>>core*/

    /*>>inline*/

    var INLINE_NS = 'inline',
        _hiddenClass,
        _inlinePlaceholder,
        _lastInlineElement,
        _putInlineElementsBack = function() {
            if (_lastInlineElement) {
                _inlinePlaceholder.after(_lastInlineElement.addClass(_hiddenClass)).detach();
                _lastInlineElement = null;
            }
        };

    $j.magnificPopup.registerModule(INLINE_NS, {
        options: {
            hiddenClass: 'hide', // will be appended with `mfp-` prefix
            markup: '',
            tNotFound: 'Content not found'
        },
        proto: {

            initInline: function() {
                mfp.types.push(INLINE_NS);

                _mfpOn(CLOSE_EVENT + '.' + INLINE_NS, function() {
                    _putInlineElementsBack();
                });
            },

            getInline: function(item, template) {

                _putInlineElementsBack();

                if (item.src) {
                    var inlineSt = mfp.st.inline,
                        el = $j(item.src);

                    if (el.length) {

                        // If target element has parent - we replace it with placeholder and put it back after popup is closed
                        var parent = el[0].parentNode;
                        if (parent && parent.tagName) {
                            if (!_inlinePlaceholder) {
                                _hiddenClass = inlineSt.hiddenClass;
                                _inlinePlaceholder = _getEl(_hiddenClass);
                                _hiddenClass = 'mfp-' + _hiddenClass;
                            }
                            // replace target inline element with placeholder
                            _lastInlineElement = el.after(_inlinePlaceholder).detach().removeClass(_hiddenClass);
                        }

                        mfp.updateStatus('ready');
                    } else {
                        mfp.updateStatus('error', inlineSt.tNotFound);
                        el = $j('<div>');
                    }

                    item.inlineElement = el;
                    return el;
                }

                mfp.updateStatus('ready');
                mfp._parseMarkup(template, {}, item);
                return template;
            }
        }
    });

    /*>>inline*/

    /*>>ajax*/
    var AJAX_NS = 'ajax',
        _ajaxCur,
        _removeAjaxCursor = function() {
            if (_ajaxCur) {
                _body.removeClass(_ajaxCur);
            }
        },
        _destroyAjaxRequest = function() {
            _removeAjaxCursor();
            if (mfp.req) {
                mfp.req.abort();
            }
        };

    $j.magnificPopup.registerModule(AJAX_NS, {

        options: {
            settings: null,
            cursor: 'mfp-ajax-cur',
            tError: '<a href="%url%">The content</a> could not be loaded.'
        },

        proto: {
            initAjax: function() {
                mfp.types.push(AJAX_NS);
                _ajaxCur = mfp.st.ajax.cursor;

                _mfpOn(CLOSE_EVENT + '.' + AJAX_NS, _destroyAjaxRequest);
                _mfpOn('BeforeChange.' + AJAX_NS, _destroyAjaxRequest);
            },
            getAjax: function(item) {

                if (_ajaxCur)
                    _body.addClass(_ajaxCur);

                mfp.updateStatus('loading');

                var opts = $j.extend({
                    url: item.src,
                    success: function(data, textStatus, jqXHR) {
                        var temp = {
                            data: data,
                            xhr: jqXHR
                        };

                        _mfpTrigger('ParseAjax', temp);

                        mfp.appendContent($j(temp.data), AJAX_NS);

                        item.finished = true;

                        _removeAjaxCursor();

                        mfp._setFocus();

                        setTimeout(function() {
                            mfp.wrap.addClass(READY_CLASS);
                        }, 16);

                        mfp.updateStatus('ready');

                        _mfpTrigger('AjaxContentAdded');
                    },
                    error: function() {
                        _removeAjaxCursor();
                        item.finished = item.loadError = true;
                        mfp.updateStatus('error', mfp.st.ajax.tError.replace('%url%', item.src));
                    }
                }, mfp.st.ajax.settings);

                mfp.req = $j.ajax(opts);

                return '';
            }
        }
    });







    /*>>ajax*/

    /*>>image*/
    var _imgInterval,
        _getTitle = function(item) {
            if (item.data && item.data.title !== undefined)
                return item.data.title;

            var src = mfp.st.image.titleSrc;

            if (src) {
                if ($j.isFunction(src)) {
                    return src.call(mfp, item);
                } else if (item.el) {
                    return item.el.attr(src) || '';
                }
            }
            return '';
        };

    $j.magnificPopup.registerModule('image', {

        options: {
            markup: '<div class="mfp-figure">' +
                '<div class="mfp-close"></div>' +
                '<figure>' +
                '<div class="mfp-img"></div>' +
                '<figcaption>' +
                '<div class="mfp-bottom-bar">' +
                '<div class="mfp-title"></div>' +
                '<div class="mfp-counter"></div>' +
                '</div>' +
                '</figcaption>' +
                '</figure>' +
                '</div>',
            cursor: 'mfp-zoom-out-cur',
            titleSrc: 'title',
            verticalFit: true,
            tError: '<a href="%url%">The image</a> could not be loaded.'
        },

        proto: {
            initImage: function() {
                var imgSt = mfp.st.image,
                    ns = '.image';

                mfp.types.push('image');

                _mfpOn(OPEN_EVENT + ns, function() {
                    if (mfp.currItem.type === 'image' && imgSt.cursor) {
                        _body.addClass(imgSt.cursor);
                    }
                });

                _mfpOn(CLOSE_EVENT + ns, function() {
                    if (imgSt.cursor) {
                        _body.removeClass(imgSt.cursor);
                    }
                    _window.off('resize' + EVENT_NS);
                });

                _mfpOn('Resize' + ns, mfp.resizeImage);
                if (mfp.isLowIE) {
                    _mfpOn('AfterChange', mfp.resizeImage);
                }
            },
            resizeImage: function() {
                var item = mfp.currItem;
                if (!item || !item.img) return;

                if (mfp.st.image.verticalFit) {
                    var decr = 0;
                    // fix box-sizing in ie7/8
                    if (mfp.isLowIE) {
                        decr = parseInt(item.img.css('padding-top'), 10) + parseInt(item.img.css('padding-bottom'), 10);
                    }
                    item.img.css('max-height', mfp.wH - decr);
                }
            },
            _onImageHasSize: function(item) {
                if (item.img) {

                    item.hasSize = true;

                    if (_imgInterval) {
                        clearInterval(_imgInterval);
                    }

                    item.isCheckingImgSize = false;

                    _mfpTrigger('ImageHasSize', item);

                    if (item.imgHidden) {
                        if (mfp.content)
                            mfp.content.removeClass('mfp-loading');

                        item.imgHidden = false;
                    }

                }
            },

            /**
             * Function that loops until the image has size to display elements that rely on it asap
             */
            findImageSize: function(item) {

                var counter = 0,
                    img = item.img[0],
                    mfpSetInterval = function(delay) {

                        if (_imgInterval) {
                            clearInterval(_imgInterval);
                        }
                        // decelerating interval that checks for size of an image
                        _imgInterval = setInterval(function() {
                            if (img.naturalWidth > 0) {
                                mfp._onImageHasSize(item);
                                return;
                            }

                            if (counter > 200) {
                                clearInterval(_imgInterval);
                            }

                            counter++;
                            if (counter === 3) {
                                mfpSetInterval(10);
                            } else if (counter === 40) {
                                mfpSetInterval(50);
                            } else if (counter === 100) {
                                mfpSetInterval(500);
                            }
                        }, delay);
                    };

                mfpSetInterval(1);
            },

            getImage: function(item, template) {

                var guard = 0,

                    // image load complete handler
                    onLoadComplete = function() {
                        if (item) {
                            if (item.img[0].complete) {
                                item.img.off('.mfploader');

                                if (item === mfp.currItem) {
                                    mfp._onImageHasSize(item);

                                    mfp.updateStatus('ready');
                                }

                                item.hasSize = true;
                                item.loaded = true;

                                _mfpTrigger('ImageLoadComplete');

                            } else {
                                // if image complete check fails 200 times (20 sec), we assume that there was an error.
                                guard++;
                                if (guard < 200) {
                                    setTimeout(onLoadComplete, 100);
                                } else {
                                    onLoadError();
                                }
                            }
                        }
                    },

                    // image error handler
                    onLoadError = function() {
                        if (item) {
                            item.img.off('.mfploader');
                            if (item === mfp.currItem) {
                                mfp._onImageHasSize(item);
                                mfp.updateStatus('error', imgSt.tError.replace('%url%', item.src));
                            }

                            item.hasSize = true;
                            item.loaded = true;
                            item.loadError = true;
                        }
                    },
                    imgSt = mfp.st.image;


                var el = template.find('.mfp-img');
                if (el.length) {
                    var img = document.createElement('img');
                    img.className = 'mfp-img';
                    item.img = $j(img).on('load.mfploader', onLoadComplete).on('error.mfploader', onLoadError);
                    img.src = item.src;

                    // without clone() "error" event is not firing when IMG is replaced by new IMG
                    // TODO: find a way to avoid such cloning
                    if (el.is('img')) {
                        item.img = item.img.clone();
                    }

                    img = item.img[0];
                    if (img.naturalWidth > 0) {
                        item.hasSize = true;
                    } else if (!img.width) {
                        item.hasSize = false;
                    }
                }

                mfp._parseMarkup(template, {
                    title: _getTitle(item),
                    img_replaceWith: item.img
                }, item);

                mfp.resizeImage();

                if (item.hasSize) {
                    if (_imgInterval) clearInterval(_imgInterval);

                    if (item.loadError) {
                        template.addClass('mfp-loading');
                        mfp.updateStatus('error', imgSt.tError.replace('%url%', item.src));
                    } else {
                        template.removeClass('mfp-loading');
                        mfp.updateStatus('ready');
                    }
                    return template;
                }

                mfp.updateStatus('loading');
                item.loading = true;

                if (!item.hasSize) {
                    item.imgHidden = true;
                    template.addClass('mfp-loading');
                    mfp.findImageSize(item);
                }

                return template;
            }
        }
    });



    /*>>image*/

    /*>>zoom*/
    var hasMozTransform,
        getHasMozTransform = function() {
            if (hasMozTransform === undefined) {
                hasMozTransform = document.createElement('p').style.MozTransform !== undefined;
            }
            return hasMozTransform;
        };

    $j.magnificPopup.registerModule('zoom', {

        options: {
            enabled: false,
            easing: 'ease-in-out',
            duration: 300,
            opener: function(element) {
                return element.is('img') ? element : element.find('img');
            }
        },

        proto: {

            initZoom: function() {
                var zoomSt = mfp.st.zoom,
                    ns = '.zoom',
                    image;

                if (!zoomSt.enabled || !mfp.supportsTransition) {
                    return;
                }

                var duration = zoomSt.duration,
                    getElToAnimate = function(image) {
                        var newImg = image.clone().removeAttr('style').removeAttr('class').addClass('mfp-animated-image'),
                            transition = 'all ' + (zoomSt.duration / 1000) + 's ' + zoomSt.easing,
                            cssObj = {
                                position: 'fixed',
                                zIndex: 9999,
                                left: 0,
                                top: 0,
                                '-webkit-backface-visibility': 'hidden'
                            },
                            t = 'transition';

                        cssObj['-webkit-' + t] = cssObj['-moz-' + t] = cssObj['-o-' + t] = cssObj[t] = transition;

                        newImg.css(cssObj);
                        return newImg;
                    },
                    showMainContent = function() {
                        mfp.content.css('visibility', 'visible');
                    },
                    openTimeout,
                    animatedImg;

                _mfpOn('BuildControls' + ns, function() {
                    if (mfp._allowZoom()) {

                        clearTimeout(openTimeout);
                        mfp.content.css('visibility', 'hidden');

                        // Basically, all code below does is clones existing image, puts in on top of the current one and animated it

                        image = mfp._getItemToZoom();

                        if (!image) {
                            showMainContent();
                            return;
                        }

                        animatedImg = getElToAnimate(image);

                        animatedImg.css(mfp._getOffset());

                        mfp.wrap.append(animatedImg);

                        openTimeout = setTimeout(function() {
                            animatedImg.css(mfp._getOffset(true));
                            openTimeout = setTimeout(function() {

                                showMainContent();

                                setTimeout(function() {
                                    animatedImg.remove();
                                    image = animatedImg = null;
                                    _mfpTrigger('ZoomAnimationEnded');
                                }, 16); // avoid blink when switching images 

                            }, duration); // this timeout equals animation duration

                        }, 16); // by adding this timeout we avoid short glitch at the beginning of animation


                        // Lots of timeouts...
                    }
                });
                _mfpOn(BEFORE_CLOSE_EVENT + ns, function() {
                    if (mfp._allowZoom()) {

                        clearTimeout(openTimeout);

                        mfp.st.removalDelay = duration;

                        if (!image) {
                            image = mfp._getItemToZoom();
                            if (!image) {
                                return;
                            }
                            animatedImg = getElToAnimate(image);
                        }


                        animatedImg.css(mfp._getOffset(true));
                        mfp.wrap.append(animatedImg);
                        mfp.content.css('visibility', 'hidden');

                        setTimeout(function() {
                            animatedImg.css(mfp._getOffset());
                        }, 16);
                    }

                });

                _mfpOn(CLOSE_EVENT + ns, function() {
                    if (mfp._allowZoom()) {
                        showMainContent();
                        if (animatedImg) {
                            animatedImg.remove();
                        }
                        image = null;
                    }
                });
            },

            _allowZoom: function() {
                return mfp.currItem.type === 'image';
            },

            _getItemToZoom: function() {
                if (mfp.currItem.hasSize) {
                    return mfp.currItem.img;
                } else {
                    return false;
                }
            },

            // Get element postion relative to viewport
            _getOffset: function(isLarge) {
                var el;
                if (isLarge) {
                    el = mfp.currItem.img;
                } else {
                    el = mfp.st.zoom.opener(mfp.currItem.el || mfp.currItem);
                }

                var offset = el.offset();
                var paddingTop = parseInt(el.css('padding-top'), 10);
                var paddingBottom = parseInt(el.css('padding-bottom'), 10);
                offset.top -= ($j(window).scrollTop() - paddingTop);


                /*
			
                Animating left + top + width/height looks glitchy in Firefox, but perfect in Chrome. And vice-versa.

                 */
                var obj = {
                    width: el.width(),
                    // fix Zepto height+padding issue
                    height: (_isJQ ? el.innerHeight() : el[0].offsetHeight) - paddingBottom - paddingTop
                };

                // I hate to do this, but there is no another option
                if (getHasMozTransform()) {
                    obj['-moz-transform'] = obj['transform'] = 'translate(' + offset.left + 'px,' + offset.top + 'px)';
                } else {
                    obj.left = offset.left;
                    obj.top = offset.top;
                }
                return obj;
            }

        }
    });



    /*>>zoom*/

    /*>>iframe*/

    var IFRAME_NS = 'iframe',
        _emptyPage = '//about:blank',

        _fixIframeBugs = function(isShowing) {
            if (mfp.currTemplate[IFRAME_NS]) {
                var el = mfp.currTemplate[IFRAME_NS].find('iframe');
                if (el.length) {
                    // reset src after the popup is closed to avoid "video keeps playing after popup is closed" bug
                    if (!isShowing) {
                        el[0].src = _emptyPage;
                    }

                    // IE8 black screen bug fix
                    if (mfp.isIE8) {
                        el.css('display', isShowing ? 'block' : 'none');
                    }
                }
            }
        };

    $j.magnificPopup.registerModule(IFRAME_NS, {

        options: {
            markup: '<div class="mfp-iframe-scaler">' +
                '<div class="mfp-close"></div>' +
                '<iframe class="mfp-iframe" src="//about:blank" frameborder="0" allowfullscreen></iframe>' +
                '</div>',

            srcAction: 'iframe_src',

            // we don't care and support only one default type of URL by default
            patterns: {
                youtube: {
                    index: 'youtube.com',
                    id: 'v=',
                    src: '//www.youtube.com/embed/%id%?autoplay=1'
                },
                vimeo: {
                    index: 'vimeo.com/',
                    id: '/',
                    src: '//player.vimeo.com/video/%id%?autoplay=1'
                },
                gmaps: {
                    index: '//maps.google.',
                    src: '%id%&output=embed'
                }
            }
        },

        proto: {
            initIframe: function() {
                mfp.types.push(IFRAME_NS);

                _mfpOn('BeforeChange', function(e, prevType, newType) {
                    if (prevType !== newType) {
                        if (prevType === IFRAME_NS) {
                            _fixIframeBugs(); // iframe if removed
                        } else if (newType === IFRAME_NS) {
                            _fixIframeBugs(true); // iframe is showing
                        }
                    } // else {
                    // iframe source is switched, don't do anything
                    //}
                });

                _mfpOn(CLOSE_EVENT + '.' + IFRAME_NS, function() {
                    _fixIframeBugs();
                });
            },

            getIframe: function(item, template) {
                var embedSrc = item.src;
                var iframeSt = mfp.st.iframe;

                $j.each(iframeSt.patterns, function() {
                    if (embedSrc.indexOf(this.index) > -1) {
                        if (this.id) {
                            if (typeof this.id === 'string') {
                                embedSrc = embedSrc.substr(embedSrc.lastIndexOf(this.id) + this.id.length, embedSrc.length);
                            } else {
                                embedSrc = this.id.call(this, embedSrc);
                            }
                        }
                        embedSrc = this.src.replace('%id%', embedSrc);
                        return false; // break;
                    }
                });

                var dataObj = {};
                if (iframeSt.srcAction) {
                    dataObj[iframeSt.srcAction] = embedSrc;
                }
                mfp._parseMarkup(template, dataObj, item);

                mfp.updateStatus('ready');

                return template;
            }
        }
    });



    /*>>iframe*/

    /*>>gallery*/
    /**
     * Get looped index depending on number of slides
     */
    var _getLoopedId = function(index) {
            var numSlides = mfp.items.length;
            if (index > numSlides - 1) {
                return index - numSlides;
            } else if (index < 0) {
                return numSlides + index;
            }
            return index;
        },
        _replaceCurrTotal = function(text, curr, total) {
            return text.replace(/%curr%/gi, curr + 1).replace(/%total%/gi, total);
        };

    $j.magnificPopup.registerModule('gallery', {

        options: {
            enabled: false,
            arrowMarkup: '<button title="%title%" type="button" class="mfp-arrow mfp-arrow-%dir%"></button>',
            preload: [0, 2],
            navigateByImgClick: true,
            arrows: true,

            tPrev: 'Previous (Left arrow key)',
            tNext: 'Next (Right arrow key)',
            tCounter: '%curr% of %total%'
        },

        proto: {
            initGallery: function() {

                var gSt = mfp.st.gallery,
                    ns = '.mfp-gallery',
                    supportsFastClick = Boolean($j.fn.mfpFastClick);

                mfp.direction = true; // true - next, false - prev

                if (!gSt || !gSt.enabled) return false;

                _wrapClasses += ' mfp-gallery';

                _mfpOn(OPEN_EVENT + ns, function() {

                    if (gSt.navigateByImgClick) {
                        mfp.wrap.on('click' + ns, '.mfp-img', function() {
                            if (mfp.items.length > 1) {
                                mfp.next();
                                return false;
                            }
                        });
                    }

                    _document.on('keydown' + ns, function(e) {
                        if (e.keyCode === 37) {
                            mfp.prev();
                        } else if (e.keyCode === 39) {
                            mfp.next();
                        }
                    });
                });

                _mfpOn('UpdateStatus' + ns, function(e, data) {
                    if (data.text) {
                        data.text = _replaceCurrTotal(data.text, mfp.currItem.index, mfp.items.length);
                    }
                });

                _mfpOn(MARKUP_PARSE_EVENT + ns, function(e, element, values, item) {
                    var l = mfp.items.length;
                    values.counter = l > 1 ? _replaceCurrTotal(gSt.tCounter, item.index, l) : '';
                });

                _mfpOn('BuildControls' + ns, function() {
                    if (mfp.items.length > 1 && gSt.arrows && !mfp.arrowLeft) {
                        var markup = gSt.arrowMarkup,
                            arrowLeft = mfp.arrowLeft = $j(markup.replace(/%title%/gi, gSt.tPrev).replace(/%dir%/gi, 'left')).addClass(PREVENT_CLOSE_CLASS),
                            arrowRight = mfp.arrowRight = $j(markup.replace(/%title%/gi, gSt.tNext).replace(/%dir%/gi, 'right')).addClass(PREVENT_CLOSE_CLASS);

                        var eName = supportsFastClick ? 'mfpFastClick' : 'click';
                        arrowLeft[eName](function() {
                            mfp.prev();
                        });
                        arrowRight[eName](function() {
                            mfp.next();
                        });

                        // Polyfill for :before and :after (adds elements with classes mfp-a and mfp-b)
                        if (mfp.isIE7) {
                            _getEl('b', arrowLeft[0], false, true);
                            _getEl('a', arrowLeft[0], false, true);
                            _getEl('b', arrowRight[0], false, true);
                            _getEl('a', arrowRight[0], false, true);
                        }

                        mfp.container.append(arrowLeft.add(arrowRight));
                    }
                });

                _mfpOn(CHANGE_EVENT + ns, function() {
                    if (mfp._preloadTimeout) clearTimeout(mfp._preloadTimeout);

                    mfp._preloadTimeout = setTimeout(function() {
                        mfp.preloadNearbyImages();
                        mfp._preloadTimeout = null;
                    }, 16);
                });


                _mfpOn(CLOSE_EVENT + ns, function() {
                    _document.off(ns);
                    mfp.wrap.off('click' + ns);

                    if (mfp.arrowLeft && supportsFastClick) {
                        mfp.arrowLeft.add(mfp.arrowRight).destroyMfpFastClick();
                    }
                    mfp.arrowRight = mfp.arrowLeft = null;
                });

            },
            next: function() {
                mfp.direction = true;
                mfp.index = _getLoopedId(mfp.index + 1);
                mfp.updateItemHTML();
            },
            prev: function() {
                mfp.direction = false;
                mfp.index = _getLoopedId(mfp.index - 1);
                mfp.updateItemHTML();
            },
            goTo: function(newIndex) {
                mfp.direction = (newIndex >= mfp.index);
                mfp.index = newIndex;
                mfp.updateItemHTML();
            },
            preloadNearbyImages: function() {
                var p = mfp.st.gallery.preload,
                    preloadBefore = Math.min(p[0], mfp.items.length),
                    preloadAfter = Math.min(p[1], mfp.items.length),
                    i;

                for (i = 1; i <= (mfp.direction ? preloadAfter : preloadBefore); i++) {
                    mfp._preloadItem(mfp.index + i);
                }
                for (i = 1; i <= (mfp.direction ? preloadBefore : preloadAfter); i++) {
                    mfp._preloadItem(mfp.index - i);
                }
            },
            _preloadItem: function(index) {
                index = _getLoopedId(index);

                if (mfp.items[index].preloaded) {
                    return;
                }

                var item = mfp.items[index];
                if (!item.parsed) {
                    item = mfp.parseEl(index);
                }

                _mfpTrigger('LazyLoad', item);

                if (item.type === 'image') {
                    item.img = $j('<img class="mfp-img" />').on('load.mfploader', function() {
                        item.hasSize = true;
                    }).on('error.mfploader', function() {
                        item.hasSize = true;
                        item.loadError = true;
                        _mfpTrigger('LazyLoadError', item);
                    }).attr('src', item.src);
                }


                item.preloaded = true;
            }
        }
    });

    /*
    Touch Support that might be implemented some day

    addSwipeGesture: function() {
    	var startX,
    		moved,
    		multipleTouches;

    		return;

    	var namespace = '.mfp',
    		addEventNames = function(pref, down, move, up, cancel) {
    			mfp._tStart = pref + down + namespace;
    			mfp._tMove = pref + move + namespace;
    			mfp._tEnd = pref + up + namespace;
    			mfp._tCancel = pref + cancel + namespace;
    		};

    	if(window.navigator.msPointerEnabled) {
    		addEventNames('MSPointer', 'Down', 'Move', 'Up', 'Cancel');
    	} else if('ontouchstart' in window) {
    		addEventNames('touch', 'start', 'move', 'end', 'cancel');
    	} else {
    		return;
    	}
    	_window.on(mfp._tStart, function(e) {
    		var oE = e.originalEvent;
    		multipleTouches = moved = false;
    		startX = oE.pageX || oE.changedTouches[0].pageX;
    	}).on(mfp._tMove, function(e) {
    		if(e.originalEvent.touches.length > 1) {
    			multipleTouches = e.originalEvent.touches.length;
    		} else {
    			//e.preventDefault();
    			moved = true;
    		}
    	}).on(mfp._tEnd + ' ' + mfp._tCancel, function(e) {
    		if(moved && !multipleTouches) {
    			var oE = e.originalEvent,
    				diff = startX - (oE.pageX || oE.changedTouches[0].pageX);

    			if(diff > 20) {
    				mfp.next();
    			} else if(diff < -20) {
    				mfp.prev();
    			}
    		}
    	});
    },
    */


    /*>>gallery*/

    /*>>retina*/

    var RETINA_NS = 'retina';

    $j.magnificPopup.registerModule(RETINA_NS, {
        options: {
            replaceSrc: function(item) {
                return item.src.replace(/\.\w+$/, function(m) {
                    return '@2x' + m;
                });
            },
            ratio: 1 // Function or number.  Set to 1 to disable.
        },
        proto: {
            initRetina: function() {
                if (window.devicePixelRatio > 1) {

                    var st = mfp.st.retina,
                        ratio = st.ratio;

                    ratio = !isNaN(ratio) ? ratio : ratio();

                    if (ratio > 1) {
                        _mfpOn('ImageHasSize' + '.' + RETINA_NS, function(e, item) {
                            item.img.css({
                                'max-width': item.img[0].naturalWidth / ratio,
                                'width': '100%'
                            });
                        });
                        _mfpOn('ElementParse' + '.' + RETINA_NS, function(e, item) {
                            item.src = st.replaceSrc(item, ratio);
                        });
                    }
                }

            }
        }
    });

    /*>>retina*/

    /*>>fastclick*/
    /**
     * FastClick event implementation. (removes 300ms delay on touch devices)
     * Based on https://developers.google.com/mobile/articles/fast_buttons
     *
     * You may use it outside the Magnific Popup by calling just:
     *
     * $j('.your-el').mfpFastClick(function() {
     *     console.log('Clicked!');
     * });
     *
     * To unbind:
     * $j('.your-el').destroyMfpFastClick();
     * 
     * 
     * Note that it's a very basic and simple implementation, it blocks ghost click on the same element where it was bound.
     * If you need something more advanced, use plugin by FT Labs https://github.com/ftlabs/fastclick
     * 
     */

    (function() {
        var ghostClickDelay = 1000,
            supportsTouch = 'ontouchstart' in window,
            unbindTouchMove = function() {
                _window.off('touchmove' + ns + ' touchend' + ns);
            },
            eName = 'mfpFastClick',
            ns = '.' + eName;


        // As Zepto.js doesn't have an easy way to add custom events (like jQuery), so we implement it in this way
        $j.fn.mfpFastClick = function(callback) {

            return $j(this).each(function() {

                var elem = $j(this),
                    lock;

                if (supportsTouch) {

                    var timeout,
                        startX,
                        startY,
                        pointerMoved,
                        point,
                        numPointers;

                    elem.on('touchstart' + ns, function(e) {
                        pointerMoved = false;
                        numPointers = 1;

                        point = e.originalEvent ? e.originalEvent.touches[0] : e.touches[0];
                        startX = point.clientX;
                        startY = point.clientY;

                        _window.on('touchmove' + ns, function(e) {
                            point = e.originalEvent ? e.originalEvent.touches : e.touches;
                            numPointers = point.length;
                            point = point[0];
                            if (Math.abs(point.clientX - startX) > 10 ||
                                Math.abs(point.clientY - startY) > 10) {
                                pointerMoved = true;
                                unbindTouchMove();
                            }
                        }).on('touchend' + ns, function(e) {
                            unbindTouchMove();
                            if (pointerMoved || numPointers > 1) {
                                return;
                            }
                            lock = true;
                            e.preventDefault();
                            clearTimeout(timeout);
                            timeout = setTimeout(function() {
                                lock = false;
                            }, ghostClickDelay);
                            callback();
                        });
                    });

                }

                elem.on('click' + ns, function() {
                    if (!lock) {
                        callback();
                    }
                });
            });
        };

        $j.fn.destroyMfpFastClick = function() {
            $j(this).off('touchstart' + ns + ' click' + ns);
            if (supportsTouch) _window.off('touchmove' + ns + ' touchend' + ns);
        };
    })();

    /*>>fastclick*/
    _checkInstance();
})(window.$j || window.Zepto);

$j(document).ready(function() {
    $j('.image-gallery-container').magnificPopup({
        delegate: 'a',
        type: 'image',
        tLoading: 'Loading image #%curr%...',
        mainClass: 'mfp-img-mobile',
        gallery: {
            enabled: true,
            navigateByImgClick: true,
            preload: [0, 1] // Will preload 0 - before current, and 1 after the current image
        },
        image: {
            tError: '<a href="%url%">The image #%curr%</a> could not be loaded.',
            titleSrc: function(item) {
                return item.el.attr('title');
            }
        }
    });

    $j(".image-gallery-wrapper").each(function() {
        $j(this).magnificPopup({
            delegate: 'a',
            type: 'image',
            tLoading: 'Loading image #%curr%...',
            mainClass: 'mfp-img-mobile',
            gallery: {
                enabled: true,
                navigateByImgClick: true,
                preload: [0, 1] // Will preload 0 - before current, and 1 after the current image
            },
            image: {
                tError: '<a href="%url%">The image #%curr%</a> could not be loaded.',
                titleSrc: function(item) {
                    return item.el.attr('title');
                }
            }
        });

    });

    $j(document).on("click", ".rad-popup", function(e) {
        e.preventDefault();
        var selector = $j(this).parents(".related-link-content").siblings(".image-gallery-wrapper").children(".image-gallery-item:first-child").children(".popup-image");
        $j(selector).trigger("click");
    });

});

$j(document).ajaxComplete(function() {
    $j('.image-gallery-container').magnificPopup({
        delegate: 'a',
        type: 'image',
        tLoading: 'Loading image #%curr%...',
        mainClass: 'mfp-img-mobile',
        gallery: {
            enabled: true,
            navigateByImgClick: true,
            preload: [0, 1] // Will preload 0 - before current, and 1 after the current image
        },
        image: {
            tError: '<a href="%url%">The image #%curr%</a> could not be loaded.',
            titleSrc: function(item) {
                return item.el.attr('title');
            }
        }
    });

    $j(".image-gallery-wrapper").each(function() {
        $j(this).find('a').magnificPopup({
            type: 'image',
            tLoading: 'Loading image #%curr%...',
            mainClass: 'mfp-img-mobile',
            gallery: {
                enabled: true,
                navigateByImgClick: true,
                preload: [0, 1] // Will preload 0 - before current, and 1 after the current image
            },
            image: {
                tError: '<a href="%url%">The image #%curr%</a> could not be loaded.',
                titleSrc: function(item) {
                    return item.el.attr('title');
                }
            }
        });

    });
});

/*!---- standard-modular-page-----*/
$j(document).ready(function() {
    currWidth = $j(window).width();

    //if(currWidth < 992 && currWidth > 639){
    /* setTimeout(function(){
      
      $j(".pd-box-wrapper .pd-box-snapdown-click").each(function(){
        if ($j(this).find(".pd-box-text").height() > 200 ) {
          $j(this).height($j(this).find(".pd-box-text").height());
        } else {
          $j(this).height(170);
        }
      });
      
    }, 500);*/
    //}



});

$j(window).resize(function() {

    currWidth = $j(window).width();

    // if(currWidth < 992 && currWidth > 639){
    // setTimeout(function(){
    /*  $j(".pd-box-wrapper .pd-box-snapdown-click").each(function(){
        $j(this).height($j(this).find("img").height());
      });*/

    /*     $j(".pd-box-wrapper .pd-box-snapdown-click").each(function(){
         if ($j(this).find(".pd-box-text").height() > 200 ) {
           $j(this).height($j(this).find(".pd-box-text").height());
         } else {
           $j(this).height(170);
         }
       });
       
       }, 500);*/
    // }

});
/*!---- snapdown-----*/
$j(document).ready(function() {

    var totmod = $j(".module-tabbed-list-section-template").length;
    if ($j(".module-tabbed-list-section-template").length > 0) {

        $j('.module-tabbed-list-section-template ul.btabmenu li, .module-tabbed-list-section-template ul.tabs li').click(function() {
            var tabhash = window.location.hash;
            var hash = tabhash.substring(tabhash.indexOf('#') + 1);
            var fields = hash.split('/');
            var phash = fields[0];
            var chash = fields[1];

            var tab_id = $j(this).data("tab-id");

            if (chash === undefined) {
                window.location.hash = phash + "/" + tab_id;
            } else {
                window.location.hash = phash + "/" + tab_id;
            }

            //
        });
    }







    /*------------------ Snapdown Starts -------------------*/
    ///*
    $j(".snapdown-content").hide();




    /*$j(".btn-appendices a").click(function(e) {	
    				//$j(this).attr(href, "#");				   
    				e.preventDefault();
    		$j(".snapdown-title-container[data-hash=appendices]").click();
    });
    */

    $j(document).on('click', ".snapdown-title-container", function() {
        if ($j(this).hasClass("snapopen")) {
            $j(this).removeClass("snapopen");
            $j(this).children(".snapdown-right").html("Read More");
            $j(this).siblings(".snapdown-content").slideUp();
        } else {

            $j(this).parent().parent().find(".snapdown-title-container.snapopen").siblings(".snapdown-content").slideUp();
            $j(this).parent().parent().find(".snapdown-title-container.snapopen").children(".snapdown-right").html("Read More");
            $j(this).parent().parent().find(".snapdown-title-container.snapopen").removeClass("snapopen");
            $j(this).addClass("snapopen");
            $j(this).children(".snapdown-right").html("Read Less");
            $j(this).siblings(".snapdown-content").slideDown();
            var thisSnap = $j(this);
            setTimeout(function() {
                $j("html,body").animate({
                    scrollTop: thisSnap.offset().top
                }, "slow");
            }, 700);
        }
        //*/
    });


    $j(document).on('click', ".snapdown-clickable", function() {
        if ($j(this).hasClass("snapopen")) {
            $j(this).removeClass("snapopen");
            $j(this).parent(".banner-container").removeClass("snapopen");
            //$j(this).children(".read-more .read-more-link").text("Read More");
            $j(this).find(".read-more-link").text("Read More");
            $j(this).find(".read-more-link").removeClass("snapopen");
            $j(this).siblings(".graphical-snapdown-content").slideUp();
        } else {
            $j(".snapdown-clickable").removeClass("snapopen");
            $j(".banner-container").removeClass("snapopen");
            $j(".snapdown-clickable").siblings(".graphical-snapdown-content").slideUp();
            $j(".read-more .read-more-link").text("Read More");
            $j(".read-more .read-more-link").removeClass("snapopen");
            $j(this).addClass("snapopen");
            $j(this).parent(".banner-container").addClass("snapopen");
            $j(this).find(".read-more-link").text("Read less");

            $j(this).find(".read-more-link").addClass("snapopen");
            $j(this).siblings(".graphical-snapdown-content").slideDown();
            setTimeout(function() {
                $j("html,body").animate({
                    scrollTop: $j('.banner-container.snapopen').offset().top
                }, "slow");
            }, 700);
        }
        //*/
    });



    $j(document).on('click', ".snap-head", function(e) {
        e.preventDefault();
        if ($j(this).hasClass('open')) {
            $j(this).removeClass('open');
            $j(this).parent().removeClass('open');
            $j(this).parent().find('.snap-content').slideUp();
        } else {
            $j('.snap-head').removeClass('open');
            $j(this).addClass('open');
            $j('.snap-head').parent().removeClass('open');
            $j(this).parent().addClass('open');
            //$j(this).parent().parent().find('.snapContent').slideUp();
            $j('.snap-content').slideUp();
            $j(this).parent().find('.snap-content').slideDown();

            setTimeout(function() {
                $j("html,body").animate({
                    scrollTop: $j('.snap-head.open').offset().top
                }, "slow");
            }, 700);
        }

    });
    /*snapid = getParamVal("snapid");
    if (snapid) {
      $j('#' + snapid + " .snapdown-title").trigger('click');
      setTimeout(function () {
        $j("html,body").animate({
          scrollTop: $j('#' + snapid).offset().top
        }
                                , "slow");
      }
                 , 500);
    }*/
    /*------------------ Snapdown Ends -------------------*/
});

/*
$j(window).load(function() {
	setTimeout(function(){
    var tabhash = window.location.hash;
	var hash = tabhash.substring(tabhash.indexOf('#')+1);
	var fields = hash.split('/');
	var phash = fields[0];
	var chash = fields[1];
	
	if(chash!=='undefined')
		{
			chash = "ul.btabmenu li#"+chash;
			//console.log(chash);
			//$j(chash).trigger("click");
		}
	},2000);
});*/
/*!---- full-width-global-function-----*/
function sliderArw() {

    if ($j('.menuWrapper').length > 0) {
        setTimeout(function() {
            menuOffset = $j('.menuWrapper').offset().top;
        }, 800);
    }
    var mypflag = 0;
    var myp2flag = 0;

    /*--  Sustainability Section starts  --*/

    setTimeout(function() {
        setEqualHeight_CommonClass(".word");
    }, 200);
    setTimeout(function() {
        setEqualHeight_CommonClass(".trust-icon");
    }, 400);
    setTimeout(function() {
        setEqualHeight_CommonClass(".trust-box");
    }, 600);

    //$j(".trust-wrapper .trust-box .trust-box-inner").click(function(){

    /*--  Hide view all button for tabs modules if tabs less than 3 starts  --*/
    if (viewport1().width >= 768) {
        setTimeout(function() {
            $j('.prgm-view-all').each(function() {
                if ($j(this).next().find('.slick-arrow').length <= 0) {
                    $j(this).hide();
                } else {
                    $j(this).show();
                }
            });
        }, 200);
    }
    /*--  Hide view all button for tabs modules if tabs less than 3 ends  --*/

    if (viewport1().width <= 991) {
        $j(document).off("click", ".trust-wrapper .trust-box .trust-box-inner");
        $j(document).on("click", ".trust-wrapper .trust-box .trust-box-inner", function() {
            if ($j(this).hasClass('active')) {
                $j(this).removeClass('active').next().slideUp();
            } else {
                $j(this).addClass('active').next().slideDown();
            }
            return false;
        });
    } else {
        $j(document).off("click", ".trust-wrapper .trust-box .trust-box-inner");
    }

    $j('#country-content-container.new-site-fw .fw-text-download-and-language ul').mCustomScrollbar({
        advanced: {
            updateOnContentResize: true
        },
        mouseWheel: {
            scrollAmount: 100
        }
    });

    /*--  Module Tabs with text and downloads slider starts  --*/

    if ($j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer .fw-dwld-inner-box').length > 0) {
        if (viewport1().width > 1399) {

            if ($j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer.slick-initialized').length > 0 && myp2flag == 0) {
                $j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer.slick-initialized').slick('unslick');
                myp2flag = 1;

                $j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer').not('.slick-initialized').slick({
                    infinite: false,
                    dots: true,
                    prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                    nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                    speed: 300,
                    rows: 2,
                    slidesPerRow: 3
                });

            } else {
                $j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer').not('.slick-initialized').slick({
                    infinite: false,
                    dots: true,
                    prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                    nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                    speed: 300,
                    rows: 2,
                    slidesPerRow: 3
                });
            }
        } else {
            if ($j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer.slick-initialized').length > 0 && mypflag == 0) {
                $j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer.slick-initialized').slick('unslick');
                mypflag = 1;

                $j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer').not('.slick-initialized').slick({
                    infinite: false,
                    dots: true,
                    prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                    nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                    slidesToShow: 3,
                    slidesToScroll: 3,
                    speed: 300,
                    responsive: [{
                            breakpoint: 992,
                            settings: {
                                slidesToShow: 2,
                                slidesToScroll: 2
                            }
                        },
                        {
                            breakpoint: 768,
                            settings: {
                                slidesToShow: 1,
                                slidesToScroll: 1
                            }
                        }
                    ]
                });

            } else {
                $j('.fw-tabs-with-downloads .fw-tab-dwld-sld-outer').not('.slick-initialized').slick({
                    infinite: false,
                    dots: true,
                    prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                    nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                    slidesToShow: 3,
                    slidesToScroll: 3,
                    speed: 300,
                    responsive: [{
                            breakpoint: 992,
                            settings: {
                                slidesToShow: 2,
                                slidesToScroll: 2
                            }
                        },
                        {
                            breakpoint: 768,
                            settings: {
                                slidesToShow: 1,
                                slidesToScroll: 1
                            }
                        }
                    ]
                });
            }

        }
    }

    /*--  Module tabs with text and downloads slider ends  --*/



    /*---   Module Tabs with bullets and downloads slider starts   ---*/

    if ($j('.fw-tabs-with-bullets-and-downloads .fw-dwld-inner-box').length > 0) {
        $j('.fw-tabs-with-bullets-and-downloads .fw-tab-dwld-sld-one-row').not('.slick-initialized').slick({
            infinite: false,
            dots: true,
            prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
            nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
            slidesToShow: 3,
            slidesToScroll: 3,
            speed: 300,
            responsive: [{
                    breakpoint: 1400,
                    settings: {
                        slidesToShow: 2,
                        slidesToScroll: 2
                    }
                },
                {
                    breakpoint: 992,
                    settings: {
                        slidesToShow: 3,
                        slidesToScroll: 3
                    }
                },
                {
                    breakpoint: 768,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1
                    }
                }
            ]
        });
    }

    /*---   Module Tabs with bullets and downloads slider ends   ---*/


    /*$j('.fw-tab-sld-outer').each(function() {
          
          if($j(this).find('.slick-dots > li').length > 0){
            var totalWidth1 = 0;
            $j(this).find('.slick-dots > li').each(function() {
              totalWidth1 = totalWidth1 + $j(this).width();
            });
            var newPrevNext1 = (totalWidth1*2) + 50;      
            $j(this).find('.slick-arrow.slick-next').css('right',-(newPrevNext1));
            $j(this).find('.slick-arrow.slick-prev').css('left',-(newPrevNext1));
          }
        });*/

    setTimeout(function() {
        slider_arrows_adjust('.fw-tab-dwld-sld-outer');

        slider_arrows_adjust('.fw-tabs-with-bullets-and-downloads .fw-tab-dwld-sld-one-row ');

    }, 300);

    /*--    Sustainability section ends    --*/

    /*--  Marine starts  --*/

    if ($j('.prod-container .prod-container-inner-load .product-item').length > 0) {
        if (viewport1().width < 992) {
            $j('.prod-container .prod-container-inner-load').not('.slick-initialized').slick({
                infinite: false,
                dots: true,
                prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                slidesToShow: 2,
                slidesToScroll: 2,
                speed: 300,
                responsive: [{
                    breakpoint: 768,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1
                    }
                }]
            });
        } else {
            if ($j('.prod-container .prod-container-inner-load.slick-initialized').length > 0) {
                $j('.prod-container .prod-container-inner-load.slick-initialized').slick('unslick');
            }
        }
    }

    if ($j('.discover-items-wrapper.central-slider > div').length > 0) {
        if (viewport1().width < 768) {
            $j('.discover-items-wrapper').not('.slick-initialized').slick({
                infinite: false,
                dots: true,
                prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                slidesToShow: 2,
                slidesToScroll: 2,
                responsive: [{
                    breakpoint: 641,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1
                    }
                }],
                speed: 300
            });
        } else {
            if ($j('.discover-items-wrapper.slick-initialized').length > 0) {
                $j('.discover-items-wrapper.slick-initialized').slick('unslick');
            }
        }
    }

    /*--  Marine ends  --*/

    /*if($j('.central-slider .slick-dots li').length > 0){
      var totalWidth1 = 0;
      $j('.central-slider .slick-dots li').each(function() {
        totalWidth1 = totalWidth1 + $j(this).width();
      });
      var newPrevNext1 = (totalWidth1*2) + 50;
      
      $j('.central-slider .slick-dots').each(function(){
        if($j(this).find('li').length > 8)
        {
          $j(this).find('li').hide();
          $j(this).parent().parent().find('.slick-initialized').addClass('morethen8dots');
        }else{
          $j('.central-slider .slick-arrow.slick-next').css('right',-newPrevNext1);
          $j('.central-slider .slick-arrow.slick-prev').css('left',-(newPrevNext1-15));
        }
      });  
      
    }*/


    setTimeout(function() {
        slider_arrows_adjust('.central-slider');
    }, 200);

}

/* fullwidthresponsiveElements Start */
function fullwidthresponsiveElements() {

    /*-------- General Product listing --------*/

    $j('.prod-container .general-listing').each(function() {
        if (viewport1().width > 767) {
            if ($j(this).find('.product-item').length > 4) {

                if ($j(this).hasClass('slick-initialized')) {
                    $j(this).slick('unslick');
                }

                $j(this).not('.slick-initialized').slick({
                    infinite: false,
                    dots: true,
                    prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                    nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                    slidesToShow: 3,
                    slidesToScroll: 3,
                    speed: 300,
                    responsive: [{
                            breakpoint: 992,
                            settings: {
                                slidesToShow: 2,
                                slidesToScroll: 2,
                                dots: true
                            }
                        },
                        {
                            breakpoint: 768,
                            settings: {
                                slidesToShow: 1,
                                slidesToScroll: 1,
                                dots: true
                            }
                        }
                    ]
                });

            } else {
                $j(this).addClass('disabled-slick-space');

            }
        } else {
            if ($j(this).find('.product-item').length > 1) {
                if ($j(this).hasClass('slick-initialized')) {
                    $j(this).slick('unslick');
                }
                $j(this).not('.slick-initialized').slick({
                    infinite: false,
                    dots: true,
                    prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                    nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                    slidesToShow: 4,
                    slidesToScroll: 4,
                    speed: 300,
                    responsive: [{
                            breakpoint: 992,
                            settings: {
                                slidesToShow: 2,
                                slidesToScroll: 2,
                                dots: true
                            }
                        },
                        {
                            breakpoint: 768,
                            settings: {
                                slidesToShow: 1,
                                slidesToScroll: 1,
                                dots: true
                            }
                        }
                    ]
                });
            } else {
                $j(this).addClass('disabled-slick-space');
            }
        }
    });

    /*-------- /General Product listing --------*/

    if (viewport1().width > 767) {
        if ($j('.fw-tabbed-list-wrap-inner .fw-tabbed-wrap .tab-list .slick-arrow.slick-prev').length > 0) {
            setTimeout(function() {
                $j('.fw-tabbed-list-wrap-inner .fw-tabbed-wrap .tab-list .slick-arrow.slick-prev').trigger('click');
            }, 300);
        }
    }

    if (viewport1().width <= 767) {
        if ($j('.tab-list-content-wrapper .tab-content-main.tlsld').length > 0) {
            $j('.tab-list-content-wrapper .tab-content-main.tlsld').not('.slick-initialized').slick({
                infinite: false,
                speed: 300,
                responsive: [{
                    breakpoint: 768,
                    settings: {
                        adaptiveHeight: true,
                        touchMove: false,
                        slidesToShow: 1,
                        slidesToScroll: 1,
                        dots: true,
                        prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                        nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>"
                    }
                }]
            });
        }

        setTimeout(function() {
            //slider_arrows_adjust('.tab-list-content-wrapper .tab-content-main.tlsld');

            $j('.tab-list-content-wrapper .tab-content-main.tlsld').each(function() {

                if ($j(this).find('.slick-dots > li').length > 0) {
                    var totalWidth1 = 0;
                    $j(this).find('.slick-dots > li').each(function() {
                        totalWidth1 = totalWidth1 + $j(this).width();
                    });
                    var newPrevNext1 = (totalWidth1 * 2) + 50;
                    if (currWidth < 768) {
                        if ($j(this).find('.slick-dots > li').length > 0) {
                            $j(this).find('.slick-dots > li').hide();
                            $j(this).parent().parent().find('.slick-initialized').addClass('morethen8dots');
                            $j(this).find('.slick-arrow.slick-next').css('right', '-8px');
                            $j(this).find('.slick-arrow.slick-prev').css('left', '0');
                        } else {
                            $j(this).find('.slick-dots > li').show();
                            $j(this).parent().parent().find('.slick-initialized').removeClass('morethen8dots');
                            $j(this).find('.slick-arrow.slick-next').css('right', -(newPrevNext1 + 120));
                            $j(this).find('.slick-arrow.slick-prev').css('left', -(newPrevNext1 + 120));
                        }
                    } else {
                        $j(this).find('.slick-dots > li').show();
                        $j(this).parent().parent().find('.slick-initialized').removeClass('morethen8dots');
                        $j(this).find('.slick-arrow.slick-next').css('right', -(newPrevNext1 + 120));
                        $j(this).find('.slick-arrow.slick-prev').css('left', -(newPrevNext1 + 120));
                    }
                }

            });
        }, 200);
    }

    if (viewport1().width > 767) {
        if ($j('.tab-list-content-wrapper .tab-content-main.tlsld.slick-initialized').length > 0) {
            $j('.tab-list-content-wrapper .tab-content-main.tlsld').slick('unslick');
        }
    }

    $j('.tabs-with-icon').each(function() {
        setEqualHeight_CommonClass($j(this).find('span.menu-img'));
        setEqualHeight_CommonClass($j(this).find('span.menu-ttl'));
    });

    /*if(currWidth > 767){
      $j('.slick-initialized').removeClass('morethen8dots');
    }*/

    if (viewport1().width > 991) {
        if ($j(".career-dd").hasClass("open")) {
            $j(".career-dd.open").siblings("ul").slideUp();
            $j(".career-dd.open").removeClass("open");
        }
    } else {
        if ($j(".career-dd").hasClass("open")) {
            $j(".career-dd.open").siblings("ul").slideUp();
            $j(".career-dd.open").removeClass("open");
        }
    }


    /* Large SignPost */

    setEqualHeight_CommonClass(".fw-ls-content-wrapper");
    setEqualHeight_CommonClass(".three-signpost .ts-content");

    /* Large SignPost */

    /* Stats Module Start */
    if ($j('.fw-stats-section .max-width-stats').length > 0) {
        $j('.fw-stats-section .max-width-stats').each(function() {
            var noOfStats = $j(this).find(".fw-stats-box").length;
            $j(this).find(".fw-stats-box").outerWidth(($j(this).outerWidth() / noOfStats) + "px");
        });
    }
    /* Stats Module End */

    /* country-sites dropdown-srcollbar */
    if (viewport1().width > 992) {
        $j('#homewrapper .career-ul').mCustomScrollbar("destroy");
    }

    if (viewport1().width <= 992) {
        if ($j('#homewrapper .career-ul').length > 0) {
            $j('#homewrapper .career-ul').mCustomScrollbar({
                advanced: {
                    updateOnContentResize: true
                },
                mouseWheel: {
                    scrollAmount: 30
                }
            });
        }
    }
    /* country-sites dropdown-srcollbar */
    if (viewport1().width <= 991) {

        if ($j('body.insights-mobi-filter-active').length === 0) {
            $j('.insightscontentwrapper').attr('id', 'mobfilter');

            $j('.filter-click').slideUp('500', function() {
                $j('.insights-filter-wrap .filter-ttl-mobi').removeClass('active');
                $j('.insights-filter-wrap .filter-ttl-mobi').show();
                $j('body').removeClass('insights-mobi-filter-active');
                $j('.insights-filter-main,.filter-main').css('height', 'auto');
            });
            $j('#mobfilter .insights-filter-wrap span.filter-back').hide();
            $j('.filter-mobi-panel-text').text('Filter');
            $j('.open-mobi-selected-tags').removeClass('active');

            $j('.filter-click li').removeClass('active');
            $j('.filter-tab-content').removeClass('active');
            $j('.filter-click li').css('display', 'block');
            $j('.filter-click').css('display', 'none');
            $j('.insights-after-select-total,.filter-after-select-total').css('display', 'none');
            $j('#mobfilter .insights-filter-mobi-info span.filter-back, #mobfilter .insights-filter-mobi-info span.filter-mobi-panel-text, #mobfilter .insights-filter-mobi-info span.filter-close').css('display', 'none');
            $j('#mobfilter .insights-filter-mobi-info a.filter-ttl-mobi').css('display', 'block');
            if ($j('.insights-filter-inner-total ul li a.selected').length > 0) {
                $j('.insights-after-select-total,.filter-after-select-total').css('display', 'block');
                $j('.insights-filter-inner-total, .filter-inner-total').css('display', 'block');
                $j('.open-mobi-selected-tags').addClass('active');
                $j('.open-mobi-selected-tags').css('display', 'block');
            }
            if ($j('.filter-inner-total ul li a.selected').length > 0) {
                $j('.filter-after-select-total').css('display', 'block');
                $j('.filter-inner-total').css('display', 'block');
                $j('.open-mobi-selected-tags').addClass('active');
                $j('.open-mobi-selected-tags').css('display', 'block');
            }

        }

    }
    if (viewport1().width > 991) {
        $j('.insightscontentwrapper').attr('id', 'desktopfilter');
        $j('body').removeClass('insights-mobi-filter-active');

        $j('.filter-click').css('display', 'inline-block');
        $j('.filter-click li').css('display', 'inline-block');
        $j('.insights-filter-inner-total, .filter-inner-total').css('display', 'block');
        //$j('.clearfilter').css('display', 'inline-block');
        $j('.insights-filter-main,.filter-main').css('height', 'auto');
        $j('.open-mobi-selected-tags').css('display', 'none');

        if ($j('.insights-filter-inner-total ul li a.selected, .filter-inner-total ul li a.selected').length > 0) {
            $j('.clearALLfilter').css('display', 'inline-block');
        }

    }


    if ($j('.inv_videoPlaying').length > 0) {
        $j('.new-video-fw').each(function() {
            setTimeout(function() {
                $j(this).find('.inv_videoPlaying').css('height', $j(this).outerHeight());
            }, 200);
        });
        //$j('.inv_videoPlaying').css('height',$j('.inv_videoPlaying').parents('.new-video-fw').outerHeight());
    }
    if ($j('.tab-content-main .tab-content').length > 0) {
        if (viewport1().width > 767) {
            $j('.new-site-fw .tabs.mobi-tabs-list').mCustomScrollbar("destroy");
        }
        if (viewport1().width <= 767) {
            /* overview dropdown-srcollbar */
            if ($j('.new-site-fw .tabs.mobi-tabs-list').length > 0) {
                $j('.new-site-fw .tabs.mobi-tabs-list').mCustomScrollbar({
                    advanced: {
                        updateOnContentResize: true
                    },
                    mouseWheel: {
                        scrollAmount: 30
                    }
                });
            }
            /* overview dropdown-srcollbar */
            if (!$j('.tab-content-main .tab-content').hasClass('current')) {
                $j('.tab-content-main .tab-content').removeClass('current');
                $j('.tab-content-main .tab-content:first-child').addClass('current');
            }
        }
    }
    /*if ($j('#landing-video-player-wrapper').length > 0) {
        $j('#landing-video-player-wrapper').css('height', $j('.home-banner-fw').outerHeight());
    }*/

    $j('#landing-video-player-wrapper').each(function() {
        $j(this).css('height', $j(this).closest('.home-banner-fw').outerHeight());
    });

    setTimeout(function() {

        slider_arrows_adjust('.fw-sld-wrapper .fw-rp-sld-outer');

        slider_arrows_adjust('.fw-adrs-box-wrap');

        slider_arrows_adjust('.fw-dwld-sld-outer');

        slider_arrows_adjust('.fw-sld-outer-contact-card');

        slider_arrows_adjust('.fw-sld-outer');

    }, 500);



    /*if ($j('.fw-dwld-top').length > 0) {
        setEqualHeight_CommonClass(".fw-dwld-top");
    }*/

    $j('.fw-tab-sld-outer').each(function() {
        if ($j(this).find(".fw-dwld-top").length > 0) {
            setEqualHeight_CommonClass($j(this).find(".fw-dwld-top"));
        }
    });

    if (viewport1().width >= 768) {
        if ($j('.fw-adrs-box').length > 0) {
            setEqualHeight_CommonClass(".fw-adrs-box");
        }
    }
    if (viewport1().width <= 991) {
        $j('.home-content-fw-inner').css('margin-top', '');
    }

    /* Address Slider */
    if (viewport1().width <= 767) {
        if ($j('.fw-adrs-box-wrap .fw-adrs-box').length > 1) {
            $j('.fw-adrs-box-wrap').not('.slick-initialized').slick({
                responsive: [{
                    breakpoint: 767,
                    settings: {
                        infinite: false,
                        prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                        nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                        speed: 300,
                        slidesToShow: 1,
                        slidesToScroll: 1,
                        dots: true
                    }
                }]
            });
        }
    }
    if (viewport1().width > 767) {
        if ($j('.fw-adrs-box-wrap.slick-initialized').length > 0) {
            $j('.fw-adrs-box-wrap').slick('unslick');
        }
    }

    /* Address Slider*/

    /*if(viewport1().width <= 767){
      if($j('.do-slick.slick-initialized').length > 0){
        $j('.do-slick').slick('unslick');
      }    
    }*/

    $j('.fw-tabbed-wrap-inner.fw-tabbed-two-col .tab-list').each(function() {
        if ($j(this).find('.mobi-tabs-list li').length < 2) {
            $j(this).hide();
        }
    });

    if ($j('.stickyNavWrap .menuWrapper').length > 0) {
        if (viewport1().width < 1720) {
            $j('.fw-tabbed-wrap-inner.sub-section .tab-list,.fw-tabbed-wrap-inner.sub-section .tab-content-left').css('padding-left', $j('.stickyNavWrap .menuWrapper').offset().left);
        }
        if (viewport1().width >= 1720) {
            $j('.fw-tabbed-wrap-inner.sub-section .tab-list,.fw-tabbed-wrap-inner.sub-section .tab-content-left').css('padding-left', '');
        }
        if (viewport1().width <= 1200) {
            $j('.fw-tabbed-wrap-inner.sub-section .tab-list,.fw-tabbed-wrap-inner.sub-section .tab-content-left').css('padding-left', $j('.stickyNavWrap .menuWrapper').offset().left);
        }
        if (viewport1().width <= 991) {
            $j('.fw-tabbed-wrap-inner.sub-section .tab-list,.fw-tabbed-wrap-inner.sub-section .tab-content-left').css('padding-left', '');
            $j('.fw-tabbed-wrap-inner.sub-section .tab-list,.fw-tabbed-wrap-inner.sub-section .tab-content-left').css('padding-right', '');
        }
    } else {
        if ($j('.fw-ttl-intro-section h1').length > 0) {
            if (viewport1().width < 1720) {
                $j('.fw-tabbed-wrap-inner .tab-content-left').css('padding-left', $j('.fw-ttl-intro-section h1').offset().left);
            }
            if (viewport1().width >= 1720) {
                $j('.fw-tabbed-wrap-inner .tab-content-left').css('padding-left', '');
            }
            if (viewport1().width <= 1200) {
                $j('.fw-tabbed-wrap-inner .tab-content-left').css('padding-left', $j('.fw-ttl-intro-section h1').offset().left);
            }
            if (viewport1().width <= 991) {
                $j('.fw-tabbed-wrap-inner .tab-content-left').css('padding-left', '');
                $j('.fw-tabbed-wrap-inner .tab-content-left').css('padding-right', '');
            }
        }
    }

    if ($j('.fw-tabbed-list-wrap-inner .tab-list-content-wrapper .tab-content-main .tab-content-left').length > 0) {
        var newRIGHT = $j('.fw-tabbed-list-wrap-inner .tab-list').offset().left;

        if (viewport1().width < 1720) {
            $j('.fw-tabbed-list-wrap-inner .tab-list-content-wrapper .tab-content-main .tab-content-left').css('padding-left', newRIGHT);
            $j('.fw-tabbed-list-wrap-inner .tab-list-content-wrapper .tab-content-main .tab-content-left').css('padding-right', newRIGHT);
        }
        if (viewport1().width >= 1720) {
            $j('.fw-tabbed-list-wrap-inner .tab-list-content-wrapper .tab-content-main .tab-content-left').css('padding-left', '');
            $j('.fw-tabbed-list-wrap-inner .tab-list-content-wrapper .tab-content-main .tab-content-left').css('padding-right', '');
        }
        if (viewport1().width <= 1200) {
            $j('.fw-tabbed-list-wrap-inner .tab-list-content-wrapper .tab-content-main .tab-content-left').css('padding-left', '');
            $j('.fw-tabbed-list-wrap-inner .tab-list-content-wrapper .tab-content-main .tab-content-left').css('padding-left', newRIGHT);
        }
        if (viewport1().width <= 991) {
            $j('.fw-tabbed-list-wrap-inner .tab-list-content-wrapper .tab-content-main .tab-content-left').css('padding-left', '');
            $j('.fw-tabbed-list-wrap-inner .tab-list-content-wrapper .tab-content-main .tab-content-left').css('padding-right', '');
        }
    }

    if ($j('.fw-tabbed-wrap').length > 0) {
        $j('.fw-tabbed-wrap').each(function() {
            $j(this).find('.tab-list .slick-list li').addClass('equalHt');
            $j(this).find('.tab-list .slick-list li').css('height', 'auto');
            setEqualHeight_CommonClass($j(this).find('.equalHt'));
        });
    }

    if ($j('.banner-cnt-right .home-content-fw-inner').length > 0) {
        if (viewport1().width > 991) {
            if (window.location.href.indexOf("arabic") > -1) {
                $j('.banner-cnt-right .home-content-fw-inner').css('right', $j(window).width() - ($j('#logo').offset().left + $j('#logo').outerWidth()));
            } else {
                $j('.banner-cnt-right .home-content-fw-inner').css('right', $j('#logo').offset().left);
            }
        }
    }

    /*setTimeout(function(){
    if ($j('#arabic .banner-cnt-right .home-content-fw-inner').length > 0) {
    console.log("inner");
            if (viewport1().width > 991) {
                $j('#arabic .banner-cnt-right .home-content-fw-inner, .ip3-arabic .banner-cnt-right .home-content-fw-inner').css('left', $j('#logo').offset().right);
                console.log("outer");
            }
        }
        },1000);*/

    //if($j('.video-img-on-left .vid-img-ttl').length > 0){
    if (viewport1().width < 1720) {
        if ($j('.fw-ttl-intro-section').length > 0) {
            if ($j('.tab-content-left').length > 0) {
                var offsetTTl = $j('.tab-content-left').offset().left;
            }
            if ($j('.video-img-on-left .vid-img-ttl').length > 0) {
                $j('.video-img-on-left .vid-img-ttl').css('padding-left', $j('.fw-ttl-intro-section').offset().left);
            }
            if ($j('.video-img-on-left .vid-img-desc').length > 0) {
                $j('.video-img-on-left .vid-img-desc').css('padding-left', $j('.fw-ttl-intro-section').offset().left);
            }

            $j('.full-width-content-inner .tab-content-left').css('padding-left', $j('.fw-ttl-intro-section').offset().left);
            $j('.full-width-content-inner .tab-content-left').css('padding-right', $j('.fw-ttl-intro-section').offset().left);
        }
        if ($j('.fw-intro-section').length > 0) {
            //var offsetTTl1 = $j('.tab-content-left').offset().left;    
            if ($j('.fw-intro-section .module-max-width').length > 0) {
                if ($j('.video-img-on-left .vid-img-ttl').length > 0) {
                    $j('.video-img-on-left .vid-img-ttl').css('padding-left', $j('.fw-intro-section .module-max-width').offset().left);
                }
                if ($j('.video-img-on-left .vid-img-desc').length > 0) {
                    $j('.video-img-on-left .vid-img-desc').css('padding-left', $j('.fw-intro-section .module-max-width').offset().left);
                }

                $j('.full-width-content-inner .tab-content-left').css('padding-left', $j('.fw-intro-section .module-max-width').offset().left);
                $j('.full-width-content-inner .tab-content-left').css('padding-right', $j('.fw-intro-section .module-max-width').offset().left);
            } else {
                if ($j('.video-img-on-left .vid-img-ttl').length > 0) {
                    $j('.video-img-on-left .vid-img-ttl').css('padding-left', $j('.fw-intro-section').offset().left);
                }
                if ($j('.video-img-on-left .vid-img-desc').length > 0) {
                    $j('.video-img-on-left .vid-img-desc').css('padding-left', $j('.fw-intro-section').offset().left);
                }

                $j('.full-width-content-inner .tab-content-left').css('padding-left', $j('.fw-intro-section').offset().left);
                $j('.full-width-content-inner .tab-content-left').css('padding-right', $j('.fw-intro-section').offset().left);
            }


        }
    }
    if (viewport1().width >= 1720) {
        $j('.full-width-content-inner .tab-content-left').css('padding-left', '');
        $j('.full-width-content-inner .tab-content-left').css('padding-right', '');
    }

    if ($j('.video-img-on-left .vid-img-ttl').length > 0) {
        if (viewport1().width >= 1720) {
            $j('.video-img-on-left .vid-img-ttl, .video-img-on-left .vid-img-desc').css('padding-left', '36%');
            $j('.full-width-content-inner .tab-content-left').css('padding-left', '');
            $j('.full-width-content-inner .tab-content-left').css('padding-right', '');
        }
    }



    //}

    /*if ($j('.img-cnt-on-img-with-video .img-cnt-on-img-content .img-cnt-txt').length > 0) {

        $j('.img-cnt-on-img.img-cnt-on-img-with-video').each(function() {

            var vdoCntHt = $j(this).find('.img-cnt-on-img-content .img-cnt-txt').outerHeight();
            //console.log(vdoCntHt);
            var vdoImgHt = $j(this).find('.img-cnt-img').outerHeight();
            //console.log(vdoImgHt);
            $j(this).find('.img-cnt-on-img-content .img-cnt-txt').css('margin-top', (vdoImgHt / 2) - (vdoCntHt / 2) + 15);

        });
    }*/

    if ($j('.stickyNavWrap').length > 0) {
        if (viewport1().width > 991) {
            $j('.career-ul').css('display', '');
            $j(".career-dd").removeClass("open");
        }
    }

    if ($j('.img-cnt-on-img-content.inn-video-wrapper.video-with-ttl').length > 0) {
        $j('.img-cnt-on-img-content.inn-video-wrapper.video-with-ttl').each(function() {
            $j(this).css('margin-top', -($j(this).outerHeight() / 2));
        });
    }

    /*
    if($j('.stickyNavWrap').length > 0){
      $j('.stickyNavWrap').css('height',$j('.menuWrapper').outerHeight());
    }
    */

    /*  if($j('.stickyNavWrap').length > 0){
      setTimeout(function(){
        var stickyHt = $j('.stickyNavWrap').outerHeight();
        var bannerHt = $j('.homecontentwrapper').outerHeight() - stickyHt;    
        $j('.stickyNavWrap').css('top',bannerHt);
      },300);
    }*/


    if ($j('.new-site-fw .mCS_destroyed').length > 0) {
        setTimeout(function() {
            $j('.new-site-fw .mCS_destroyed').css('display', '');



            if ($j('.inv_mapWrapper .inv_listContainer').length > 0) {
                $j('.inv_mapWrapper .inv_listContainer').mCustomScrollbar({
                    axis: 'y',
                    scrollbarPosition: 'inside',
                    autoDraggerLength: false
                });
            }

        }, 500);
    }


    if ($j('.stickyNavWrap').length > 0) {
        setTimeout(function() {
            var stickyHt = $j('.stickyNavWrap').outerHeight();
            var bannerHt = $j('.homecontentwrapper,.full-width-banner').outerHeight() - stickyHt;
            $j('.stickyNavWrap').css('top', bannerHt);
        }, 600);
    }
    /*if ($j('.prod-finder-main-container .stickyNavWrap').length > 0) {
           setTimeout(function() {
           var FinalHei = $j('.prod-finder-main-container .product-filter-area').outerHeight();
               var stickyHt = $j('.prod-finder-main-container .stickyNavWrap').outerHeight();
               var bannerHt = $j('.prod-finder-main-container  .procontentwrapper').outerHeight() - stickyHt + FinalHei;
               $j('.prod-finder-main-container .stickyNavWrap').css('top', bannerHt);
           }, 600);
       }*/


    if (viewport1().width > 991) {
        if ($j('.home-banner-fw-inner').length > 0) {
            setTimeout(function() {
                var newBnrCnttop = $j('.home-content-fw-inner').outerHeight();
                if ($j('.stickyNavWrap').length > 0) {
                    var newBnrCnttopht = ((newBnrCnttop - $j('.stickyNavWrap').outerHeight()) / 2) + 60;
                    $j('.home-content-fw-inner').css('margin-top', -newBnrCnttopht);
                } else {
                    $j('.home-content-fw-inner').css('margin-top', -(newBnrCnttop / 2));
                }
            }, 300);
        }
    }

    if (viewport1().width < 1200 && viewport1().width > 991) {
        if ($j('.fw-home-banner-btm-content-main').length > 0) {
            setTimeout(function() {
                var newBnrCntHt = $j('.home-banner-fw-inner').outerHeight();
                var newSticyHt = $j('.stickyNavWrap').outerHeight();
                var newBtmCntHt = $j('.fw-home-banner-btm-content-main').outerHeight();
                var finalVdoPosition = newBnrCntHt - (newSticyHt + newBtmCntHt);
                //if($j('.stickyNavWrap').length > 0){
                $j('.fw-home-banner-btm-content-main').css('bottom', newSticyHt);
                $j('.inn-video-wrapper').css('top', '0');
                $j('.inn-video-wrapper').css('margin-top', (finalVdoPosition / 2) - 25 + 'px');
                /*}else{
                  $j('.fw-home-banner-btm-content-main').css('bottom','25px');
                }*/
            }, 300);
        }
    }
    if (viewport1().width > 1199) {
        if ($j('.fw-home-banner-btm-content-main').length > 0) {
            setTimeout(function() {
                $j('.inn-video-wrapper').css('top', '');
                $j('.inn-video-wrapper').css('margin-top', '');
            }, 300);
        }
    }
    if (viewport1().width < 2000 && viewport1().width > 991) {
        if ($j('.fw-home-banner-btm-content-main').length > 0) {
            setTimeout(function() {
                var newBnrCntHt = $j('.home-banner-fw-inner').outerHeight();
                var newSticyHt = $j('.stickyNavWrap').outerHeight();
                var newBtmCntHt = $j('.fw-home-banner-btm-content-main').outerHeight();
                var finalVdoPosition = newBnrCntHt - (newSticyHt + newBtmCntHt);
                //if($j('.stickyNavWrap').length > 0){
                $j('.fw-home-banner-btm-content-main').css('bottom', newSticyHt);
                //$j('.inn-video-wrapper').css('top','0');
                //$j('.inn-video-wrapper').css('margin-top',(finalVdoPosition/2)-40+'px');
                /*}else{
                  $j('.fw-home-banner-btm-content-main').css('bottom','25px');
                }*/
            }, 300);
        }
    }

    if (viewport1().width > 991) {
        if ($j('.fw-home-banner-btm-content-main').length > 0) {
            setTimeout(function() {
                $j('.fw-home-banner-btm-content-main').css('bottom', $j('.stickyNavWrap').outerHeight());
            }, 400);
        }
    }

    if (viewport1().width < 991) {
        if ($j('.fw-home-banner-btm-content-main').length > 0) {
            //if($j('.stickyNavWrap').length > 0){
            $j('.fw-home-banner-btm-content-main').css('bottom', '');
            $j('.inn-video-wrapper').css('top', 'auto');
            $j('.inn-video-wrapper').css('margin-top', '');
            //}
        }
    }

    if (viewport1().width > 767) {
        if ($j('.img-cnt-outer-bg').length > 0) {
            $j('.img-cnt-outer-bg').each(function() {
                var imgcntHt = $j(this).find('.img-cnt-txt').outerHeight() + 90;
                $j(this).css('height', imgcntHt);
                $j(this).find('.img-cnt-img').css('height', imgcntHt);
            });
        }
    }


    if (viewport1().width <= 767) {
        $j('.show-3-8-filter a.show-3').trigger('click', function() {
            //$j('a.show-3.active').click(function(){
            $j(this).removeClass('active');
            $j(this).parents('.fw-sld-wrapper').find('a.show-8').addClass('active');
            $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').slick('unslick');
            $j(this).parents('.fw-sld-wrapper').find('.rp-show-8-container').unwrap();
            $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer .product-item').unwrap();
            $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').removeClass('show-8');
            $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').addClass('show-3');
            $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').slick({
                infinite: false,
                dots: true,
                prevArrow: '<span class=\'rr-icon-arrow-nav slick-prev\'></span>',
                nextArrow: '<span class=\'rr-icon-arrow-nav slick-next\'></span>',
                slidesToShow: 3,
                slidesToScroll: 3,
                speed: 300,
                responsive: [{
                    breakpoint: 768,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1,
                        dots: true
                    }
                }]
            });
            setTimeout(function() {
                $j(this).parents('.fw-sld-wrapper').find('.fw-rp-sld-outer').each(function() {
                    if ($j(this).find('.slick-dots > li').length > 0) {
                        var totalWidth1 = 0;
                        $j(this).find('.slick-dots > li').each(function() {
                            totalWidth1 = totalWidth1 + $j(this).width();
                        });
                        var newPrevNext1 = (totalWidth1 * 2) + 50;
                        $j(this).find('.slick-arrow.slick-next').css('right', -(newPrevNext1 + 120));
                        $j(this).find('.slick-arrow.slick-prev').css('left', -(newPrevNext1 + 120));
                    }
                });

            }, 300);

        });
    }

    setTimeout(function() {
        $j('.fw-module-global-signpost .hsp-main').each(function() {

            $j(this).find('.hsp-img').height($j(this).find('.hsp-img > img').height());
            $j(this).height($j(this).find('.hsp-img > img').height());

        });
    }, 350);


}
/* fullwidthresponsiveElements End */


/*$j(document).ready(function() {
    if ($j(window).width() > '639') {
        trimString(60, $j('.hsp-main.hsp-news .hsp-text h3'), '...');
    }
});

$j(window).resize(function() {
    if ($j(window).width() > '639') {
        trimString(60, $j('.hsp-main.hsp-news .hsp-text h3'), '...');
    }
});

$j(document).ajaxComplete(function() {
    setTimeout(function(){
    	if ($j(window).width() > '639') {
            trimString(60, $j('.hsp-main.hsp-news .hsp-text h3'), '...');
        }
    },500);
});


function trimString(my_char_limit, my_Str, my_append) {
    $j(my_Str).each(function() {
        //console.log($j(this).height());
        if ($j(this).height() > 140 && $j(this).text().indexOf('...') < 0) {
            var _curr_str = $j(this).html();
            my_Str = _curr_str.substring(0, my_char_limit);
            if (_curr_str.length > my_char_limit) {
                if (_curr_str.substring(my_char_limit, my_char_limit + 1) !== ' ') {
                    //alert(my_Str);
                    my_Str = my_Str.substring(0, my_Str.lastIndexOf(' '));
                }
            }
            $j(this).html(my_Str + my_append);
        }

    });
}
*/


/*-------Text overflow ellipses starts---------*/

$j(window).load(function() {
    $j('.hsp-main.hsp-news .hsp-text h3').each(function() {
        var h = $j(this).height() + 120;
        if (h > $j(this).closest('.hsp-news').height()) {
            trimString(75, $j(this), '...');
        }
    });


});

$j(window).resize(function() {
    setTimeout(function() {
        $j('.hsp-main.hsp-news .hsp-text h3').each(function() {
            var h = $j(this).height() + 120;

            if (h > $j(this).closest('.hsp-news').height() && $j(this).text().indexOf('...') < 0) {
                trimString(75, $j(this), '...');
            } else if ($j(this).text().indexOf('...') > -1) {

                if ($j(this).next().is('.original_text') && $j(this).next().height() + 120 < $j(this).closest('.hsp-news').height()) {
                    var text = $j(this).next().text();
                    $j(this).text(text);
                    $j(this).next().remove();
                }
            }
        });
    }, 1000);

});


function trimString(my_char_limit, my_Str, my_append) {

    $j(my_Str).each(function() {

        if (!$j(this).next().is('.original_text')) {
            $j('<p class="original_text">' + $j(this).text() + '</p>').insertAfter(this);
        }

        //console.log($j(this).height());
        if ($j(this).height() > 130 && $j(this).text().indexOf('...') < 0) {
            var _curr_str = $j(this).html();
            my_Str = _curr_str.substring(0, my_char_limit);
            if (_curr_str.length > my_char_limit) {
                if (_curr_str.substring(my_char_limit, my_char_limit + 1) !== ' ') {
                    //alert(my_Str);
                    my_Str = my_Str.substring(0, my_Str.lastIndexOf(' '));
                }
            }
            $j(this).html(my_Str + my_append);
        }

    });
}

/*-------Text overflow ellipses ends---------*/


$j(window).load(function() {
    sliderArw();


    $j("#product-performance ul.tabs li").each(function(index) {
        $j(this).click(function() {
            var catabsname = $j(this).data("tab-id");
            if (catabsname == "power-of-trent") {
                $j("div#inner-business-aviation-signpost").hide();
                $j("div#inner-future-products-signpost").hide();
                $j("div#inner-carestore-now-open").show();
            } else if (catabsname == "IntelligentEngine") {
                $j("div#inner-business-aviation-signpost").hide();
                $j("div#inner-carestore-now-open").hide();
                $j("div#inner-future-products-signpost").show();
            } else if (catabsname == "business-aviation") {
                $j("div#inner-carestore-now-open").hide();
                $j("div#inner-future-products-signpost").hide();
                $j("div#inner-business-aviation-signpost").show();
            }
        });
    });
});


$j(document).ready(function() {

    /* ---------------- Start Onpage module scroll link ------------ */
    $j(document).on("click", "a.onpage-module-link", function(e) {
        e.preventDefault();

        var hashID = $j(this).attr("href");

        if ($j(hashID).length > 0) {
            $j('html,body').animate({
                scrollTop: $j(hashID).offset().top - 60
            }, "slow");
        }

    });
    /* ---------------- Ends Onpage module scroll link ------------ */

});

/*---------------cs-js------------------*/
var maxHeight = 0;

$j(".arabic-stats-wrap .fw-stats-box .fw-stats-left ").each(function() {
    if ($j(this).height() > maxHeight) {
        maxHeight = $j(this).height();
    }
});
$j(".arabic-stats-wrap .fw-stats-box .fw-stats-left ").height(maxHeight);
/*!---- frame-manager-----*/
/*! iFrame Resizer (iframeSizer.min.js ) - v2.6.2 - 2014-10-11
 *  Desc: Force cross domain iframes to size to content.
 *  Requires: iframeResizer.contentWindow.min.js to be loaded into the target frame.
 *  Copyright: (c) 2014 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 *	Requires: iframeResizer_child.js on I-framed page.
 */

! function() {
    "use strict";

    function a(a, b, c) {
        "addEventListener" in window ? a.addEventListener(b, c, !1) : "attachEvent" in window && a.attachEvent("on" + b, c)
    }

    function b() {
        var a, b = ["moz", "webkit", "o", "ms"];
        for (a = 0; a < b.length && !w; a += 1) w = window[b[a] + "RequestAnimationFrame"];
        w || c(" RequestAnimationFrame not supported")
    }

    function c(a) {
        y.log && "object" == typeof console && console.log(s + "[Host page" + u + "]" + a)
    }

    function d(a) {
        function b() {
            function a() {
                h(z), f(), y.resizedCallback(z)
            }
            i(a, z, "resetPage")
        }

        function d(a) {
            var b = a.id;
            c(" Removing iFrame: " + b), a.parentNode.removeChild(a), y.closedCallback(b), c(" --")
        }

        function e() {
            var a = x.substr(t).split(":");
            return {
                iframe: document.getElementById(a[0]),
                id: a[0],
                height: a[1],
                width: a[2],
                type: a[3]
            }
        }

        function j(a) {
            var b = Number(y["max" + a]),
                d = Number(y["min" + a]),
                e = a.toLowerCase(),
                f = Number(z[e]);
            if (d > b) throw new Error("Value for min" + a + " can not be greater than max" + a);
            c(" Checking " + e + " is in range " + d + "-" + b), d > f && (f = d, c(" Set " + e + " to min value")), f > b && (f = b, c(" Set " + e + " to max value")), z[e] = "" + f
        }

        function k() {
            var b = a.origin,
                d = z.iframe.src.split("/").slice(0, 3).join("/");
            if (y.checkOrigin && (c(" Checking connection is from: " + d), "" + b != "null" && b !== d)) throw new Error("Unexpected message received from: " + b + " for " + z.iframe.id + ". Message was: " + a.data + ". This error can be disabled by adding the checkOrigin: false option.");
            return !0
        }

        function l() {
            return s === ("" + x).substr(0, t)
        }

        function m() {
            var a = z.type in {
                "true": 1,
                "false": 1
            };
            return a && c(" Ignoring init message from meta parent page"), a
        }

        function n() {
            var a = x.substr(x.indexOf(":") + r + 6);
            c(" MessageCallback passed: {iframe: " + z.iframe.id + ", message: " + a + "}"), y.messageCallback({
                iframe: z.iframe,
                message: a
            }), c(" --")
        }

        function o() {
            if (null === z.iframe) throw new Error("iFrame (" + z.id + ") does not exist on " + u);
            return !0
        }

        function q() {
            c(" Reposition requested from iFrame"), v = {
                x: z.width,
                y: z.height
            }, f()
        }

        function w() {
            switch (z.type) {
                case "close":
                    d(z.iframe), y.resizedCallback(z);
                    break;
                case "message":
                    n();
                    break;
                case "scrollTo":
                    q();
                    break;
                case "reset":
                    g(z);
                    break;
                case "init":
                    b(), y.initCallback(z.iframe);
                    break;
                default:
                    b()
            }
        }
        var x = a.data,
            z = {};
        l() && (c(" Received: " + x), z = e(), j("Height"), j("Width"), !m() && o() && k() && (w(), p = !1))
    }

    function e() {
        null === v && (v = {
            x: void 0 !== window.pageXOffset ? window.pageXOffset : document.documentElement.scrollLeft,
            y: void 0 !== window.pageYOffset ? window.pageYOffset : document.documentElement.scrollTop
        }, c(" Get position: " + v.x + "," + v.y))
    }

    function f() {
        null !== v && (window.scrollTo(v.x, v.y), c(" Set position: " + v.x + "," + v.y), v = null)
    }

    function g(a) {
        function b() {
            h(a), j("reset", "reset", a.iframe)
        }
        c(" Size reset requested by " + ("init" === a.type ? "host page" : "iFrame")), e(), i(b, a, "init")
    }

    function h(a) {
        function b(b) {
            a.iframe.style[b] = a[b] + "px", c(" IFrame (" + a.iframe.id + ") " + b + " set to " + a[b] + "px")
        }
        y.sizeHeight && b("height"), y.sizeWidth && b("width")
    }

    function i(a, b, d) {
        d !== b.type && w ? (c(" Requesting animation frame"), w(a)) : a()
    }

    function j(a, b, d) {
        c("[" + a + "] Sending msg to iframe (" + b + ")"), d.contentWindow.postMessage(s + b, "*")
    }

    function k() {
        function b() {
            function a(a) {
                1 / 0 !== y[a] && 0 !== y[a] && (k.style[a] = y[a] + "px", c(" Set " + a + " = " + y[a] + "px"))
            }
            a("maxHeight"), a("minHeight"), a("maxWidth"), a("minWidth")
        }

        function d(a) {
            return "" === a && (k.id = a = "iFrameResizer" + o++, c(" Added missing iframe ID: " + a + " (" + k.src + ")")), a
        }

        function e() {
            c(" IFrame scrolling " + (y.scrolling ? "enabled" : "disabled") + " for " + l), k.style.overflow = !1 === y.scrolling ? "hidden" : "auto", k.scrolling = !1 === y.scrolling ? "no" : "yes"
        }

        function f() {
            ("number" == typeof y.bodyMargin || "0" === y.bodyMargin) && (y.bodyMarginV1 = y.bodyMargin, y.bodyMargin = "" + y.bodyMargin + "px")
        }

        function h() {
            return l + ":" + y.bodyMarginV1 + ":" + y.sizeWidth + ":" + y.log + ":" + y.interval + ":" + y.enablePublicMethods + ":" + y.autoResize + ":" + y.bodyMargin + ":" + y.heightCalculationMethod + ":" + y.bodyBackground + ":" + y.bodyPadding + ":" + y.tolerance
        }

        function i(b) {
            a(k, "load", function() {
                var a = p;
                j("iFrame.onload", b, k), !a && y.heightCalculationMethod in x && g({
                    iframe: k,
                    height: 0,
                    width: 0,
                    type: "init"
                })
            }), j("init", b, k)
        }
        var k = this,
            l = d(k.id);
        e(), b(), f(), i(h())
    }

    function l(a) {
        if ("object" != typeof a) throw new TypeError("Options is not an object.")
    }

    function m() {
        function a(a) {
            if ("IFRAME" !== a.tagName.toUpperCase()) throw new TypeError("Expected <IFRAME> tag, found <" + a.tagName + ">.");
            k.call(a)
        }

        function b(a) {
            a = a || {}, l(a);
            for (var b in z) z.hasOwnProperty(b) && (y[b] = a.hasOwnProperty(b) ? a[b] : z[b])
        }
        return function(c, d) {
            b(c), Array.prototype.forEach.call(document.querySelectorAll(d || "iframe"), a)
        }
    }

    function n(a) {
        a.fn.iFrameResize = function(b) {
            return b = b || {}, l(b), y = a.extend({}, z, b), this.filter("iframe").each(k).end()
        }
    }
    var o = 0,
        p = !0,
        q = "message",
        r = q.length,
        s = "[iFrameSizer]",
        t = s.length,
        u = "",
        v = null,
        w = window.requestAnimationFrame,
        x = {
            max: 1,
            scroll: 1,
            bodyScroll: 1,
            documentElementScroll: 1
        },
        y = {},
        z = {
            autoResize: !0,
            bodyBackground: null,
            bodyMargin: null,
            bodyMarginV1: 8,
            bodyPadding: null,
            checkOrigin: !0,
            enablePublicMethods: !1,
            heightCalculationMethod: "offset",
            interval: 32,
            log: !1,
            maxHeight: 1 / 0,
            maxWidth: 1 / 0,
            minHeight: 0,
            minWidth: 0,
            scrolling: !1,
            sizeHeight: !0,
            sizeWidth: !1,
            tolerance: 0,
            closedCallback: function() {},
            initCallback: function() {},
            messageCallback: function() {},
            resizedCallback: function() {}
        };
    b(), a(window, "message", d), "jQuery" in window && n($j), "function" == typeof define && define.amd ? define(function() {
        return m()
    }) : window.iFrameResize = m()
}();

if (!Array.prototype.forEach) {
    Array.prototype.forEach = function(fun /*, thisArg */ ) {
        "use strict";
        if (this === void 0 || this === null || typeof fun !== "function") throw new TypeError();

        var
            t = Object(this),
            len = t.length >>> 0,
            thisArg = arguments.length >= 2 ? arguments[1] : void 0;

        for (var i = 0; i < len; i++)
            if (i in t)
                fun.call(thisArg, t[i], i, t);
    };
}

$j(document).ready(function() {
    $j("iframe.responsive-frame").iFrameResize({
        log: false
    });
    $j("iframe.responsive").iFrameResize({
        log: false
    });
    $j("iframe.responsive-frame-1").iFrameResize({
        log: false
    });

});
$j(window).load(function() {
    $j('iframe.responsive-frame').iFrameResize({
        log: false
    });
});
$j(window).resize(function() {
    if ($j("iframe.responsive-frame").length > 0) {
        $j("#iframe-container iframe.responsive-frame").css("width", $j("#iframe-container").width() + "px");
    }
    if ($j("iframe.responsive").length > 0) {
        $j("#iframe-container iframe.responsive").css("width", $j("#iframe-container").width() + "px");
    }
    if ($j(".dct-tool-landing-page iframe.responsive-frame-1").length > 0) {
        $j("#iframe-container iframe.responsive-frame-1").css("width", $j("#iframe-container").width() + "px");
    }
});
/*!---- full-width-header-footer-home-----*/
var setFlag = 0;
/*
	By Osvaldas Valutis, www.osvaldas.info
	Available for use under the MIT License
*/
var stickySecNav;

(function($j, window, document, undefined) {
    $j.fn.doubleTapToGo = function(params) {
        if (!('ontouchstart' in window) &&
            !navigator.msMaxTouchPoints &&
            !navigator.userAgent.toLowerCase().match(/windows phone os 7/i)) return false;
        this.each(function() {
            var curItem = false;
            $j(this).on('click', function(e) {
                var item = $j(this);
                if (item[0] != curItem[0]) {
                    e.preventDefault();
                    curItem = item;
                }
            });
            $j(document).on('click touchstart MSPointerDown', function(e) {
                var resetItem = true,
                    parents = $j(e.target).parents();
                for (var i = 0; i < parents.length; i++)
                    if (parents[i] == curItem[0])
                        resetItem = false;
                if (resetItem)
                    curItem = false;
            });
        });
        return this;
    };
})($j, window, document);

function is_touch_device() {
    return (('ontouchstart' in window) ||
        (navigator.MaxTouchPoints > 0) ||
        (navigator.msMaxTouchPoints > 0));
}
/*
$j(document).on('click touchstart', function(event) {
  if (!$j(event.target).closest('#more').length && !$j(event.target).closest('.secondlevelnextall').length) {
    if($j('#more').hasClass('moreactive')){
      $j('.secondlevelnextall').slideUp('500', function() {
        $j('.secondlevelnextall').css('overflow','');
        $j('#more').removeClass("moreactive");
      }
                                       );
    }
  }
  if (!$j(event.target).closest('.new-bread-div').length && !$j(event.target).closest('.new-bread-div ul').length) {
    if($j('.new-bread-div').hasClass('bread-active-parent')){
      $j('.bread-active-parent > ul').slideUp('500', function() {
        $j('.bread-active-parent > ul').css('overflow','');
        $j('.new-bread-div').removeClass("bread-active-parent");
        $j('.new-bread-div > a').removeClass("bread-active");
      }
                                             );
    }
  }
  
  if (!$j(event.target).closest('.new-bread-div-active').length && !$j(event.target).closest('.new-bread-div-active li.bread-uppercase').length) {
    if($j('.new-bread-div-active li.bread-uppercase').hasClass('bread-active-parent')){
      $j('.bread-active-parent > ul').slideUp('500', function() {
        $j('.bread-active-parent > ul').css('overflow','');
        $j('.new-bread-div-active li.bread-uppercase').removeClass("bread-active-parent");
        $j('.new-bread-div-active li.bread-uppercase a.bread-active').removeClass("bread-active");
      }
                                             );
    }
  }
  if (!$j(event.target).closest('#headerlinks > ul > li').length && !$j(event.target).closest('#headerlinks > ul > li > ul').length) {
    if($j('#headerlinks > ul > li').hasClass('globalactive')){
      $j('#headerlinks > ul > li > ul').slideUp('500', function() {
        $j('#headerlinks > ul > li > ul').css('overflow','');
        $j('#headerlinks > ul > li').removeClass("globalactive");
      }
                                               );
    }
  }
  if (!$j(event.target).closest('#headerlinksmobi > ul > li').length && !$j(event.target).closest('#headerlinksmobi > ul > li > ul').length) {
    if($j('#headerlinksmobi > ul > li').hasClass('globalactive')){
      $j('.mm-footer').animate({
        bottom:250
      }
                               ,400);
      //var newHt2 = $j('#mob-menu-wrap').height();
    //  $j('.mm-menu,.mm-page').height(newHt2 - 250);
      $j('#headerlinksmobi > ul > li > ul').slideUp('500', function() {
        $j('#headerlinksmobi > ul > li > ul').css('overflow','');
        $j('#headerlinksmobi > ul > li').removeClass("globalactive");
      }
                                                   );
    }
  }
}); 





               */
function viewport1() {
    var e = window,
        a = 'inner';
    if (!('innerWidth' in window)) {
        a = 'client';
        e = document.documentElement || document.body;
    }
    return {
        width: e[a + 'Width'],
        height: e[a + 'Height']
    };
}
/* Sticky Mobi Menu */
//if(viewport1().width <= 1024){
var didScroll;
var lastScrollTop = 0;
var delta = 5;
var navbarHeight = $j('.header-outer').outerHeight();
$j(window).scroll(function(event) {
    didScroll = true;
});
setInterval(function() {
    if (didScroll) {
        if (!($j('html').hasClass("mm-opened"))) {
            hasScrolled();
            didScroll = false;
        }
    }
}, 250);
//}
function hasScrolled() {
    var st = $j(this).scrollTop();
    // Make sure they scroll more than delta
    if (Math.abs(lastScrollTop - st) <= delta)
        return;
    // If they scrolled down and are past the navbar, add class .nav-up.
    // This is necessary so you never see what is "behind" the navbar.
    if (st > lastScrollTop && st > navbarHeight) {
        // Scroll Down
        $j('.header-outer,.stickyNavWrap,.header-outer-dummy,.stickyNavI').removeClass('nav-down').addClass('nav-up');
    } else {
        // Scroll Up
        if (st + $j(window).height() < $j(document).height()) {
            $j('.header-outer,.stickyNavWrap,.header-outer-dummy,.stickyNavI').removeClass('nav-up').addClass('nav-down');
        }
    }
    lastScrollTop = st;
}
/* Sticky Mobi Menu */
$j(document).ready(function() {

    if ($j('.ProductDetail').length > 0) {
        $j('.BreadcrumbInnerWrap  .view-more-nav-container > .new-bread-div').slice(-3).remove();
        $j('.BreadcrumbInnerWrap  .view-more-nav-container > .new-bread-div:last-child').find('.separator').remove();
    }




    /*$j('.show-ul').mCustomScrollbar({
      advanced: {
        updateOnContentResize: true
      },
      mouseWheel :{
        scrollAmount : 100
      }
    }); 
    */
    /*  $j('#topnavigation .fwMenuwrapper > ul li#nav-media-level1 > ul#section-media-level2').prepend('<li id="nav-media-home-level2" class="level2"><a href="/media.aspx"><span>Media home</span></a></li>');*/
    if (viewport1().width <= 991) {
        //$j('.header-outer-dummy').css('height',$j('.header-outer').outerHeight());
        //$j('.header-outer').addClass('detached');
        //$j('.header-outer').css('top',0);
    }
    // moreMenu();  
    /*----Main nav starts----*/
    if (is_touch_device()) {
        if (window.navigator.msPointerEnabled) {
            $j('.fwMenuwrapper ul > li.level1').hover(function() {
                $j('.show-desc').hide();
                $j('body').removeClass('megamenuhover');
                $j('.show-ul-outer').removeClass('white-bg');
                $j('.fwMenuwrapper ul > li.level1').removeClass('do-opaque');
                $j('.fwMenuwrapper ul > li.level1').removeClass('hoveractive');
                passLevl1 = $j(this);
                checkActiveLevel(passLevl1);
                $j('.show-menu').show();
                $j('.show-menu,.show-desc').empty();
                if ($j(this).hasClass('haschildren')) {
                    $j('body').addClass('megamenuhover');
                    $j(this).addClass('do-opaque');
                    $j(this).addClass('hoveractive');
                    $j('.show-ul-outer').addClass('white-bg');
                    if ($j(this).hasClass('current')) {
                        var mTitle = $j(this).find(' > span').text();
                        $j('.show-menu').append("<p class='megamenu-title'>" + mTitle + "</p>");
                    } else {
                        var mTitle1 = $j(this).find(' > a span').text();
                        $j('.show-menu').append("<p class='megamenu-title'>" + mTitle1 + "</p>");
                    }
                    if ($j('.fw-' + $j(this).attr('id')).length > 0) {
                        $j('.fw-' + $j(this).attr('id')).clone().appendTo('.show-desc');
                    }

                    $j(this).children('ul').clone().appendTo('.show-menu');


                    setEqualHeight_CommonClass(".show-menu ul");
                    $j('.show-menu li.haschildren > a,.show-menu li.haschildren.current > span').each(function() {
                        $j(this).append('<span class="fa fa-angle-right"></span>');
                    });
                }

            });
            $j('.white-overlay,.hide-content').hover(function() {
                $j('.show-ul-outer').removeClass('white-bg');
                $j('.fwMenuwrapper ul > li.level1').removeClass('hoveractive');
                $j('.fwMenuwrapper ul > li.level1').removeClass('do-opaque');
                $j('body').removeClass('megamenuhover');

            });
        } else {
            $j(".fwMenuwrapper ul > li.level1").one("click", function(e) {
                e.preventDefault();
                $j('.show-desc').hide();
                $j('body').removeClass('megamenuhover');
                $j('.show-ul-outer').removeClass('white-bg');
                $j('.fwMenuwrapper ul > li.level1').removeClass('do-opaque');
                $j('.fwMenuwrapper ul > li.level1').removeClass('hoveractive');
                passLevl1 = $j(this);
                checkActiveLevel(passLevl1);
                $j('.show-menu').show();
                $j('.show-menu,.show-desc').empty();
                if ($j(this).hasClass('haschildren')) {
                    $j('body').addClass('megamenuhover');
                    $j(this).addClass('do-opaque');
                    $j(this).addClass('hoveractive');
                    $j('.show-ul-outer').addClass('white-bg');
                    if ($j(this).hasClass('current')) {
                        var mTitle = $j(this).find(' > span').text();
                        $j('.show-menu').append("<p class='megamenu-title'>" + mTitle + "</p>");
                    } else {
                        var mTitle1 = $j(this).find(' > a span').text();
                        $j('.show-menu').append("<p class='megamenu-title'>" + mTitle1 + "</p>");
                    }
                    if ($j('.fw-' + $j(this).attr('id')).length > 0) {
                        $j('.fw-' + $j(this).attr('id')).clone().appendTo('.show-desc');
                    }

                    $j(this).children('ul').clone().appendTo('.show-menu');


                    setEqualHeight_CommonClass(".show-menu ul");
                    $j('.show-menu li.haschildren > a,.show-menu li.haschildren.current > span').each(function() {
                        $j(this).append('<span class="fa fa-angle-right"></span>');
                    });
                    /* Double Tap To Go */
                    $j('.show-menu ul li.haschildren').doubleTapToGo();
                    $j('.show-menu ul li.haschildren').each(function() {
                        $j(this).attr('aria-haspopup', 'true');
                        $j(this).children("a").attr('onclick', 'true');

                    });
                    /* Double Tap To Go */
                }
            });
            $j('.white-overlay,.hide-content').click(function() {
                $j('.show-ul-outer').removeClass('white-bg');
                $j('.fwMenuwrapper ul > li.level1').removeClass('hoveractive');
                $j('.fwMenuwrapper ul > li.level1').removeClass('do-opaque');
                $j('body').removeClass('megamenuhover');
            });
        }
    } else {
        var timer;
        $j(document).on("mouseover", ".fwMenuwrapper ul > li.level1", function(e) {
            $j('.fwMenuwrapper ul > li.level1').removeClass('do-opaque');
            $j('.fwMenuwrapper ul > li.level1').removeClass('hoveractive');
            $j(this).addClass('do-opaque');
            $j(this).addClass('hoveractive');
            //$j('.show-ul').mCustomScrollbar("destroy");
        });
        $j('.MainWrapperInner,.white-overlay,.hide-content,#logo,#top-left,.customer-banner-container-outer').not('#topnavigation').mouseover(function() {
            $j('.fwMenuwrapper ul > li.level1').removeClass('do-opaque');
            $j('.fwMenuwrapper ul > li.level1').removeClass('hoveractive');
        });

        //$j(document).on("mouseover", ".fwMenuwrapper ul > li.level1", function(e) {
        $j(".fwMenuwrapper ul > li.level1").mouseenter(function(e) {
            $j('.show-desc').hide();
            //$j(document).on("mouseenter", ".fwMenuwrapper ul > li.level1", function(e) {
            if ($j('#headerlinks > ul > li').hasClass('globalactive')) {
                $j('#headerlinks > ul > li > ul').slideUp('500', function() {
                    $j('#headerlinks > ul > li > ul').css('overflow', '');
                    $j('#headerlinks > ul > li').removeClass("globalactive");
                });
            }
            e.preventDefault();
            $j('.fwMenuwrapper ul > li.level1').removeClass('do-opaque');
            $j('.fwMenuwrapper ul > li.level1').removeClass('hoveractive');
            if ($j(this).hasClass('haschildren')) {
                if ($j('body').hasClass('megamenuhover')) {
                    timer = setTimeout(function() {
                        $j(this).addClass('do-opaque');
                        $j(this).addClass('hoveractive');
                    }, 300);
                } else {
                    $j('body').removeClass('megamenuhover');
                    $j('.show-ul-outer').removeClass('white-bg');
                }
                passLevl1 = $j(this);
                checkActiveLevel(passLevl1);
                $j('.show-menu').show();
                $j('.show-menu,.show-desc').empty();
                timer = setTimeout(function() {
                    $j(this).addClass('do-opaque');
                    $j(this).addClass('hoveractive');
                    $j('body').addClass('megamenuhover');
                    $j('.show-ul-outer').addClass('white-bg');
                    //$j('.show-ul').mCustomScrollbar("destroy");         
                }, 300);
                if ($j(this).hasClass('current')) {
                    var mTitle = $j(this).find(' > span').text();
                    $j('.show-menu').append("<p class='megamenu-title'>" + mTitle + "</p>");
                } else {
                    var mTitle1 = $j(this).find(' > a span').text();
                    $j('.show-menu').append("<p class='megamenu-title'>" + mTitle1 + "</p>");
                }
                if ($j('.fw-' + $j(this).attr('id')).length > 0) {
                    $j('.fw-' + $j(this).attr('id')).clone().appendTo('.show-desc');
                }

                $j(this).children('ul').clone().appendTo('.show-menu');


                //setEqualHeight_CommonClass(".show-menu ul");
                $j('.show-menu li.haschildren > a,.show-menu li.haschildren.current > span').each(function() {
                    $j(this).append('<span class="fa fa-angle-right"></span>');
                });
                /* Double Tap To Go */
                $j('.show-menu ul li.haschildren').doubleTapToGo();
                $j('.show-menu ul li.haschildren').each(function() {
                    $j(this).attr('aria-haspopup', 'true');
                    $j(this).children("a").attr('onclick', 'true');
                });
                /* Double Tap To Go */
            } else {
                $j('.show-ul-outer').removeClass('white-bg');
                $j('.fwMenuwrapper ul > li.level1').removeClass('hoveractive');
                $j('.fwMenuwrapper ul > li.level1').removeClass('do-opaque');
                $j('body').removeClass('megamenuhover');
            }
            /* $j('.show-ul').mCustomScrollbar({
               advanced: {
                 updateOnContentResize: true
               }
               ,
               mouseWheel :{
                 scrollAmount : 100
                 
               }
               
             });
             */

        }).mouseleave(function() {


            clearTimeout(timer);
        });



        $j('.white-overlay,.hide-content,.header-outer').hover(function() {
            /*console.log('hoverout');*/
            $j('.show-ul-outer').removeClass('white-bg');
            $j('.fwMenuwrapper ul > li.level1').removeClass('hoveractive');
            $j('.fwMenuwrapper ul > li.level1').removeClass('do-opaque');
            $j('body').removeClass('megamenuhover');

        });
        $j('.megamenu-close').click(function() {

            $j('.show-ul-outer').removeClass('white-bg');
            $j('.fwMenuwrapper ul > li.level1').removeClass('hoveractive');
            $j('.fwMenuwrapper ul > li.level1').removeClass('do-opaque');
            $j('body').removeClass('megamenuhover');
        });
    }
    /*----Main nav ends----*/
    var htViewport = viewport().height;
    var htHeader;
    var diffHeight;
    if ($j('.new-second-level-navigation-outer').length > 0) {
        htHeader = $j('#header').outerHeight();
        diffHeight = htViewport - htHeader;
        //    $j('.show-ul').css('height',diffHeight-140);
    } else {
        htHeader = $j('#header').outerHeight();
        diffHeight = htViewport - htHeader;
        // $j('.show-ul').css('height',diffHeight-40);
    }

    $j(document).on("mouseover", ".show-menu > ul > li", function(e) {
        $j('.show-desc').hide();


        //$j('.show-menu > ul > li > ul').hide();
        // $j(this).find('> ul').fadeIn(100);
        // setEqualHeight_CommonClass(".show-menu ul");

    });

    $j(document).on("mouseover", "#topnavigation", function(e) {

        setTimeout(function() {
            $j('.show-menu ul li').each(function() {
                if ($j(this).hasClass('selected')) {
                    // alert();
                    $j(this).parent().addClass('showShadow');
                    //setEqualHeight_CommonClass(".show-menu ul");

                }

            });



        }, 100);
        /*WO : #364664 Start*/
        setTimeout(function() {
            var currmaxHeight = 0;
            var highlightht = 0;
            $j('.show-menu ul').each(function() {

                if ($j(this).css('visibility') === "visible") {

                    highlightht = Math.max(highlightht, $j(this).height());

                }

            });
            $j('.show-menu ul').height(highlightht + "px");

        }, 600);
        /*WO : #364664 End*/
    });




    /*---mouse in out for 2nd level--*/
    $j(document).on("mouseover", ".show-menu > ul > li:not(.selected),.show-menu > ul > li:not(.selected) *", function(e) {

        $j('.show-menu > ul > li.selected').find('ul').addClass("tempHide");

    });

    $j(document).on("mouseout", ".show-menu > ul > li:not(.selected),.show-menu  > ul > li:not(.selected) *", function(e) {
        $j('.show-menu > ul > li.selected').find('ul').removeClass("tempHide");

    });
    /*---mouse in out for 2nd level--*/

    /*---mouse in out for 3rd level--*/
    $j(document).on("mouseover", ".show-menu > ul > li.selected > ul > li:not(.selected),  .show-menu > ul > li.selected > ul > li:not(.selected) *", function(e) {

        $j('.show-menu > ul > li.selected > ul > li.selected').find('ul').addClass("tempHide");

    });

    $j(document).on("mouseout", ".show-menu > ul > li.selected > ul > li:not(.selected),  .show-menu > ul > li.selected > ul > li:not(.selected) *", function(e) {

        $j('.show-menu > ul > li.selected > ul > li.selected').find('ul').removeClass("tempHide");

    });
    /*---mouse in out for 3rd level--*/

    /*---mouse in out for 4th level--*/
    $j(document).on("mouseover", ".show-menu > ul > li.selected > ul > li.selected > ul > li:not(.selected),  .show-menu > ul > li.selected > ul > li.selected > ul > li:not(.selected) *", function(e) {

        $j('.show-menu > ul > li.selected > ul > li.selected > ul > li.selected').find('ul').addClass("tempHide");
    });

    $j(document).on("mouseout", ".show-menu > ul > li.selected > ul > li.selected > ul > li:not(.selected),  .show-menu > ul > li.selected > ul > li.selected > ul > li:not(.selected) *", function(e) {

        $j('.show-menu > ul > li.selected > ul > li.selected > ul > li.selected').find('ul').removeClass("tempHide");
    });
    /*---mouse in out for 4th level--*/

    /*---mouse in out fade--*/
    $j(document).on("mouseover", ".show-menu > ul > li.haschildren, .show-menu > ul > li.haschildren > ul > li.haschildren,.show-menu > ul > li.haschildren > ul > li.haschildren > ul > li.haschildren", function(e) {
        $j(this).parent().parent().addClass('borderStyle');
        $j(this).siblings().addClass("faded");
        $j(this).parent().addClass('showShadow');
        //console.log($j(this));
    });

    $j(document).on("mouseout", ".show-menu > ul > li.haschildren,.show-menu > ul > li.haschildren > ul > li.haschildren,.show-menu > ul > li.haschildren > ul > li.haschildren > ul > li.haschildren", function(e) {
        $j(this).parent().parent().removeClass('borderStyle');
        $j(this).siblings().removeClass("faded");
        $j(this).parent().removeClass('showShadow');
    });
    /*---mouse in out fade--*/

    $j(document).on("mouseover", ".show-menu ul li", function(e) {
        $j(this).parent().parent().addClass('borderStyle');
    });

    $j(document).on("mouseout", ".show-menu ul li", function(e) {
        $j(this).parent().parent().removeClass('borderStyle');
    });


    /*$j(document).on("mouseover", ".fwMenuwrapper > ul > li", function(e) {   
      setEqualHeight_CommonClass(".show-menu ul");     
    });*/

    /*WO : #364664 Start*/
    $j(document).on("mouseover", ".show-menu ul li", function(e) {
        var maxHeight = 0;
        setTimeout(function() {
            $j('.show-menu ul').each(function() {

                if ($j(this).css('visibility') === "visible") {
                    var totalLiHeight = 0;
                    $j($j(this).children()).each(function() {

                        totalLiHeight += $j(this).outerHeight();

                    });
                    //console.log(totalLiHeight);
                    if (totalLiHeight > maxHeight) {
                        maxHeight = totalLiHeight;
                    }

                }
                $j('.show-menu ul').height(maxHeight + "px");
                //console.log(maxHeight);
            });
        }, 450);

    });

    $j(document).on("mouseout", ".show-menu ul li", function(e) {
        var maxHeight = 0;
        setTimeout(function() {
            $j('.show-menu ul').each(function() {

                if ($j(this).css('visibility') === "visible") {
                    var totalLiHeight = 0;
                    $j($j(this).children()).each(function() {

                        totalLiHeight += $j(this).outerHeight();

                    });
                    //console.log(totalLiHeight);
                    if (totalLiHeight > maxHeight) {
                        maxHeight = totalLiHeight;
                    }

                }
                $j('.show-menu ul').height(maxHeight + "px");
                //console.log(maxHeight);
            });
        }, 450);

    });

    /*WO : #364664 END*/


    $j(document).on("click", "#headerlinks > ul > li", function(e) {
        //e.preventDefault();    
        if ($j(this).hasClass('globalactive')) {
            $j('#headerlinks > ul > li > ul').slideUp('500', function() {
                $j('#headerlinks > ul > li > ul').css('overflow', '');
                $j('#headerlinks > ul > li').removeClass("globalactive");
            });
        } else {
            $j('#headerlinks > ul > li > ul').slideDown('500', function() {
                $j('#headerlinks > ul > li').addClass('globalactive');
                $j('#headerlinks > ul > li > ul').css('overflow', '');
            });
        }

        $j('.new-bread-div > a.bread-active').trigger('click', function() {
            var thisClicked = $j('.new-bread-div > a');
            $j(this).removeClass('bread-active');
            $j(this).parent().removeClass('bread-active-parent');
            $j(this).siblings('ul').slideUp('500', function() {
                thisClicked.siblings('ul').css('overflow', '');
                thisClicked.siblings('ul').removeClass('bread-clicked');
            });
        });

    });
    $j(document).on("click", "#headerlinksmobi > ul > li", function(e) {
        //e.preventDefault();    
        if ($j(this).hasClass('globalactive')) {
            $j('.mm-footer').animate({
                bottom: 250
            }, 400);
            $j('#headerlinksmobi > ul > li > ul').slideUp('500', function() {
                $j('#headerlinksmobi > ul > li > ul').css('overflow', '');
                $j('#headerlinksmobi > ul > li').removeClass("globalactive");
                /*var newHt = $j('#mob-menu-wrap').height();
                $j('.mm-menu,.mm-page').height(newHt - 250);*/
            });
        } else {
            $j('.mm-footer').animate({
                bottom: 0
            }, 400);
            $j('#headerlinksmobi > ul > li').addClass('globalactive');
            /*var newHt1 = $j('#mob-menu-wrap').height();
            $j('.mm-menu,.mm-page').height(newHt1 + 250);*/
            $j('#headerlinksmobi > ul > li > ul').slideDown('500', function() {
                $j('#headerlinksmobi > ul > li > ul').css('overflow', '');
            });
        }
    });
    //$j('.used-for-clone .selected.level1 > ul[id*="-level2"]').clone().appendTo('.bread-uppercase');  
});

$j(document).on('click touchstart', '.megamenu-close', function(e) {
    $j('.show-ul-outer').removeClass('white-bg');
    $j('.fwMenuwrapper ul > li.level1').removeClass('hoveractive');
    $j('.fwMenuwrapper ul > li.level1').removeClass('do-opaque');
    $j('body').removeClass('megamenuhover');
});
$j(window).load(function() {




    $j('#mob-menu-wrap > ul').each(function() {
        var vhrefUSEFUL;
        var vhref;
        var vClickText = $j(this).find('.mmenu-section-head').text();
        var replaceend;
        var finalstr;
        $j(this).find('li a').each(function() {
            vhref = $j(this).attr('href');
            vhrefUSEFUL = $j(this).attr('href');
            replaceend = vClickText.replace(/&/g, 'and');
            finalstr = replaceend.replace(/\s+/g, '-').toLowerCase();
            if ($j(this).parent().find("a").length < 2) {
                if (vhref.indexOf('#') > -1) {} else {
                    //console.log(vhrefUSEFUL);
                    return false;
                }
            }

        });
        /* console.log("vhrefUSEFUL: ",vhrefUSEFUL);*/
        var lastItem = vhrefUSEFUL.substr(vhrefUSEFUL.lastIndexOf('/') + 1);
        var newURL = vhrefUSEFUL.replace(new RegExp(lastItem), '');
        var removeASPX = lastItem.replace(/\.aspx/, '');
        /*console.log(newURL);
        console.log(vClickText);*/
        var appendLandingitem = $j('<li class="landingItem"><a href="' + newURL + '">' + vClickText + ' home</a></li>');
        var appendInsertAfter = $j(this).find('li.mmenu-section-head');
        appendLandingitem.insertAfter(appendInsertAfter);
    });
    /*$j('.new-bread-div > a').doubleTapToGo();
    $j('.new-bread-div > a').attr('aria-haspopup', 'true');
    $j('.new-bread-div > a').children("a").attr('onclick', 'true');*/
    /* Double Tap To Go */
    if ($j('.innovation-header').length > 0) {
        $j('.hide-content').insertBefore('#MainWrapper > div:first-child');
    }

    $j('.mm-list .landingItem a').each(function() {
        var NavURLfirst
        var NavURL;
        var NavFinalURL;
        var NavFinalnewURL

        if ($j(this).text() === 'AGM home') {
            NavURLfirst = $j(this).attr('href');
            NavURL = NavURLfirst.replace(/\/$/, '');
            NavFinalURL = NavURL.substr(NavURL.lastIndexOf('/') + 1);
            NavFinalnewURL = NavURL.replace(new RegExp(NavFinalURL), '');

            $j(this).attr('href', NavFinalnewURL);
        }
        if ($j(this).text() === 'Annual Report 2022 home') {
            NavURLfirst = $j(this).attr('href');
            NavURL = NavURLfirst.replace(/\/$/, '');
            NavFinalURL = NavURL.substr(NavURL.lastIndexOf('/') + 1);
            NavFinalnewURL = NavURL.replace(new RegExp(NavFinalURL), '');

            $j(this).attr('href', NavFinalnewURL);
        }

    });
});

/*--------- Adjust mega menu height on resize starts -----------*/

$j(window).resize(function() {

    var htViewport = viewport().height;
    var htHeader;
    var diffHeight;
    if ($j('.new-second-level-navigation-outer').length > 0) {
        htHeader = $j('#header').outerHeight();
        diffHeight = htViewport - htHeader;
        // $j('.show-ul').css('height',diffHeight-140);
    } else {
        htHeader = $j('#header').outerHeight();
        diffHeight = htViewport - htHeader;
        // $j('.show-ul').css('height',diffHeight-40);
    }

});
/*--------- Adjust mega menu height on resize ends -----------*/


//check active level
function checkActiveLevel(getLevel1) {
    setFlag = 0;

    getLevel1.find('ul li.level2').each(function() {

        $j(this).find('ul li.level3').each(function() {
            if (($j(this).hasClass('selected') || $j(this).hasClass('current'))) {

                $j('.show-desc').hide();
                setFlag++;

            } else {
                if (setFlag == 0) {
                    $j('.show-desc').show();
                }


            }
        });

    });
    if (setFlag == 0) {
        $j('.show-desc').show();
    }
}
/*!---- responsive-----*/
/*!
 * jQuery lightweight responsive web adaptation plugin
 * Original author: @stildv
 * Copyright  2011: Devrim Vardar, @stildv -- http://stild.com/
 * Further changes, comments: @stildv -- http://stild.com/code/jquery-responsive-web/
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://stild.com/license/
 * Date: Thu Oct 20 01:27:32 2011 +0300
 * Version: 1.00 (20-OCT-2010)
 * PS. I am not a wonderful coder, I neither have the patience nor the repertoire so this is almost as good as I get. Cheers. :)
 */


(function($j, window, document, undefined) {

    $j.responsiveWeb = function(element, options) {

        var windowadaptTimeout;
        var tempCounter = 0;
        var winWidth;
        var winHeight;

        this.options = {};
        var that = this;
        element.data('responsiveWeb', this);

        this.init = function(element, options) {
            this.options = $j.extend({}, $j.responsiveWeb.defaultOptions, options);
            options = this.options;
            element.resize(checkResize);
            checkResize();
            if (options.manipulateDesign) {
                manipulateDesign();
            }
        };

        function delayedResize() {
            options = that.options;
            //window.status = ++tempCounter;
            var winNewWidth = $j(window).width();
            var winNewHeight = $j(window).height();
            if (winWidth != winNewWidth || winHeight != winNewHeight) {
                winWidth = winNewWidth;
                winHeight = winNewHeight;

                if (options.applyBodyClasses) {
                    applyBodyClasses();
                }
                if (options.rearrangeObjects) {
                    rearrangeObjects();
                }
            }
            //$j('body div.loadingDiv').remove();
        }

        function checkResize() {
            //window.scrollTo(0, 1);
            //$j('body').append('<div class="loadingDiv" style="width:100%;height:100%;position:absolute;left:0;top:0;zoom:1;filter:alpha(opacity=85);opacity:0.85;background:#AAA url(\'img/loading.gif\') no-repeat center center;">loading...</div>');
            window.clearTimeout(windowadaptTimeout);
            windowadaptTimeout = window.setTimeout(delayedResize, 250);
        }

        function applyBodyClasses() {
            options = that.options;
            clearBodyClasses();

            var currcC = '';
            var tmpWidth = decideResolution();
            var tmpArrWidth = tmpWidth.split(" ");
            tmpWidth = tmpArrWidth[0];
            if (options.applyPlatform) {
                currcC += decidePlatform();
            }
            if (options.applyBrowser) {
                currcC += decideBrowser();
            }
            if (options.applyResolution) {
                currcC += decideResolution();
            }
            $j('body').addClass(currcC);
            $j('body').attr("data-width", tmpWidth.substr(1));

            if (options.debug) {
                log(winWidth + 'x' + winHeight + ' || ' + $j('body').attr('class'));
            }
        }

        function log(str) {
            var debugDiv = '<div class="debugDiv" style="position:absolute;top:0;right:0;padding:2px;background:black;color:lime;font-size:9px;line-height:9px;"></div>';
            if ($j('.debugDiv ul').length) {
                $j('.debugDiv ul').append('<li>' + str + '</li>');
            } else {
                $j('body').append(debugDiv);
                $j('.debugDiv').append('<ul></ul>');
                $j('.debugDiv ul').append('<li>' + str + '</li>');
            }
        }

        function decidePlatform() {
            var cC = '';

            var platform = navigator.userAgent;
            if (platform.indexOf('Windows') > 0) {
                cC = 'windows' + ' ';
            } else if (platform.indexOf('Linux') > 0 && platform.indexOf('Android') < 0) {
                cC = 'linux' + ' ';
            } else if (platform.indexOf('Mac') > 0 && (platform.indexOf('iphone') < 0 || platform.indexOf('ipad') < 0)) {
                cC = 'mac' + ' ';
            } else if (platform.indexOf('iPhone') > 0) {
                cC = 'iphone' + ' ';
            } else if (platform.indexOf('iPad') > 0) {
                cC = 'ipad' + ' ';
            } else if (platform.indexOf('Android') > 0) {
                cC = 'android' + ' ';
            }

            return cC;
        }

        function decideBrowser() {
            var cC = '';
            options = that.options;

            var nVer = navigator.appVersion;
            var nAgt = navigator.userAgent;
            var browserName = navigator.appName;
            var fullVersion = '' + parseFloat(navigator.appVersion);
            var majorVersion = parseInt(navigator.appVersion, 10);
            var nameOffset, verOffset, ix;

            if ((verOffset = nAgt.indexOf("Opera")) != -1) {
                browserName = "opera";
                fullVersion = nAgt.substring(verOffset + 6);
                if ((verOffset = nAgt.indexOf("Version")) != -1)
                    fullVersion = nAgt.substring(verOffset + 8);
            } else if ((verOffset = nAgt.indexOf("MSIE")) != -1) {
                browserName = "msie";
                fullVersion = nAgt.substring(verOffset + 5);
            } else if ((verOffset = nAgt.indexOf("Chrome")) != -1) {
                browserName = "chrome";
                fullVersion = nAgt.substring(verOffset + 7);
            } else if ((verOffset = nAgt.indexOf("Safari")) != -1) {
                browserName = "safari";
                fullVersion = nAgt.substring(verOffset + 7);
                if ((verOffset = nAgt.indexOf("Version")) != -1)
                    fullVersion = nAgt.substring(verOffset + 8);
            } else if ((verOffset = nAgt.indexOf("Firefox")) != -1) {
                browserName = "firefox";
                fullVersion = nAgt.substring(verOffset + 8);
            } else if ((nameOffset = nAgt.lastIndexOf(' ') + 1) < (verOffset = nAgt.lastIndexOf('/'))) {
                browserName = nAgt.substring(nameOffset, verOffset);
                fullVersion = nAgt.substring(verOffset + 1);
                if (browserName.toLowerCase() == browserName.toUpperCase()) {
                    browserName = navigator.appName;
                }
            }
            if ((ix = fullVersion.indexOf(";")) != -1) fullVersion = fullVersion.substring(0, ix);
            if ((ix = fullVersion.indexOf(" ")) != -1) fullVersion = fullVersion.substring(0, ix);

            majorVersion = parseInt('' + fullVersion, 10);
            if (isNaN(majorVersion)) {
                fullVersion = '' + parseFloat(navigator.appVersion);
                majorVersion = parseInt(navigator.appVersion, 10);
            }

            if (options.applyBrowser) {
                cC += browserName + ' ';
            }
            if (options.applyBrowserVersion) {
                cC += browserName + majorVersion + ' ';
            }

            return cC;
        }

        function decideResolution() {
            var h = $j(window).height();
            var w = $j(window).width();
            var cC = '';

            if (w >= 1880) {
                cC = 'w1920' + ' ';
            } else if (w >= 1560) {
                cC = 'w1600' + ' ';
            } else if (w >= 1400) {
                cC = 'w1440' + ' ';
            } else if (w >= 1240) {
                cC = 'w1280' + ' ';
            } else if (w >= 984) {
                cC = 'w1024' + ' ';
            } else if (w >= 728) {
                cC = 'w768' + ' ';
            } else if (w >= 440) {
                cC = 'w480' + ' ';
            } else if (w >= 280) {
                cC = 'w320' + ' ';
            } else {
                cC = 'wtiny' + ' ';
            }

            if (h >= 864) {
                cC += 'h1024' + ' ';
            } else if (h >= 740) {
                cC += 'h900' + ' ';
            } else if (h >= 608) {
                cC += 'h768' + ' ';
            } else if (h >= 440) {
                cC += 'h600' + ' ';
            } else if (h >= 320) {
                cC += 'h480' + ' ';
            } else {
                cC += 'htiny' + ' ';
            }

            return cC;
        }

        function clearBodyClasses() {
            $j('body').removeClass('w1920 w1600 w1440 w1280 w1024 w768 w480 w320 wtiny h1024 h900 h768 h600 h480 htiny');
        }

        this.init(element, options);
    };

    $j.fn.responsiveWeb = function(options) {
        return this.each(function() {
            (new $j.responsiveWeb($j(this), options));
        });
    };


    $j.responsiveWeb.defaultOptions = {
        applyBodyClasses: true,
        applyResolution: true,
        applyPlatform: true,
        applyBrowser: true,
        applyBrowserVersion: true,
        manipulateDesign: true,
        rearrangeObjects: true,
        debug: false
    };

})($j, window, document);

var isTab = '';

function manipulateDesign() {}


function viewport() {
    var e = window,
        a = 'inner';
    if (!('innerWidth' in window)) {
        a = 'client';
        e = document.documentElement || document.body;
    }
    return {
        width: e[a + 'Width'],
        height: e[a + 'Height']
    };
}

var susSlider;
var slider = false,
    carousal = false;
setFlag = 0;
var avoidFirstLoad = 0;

function rearrangeObjects() {

    if ($j(window).width() > 767) {
        $j('.section').each(function() {
            setEqualHeight_CommonClass($j(this).find('.hsp-main'));
        });
    }


    /*======ANNUAL REPORT JS STARTS==============*/
    if ($j('.graph').length > 0) {
        //    resizeAllPiechart();
    }
    if ($j(".ar-popup-container-outer").length > 0) {

        var FinalHei = $j(".ar-popup-container-outer").height();
        var MarTop = FinalHei / 2;
        $j(".ar-popup-container-outer").css("margin-top", -MarTop);
    }
    /*======ANNUAL REPORT JS ENDS==============*/



    if ($j('.new-site-fw,.home-fw').length > 0) {
        fullwidthresponsiveElements();
        sliderArw();
    }
    //if(viewport().width > 1199){
    setEqualHeight_CommonClass('#home-content-container .hsp-main');
    setEqualHeight_CommonClass('#channels-wrapper .brick');
    //}
    if (viewport().width < 1200) {
        $j('.hsp-news').css('height', $j('.hsp-innovation').height());
    }
    if (viewport().width < 991) {
        $j('body').removeClass('megamenuhover');
        $j('.show-ul-outer').removeClass('white-bg');
    }
    //window.setTimeout(FrameManager.resizeFrames, 300);

    /* View MOre Menu Start */

    /* View More Menu End */


    currWidth = viewport().width;
    /* $j(".new-bread-div-active ul").append($j(".new-bread-div-active li.hideshow ul").html());
     $j(".new-bread-div-active li.hideshow").remove();
     if(setFlag!=0)
     {
     moreMenu();
     
     }
     setFlag++;*/
    $j('.whtie-slider-wrapper .bx-viewport, .blue-slider-wrapper .bx-viewport').css('height', 'auto');


    $j(".animate-image").height($j(".animate-image>img").height());


    /* --------- Insights Blog - Starts - added by Pritesh 8 July 2015 -------- */

    if (currWidth > 804) {
        $j(".inCategories > ul").css("display", "block");
        setTimeout(function() {

            setEqualHeight_CommonClass(".section2 .boxContent");
            setEqualHeight_CommonClass(".section2 .boxcolContainer");
            setEqualHeight_CommonClass(".section3a .boxContent");
            setEqualHeight_CommonClass(".section3a .boxcolContainer");
        }, 1000);
    }

    if (currWidth < 805) {
        setTimeout(function() {
            $j(".section2 .boxContent").height('auto');
            $j(".section2 .boxcolContainer").height('auto');
            $j(".section3a .boxContent").height('auto');
            $j(".section3a .boxcolContainer").height('auto');

        }, 1000);


        $j(".inCategories > ul").css("display", "none");
        $j(".inCatMobi a").removeClass("active");

        $j(".inCatMobi > a").unbind().bind('click').click(function(e) {
            e.preventDefault();
            //alert("hi");
            $j(this).toggleClass("active");
            $j(".inCategories > ul").toggle();

        });


        $j(".inHomeWrapper .inCategories ul li a.inClick").unbind().bind('click').click(function(e) {
            e.preventDefault();

            tagsList = $j(this).parent().attr("data-id");

            $j(".insightSection1").css("display", "none");
            $j(".insightTop2").css("display", "block");
            $j(".inSubTags a").removeClass("current").parent().css("display", "none");
            $j('.inSubTags a.' + tagsList).parent().show();
            $j(".inCategories li").removeClass("current");
            $j(".inCatMobi a").toggleClass("active");
            $j(".inCategories > ul").toggle();
            $j(this).parent().addClass("current");
            loadStories("*", $j(".inCategories li.current").attr("data-id"));
            $j(".insightSection2").addClass("loading");

        });
    } else {

        //on category click

        $j(".inHomeWrapper .inCategories ul li a.inClick").unbind().bind('click').click(function(e) {
            e.preventDefault();

            tagsList = $j(this).parent().attr("data-id");

            $j(".insightSection1").css("display", "none");
            $j(".insightTop2").css("display", "block");
            $j(".inSubTags a").removeClass("current").parent().css("display", "none");
            $j('.inSubTags a.' + tagsList).parent().show();
            $j(".inCategories li").removeClass("current");
            $j(this).parent().addClass("current");
            loadStories("*", $j(".inCategories li.current").attr("data-id"));
            $j(".insightSection2").addClass("loading");

        });

    }



    /* --------- Insights Blog - Ends -------- */

    /* --------- New Tab Logic Starts -------- */
    var tabFlag = 0;
    if (currWidth > 767) {
        $j('#twocolright .desktop-view, #twocolright .mobile-view').removeClass('forceSnap');
        var ulWidth = parseInt($j(".tabs-container ul").width());
        var liWidth = 0;
        var liLength = parseInt($j(".tabs-container ul li").length);

        $j(".tabs-container ul li").each(function(i) {

            liWidth += parseInt($j(this).width()) + 3;

            if ((i + 1) == liLength) {
                var marginGap = (liLength - 1) * 3;
                if (liWidth > ulWidth) {
                    tabFlag = 1;
                }
            }
        });
    }
    if (tabFlag === 1) {
        $j('#twocolright .desktop-view, #twocolright .mobile-view').addClass('forceSnap');
    } else {
        $j('#twocolright .desktop-view, #twocolright .mobile-view').removeClass('forceSnap');
    }
    if (currWidth > 767 && tabFlag === 0) {
        /*------------- Tabs starts ---------------*/
        if ($j(".tabs-container").length > 0 && $j(".content-tab-item").length <= 0) {
            getHashData(".tabs-container ul li", ".content-wrapper");
            $j(".mobile-view .snapdown-content").html('');
        }
        /*------------- Tabs ends ---------------*/
    } else {
        /*------------- Tabs starts ---------------*/
        if ($j(".tabs-container").length > 0) {
            $j(".mobile-view .snapdown-item.current .snapdown-title-container").addClass("snapopen");
            getHashData(".mobile-view .snapdown-item", "selectSib");
            $j(".desktop-view .content-wrapper").html('');
        }
        /*------------- Tabs ends ---------------*/
    }
    /* --------- New Tab Logic Ends -------- */

    if (currWidth > 767 && currWidth < 800) {
        if (!$j(".lhs-snaphead").hasClass("open")) {
            $j(".lhs-snaphead").addClass("open");
            $j(".lhs-snapcontent").show();
        }
    }


    if (currWidth > 767) {
        setEqualHeight_CommonClass(".section2-box .box-head");

        setEqualHeight([".research-university-center-content", ".research-dropdown-container"]);

        /*------------- Header starts ---------------*/
        if ($j("html").hasClass("mm-opened")) {
            $j("#mob-menu-wrap").trigger("close.mm");
        }
        /*------------- Header ends ---------------*/

        /*------------- Footer starts ---------------*/
        $j(".col1 .footer-header").removeClass("footer-snap-head");
        $j(".col1 .footer-content").show();
        /*------------- Footer ends ---------------*/


        /*------------- Equal height for contacts slider starts -------------*/

        $j('.fw-contact-cards-sld').each(function() {
            setEqualHeight_CommonClass($j(this).find('.fw-contact-cards-box .cc-ttl'));
            setEqualHeight_CommonClass($j(this).find('.fw-contact-cards-box .cc-info'));
        });

        /*------------- Equal height for contacts slider ends -------------*/

        /*------------- Equal height for tabs starts -------------*/

        setTimeout(function() {
            $j('.tabs').each(function() {
                if ($j(window).width() > 767) {
                    setEqualHeight_CommonClass($j(this).find('li a'));
                    setEqualHeight_CommonClass($j(this).find('li'));
                } else {
                    $j(this).find('li a').height('auto');
                    $j(this).find('li').height('auto');
                }
            });
        }, 500);

        /*------------- Equal height for tabs ends -------------*/

        /*------------- Equal height for products slider starts -------------*/

        $j('.general-listing').each(function() {
            setEqualHeight_CommonClass($j(this).find('.product-item-top'));
        });

        /*------------- Equal height for products slider ends -------------*/

        setEqualHeight_CommonClass(".tabs-container ul li a span");

        if ($j("body").hasClass("msie") || $j("body").hasClass("Netscape")) {
            $j(".tabs-container ul li a span").height(parseInt($j(".tabs-container ul li a span").height()) + 1);
        }

        /*--------------------for Tren XWB Technology------------------*/
        $j('.breakdown-items dt a').removeClass('hidehoverinfo');

        /*--------------------- Customer Landing ---------------*/
        setEqualHeight_CommonClass(".customer-content-container .landing-page-item-image");

        /*----------------- Static Tabs -----------------*/
        setEqualHeight_CommonClass(".static-tab");

        $j(".static-tab.current").removeClass("current");
        var currentTab = $j(".static-tab-wrap .snapdown-content:visible").attr("id");
        $j(".static-tab[data-tab='" + currentTab + "']").addClass("current");

        /*----------- KPI landing starts ---------*/
        $j(".kpi-nav").show();
        $j(".kpi-nav").removeClass("mobiNav");
        setEqualHeight_CommonClass(".kpi-title");
        setEqualHeight_CommonClass(".kpi-item-inner");
        setEqualHeight([".kpi-box1 .kpi-title-bar", ".kpi-box2 .kpi-title-bar"]);
        setEqualHeight([".kpi-box1 .kpi-content-bar", ".kpi-box2 .kpi-content-bar"]);
        setEqualHeight_CommonClass(".kpi-small-box .kpi-title-bar");
        setEqualHeight_CommonClass(".kpi-small-box .kpi-content-bar");
        setEqualHeight([".kpi-box7 .kpi-title-bar", ".kpi-box8 .kpi-title-bar"]);
        setEqualHeight([".kpi-box7 .kpi-content-bar", ".kpi-box8 .kpi-content-bar"]);

        /*----------- KPI landing ends ---------*/
    } else {

        $j(".kpi-title-bar,.kpi-content-bar").height('auto');
        $j(".research-university-center-content,.kpi-title,.kpi-item-inner,.kpi-image-bar.kpi-signpost-wrap .kpi-signpost-wrapper .left-signpost-wrapper").height('auto');

        $j(".kpi-nav").addClass("mobiNav");
        $j(".research-dropdown-container").height('auto');

        $j(".section2-box .box-head").height("auto");
        /*------------- Footer starts ---------------*/
        $j(".col1 .footer-header").addClass("footer-snap-head");
        if ($j(".col1 .footer-header").hasClass("open")) {
            $j(".col1 .footer-content").show();
        } else {
            $j(".col1 .footer-content").hide();
        }
        /*------------- Footer ends ---------------*/

        /*--------------------for Tren XWB Technology------------------*/
        $j('.breakdown-items dt a').addClass('hidehoverinfo');

        /*--------------------- Customer Landing ---------------*/
        $j(".customer-content-container .landing-page-item-image,.kpi-item-inner").height('auto');
    }


    /*----------- KPI landing starts ---------*/
    if ($j(".kpi-nav").is(":visible"))
        setEqualHeight_CommonClass($j(".kpi-nav li"));
    /*----------- KPI landing ends ---------*/


    if (currWidth >= 641 && currWidth <= 800) {
        //setEqualHeight_CommonClass(".left-signpost-wrapper");
        setEqualHeight_CommonClass(".left-signpost-wrapper");
    } else {
        //$j(".left-signpost-wrapper").height('auto');
        $j(".left-signpost-wrapper").height('auto');
    }

    if (currWidth >= 480) {

        if ($j(".showCarousal").length > 0) {
            var slideWidth = (parseInt($j(".showCarousal").width()) - 10) / 2;
            if ($j(".landing-page-content>.landing-page-item").length > 2) {
                if (susCarousal != undefined)
                    susCarousal.destroySlider();
                if (slider) {
                    susSlider.destroySlider();
                    slider = false;
                }
                carousal = true;
                susCarousal = $j(".showCarousal .landing-page-content").bxSlider({
                    infiniteLoop: false,
                    pager: false,
                    hideControlOnEnd: true,
                    touchEnabled: false,
                    maxSlides: 2,
                    slideWidth: slideWidth,
                    adaptiveHeight: true,
                    slideMargin: 0
                });
                $j(".showCarousal .bx-wrapper").css('max-width', $j(".showCarousal").width());
            }
        }

        /*------------ Bottom Signpost Carousal ---------------*/
        var slideWidth = (parseInt($j(".showCarousal").width()) - 10) / 2;
        if ($j(".showCarousal .signpost-container>.signpost-item").length > 2) {
            if (susCarousal != undefined)
                susCarousal.destroySlider();
            if (slider) {
                susSlider.destroySlider();
                slider = false;
            }
            carousal = true;
            susCarousal = $j(".showCarousal .signpost-container").bxSlider({
                infiniteLoop: false,
                pager: false,
                hideControlOnEnd: true,
                touchEnabled: false,
                maxSlides: 2,
                slideWidth: slideWidth,
                adaptiveHeight: true,
                slideMargin: 0
            });
            $j(".showCarousal .bx-wrapper").css('max-width', $j(".showCarousal").width());
        }
        /*------------ Bottom Signpost Carousal ---------------*/


        setEqualHeight_CommonClass(".landing-page-item-outer.is-not-hover .landing-page-item-title-container");
        setEqualHeight_CommonClass(".board-item-title-outer");
        setEqualHeight_CommonClass(".landing-page-item-bottom-container");
        setEqualHeight_CommonClass(".signpost-item-title-container");
        setEqualHeight_CommonClass(".landing-box");


        setEqualHeight_CommonClass("span.inv-lnd-title");
        setEqualHeight_CommonClass("span.inv-lnd-title-top");
        setEqualHeight_CommonClass(".inv-lnd-link .inv-box-cont");
        setEqualHeight_CommonClass(".inv-lnd-bx-img");

    } else {
        $j(".landing-page-item-outer.is-not-hover .landing-page-item-title-container").height('auto');
        $j(".board-item-title-outer").height('auto');
        $j(".landing-page-item-bottom-container").height('auto');
        $j(".landing-box").height('auto');
        $j(".signpost-item-title-container").height('auto');
        if ($j(".showCarousal").length > 0) {
            if (!slider) {
                if ($j(".landing-page-content>.landing-page-item").length > 2) {
                    if (carousal) {
                        susCarousal.destroySlider();
                        carousal = false;
                    }
                    slider = true;
                    susSlider = $j('.showCarousal .landing-page-content').bxSlider({
                        infiniteLoop: false,
                        pager: false,
                        controls: true,
                        hideControlOnEnd: true,
                        touchEnabled: false,
                        auto: true,
                        adaptiveHeight: true
                    });
                }
            }
        }
        /*------------ Bottom Signpost Carousal ---------------*/
        if (!slider) {
            if ($j(".showCarousal .signpost-container>.signpost-item").length > 2) {
                if (carousal) {
                    susCarousal.destroySlider();
                    carousal = false;
                }
                slider = true;
                susSlider = $j('.showCarousal .signpost-container').bxSlider({
                    infiniteLoop: false,
                    pager: false,
                    controls: true,
                    hideControlOnEnd: true,
                    touchEnabled: false,
                    auto: true,

                    adaptiveHeight: true
                });
            }
        }
        /*------------ Bottom Signpost Carousal ---------------*/

        $j(".inv-lnd-title,.inv-lnd-title-top,.inv-lnd-link .inv-box-cont,.inv-lnd-bx-img").height("auto");
    }

    if (currWidth > 767) {
        setEqualHeight_CommonClass(".kpi-signpost-wrap .kpi-signpost-wrapper .left-signpost-wrapper");
    } else {
        $j(".left-signpost-wrapper").height('auto');
    }

    /*-------------- Popup module ---------------*/

    if ($j(window).width() > '640') {
        setEqualHeight_CommonClass('.popup-story-module .hsp-main .hsp-img img');
    } else {
        $j('.popup-story-module .hsp-main .hsp-img img').height('auto');
    }
    /*-------------- Popup module ---------------*/


    /*--------------About us  - - Leadership Page---------*/
    if ($j("#leadership-content-container").length > 0) {
        $j('.bod-group').each(function() {
            setEqualHeight_CommonClass($j(this).find(".people-image"));
            setEqualHeight_CommonClass($j(this).find(".people-info"));
            setEqualHeight_CommonClass($j(this).find(".bod-item"));
        });
        if (currWidth > 991) {
            bodProcess($j(".bodWrapper"), "desktop", 3);
        } else if (currWidth < 992 && currWidth >= 640) {
            bodProcess($j(".bodWrapper"), "tablet", 2);
        } else {
            bodProcess($j(".bodWrapper"), "mobile", 1);
        }
    }

}

$j(document).ready(function() {

    $j(window).responsiveWeb({
        applyBodyClasses: true,
        applyResolution: true,
        applyPlatform: true,
        applyBrowser: true,
        applyBrowserVersion: false,
        manipulateDesign: true,
        rearrangeObjects: true
    });

    trimIt(60, $j(".ellipsis>a"), '...');
    /*------------------- Tabs Async starts ------------- */

    $j(document).on('click', '.tabs-container ul li a', function(e) {
        //$j(".tabs-container ul li a").click(function (e) {

        if ($j(".content-tab-item").length <= 0) {
            e.preventDefault();
            //alert("clicked");

            if (!($j(".loader").is(":visible")) && !($j(this).parent().hasClass("current")) && $j(".tabs-container").length > 0) {
                isTab = 'true';
                getAsyncData($j(this), ".content-wrapper");
            }
        }
    });




    /*------------------- Browser back button for tab starts ------------- 
    window.onhashchange = myFunction;
    function myFunction() {
      var hashu = window.location.hash.substring(0, window.location.hash.length);
      
      if(hashu === 'undefined' || hashu === '')
      {
      }else{
        
        if(isTab == 'true')
        {
          isTab = 'false';
        }
        else
        {
          
          //getAsyncData($j(".tabs-container li a[data-hash='"+hashu+"']"), ".content-wrapper");
        }
        
      }
    }
    ------------------- Browser back button for tab End ------------- */






    $j(document).on('click', '.mobile-view .snapdown-item>a', function(e) {
        //$j(".mobile-view .snapdown-item a").click(function (e) {
        e.preventDefault();
        var data = $j.trim($j(this).siblings(".snapdown-content").html());
        if (data == '') {
            var containerSelec = $j(this).siblings(".snapdown-content");
            getAsyncData($j(this), containerSelec);
        } else {
            window.location.hash = $j(this).attr("data-hash");
            if (data.indexOf("sitesearchpagination") > 0) {
                nextPage_URL = $j(this).siblings(".snapdown-content").find('.sitesearchpagination').children('ul').find('li.pagerlink.pageloaded:last').next('.pagerlink').children('a').attr('href');
            }

        }

    });
    /*------------------- Tabs Async Ends ------------- */

    /*------------------ Load More publications starts -------------*/
    //loadMore_Pagination('.sitesearchpagination', '.publication-wrapper', '.content-wrapper', 'LOAD MORE');
    /*------------------ Load More publications ends -------------*/

});

$j(window).load(function() {
    rearrangeObjects();

    // $j(".bx-viewport").height("auto");
    $j(".showCarousal .bx-viewport").height($j(".landing-page-content").height());

    if ($j('.secondlevelnextall li > span').length > 0) {
        $j('.secondlevelmore').addClass('hasActiveEle');
    } else {
        $j('.secondlevelmore').removeClass('hasActiveEle');
    }

});



$j(document).ajaxComplete(function() {

    /* ------------------ File extension to UPPERCASE in title attribute ------------------ */
    $j("a.extension-link[title]").each(function() {
        var tmpTxt = $j(this).attr("title").split(",");
        if (tmpTxt.length > 1) {
            tmpTxt[0] = tmpTxt[0].toUpperCase();
        }
        $j(this).attr("title", tmpTxt.join());
    });

    $j("img.extension-link-img[alt]").each(function() {
        var tmpTxt = $j(this).attr("alt").split(",");
        var tmpTxt1 = tmpTxt[1].split(",");
        if (tmpTxt.length > 1 && tmpTxt1.length > 1) {
            tmpTxt1[0] = tmpTxt1[0].toUpperCase();
        }
        $j(this).attr("alt", tmpTxt[0] + ',' + tmpTxt1.join());
    });
    /* ------------------ <END> File extension to UPPERCASE in title attribute ------------ */

    if (reloadPagination && $j(".publication-wrapper")) {
        /*------------------ Load More publications starts -------------*/
        $j('.sitesearchpagination').each(function() {
            if ($j(this).parents(".publication-wrapper").hasClass("load-pagination")) {
                loadMore_Pagination_Publication($j(this), '.publication-container-wrap', '.publication-container-wrap', 'LOAD MORE');
                reloadPagination = false;
            }
        });

        /*------------------ Load More publications ends -------------*/
    }

    /* -------------- Scrolling Table starts ------------- */
    $j(".page-content table").not("table[id^='inv-responsive']").each(function() {
        $j(this).wrap('<div class="scroll-table-container" />');
    });

    $j('.breakdown').each(function() {
        $j(this).addClass('scroll-table-container');
    });
    /* -------------- Scrolling Table ends ------------- */

    /* ----- Remove Extra Heading Starts ---- */
    $j('.snapdown-container .snapdown-item').each(function() {
        var snapheading = $j.trim($j(this).find('.snapdown-content .page-content h2:first-child').text());
        var snapTitle = $j.trim($j(this).find('.snapdown-title').text());
        if (snapTitle == snapheading) {
            $j(this).find('.snapdown-content .page-content h2:first-child').addClass('invisible');
        }
    });
    /* ----- Remove Extra Heading Ends ---- */

});
/*------------- Set equal height function Starts -------------- */
function setEqualHeight_CommonClass(arr) {
    var x = new Array([]);
    $j(arr).each(function(i) {
        $j(this).height('auto');
        x[i] = $j(this).height();
    });
    Max_Value = Array.max(x);
    $j(arr).each(function(i) {
        //if($j(arr[i]).height() != Max_Value)
        //	{x[i] = $j(arr[i]).height(Max_Value);}
        $j(this).height(Max_Value);
    });
}

function setEqualHeight(arr) {
    var x = new Array([]);
    for (i = 0; i < arr.length; i++) {
        x[i] = $j(arr[i]).height('auto');
        x[i] = $j(arr[i]).height();
    }
    Max_Value = Array.max(x);
    for (i = 0; i < arr.length; i++) {
        //if($j(arr[i]).height() != Max_Value)
        // {x[i] = $j(arr[i]).height(Max_Value);}
        x[i] = $j(arr[i]).height(Max_Value);
    }
}

Array.max = function(array) {
    return Math.max.apply(Math, array);
};
/*------------- Set equal height function Ends -------------- */
var reloadPagination = false;
/*------------- Async functions Starts -------------- */
function getAsyncData(selector, containerName) {

    var thisSelec = selector;
    var hash = window.location.hash.substring(1, window.location.hash.length);
    if (hash === '') {} else {
        $j(".tabs-container ul li.current").removeClass("current");
        $j(".mobile-view .snapdown-item.current").removeClass("current");
    }

    $j(containerName).html('<div class="show-loader"></div>').addClass("loader").show();

    var requestPage_URL = $j(thisSelec).attr("href") + "?async=1";

    finalURL = encodeURI(requestPage_URL);

    /* For async data GA tracking */
    /* 
     _gaq.push(['_trackPageview', finalURL]);
     var filetypes = /\.(zip.*|exe.*|dmg.*|pdf.*|doc.*|xls.*|ppt.*|ics.*|vcf.*|mp3.*|txt.*|rar.*|wma.*|mov.*|avi.*|wmv.*|flv.*|wav.*)$/i;
     
     var baseHref = '';
     if ($j('base').attr('href') != undefined) baseHref = $j('base').attr('href');
     var hrefRedirect = '';
     
     $j('body').on('click', 'a', function(event) {
       
       var el = $j(this);
       var track = true;
       var href = (typeof(el.attr('href')) != 'undefined' ) ? el.attr('href') : '';
       var isThisDomain = href.match(document.domain.split('.').reverse()[1] + '.' + document.domain.split('.').reverse()[0]);
       if (!href.match(/^javascript:/i)) {
         var elEv = []; elEv.value=0, elEv.non_i=false;
         if (href.match(/^mailto\:/i)) {
           elEv.category = 'email';
           elEv.action = 'click';
           elEv.label = href.replace(/^mailto\:/i, '');
           elEv.loc = href;
         }
         else if (href.match(filetypes)) {
           var extension = (/[.]/.exec(href)) ? /[^.]+$/.exec(href) : undefined;
           elEv.category = 'download';
           elEv.action = 'click-' + extension[0];
           elEv.label = href.replace(/ /g,'-');
           elEv.loc = baseHref + href;
         }
           else if (href.match(/^https?\:/i) && !isThisDomain) {
             elEv.category = 'external';
             elEv.action = 'click';
             elEv.label = href.replace(/^https?\:\/\//i, '');
             elEv.non_i = true;
             elEv.loc = href;
           }
             else if (href.match(/^tel\:/i)) {
               elEv.category = 'telephone';
               elEv.action = 'click';
               elEv.label = href.replace(/^tel\:/i, '');
               elEv.loc = href;
             }
               else track = false;
         
         
         if (track) {
           var ret = true;
           
           if((elEv.category == 'external' || elEv.category == 'download') && (el.attr('target') == undefined || el.attr('target').toLowerCase() != '_blank') ) {
             hrefRedirect = elEv.loc;
             _gaq.push(["_trackEvent", elEv.category.toLowerCase() , href]);
             
             ret = true;
           }
           else {
             
             _gaq.push(["_trackEvent", elEv.category.toLowerCase() , href]);
           }
           
           return ret;
         }
       }
       
       
       
     });*/
    /* For async data GA tracking */




    $j("#loadedContent").load(finalURL, function(data) {
        $j(containerName).removeClass("loader").html(data);
        if (data.indexOf("sitesearchpagination") >= 0) {
            reloadPagination = true;
            $j(".publication-wrapper").removeClass("load-pagination");
            $j(containerName).children(".publication-wrapper").addClass("load-pagination");
        }

        $j("#loadedContent").html('');
        $j(thisSelec).parent().addClass("current");
        window.location.hash = $j(thisSelec).attr("data-hash");

    });
}

function getHashData(selector, toLoadCont) {
    var hash = window.location.hash.substring(1, window.location.hash.length);
    if (hash === '') {
        var aSelec = selector + ".current a";
        if (toLoadCont == "selectSib") {
            aSelec = selector + " a.snapopen";
            toLoadCont = $j(aSelec).siblings(".snapdown-content");
        }
        getAsyncData(aSelec, toLoadCont);
    } else {
        var aSelec = selector + " a[data-hash=" + hash + "]";
        //var parentS = findParent(hash, spanSelec);
        if (aSelec != undefined) {
            if (toLoadCont == "selectSib") {
                toLoadCont = $j(aSelec).siblings(".snapdown-content");
                if ($j(aSelec).siblings(".snapdown-content").css("display") == "none") {
                    $j(aSelec).trigger("click");
                    getAsyncData(aSelec, toLoadCont);
                } else if ($j.trim($j(aSelec).siblings(".snapdown-content").html()) == '') {
                    getAsyncData(aSelec, toLoadCont);
                }
            } else {
                if (!($j(aSelec).parent().hasClass("current"))) {
                    getAsyncData(aSelec, toLoadCont);
                }
            }
        }

    }
}

function findParent(hash, selector) {
    var returnVal = "null";
    $j(selector).each(function() {
        var currentVal = $j(this).data("name");
        if (currentVal == hash.toLowerCase()) {
            returnVal = $j(this).parent();
            return false;
        } else {}
    });
    return returnVal;
}

/*------------- Async functions Ends -------------- */

/* -------- Load More with pagination Starts ------------ */
var nextPage_URL, g_ajax_Page_id, g_append_id, g_load_Text = "";

function loadMore_Pagination_Publication(pagination_id, ajax_Page_id, append_id, load_Text) {
    if ($j(pagination_id).length > 0 && $j(pagination_id).siblings(".loadmore").length <= 0) {
        $j('<div class="loader">LOADING...</div><div class="loadmore"><a href="#">' + load_Text + '</a></div>').insertAfter(pagination_id);
        nextPage_URL = $j(pagination_id).children('ul').find('li.pagerlink.pageloaded:last').next('.pagerlink').children('a').attr('href');

        g_ajax_Page_id = ajax_Page_id;
        g_append_id = append_id;
        g_load_Text = load_Text;

        //alert(nextPage_URL);
        $j(pagination_id).hide();
    }

    if (typeof nextPage_URL === 'undefined') {
        //alert("Finish loading");
        $j('#loadmore').hide();
    }

}

$j(document).on('click', ".loadmore a", function(e) {

    e.preventDefault();
    if (!($j(".loader").is(":visible"))) {
        var thisSelec = $j(this);
        var thisParent = $j(this).parent();
        thisParent.siblings('.sitesearchpagination').children('ul').find('li.pagerlink.pageloaded:last').next('.pagerlink').addClass('pageloaded');
        thisParent.siblings('.loader').fadeIn();

        finalURL = encodeURI(nextPage_URL);

        _gaq.push(['_trackPageview', finalURL]);


        $j("#loadedcontent").load(finalURL + ' ' + g_ajax_Page_id, function(data) {

            thisParent.siblings('.loader').fadeOut();
            thisParent.parents(".page-content").children(g_append_id).append($j('#loadedcontent').children(g_ajax_Page_id).html());
            $j('#loadedcontent').html('');

            //updateURL();

        });

        nextPage_URL = thisParent.siblings('.sitesearchpagination').children('ul').find('li.pagerlink.pageloaded:last').next('.pagerlink').children('a').attr('href');
        if (typeof nextPage_URL === 'undefined') {
            //alert("Finish loading");
            thisParent.hide();

        }
    }
});
/* -------- Load More with pagination Ends ------------ */


function trimIt(my_char_limit, my_Str, my_append) {
    $j(my_Str).each(function() {
        var _curr_str = $j(this).html();
        my_Str = _curr_str.substring(0, my_char_limit);
        if (_curr_str.length > my_char_limit) {
            if (_curr_str.substring(my_char_limit, my_char_limit + 1) !== ' ') {
                //alert(my_Str);
                my_Str = my_Str.substring(0, my_Str.lastIndexOf(' '));
            }
            my_Str += my_append;
        }
        $j(this).html(my_Str);
    });
}

function slider_arrows_adjust(selector) {

    var currWidth = $j(window).innerWidth();

    $j(selector).each(function() {

        if ($j(this).find('.slick-dots > li').length > 0) {
            var totalWidth1 = 0;
            $j(this).find('.slick-dots > li').each(function() {
                totalWidth1 = totalWidth1 + $j(this).width();
            });

            var newPrevNext1 = (totalWidth1 * 2) + 50;

            if (currWidth < 768) {
                if ($j(this).find('.slick-dots > li').length > 8) {
                    $j(this).find('.slick-dots > li').hide();
                    //$j(this).parent().parent().find('.slick-initialized').addClass('morethen8dots');

                    $j(this).addClass('morethen8dots');

                    $j(this).find('.slick-arrow.slick-next').css('right', '-8px');
                    $j(this).find('.slick-arrow.slick-prev').css('left', '0');
                } else {
                    $j(this).find('.slick-dots > li').show();
                    //$j(this).parent().parent().find('.slick-initialized').removeClass('morethen8dots');

                    $j(this).removeClass('morethen8dots');

                    $j(this).find('.slick-arrow.slick-next').css('right', -(newPrevNext1 + 120));
                    $j(this).find('.slick-arrow.slick-prev').css('left', -(newPrevNext1 + 120));
                }
            } else {
                $j(this).find('.slick-dots > li').show();
                $j(this).parent().parent().find('.slick-initialized').removeClass('morethen8dots');
                $j(this).find('.slick-arrow.slick-next').css('right', -(newPrevNext1 + 120));
                $j(this).find('.slick-arrow.slick-prev').css('left', -(newPrevNext1 + 120));
            }
        }

    });
}


function getAsyncData(selector, containerName) {
    var thisSelec = selector;
    /*var hash = window.location.hash.substring(1, window.location.hash.length);
    if (hash === '') {} else {
        $j("#reportsCont ul li.current").removeClass("current");
    }*/

    $j(containerName).html('').addClass("loader");
    var requestPage_URL = $j(thisSelec).attr("href") + "?async=1";
    finalURL = encodeURI(requestPage_URL);
    trackURL = encodeURI($j(thisSelec).attr("href"));
    // ga('send', 'pageview', trackURL);
    $j("#loadedContent").load(finalURL, function() {
        $j(containerName).removeClass("loader").html($j("#loadedContent").html());
        $j("#loadedContent").html('');
    });
}
/*!---- responsive-table-----*/
;
(function($j, window, document, undefined) {

    $j.InvResponsiveTable = function(element, options) {
        // Extend default settings
        this.options = {};
        element.data('InvResponsiveTable', this);
        var that = this;
        this.init = function(element, options) {
            this.options = $j.extend({}, $j.fn.InvResponsiveTable.defaultOptions, options);
            options = this.options;
            var $table = element;
            if (!$table.hasClass(options.prefix + "-responsive-table-processed")) {
                var tableID = $table.attr("id");
                newID = "";
                if (tableID != "" && tableID !== undefined) {
                    newID = "id=" + options.prefix + "-" + tableID;
                }

                var tHeadData = new Array();
                $table.wrap('<div class="' + options.prefix + '-responsive-table clearfix"></div>');
                $table.parent().append('<div class="' + options.prefix + '-responsive-table-wrapper"></div>');
                $resWrapper = $table.parent().find('.' + options.prefix + '-responsive-table-wrapper');
                $table.css("display", "none");
                $table.find(options.headerRowData).each(function(index) {
                    tHeadData[index] = $j(this).html();
                });
                var tbl = '';
                //alert($table.find("tbody tr").length);
                $table.find("tbody tr").each(function(index) {
                    id = 'id="' + options.prefix + '-responsive-table-' + index + '" ';
                    tbl = '<table ' + id + ' class="' + options.prefix + '-responsive-table inv-responsive-table" border="0" cellspacing="0" cellpadding="0">';
                    tbl += '<tbody>';
                    if ($j(this).hasClass(options.ingoreHeaderClass)) {
                        SI = -1
                    } else {
                        SI = options.skipIndex;
                        if ($j(this).find("th:eq(0)").length > 0) {
                            tbl += '<tr class="' + options.prefix + '-responsive-header-tr inv-responsive-header-tr"><td class="' + options.prefix + '-responsive-header-td inv-responsive-header-td" colspan="2" >' + $j(this).find("th:eq(0)").html() + '</td></tr>';
                        } else {
                            tbl += '<tr class="' + options.prefix + '-responsive-header-tr inv-responsive-header-tr"><td class="' + options.prefix + '-responsive-header-td inv-responsive-header-td" colspan="2" >' + $j(this).find("td:eq(0)").html() + '</td></tr>';
                        }
                    }

                    tmpCnt = 1;
                    tmpLength = ($j(this).children().length - options.skipIndex);
                    $j(this).children().each(function(index) {
                        //alert(options.skipIndex);								
                        if (index > SI) {
                            cls = new Array();
                            clscnt = 0;
                            if (tmpCnt == 1) {
                                cls[clscnt] = options.prefix + '-responsive-data-tr-first inv-responsive-data-tr-first';
                                clscnt++
                            }
                            if (tmpCnt == (tmpLength - 1)) {
                                cls[clscnt] = options.prefix + '-responsive-data-tr-last inv-responsive-data-tr-last';
                                clscnt++
                            }
                            if (tmpCnt % 2 == 0) {
                                cls[clscnt] = options.prefix + '-responsive-data-tr-even inv-responsive-data-tr-even';
                                clscnt++
                            } else {
                                cls[clscnt] = options.prefix + '-responsive-data-tr-odd';
                                clscnt++
                            }
                            clsName = cls.join(" ");
                            //alert(clsName);
                            tbl += '<tr class="' + options.prefix + '-responsive-data-tr ' + clsName + '"><td class="' + options.prefix + '-responsive-data-td ' + options.prefix + '-responsive-data-header inv-responsive-data-header">' + tHeadData[index] + '</td><td class="' + options.prefix + '-responsive-data-td ' + options.prefix + '-responsive-data-content inv-responsive-data-content">' + $j(this).html() + '</td></tr>';
                            tmpCnt++;
                        }
                    });
                    tbl += '</tbody>';
                    tbl += '</table>';
                    tbl += '';
                    // alert(tbl);
                    $resWrapper.append(tbl);


                });
                $resWrapper.find(".inv-responsive-data-header br").remove();
                $table.addClass(options.prefix + "-responsive-table-processed");
                runPlugin($table);
                $j(window).resize(function() {
                    runPlugin($table);


                });
            }
        };

        function runPlugin($table) {
            options = that.options;

            /*----------- Check Table Min - Width Starts -----------*/
            $j($table).show();
            var table_min_width = $j($table).find('tr').width();
            $j($table).hide();
            if (table_min_width > $j($table).parent().width()) {
                options.switchWidth = $j(window).width();
            }
            /*----------- Check Table Min - Width Ends -------------*/

            if ($j(window).width() <= options.switchWidth) {
                $j('.' + options.prefix + '-responsive-table-wrapper').css({
                    "display": "block",
                    "clear": "both"
                });
                $table.css("display", "none");
            } else {
                $j('.' + options.prefix + '-responsive-table-wrapper').css("display", "none");
                $table.css("display", "table");
            }
        }


        this.init(element, options);
    }

    $j.fn.InvResponsiveTable = function(options) {
        return this.each(function() {
            (new $j.InvResponsiveTable($j(this), options));
        });
    };

    // set default option values

    if ($j(".TrainingPortalLanding table[id^=inv-responsive]").length > 0) {

        $j.fn.InvResponsiveTable.defaultOptions = {
            prefix: 'inv',
            headerRowData: 'thead tr:eq(0) th',
            switchWidth: 767,
            ingoreHeaderClass: 'ignore-header',
            skipIndex: 0

        };
    } else {
        $j.fn.InvResponsiveTable.defaultOptions = {
            prefix: 'inv',
            headerRowData: 'thead tr:eq(0) th',
            switchWidth: 800,
            ingoreHeaderClass: 'ignore-header',
            skipIndex: 0

        };
    }

})($j, window, document);


$j(document).ready(function() {

    $j('table[id^=inv-reponsive],table[id^=inv-responsive],.responsive-table').each(function() {

        $j(this).each(function(count) {
            $j(this).InvResponsiveTable({
                prefix: 'inv' + count
            });
        });
    });
});

$j(document).ajaxComplete(function() {

    $j('table[id^=inv-reponsive],table[id^=inv-responsive],.responsive-table').each(function() {
        $j(this).each(function(count) {
            $j(this).InvResponsiveTable({
                prefix: 'inv' + count

            });
        });
    });
});

/*!---- cookie-consent-----*/
var _cookiePlaceHolderSelector = "#MainWrapper"; // placeholder for cookie consent data and accept button
var _cookieWrapper = "_cookieConsentWrapper"
var _cookieName = "_cookieConsent"; // name of the cookie which will be used to store flag if user has clicked on i accept button

var _cookieContent = '<div class="MainWrapperInner container-fluid cWrap"><p><span class="cWrapInner cCookieText">We use cookies to make this website work better for you and to track site visits anonymously. You can opt out if you like.</span><span class="cWrapInner cWrapInnerLast"><a href="/site-services/use-of-cookies">Tell me more</a> <input name="cookieagree" id="cookie-agree" onclick="setCookies();" value="OK, continue" type="button"></span></p></div>';

// disclaimer content
document.write('<style type="text/css">');
document.write('#' + _cookieWrapper + '{margin-bottom: 0px;background:#fff; bottom: 0; position: fixed; width: 100%; z-index: 1002;border-top:2px solid #eeeeee;}');
document.write('#' + _cookieWrapper + ' p{color:#858585; margin:0 5px; padding-bottom:0;}');
//document.write('#' + _cookieWrapper + ' a{ display: block;  float: left;  margin: 0 10px 5px 0;  padding: 10px 20px 10px;  color: #fff;   background: #10069f;  margin-top: 0;  text-transform: uppercase;  font-size: 16px; line-height: 1.2;}');
document.write('#' + _cookieWrapper + ' a{display:inline-block;float:left;margin:0 10px 5px 0;padding:7px 20px 7px;color:#10069f;background:linear-gradient(to right,#fff 50%,transparent 0);margin-top:0;text-transform:uppercase;font-size:16px;border:2px solid #10069f;border-radius:50px;background-size:200% 85%;font-family:RRPioneer-Bold,Arial;webkit-transition:all .5s ease;-ms-transition:all .5s ease;-moz-transition:all .5s ease;-o-transition:all .5s ease;transition:all .5s ease;background-position:right bottom;border:2px solid #10069f;background-image:linear-gradient(to right,#10069f 50%,transparent 0);color:#10069f;}');

//document.write('#' + _cookieWrapper + ' a:hover{background: #006dff;}');
document.write('#' + _cookieWrapper + ' a:hover{background-position:left bottom;color:#fff!important;webkit-transition:all .5s ease;-ms-transition:all .5s ease;-moz-transition:all .5s ease;-o-transition:all .5s ease;transition:all .5s ease;}');
document.write('#' + _cookieWrapper + ' a:after{font-size:1em;margin-left:11px;top:0;position:relative;color:#10069f;content:"\\\e311";font-family:new-icomoon;-webkit-transition:all .5s ease;-ms-transition:all .5s ease;-moz-transition:all .5s ease;-o-transition:all .5s ease;transition:all .5s ease;vertical-align:bottom;}');
document.write('#' + _cookieWrapper + ' a:hover:after{color:#fff!important;}');
//document.write('#' + _cookieWrapper + ' input{     transition: all 0.25s ease 0s;cursor: pointer; padding: 10px 20px 10px;  border: 0px;  text-decoration: none; color: #fff; background: #10069f; font-size: 16px; margin-top: 0; text-transform: uppercase;}');
document.write('#' + _cookieWrapper + ' input{display:inline-block;float:left;margin:0 10px 5px 0;padding:8px 20px 8px;color:#10069f;background:linear-gradient(to right,#fff 50%,transparent 0);margin-top:0;text-transform:uppercase;font-size:16px;border:2px solid #10069f;border-radius:50px;background-size:200% 85%;font-family:RRPioneer-Bold,Arial;webkit-transition:all .5s ease;-ms-transition:all .5s ease;-moz-transition:all .5s ease;-o-transition:all .5s ease;transition:all .5s ease;background-position:right bottom;border:2px solid #10069f;background-image:linear-gradient(to right,#10069f 50%,transparent 0);color:#10069f;}');
document.write('#' + _cookieWrapper + ' input:hover{ background-position:left bottom;color:#fff!important;webkit-transition:all .5s ease;-ms-transition:all .5s ease;-moz-transition:all .5s ease;-o-transition:all .5s ease;transition:all .5s ease;}');
document.write('#' + _cookieWrapper + ' .cWrap{padding:10px 15px;}');
document.write('span.cWrapInner{float:left; font-size: 16px;    margin-bottom: 5px;} span.cWrapInner.cWrapInnerLast{margin:0;}');
document.write('</style>');

function setCookies(name, value, hours) {

    name = typeof name !== 'undefined' ? name : _cookieName;
    value = typeof value !== 'undefined' ? value : 'yes';
    hours = typeof hours !== 'undefined' ? hours : 8760;
    var expire = "";
    if (hours != null) {
        expire = new Date((new Date()).getTime() + hours * 86400000);
        expire = "; expires=" + expire.toGMTString();
    }
    document.cookie = name + "=" + escape(value) + expire + "; path=/";
    $j("#" + _cookieWrapper).slideUp().promise().done(function() {});

    /*-------------------------Setting of Section Div height Etc on cookie wrapper close Ends-----------------------*/
}

function GetCookie(name) {
    var cookieValue = "";
    var search = name + "=";
    if (document.cookie.length > 0) {
        offset = document.cookie.indexOf(search);
        if (offset != -1) {
            offset += search.length;
            end = document.cookie.indexOf(";", offset);
            if (end == -1) end = document.cookie.length;
            cookieValue = unescape(document.cookie.substring(offset, end))
        }
    }
    return cookieValue;
}

function checkCookies() {
    var cval = GetCookie(_cookieName);
    if (cval == "yes") {
        $j("#" + _cookieWrapper).css("display", "none");
    } else {
        $j("#" + _cookieWrapper).fadeIn(2000);


    }
}

function cookieSetup() {
    wrapperDiv = '<div id="' + _cookieWrapper + '">' + _cookieContent + '</div>';
    $j(wrapperDiv).insertBefore($j(_cookiePlaceHolderSelector));
    checkCookies();
}
/*window.onload = cookieSetup;*/
/*!---- video-jquery-embedcode-review-local-----*/
var inv_isVideoFullscreen = false;
var inv_CssOrJsArray = new Array();
var inv_CssOrJsCounter = 0;

(function($j) {
    function playerConstruct(_self, params) {

        ///////////////////////////////////////////////////////////Player Configuration///////////////////////////////////////////////////////////	
        var inv_playerSpecificClass = new Array();
        inv_playerSpecificClass.push("inv_videoMainContainer");
        inv_playerSpecificClass.push("inv_videoInformation");
        inv_playerSpecificClass.push("inv_videoInformation_Title");
        inv_playerSpecificClass.push("inv_videoInformation_Description");
        inv_playerSpecificClass.push("inv_videoplaylist");
        inv_playerSpecificClass.push("inv_videoListThumbnail");
        inv_playerSpecificClass.push("inv_videoGallery");
        inv_playerSpecificClass.push("inv_videoplaylistControlsContainer");
        inv_playerSpecificClass.push("inv_prevBtn");
        inv_playerSpecificClass.push("inv_nextBtn");
        inv_playerSpecificClass.push("inv_pagesBtns");
        inv_playerSpecificClass.push("inv_playheadWellContainer");
        inv_playerSpecificClass.push("inv_pagesBtn");
        inv_playerSpecificClass.push("inv_videoListControls");
        inv_playerSpecificClass.push("inv_videoCuePoint");
        inv_playerSpecificClass.push("inv_videoListTitle");
        inv_playerSpecificClass.push("inv_videoListDescription");
        inv_playerSpecificClass.push("inv_videoList");
        inv_playerSpecificClass.push("inv_videoListConatiner");
        inv_playerSpecificClass.push("inv_relatedInformation");

        var inv_layoutChange = new Array();
        inv_layoutChange.push({
            "playerType": "singleplayer",
            "class": "inv_videoCuePoint",
            "to": "inv_videoMainContainer"
        });
        inv_layoutChange.push({
            "playerType": "singleplayer",
            "class": "inv_shareControls",
            "to": "inv_videoMainContainer"
        });
        inv_layoutChange.push({
            "playerType": "singleplayer",
            "class": "inv_relatedInformation",
            "to": "inv_videoMainContainer"
        });
        inv_layoutChange.push({
            "playerType": "singleplayer",
            "class": "inv_soundControl",
            "after": "inv_soundOnOffBtn"
        });
        inv_layoutChange.push({
            "playerType": "singleplayer",
            "class": "inv_videoInformation",
            "before": "inv_videoMainContainer"
        });

        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_videoGallery",
            "to": "inv_videoControls"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_videoCuePoint",
            "to": "inv_videoMainContainer"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_shareControls",
            "to": "inv_shareBtn"
        });
        //inv_layoutChange.push({"playerType":"galleryplayer","class":"inv_videoInformation","after":"inv_videoMainContainer"});
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_playheadWellContainer",
            "to": "inv_videoMainContainer"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_relatedInformation",
            "to": "inv_videoMainContainer"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_soundControl",
            "after": "inv_soundOnOffBtn"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_controlbigtext",
            "to": "inv_videoControls"
        });

        // Left side controls
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_nowplayingContainer",
            "to": "inv_videoControls"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_nowplayingLabel",
            "to": "inv_nowplayingContainer"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_videoInformation",
            "to": "inv_nowplayingContainer"
        });

        // Right side controls
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_videoListBtnContainer",
            "to": "inv_videoControls"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "videoListBtn",
            "to": "inv_videoListBtnContainer"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "videoListLabel",
            "to": "inv_videoListBtnContainer"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_shareBtn",
            "to": "inv_videoListBtnContainer"
        });

        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "now_next_cont",
            "to": "inv_videoplaylist"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "galleryTitle",
            "to": "now_next_cont"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "playnowcont",
            "to": "now_next_cont"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "playnextcont",
            "to": "now_next_cont"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "morevideoscont",
            "to": "inv_videoplaylist"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_overlaythumb",
            "to": "playnowcont"
        });

        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "nowplayLabel",
            "to": "playnowcont"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "nextplayLabel",
            "to": "playnextcont"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "morevideosLabel",
            "to": "morevideoscont"
        });

        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "bx-slider-holder",
            "to": "morevideoscont"
        });

        // Share Controls

        //inv_layoutChange.push({"playerType":"galleryplayer","class":"inv_vineBtn","to":"inv_shareControls"});
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_linkedinBtn",
            "to": "inv_shareControls"
        });
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_twitterBtn",
            "to": "inv_shareControls"
        });
        //inv_layoutChange.push({"playerType":"galleryplayer","class":"inv_youtubeBtn","to":"inv_shareControls"});
        inv_layoutChange.push({
            "playerType": "galleryplayer",
            "class": "inv_facebookBtn",
            "to": "inv_shareControls"
        });

        var inv_enableCategorizedGallery = false;
        var inv_enableEffects = true;
        var inv_subMenuHover = false;
        var inv_showPageNumber = false;
        //////////////////////////////////////////////////////////Sound	
        var inv_soundBars = 5;
        var inv_soundBarsDefaultselection = 2;

        ///////////////////////////////////////////////////////////Email Settings
        var inv_emailSubject = 'Video: @shortDescription';
        var inv_emailBody = "I thought you might be interested in this video: @shortDescription%0A%0AYou can view it at: @pageurl%0A"; ////////////////%0A for new line		
        ///////////////////////////////////////////////////////////Share Settings
        var inv_videoShareTitle = 'Hear from our experts';
        ///////////////////////////////////////////////////////////Google Analytics Settings
        var inv_gaAccount = "UA-22832915-1"; //UA-39226021-1 is default test account//UA-41795468-1 QA Account // UA-22832915-1 rollsroyce.com
        var inv_gaType;
        ///////////////////////////////////////////////////////////Play Video in Sequence
        var inv_gallery_playInSequence = false;
        var inv_minigallery_playInSequence = false;
        var inv_repositionToStart = true;
        var inv_isResponsive = true;

        var inv_gallery_structure = new Array();
        inv_gallery_structure.push({
            device: "desktop",
            rows: "1",
            columns: "3"
        });
        inv_gallery_structure.push({
            device: "tablets",
            rows: "2",
            columns: "4"
        });
        inv_gallery_structure.push({
            device: "mobilelarge",
            rows: "4",
            columns: "2"
        });
        inv_gallery_structure.push({
            device: "mobilesmall",
            rows: "~",
            columns: "1"
        });

        var inv_minigallery_structure = new Array();
        inv_minigallery_structure.push({
            device: "desktop",
            rows: "4",
            columns: "1"
        });
        inv_minigallery_structure.push({
            device: "tablets",
            rows: "4",
            columns: "1"
        });
        inv_minigallery_structure.push({
            device: "mobilelarge",
            rows: "4",
            columns: "1"
        });
        inv_minigallery_structure.push({
            device: "mobilesmall",
            rows: "~",
            columns: "1"
        });

        var inv_relatedData_structure = new Array();
        inv_relatedData_structure.push({
            device: "desktop",
            rows: "1",
            columns: "2"
        });
        inv_relatedData_structure.push({
            device: "tablets",
            rows: "1",
            columns: "2"
        });
        inv_relatedData_structure.push({
            device: "mobilelarge",
            rows: "1",
            columns: "2"
        });
        inv_relatedData_structure.push({
            device: "mobilesmall",
            rows: "1",
            columns: "2"
        });

        var inv_shareWithCuePoint = false;
        var inv_DBO_Detail;
        var videoCollection;
        var currentMediaIndex;
        var inv_mouseOutBool;
        var inv_mouseOutTimeout = 3000;
        var bxSlider1;

        ///////////////////////////////////////////////////////////Plugin Parameters///////////////////////////////////////////////////////////
        var op = $j.extend({}, {
            gaCode: params.gaCode,
            gaType: params.gaType,
            /*isCareersSite:params.isCareersSite,*/
            /*Urvi - 06/06/2016 removed rollsroyce careers site code*/
            playerType: params.playerType,
            integrationMethod: params.integrationMethod,
            videoId: params.videoId,
            videoTags: params.videoTags,
            xmlPath: params.xmlPath,
            overlayPlay: params.overlayPlay,
            autoPlay: params.autoPlay,
            cuePointXMLPath: params.cuePointXMLPath,
            transcriptFilePath: params.transcriptFilePath,
            relatedData: params.relatedData,
            isBanner: params.isBanner,
            showInfo: params.showInfo,
            rrcareers: params.rrcareers,
            sectionText: params.sectionText,
            loop: params.loop,
            isLoop: params.isLoop, // Banner player with loop - vine

            playerScreenModeChanged: params.playerScreenModeChanged
        }, params);

        var inv_playerContainer = _self;
        var initGA = function() {
            try {
                if (typeof window.CookieConsent == "undefined" || typeof window.CookieConsent.categories == "undefined" || typeof window.CookieConsent.categories.performanceCookies == "undefined" || window.CookieConsent.categories.performanceCookies) {
                    // centralized tracker 	
                    switch (inv_gaType) {
                        case "traditional":
                            inv_analytics = _gaq || [];
                            inv_analytics.push(['b._setAccount', 'UA-39226021-1']);
                            break;
                        case "universal":
                            ga('create', 'UA-39226021-1', 'auto', {
                                'name': 'newTracker'
                            });
                            break;
                        case "tagmanager":
                            inv_analytics = _gaq || [];
                            inv_analytics.push(['b._setAccount', 'UA-39226021-1']);
                            break;
                        case undefined:
                            inv_analytics = _gaq || [];
                            inv_analytics.push(['b._setAccount', 'UA-39226021-1']);
                            break;
                    }
                    if (inv_gaAccount != undefined) {
                        // client specific tracker
                        switch (inv_gaType) {
                            case "traditional":
                                inv_analytics.push(['inv._setAccount', inv_gaAccount]);
                                break;
                            case "universal":
                                ga('create', inv_gaAccount, 'auto');
                                break;
                            case "tagmanager":
                                inv_analytics.push(['inv._setAccount', inv_gaAccount]);
                                break;
                            case undefined:
                                inv_analytics.push(['inv._setAccount', inv_gaAccount]);
                                break;
                        }
                    }
                }
            } catch (ee) {

            }
        }


        /****************************************************************** Banner Player Start ******************************************************************/
        if (op.isBanner == true) {
            inv_soundBarsDefaultselection = 5;
        }
        /****************************************************************** Banner Player End ******************************************************************/



        /****************************************************************** Transcript Code Start ******************************************************************/
        var transcriptPath;
        if (op.transcriptFilePath != undefined) {
            transcriptPath = op.transcriptFilePath;
            if (window.location.host.indexOf("rolls-royce") == -1) {
                transcriptPath = "data/transcript.html";
            }
        }
        /****************************************************************** Transcript Code End ******************************************************************/



        /****************************************************************** RR Careers Start ******************************************************************/
        if (op.rrcareers) {
            inv_layoutChange.push({
                "playerType": "singleplayer",
                "class": "inv_playheadWellContainer",
                "before": "inv_videoControls"
            });
            inv_subMenuHover = false;
            inv_enableEffects = false;
            /*try
            {
            	var vars = {};
            	var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
            		vars[key] = value;
            	});
            	
            	var careers = vars["testcareers"];
            	if(careers!=undefined && careers.indexOf("true")!=-1)
            	{
            		inv_gaAccount="UA-123-1";
            		inv_playerContainer.attr('testcareers','true');	
            	}
            }
            catch(e){}*/



            // sharing and GA Tracking Code////////////////////////////////////////////////////////////////////////////
            var v_appId = '1706038252974554'; // lng page code


            /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
            /*if(op.isCareersSite!=undefined && op.isCareersSite)
            {
            	inv_playerContainer.attr('iscareerssite','true');	
            	inv_gaAccount="UA-123-1";
            	inv_playerContainer.attr('testcareers','true');	
            	
            	inv_enableEffects=false;
            	 
            	if(op.playerType=='singleplayer')
            	{
            		if(!op.isBanner)
            		{
            			inv_playerContainer.attr('isNotBanner','true');		
            		}
            	}
            }
            else
            	inv_playerContainer.attr('iscareerssite','false');	
            	
            if(inv_playerContainer.attr('iscareerssite')=='true')
            {
            	inv_playerContainer.addClass('inv_playerContainer');
            	
            	v_appId='1289489351077913';// careers site code
            	
            	//if(inv_playerContainer.attr('testcareers')=='true')
            	{
            		inv_layoutChange.push({"playerType":"singleplayer","class":"inv_playheadWellContainer","before":"inv_startTime"});
            		if(inv_playerContainer.attr('testcareers')=='true')
            			inv_layoutChange.push({"playerType":"galleryplayer","class":"inv_playheadWellContainer","before":"inv_startTime"});
            		//inv_subMenuHover = true; //28-04-2015
            		inv_soundBars=11;
            		inv_soundBarsDefaultselection=6;
            	}
            }*/
            /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/

            window.fbAsyncInit = function() {
                FB.init({
                    appId: v_appId,
                    status: true,
                    xfbml: true,
                    version: 'v2.8'
                });
            };

            (function(d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) {
                    return;
                }
                js = d.createElement(s);
                js.id = id;
                js.src = "//connect.facebook.net/en_US/sdk.js";
                fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));

            initGA();
        }
        /****************************************************************** RR Careers End ******************************************************************/



        /*var inv_CssOrJsArray;
        var inv_CssOrJsCounter;*/
        var inv_checkAllAvailable;
        var preinit = function() {
            /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
            /*if(inv_playerContainer.attr('iscareerssite')=='true')
            {
            	if(op.gaCode!=undefined)
            		inv_gaAccount=op.gaCode;
            	if(op.gaType!=undefined)
            		inv_gaType=op.gaType;
            }*/
            /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/

            inv_checkAllAvailable = setInterval(function() {
                checkAllAvailable()
            }, 250);
            if (inv_CssOrJsArray.length == 0) {
                inv_CssOrJsArray = new Array();
                inv_CssOrJsArray.push("https://viz.tools.investis.com/video/videoplayer-v1.0.2_Responsive/stylesheets/video-js.css");

                /****************************************************************** RR Careers Start ******************************************************************/
                if (op.rrcareers) {
                    inv_CssOrJsArray.push("https://viz.tools.investis.com/rollsroyce/html5player/rebrand/stylesheets/jquery.bxslider.css");
                    /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                    /*if(inv_playerContainer.attr('testcareers')=='true')
                    	inv_CssOrJsArray.push("https://viz.tools.investis.com/rollsroyce/html5player/rebrand/stylesheets/careers-video-style-withgallery.css");	
                    else*/
                    /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/
                    inv_CssOrJsArray.push("https://viz.tools.investis.com/rollsroyce/html5player/rebrand/stylesheets/careers-video-style.css");
                } else {
                    inv_CssOrJsArray.push("https://viz.tools.investis.com/rollsroyce/html5player/rebrand/stylesheets/video-style.css");
                }
                if (window.location.host.indexOf("rolls-royce") == -1) {
                    inv_CssOrJsArray.push("https://viz.tools.investis.com/rollsroyce/html5player/rebrand/javascripts/jquery.bxslider.js");
                }
                /****************************************************************** RR Careers End ******************************************************************/

                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                /*if(inv_playerContainer.attr('testcareers')=='true')	
                	inv_CssOrJsArray.push("https://viz.tools.investis.com/rollsroyce/html5player/rebrand/javascripts/matchMedia.js");			*/
                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/

                inv_CssOrJsArray.push("https://viz.tools.investis.com/video/videoplayer-v1.0.2_Responsive/javascripts/jquery.xdomainajax.js");
                inv_CssOrJsArray.push("https://viz.tools.investis.com/video/videoplayer-v1.0.2_Responsive/javascripts/ga.js");
                inv_CssOrJsArray.push("https://viz.tools.investis.com/video/videoplayer-v1.0.2_Responsive/javascripts/video-js.js");
                inv_CssOrJsArray.push("https://viz.tools.investis.com/rollsroyce/html5player/rebrand/javascripts/BrightcovePlaybackUrls-rollsroyce.js");
                inv_CssOrJsArray.push("https://viz.tools.investis.com/rollsroyce/html5player/rebrand/javascripts/deviceDetection.js");
                inv_CssOrJsArray.push("https://www.rolls-royce.com/javascripts/video-jquery-corecode-review.js");

                for (var i = 0; i < inv_CssOrJsArray.length; i++) {
                    addCssOrJs(inv_CssOrJsArray[i]);
                }
            }
        }
        var addCssOrJs = function(filepath) {
            var filename = filepath;
            if (filepath.split('/').length > 0) {
                filename = filepath.split('/')[filepath.split('/').length - 1];
            }
            if (filepath.lastIndexOf(".css") === (filepath.length - ".css".length)) {
                if (!$j("link[href$='" + filename + "']").length) {
                    $j('<link rel="stylesheet" href="' + filepath + '" type="text/css" />').appendTo("head").each(function() {
                        inv_CssOrJsCounter = inv_CssOrJsCounter + 1;
                    });
                } else
                    inv_CssOrJsCounter = inv_CssOrJsCounter + 1;
            } else if (filepath.lastIndexOf(".js") === (filepath.length - ".js".length)) {
                if (!$j("script[src$='" + filename + "']").length) {
                    $j.ajax({
                        url: filepath,
                        crossDomain: true,
                        dataType: "script",
                        success: function() {
                            inv_CssOrJsCounter = inv_CssOrJsCounter + 1;
                        },
                        error: function() {
                            // handle errors
                        }
                    });
                } else
                    inv_CssOrJsCounter = inv_CssOrJsCounter + 1;
            }
        }
        var checkAllAvailable = function() {
            if (inv_CssOrJsArray.length == inv_CssOrJsCounter) {
                clearInterval(inv_checkAllAvailable);
                inv_DBO_Detail = resourceCheck();

                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                /*if(inv_playerContainer.attr('iscareerssite')=='true')// && inv_playerContainer.attr('testcareers')=='true')
                {
                	if(inv_DBO_Detail.IsTouchDevice || navigator.userAgent.match(/Lumia 930/))
                	{
                		inv_playerContainer.attr("notDesktop","true");	
                	}
                }*/
                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/

                /****************************************************************** Banner Player Start******************************************************************/
                if (op.isLoop && (navigator.userAgent.match(/Lumia 930/) || inv_DBO_Detail.IsTouchDevice)) {
                    op.autoPlay = false;
                }
                /****************************************************************** Banner Player End******************************************************************/
                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                /*if(inv_playerContainer.attr('iscareerssite')=='true' && (checkIsSmallDeviceOrMediumDevice() && !navigator.userAgent.match(/Lumia 930/)))
                {
                	op.autoPlay = false;
                }*/
                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/
                if (inv_DBO_Detail.IsFlashSupported == true || inv_DBO_Detail.IsHtml5Supported == true) {
                    var deepLink = false;

                    /*////////////////////////////////Video Playlist on small mobile Start*/
                    /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                    /*if(checkIsNotCareerAndSmallDevice())
                    {
                    	op.playerType = "singleplayer";
                    }*/
                    /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/
                    /*////////////////////////////////Video Playlist on small mobile End*/

                    inv_playerContainer.coreCode({
                        playerScreenModeChanged: op.playerScreenModeChanged,
                        playerType: op.playerType,
                        integrationMethod: op.integrationMethod,
                        videoId: op.videoId,
                        videoTags: op.videoTags,
                        xmlPath: op.xmlPath,
                        overlayPlay: op.overlayPlay,
                        autoPlay: op.autoPlay,
                        cuePointXMLPath: op.cuePointXMLPath,
                        transcriptFilePath: transcriptPath,
                        playerSpecificClass: inv_playerSpecificClass,
                        layoutChange: inv_layoutChange,
                        enableEffects: inv_enableEffects,
                        enableCategorizedGallery: inv_enableCategorizedGallery,
                        subMenuHover: inv_subMenuHover,
                        showPageNumber: inv_showPageNumber,
                        soundBars: inv_soundBars,
                        soundBarsDefaultselection: inv_soundBarsDefaultselection,
                        emailSubject: inv_emailSubject,
                        emailBody: inv_emailBody,
                        shareTitle: inv_videoShareTitle,
                        gaAccount: inv_gaAccount,
                        gaType: inv_gaType,
                        gallery_playInSequence: inv_gallery_playInSequence,
                        minigallery_playInSequence: inv_minigallery_playInSequence,
                        repositionToStart: inv_repositionToStart,
                        DBO_Detail: inv_DBO_Detail,
                        shareWithCuePoint: inv_shareWithCuePoint,
                        gallery_structure: inv_gallery_structure,
                        minigallery_structure: inv_minigallery_structure,
                        relatedData_structure: inv_relatedData_structure,
                        relatedData: op.relatedData,
                        isResponsive: inv_isResponsive,
                        getVideoPlayPauseStatus: true,
                        retrieveData: true,
                        reArrangeThumbsOnBreakPoint: true,
                        deepLinking: deepLink,
                        debug: false,
                        getMediaCompleteStatus: true
                    });
                } else {
                    inv_playerContainer.html("<div style='width:100%;height:100%;text-align:center;vertical-align:middle;'><a href='http://www.adobe.com/go/getflashplayer' target='_blank'><img src='http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif' alt='Get Adobe Flash player' /></a></div>");
                }
            }
        }
        var checkclick = function(evt) {
            clearTimeout(inv_mouseOutBool);
            inv_mouseOutBool = undefined;

            /*inv_mouseOutBool = true;*/
            inv_playerContainer.find(".inv_videoMainContainer").trigger('mouseleave');
            /*if(clickedOutsideElement(inv_playerContainer.find(".inv_videoMainContainer").attr('class'),evt))
            	inv_playerContainer_mouseleave();*/
        }
        var clickedOutsideElement = function(elemId, evt) {
            var theElem = getEventTarget(evt);
            if (theElem != undefined) {
                while (theElem = theElem.offsetParent) {
                    if ($j(theElem).attr('class') == elemId) {
                        return false;
                    }
                }
                return true;
            } else
                return false;
        }
        var getEventTarget = function(evt) {
            var targ;
            if (evt == undefined) {
                evt = window.event;
            }
            if (evt != undefined) {
                targ = (evt.target) ? evt.target : evt.srcElement;

                if (targ && targ.nodeType == 3)
                    targ = targ.parentNode;
            }
            return targ;
        }



        /****************************************************************** Transcript Code Start ******************************************************************/
        var reszieTranscriptChildElements = function() {
            if (inv_playerContainer.find(".inv_videoTranscriptContent div").length != 0) {
                inv_playerContainer.find(".inv_videoTranscriptContent div").each(function() {
                    if (this && $j(this).parent().length != 0) {
                        $j(this).attr('positiontop', $j(this).offset().top - $j(this).parent().offset().top);
                    }
                });
            }
        }
        var resizeTranscript = function() {
            //KM
            // For resize after full screen toggle issue 
            if (inv_DBO_Detail.IsDesktop && inv_playerContainer.hasClass('inv_FullScreen') == false) {
                inv_playerContainer.find('.inv_videoMainContainer').width('100%');
            }
            //KM
            // Text offset update on resize
            if (inv_playerContainer.find(".inv_videoTranscriptContent").length != 0)
                inv_playerContainer.find(".inv_videoTranscriptContent").scrollTop(0);
            reszieTranscriptChildElements();

            var top = parseInt(inv_playerContainer.find('.inv_transcriptSelected').parent().attr('positiontop'));
            top = isNaN(top) ? 0 : top;
            top = top - (inv_playerContainer.find(".inv_videoTranscriptContent").outerHeight() / 2);
            inv_playerContainer.find(".inv_videoTranscriptContent").scrollTop(top);
        }
        /****************************************************************** Transcript Code End ******************************************************************/



        /****************************************************************** RR Careers Start******************************************************************/
        var getUrlVars = function(key) {
            var url = window.location.href;
            var parts = url.split(key);
            var _id;
            if (parts.length != 0) {
                for (var i = 0; i < parts.length; i++) {
                    if (parts[i].indexOf("rolls-royce") != -1 && parts[i].length == 14) {
                        _id = parts[i];
                        return _id;
                    }
                }
            } else {
                return null;
            }
        }
        var shuffle = function(o) // Collection creation of the video data
        {
            for (var j, x, i = o.length; i; j = Math.floor(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x);
            return o;
        }

        var isIE = function() {
            var myNav = navigator.userAgent.toLowerCase();
            var msie = (myNav.indexOf('msie') != -1) ? parseInt(myNav.split('msie')[1]) : false;
            return msie;
        }

        var callFBshare = function(shareTitle, shareBody, shareURL) {
            var img = inv_playerContainer.find(".inv_videoStillArea img").attr('src');

            /*FB.ui({
				method:'feed',
				link:shareURL,
				name:shareTitle,					
				picture:img,
				caption:' ',
				description:shareBody
			}, function(response)
			{});*/

            FB.ui({
                    method: 'share_open_graph',
                    action_type: 'og.shares',
                    action_properties: JSON.stringify({
                        object: {
                            'og:url': shareURL, // your url to share
                            'og:title': shareTitle,
                            'og:description': shareBody,
                            'og:image': img
                        }
                    })
                },
                // callback
                function(response) {
                    if (response && !response.error_message) {
                        // then get post content
                        //alert('successfully posted. Status id : '+response.post_id);
                    } else {
                        //alert('Something went error.');
                    }
                });
        }
        var inv_removeExtraFields = function(a) {
            var str = a.toString();
            var date_inx = a.toString().indexOf(' creationDate:');
            if (date_inx != -1) {
                str = a.toString().substr(0, date_inx);
            }
            var encodedshortDescription = encodeURIComponent(str.toString());
            encodedshortDescription = encodedshortDescription.replace('%3Cbr%2F%3E', '%20').replace('%3Cbr%3E', '%20').replace('%3Cb%3E', '%20').replace('%3C%2Fb%3E', '%20');

            return decodeURIComponent(encodedshortDescription);

        }
        var trackGA = function(label) {
            try {
                var str = inv_removeExtraFields(videoCollection[currentMediaIndex]["shortDescription"]);

                switch (inv_gaType) {
                    case "traditional":
                        inv_analytics.push(['b._trackEvent', window.location.hostname, label, str]);
                        inv_analytics.push(['inv._trackEvent', 'Video', label, str]);
                        break;
                    case "universal":
                        ga('newTracker.send', 'event', 'Video', label, str);
                        ga('send', 'event', 'Video', label, str);
                        break;
                    case "tagmanager":
                        dataLayer.push({
                            'event': 'videoEvent',
                            'eventCategory': 'Videos',
                            'eventAction': label,
                            'eventLabel': str
                        });
                        break;
                    case undefined:
                        inv_analytics.push(['b._trackEvent', window.location.hostname, label, str]);
                        inv_analytics.push(['inv._trackEvent', 'Video', label, str]);
                        break;
                }
            } catch (ee) {

            }
        }


        var calculateWidthText = function(el) {
            var playheadWellclientWidth = 0;
            if (parseInt($j(el).outerWidth(true)) == 0) {
                playheadWellclientWidth = playheadWellclientWidth + parseInt($j(el).css('width').replace('px', ''));

                if ($j(el).css('borderLeftWidth') != '' && !isNaN(parseInt($j(el).css('borderLeftWidth').replace('px', ''))))
                    playheadWellclientWidth = playheadWellclientWidth + parseInt($j(el).css('borderLeftWidth').replace('px', ''));

                if ($j(el).css('borderRightWidth') != '' && !isNaN(parseInt($j(el).css('borderRightWidth').replace('px', ''))))
                    playheadWellclientWidth = playheadWellclientWidth + parseInt($j(el).css('borderRightWidth').replace('px', ''));

                if ($j(el).css('padding-left') != '' && !isNaN(parseInt($j(this).css('padding-left').replace('px', ''))))
                    playheadWellclientWidth = playheadWellclientWidth + parseInt($j(el).css('padding-left').replace('px', ''));

                if ($j(el).css('padding-right') != '' && !isNaN(parseInt($j(this).css('padding-right').replace('px', ''))))
                    playheadWellclientWidth = playheadWellclientWidth + parseInt($j(el).css('padding-right').replace('px', ''));

                if ($j(el).css('margin-left') != '' && !isNaN(parseInt($j(this).css('margin-left').replace('px', ''))))
                    playheadWellclientWidth = playheadWellclientWidth + parseInt($j(el).css('margin-left').replace('px', ''));

                if ($j(el).css('margin-right') != '' && !isNaN(parseInt($j(this).css('margin-right').replace('px', ''))))
                    playheadWellclientWidth = playheadWellclientWidth + parseInt($j(el).css('margin-right').replace('px', ''));

            } else {
                playheadWellclientWidth = playheadWellclientWidth + parseInt($j(el).outerWidth(true));
            }
            return playheadWellclientWidth;
        }

        var createCareersPageLayout = function(type) {
            try {
                if (op.rrcareers && op.playerType.toLowerCase() != "singleplayer") {
                    var refId;
                    if (type == "changevideo")
                        refId = inv_playerContainer.data("videoId");
                    else {
                        var videoId = getUrlVars("/$");
                        if (videoId) {
                            refId = videoId;
                        } else {
                            refId = inv_playerContainer.find(".inv_videoArea").attr("referenceid");
                        }
                    }

                    //*** Sorting to get current media index
                    for (var i = 0; i < videoCollection.length; i++) {
                        var ref = videoCollection[i].referenceId;
                        if (ref == refId) {
                            currentMediaIndex = i;
                            break;
                        }
                    }
                    /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                    //if(checkIsCareerOrNotSmallDevice())/*////////////////////////////////Video Playlist on small mobile*/
                    /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/
                    {
                        var currentVid = videoCollection[currentMediaIndex];
                        var nextVid = videoCollection[currentMediaIndex + 1];
                        if (currentMediaIndex == videoCollection.length - 1) {
                            nextVid = videoCollection[0];
                        }
                        var otherVideos = new Array();
                        for (var v = 0; v < videoCollection.length; v++) {
                            if (videoCollection[v].referenceId != currentVid.referenceId && videoCollection[v].referenceId != nextVid.referenceId)
                                otherVideos.push(videoCollection[v]);
                        }
                        if (type != "resize") {
                            inv_playerContainer.find('.inv_videoListThumbnail').each(function(i, thumb) {
                                inv_playerContainer.find('.inv_videoList').append(thumb);
                            });
                        }
                        otherVideos = otherVideos.slice(0, 3);

                        inv_playerContainer.find(".bx-clone").remove();

                        var currVidEle = inv_playerContainer.find('.inv_videoListThumbnailOverimg[refid="' + currentVid.referenceId + '"]').parent().parent();
                        currVidEle.appendTo(inv_playerContainer.find('.playnowcont'));

                        if (videoCollection.length > 1) {
                            var nextVidEle = inv_playerContainer.find('.inv_videoListThumbnailOverimg[refid="' + nextVid.referenceId + '"]').parent().parent();
                            nextVidEle.appendTo(inv_playerContainer.find('.playnextcont'));

                            $j(otherVideos).each(function(i, vid) {
                                var otherVidEle = inv_playerContainer.find('.inv_videoListThumbnailOverimg[refid="' + vid.referenceId + '"]').parent().parent();
                                inv_playerContainer.find('.bx-slider-holder').appendTo(inv_playerContainer.find('.morevideoscont'));
                                otherVidEle.appendTo(inv_playerContainer.find('.morevideoscont .bx-slider-holder'));
                            });
                        } else {
                            inv_playerContainer.find('.playnextcont').hide();
                            inv_playerContainer.find('.morevideoscont').hide();
                        }

                        inv_playerContainer.find(".bx-wrapper").remove();
                        var windowWidth = ($j(window).width() <= 640);
                        /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                        /*if(inv_playerContainer.attr('testcareers')=='true')	
                        {
                        	windowWidth=window.matchMedia("(max-width: 640px)").matches;
                        }	*/
                        /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/
                        if (windowWidth && otherVideos.length > 1) /*////////////////////////////////Video Playlist on small mobile*/ {
                            if (inv_playerContainer.find('.morevideoscont .bx-slider-holder').parent().hasClass("bx-viewport") == false || inv_playerContainer.attr('testcareers') == 'true') {
                                try {
                                    bxSlider1 = inv_playerContainer.find(".morevideoscont .bx-slider-holder")
                                        .bxSlider({
                                            slideWidth: inv_playerContainer.width(),
                                            startSlide: 0,
                                            infiniteLoop: false,
                                            minSlides: 1,
                                            maxSlides: 1,
                                            pager: (inv_playerContainer.find(".morevideoscont .bx-slider-holder .inv_videoListThumbnail").not(".bx-clone").length > 1) ? true : false,
                                            onSliderLoad: function(currentIndex) {
                                                try {
                                                    if (bxSlider1 != undefined) {
                                                        bxSlider1.goToSlide(0);
                                                        inv_playerContainer.find('.morevideoscont .bx-slider-holder').css('transform', 'translate3d(0px, 0px, 0px)');
                                                    }
                                                } catch (e) {

                                                }
                                            }
                                        });
                                } catch (e) {

                                }
                            } else {
                                try {
                                    if (bxSlider1 != undefined) {
                                        bxSlider1.goToSlide(0);
                                        inv_playerContainer.find('.morevideoscont .bx-slider-holder').css('transform', 'translate3d(0px, 0px, 0px)');
                                    }
                                } catch (e) {

                                }
                            }
                        }

                        inv_playerContainer.find('.inv_videoList').hide();

                        //if(inv_playerContainer.attr('testcareers')!='true')
                        {
                            if (type != "resize") {
                                inv_playerContainer.find('.inv_videoControls_extra').appendTo(inv_playerContainer.find('.inv_videoControls'));
                                inv_playerContainer.find(".controls-container").remove();
                                $j("<div class='controls-container'></div>").appendTo(inv_playerContainer.find('.inv_videoControls'));

                                inv_playerContainer.find('.inv_videoControls_extra').each(function(i, btn) {
                                    if (!$j(btn).hasClass('inv_videoGallery'))
                                        $j(btn).appendTo(inv_playerContainer.find('.controls-container'));
                                });
                            }

                            inv_playerContainer.find('.inv_nowplayingLabel').appendTo(inv_playerContainer.find('.inv_nowplayingContainer'));
                            inv_playerContainer.find('.inv_videoInformation').appendTo(inv_playerContainer.find('.inv_nowplayingContainer'));
                            inv_playerContainer.find('.videoListBtn').appendTo(inv_playerContainer.find('.inv_videoListBtnContainer'));

                            if (op.showInfo) {
                                inv_playerContainer.find('.inv_shareBtn').appendTo(inv_playerContainer.find('.inv_videoListBtnContainer'));
                                inv_playerContainer.find('.videoListLabel').appendTo(inv_playerContainer.find('.inv_videoListBtnContainer'));
                            } else {
                                inv_playerContainer.find('.videoListLabel').appendTo(inv_playerContainer.find('.inv_videoListBtnContainer'));
                                inv_playerContainer.find('.inv_shareBtn').appendTo(inv_playerContainer.find('.inv_videoListBtnContainer'));
                            }
                        }

                        if (op.showInfo) {
                            inv_playerContainer.find(".inv_infoBtnNewDetail_Title").html(videoCollection[currentMediaIndex]["shortDescription"]);
                            inv_playerContainer.find(".inv_infoBtnNewDetail_Description").html(videoCollection[currentMediaIndex]["longDescription"]);
                        }
                        var s1 = videoCollection[currentMediaIndex]["name"].toString().split("<br/>")[0];
                        var s2 = videoCollection[currentMediaIndex]["name"].toString().split("<br/>")[1];
                        inv_playerContainer.find(".inv_videoInformation_Title").html(s1);
                        if (s2 == undefined || s2 == '') {
                            inv_playerContainer.find(".inv_videoInformation_Title").addClass("oneLine");
                            inv_playerContainer.find(".inv_videoInformation_Description").html("");
                        } else {
                            inv_playerContainer.find(".inv_videoInformation_Title").removeClass("oneLine");
                            inv_playerContainer.find(".inv_videoInformation_Description").html(s2);
                        }
                        if (type != "resize") {
                            inv_playerContainer.find('.inv_videoGallery').slideUp("fast");
                            inv_playerContainer.find(".videoListBtn").removeClass("list-active");
                            inv_playerContainer.removeClass("galleryActive");
                        }
                    }
                }
            } catch (e) {}
            changeLayoutControlbar(type);
        }

        var changeLayoutControlbar = function(type) {
            if (op.rrcareers && op.playerType.toLowerCase() != "singleplayer") {
                var windowWidth = ($j(window).width() <= 700);
                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                /*if(inv_playerContainer.attr('testcareers')=='true')	
                {
                	windowWidth=window.matchMedia("(max-width: 700px)").matches;
                }	*/
                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/
                if (windowWidth) {
                    clearTimeout(inv_mouseOutBool);
                    inv_mouseOutBool = undefined;

                    /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                    /*if(inv_playerContainer.attr('testcareers')=='true')
                    {
                    	if(type != "resize")
                    	{
                    		inv_playerContainer.find('.inv_controlbigtext').appendTo(inv_playerContainer.find('.inv_videoControls'));
                    		inv_playerContainer.find('.inv_nowplayingContainer').appendTo(inv_playerContainer.find('.inv_videoControls'));
                    		inv_playerContainer.find('.inv_videoListBtnContainer').appendTo(inv_playerContainer.find('.inv_videoControls'));
                    		
                    		inv_playerContainer.find(".controls-container").remove();
                    		$j("<div class='controls-container'></div>").appendTo(inv_playerContainer.find('.inv_videoControls'));								
                    	}
                    	inv_playerContainer.find('.controls-container').addClass("inv_videoControls_extra");
                    	
                    	inv_playerContainer.find('.inv_controlbigtext').appendTo(inv_playerContainer.find('.controls-container'));
                    	inv_playerContainer.find('.inv_nowplayingContainer').appendTo(inv_playerContainer.find('.controls-container'));
                    	inv_playerContainer.find('.inv_videoListBtnContainer').appendTo(inv_playerContainer.find('.controls-container'));
                    		
                    	if(type != "resize")
                    	{
                    		inv_playerContainer.find('.inv_videoGallery').appendTo(inv_playerContainer.find('.inv_videoMainContainer_inner'));
                    		inv_playerContainer.find('.inv_videoControls').appendTo(inv_playerContainer.find('.inv_videoMainContainer_inner'));			
                    		inv_playerContainer.find(".inv_videoControls_parent").remove();
                    		$j("<div class='inv_videoControls_parent'></div>").insertBefore(inv_playerContainer.find('.inv_videoMainContainer_inner'));
                    	}	
                    	
                    	inv_playerContainer.find('.inv_videoControls').appendTo(inv_playerContainer.find('.inv_videoControls_parent'));												
                    	inv_playerContainer.find('.controls-container').appendTo(inv_playerContainer.find('.inv_videoControls_parent'));
                    	inv_playerContainer.find('.inv_videoGallery').appendTo(inv_playerContainer.find('.inv_videoControls_parent'));
                    }	
                    else*/
                    /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/

                    {
                        inv_playerContainer.find('.inv_videoControls').appendTo(inv_playerContainer);
                        inv_playerContainer.find('.inv_videoGallery').appendTo(inv_playerContainer);
                        inv_playerContainer.find('.inv_videoListBtnContainer').appendTo(inv_playerContainer);
                    }
                    if (op.showInfo && op.rrcareers) {
                        inv_playerContainer.find('.inv_infoBtnNewDetail').appendTo(inv_playerContainer);
                    }


                    inv_playerContainer.find(".inv_videoListDescription").bind("touchstart", function(e) {
                        e.stopPropagation();
                    });

                    inv_playerContainer.find(".inv_shareBtn.inv_shareBtnClick").trigger("click");
                } else {
                    if (type == "changevideo") {
                        /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                        //if(inv_playerContainer.attr('testcareers')!='true')
                        inv_playerContainer.find(".inv_videoControls").slideDown("fast");
                        /*else
                        {
                        	inv_playerContainer.find('.inv_videoControls').show();
                        	inv_playerContainer.find('.inv_videoControls_parent').show();
                        }*/
                        /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/

                        inv_playerContainer.find('.inv_videoGallery').slideUp("fast");
                        inv_playerContainer.find(".videoListBtn").removeClass("list-active");
                        inv_playerContainer.removeClass("galleryActive");
                    } else {
                        inv_playerContainer.find('.inv_overlayPlayClicked').addClass('trans');

                        /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                        //if(inv_playerContainer.attr('testcareers')!='true')
                        {
                            inv_playerContainer.find('.inv_videoControls').appendTo(inv_playerContainer.find('.inv_videoMainContainer_inner'));
                            inv_playerContainer.find('.inv_videoGallery').appendTo(inv_playerContainer.find('.inv_videoControls'));

                            inv_playerContainer.find('.inv_videoListBtnContainer').appendTo(inv_playerContainer.find('.controls-container'));

                        }
                        /*else
                        {
                        	if(type != "resize")
                        	{
                        		inv_playerContainer.find('.inv_controlbigtext').appendTo(inv_playerContainer.find('.inv_videoControls'));
                        		inv_playerContainer.find('.inv_nowplayingContainer').appendTo(inv_playerContainer.find('.inv_videoControls'));
                        		inv_playerContainer.find('.inv_videoListBtnContainer').appendTo(inv_playerContainer.find('.inv_videoControls'));
                        		
                        		inv_playerContainer.find(".controls-container").remove();
                        		$j("<div class='controls-container'></div>").appendTo(inv_playerContainer.find('.inv_videoControls'));								
                        	}
                        	inv_playerContainer.find('.controls-container').addClass("inv_videoControls_extra");
                        	
                        	inv_playerContainer.find('.inv_controlbigtext').appendTo(inv_playerContainer.find('.controls-container'));
                        	inv_playerContainer.find('.inv_nowplayingContainer').appendTo(inv_playerContainer.find('.controls-container'));
                        	inv_playerContainer.find('.inv_videoListBtnContainer').appendTo(inv_playerContainer.find('.controls-container'));
                        		
                        	if(type != "resize")
                        	{
                        		inv_playerContainer.find('.inv_videoGallery').appendTo(inv_playerContainer.find('.inv_videoMainContainer_inner'));
                        		inv_playerContainer.find('.inv_videoControls').appendTo(inv_playerContainer.find('.inv_videoMainContainer_inner'));			
                        		inv_playerContainer.find(".inv_videoControls_parent").remove();
                        		$j("<div class='inv_videoControls_parent'></div>").insertBefore(inv_playerContainer.find('.inv_videoMainContainer_inner'));
                        	}	
                        	
                        	inv_playerContainer.find('.inv_videoControls').appendTo(inv_playerContainer.find('.inv_videoControls_parent'));												
                        	inv_playerContainer.find('.controls-container').appendTo(inv_playerContainer.find('.inv_videoControls_parent'));
                        	inv_playerContainer.find('.inv_videoGallery').appendTo(inv_playerContainer.find('.inv_videoControls_parent'));
                        }*/
                        /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/

                        if (op.showInfo) {
                            inv_playerContainer.find('.inv_infoBtnNewDetail').appendTo(inv_playerContainer.find('.inv_videoControls'));
                            inv_playerContainer.find('.inv_videoListBtnContainer').appendTo(inv_playerContainer.find('.controls-container'));
                        }
                    }




                    setTimeout(function() {
                        var calcWidth;
                        /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                        //if(inv_playerContainer.attr('testcareers')!='true')
                        {
                            if (!inv_playerContainer.find(".inv_videoControls").is(":visible")) {
                                inv_playerContainer.find(".inv_videoControls").show();
                                calcWidth = inv_playerContainer.find(".controls-container").width() -
                                    calculateWidthText(inv_playerContainer.find(".inv_controlbigtext")) -
                                    calculateWidthText(inv_playerContainer.find(".inv_nowplayingLabel")) -
                                    calculateWidthText(inv_playerContainer.find(".inv_videoListBtnContainer")) - 20;
                                inv_playerContainer.find(".inv_videoControls").hide();
                            }
                            inv_playerContainer.find(".inv_videoInformation").width(calcWidth);
                            inv_playerContainer.find(".inv_videoListDescription").css("max-height", inv_playerContainer.height() * 0.5);
                        }
                        /*else
                        {
                        	var flag=(inv_playerContainer.find(".inv_videoControls_parent").is(":visible") == false);
                        	if(flag)
                        		inv_playerContainer.find(".inv_videoControls_parent").show();
                        	
                        	calcWidth = inv_playerContainer.find(".controls-container").width() -
                        				calculateWidthText(inv_playerContainer.find(".inv_controlbigtext")) -
                        				calculateWidthText(inv_playerContainer.find(".inv_nowplayingLabel")) -
                        				calculateWidthText(inv_playerContainer.find(".inv_videoListBtnContainer")) - 30;
                        	if(flag)
                        		inv_playerContainer.find(".inv_videoControls_parent").hide();
                        						
                        	inv_playerContainer.find(".inv_videoInformation").width(calcWidth);
                        }*/
                        /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/

                    }, 1);
                }

                inv_playerContainer.find(".inv_videoMainContainer").unbind('mousemove');
                inv_playerContainer.find(".inv_videoMainContainer").unbind('mouseleave');
                inv_playerContainer.find(".inv_videoMainContainer").bind('mousemove', function(e) {
                    clearTimeout(inv_mouseOutBool);
                    inv_mouseOutBool = undefined;

                    inv_playerContainer.find(".inv_overlayPlay.inv_overlayPlayClicked").removeClass("trans");

                    if (windowWidth) {

                    } else if (!inv_playerContainer.find(".inv_videoControls").is(":visible")) {
                        inv_playerContainer.find(".inv_videoControls").slideDown("fast");
                        if (op.showInfo) {
                            inv_playerContainer.find(".inv_infoBtnNew").removeClass("active");
                            inv_playerContainer.find(".inv_infoBtnNewDetail").slideUp("fast");
                        }
                    }
                });
                inv_playerContainer.find(".inv_videoMainContainer").bind('mouseleave', function() {
                    clearTimeout(inv_mouseOutBool);
                    inv_mouseOutBool = undefined;

                    inv_mouseOutBool = setTimeout(function() {
                        inv_playerContainer.find(".inv_overlayPlay.inv_overlayPlayClicked").addClass("trans");
                        if (windowWidth) {

                        } else if (inv_playerContainer.find(".inv_videoControls").is(":visible")) {
                            inv_playerContainer.find(".inv_videoControls").slideUp("fast");
                            inv_playerContainer.find(".videoListBtn.list-active").trigger("click");
                            inv_playerContainer.find(".videoListBtn.list-active").trigger("click");

                            inv_playerContainer.find(".inv_shareBtn.inv_shareBtnClick").trigger("click");
                            inv_playerContainer.find('.inv_videoGallery').slideUp("fast");
                            inv_playerContainer.find(".videoListBtn").removeClass("list-active");
                            inv_playerContainer.removeClass("galleryActive");

                            if (op.showInfo) {
                                inv_playerContainer.find(".inv_infoBtnNew").removeClass("active");
                                inv_playerContainer.find(".inv_infoBtnNewDetail").slideUp("fast");
                            }
                        }
                    }, inv_mouseOutTimeout);
                });

                if (inv_DBO_Detail.IsTouchDevice) {
                    clearTimeout(inv_mouseOutBool);
                    inv_mouseOutBool = undefined;

                    inv_playerContainer.find(".inv_videoMainContainer")
                        .unbind("touchstart")
                        .bind("touchstart", function(e) {
                            e.stopPropagation();
                            inv_playerContainer.find(".inv_videoMainContainer").trigger('mousemove');
                        });

                    $j(document).unbind('touchstart');
                    $j(document).bind('touchstart', checkclick);
                }
                /*////////////////////////////////Video Playlist on small mobile Start*/
                //if(inv_playerContainer.width() <= 321 && !inv_playerContainer.hasClass("inv_MediumMobile"))

                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                /*if(checkIsNotCareerAndSmallDevice())
                { 
                	inv_playerContainer.find(".inv_videoInformation").insertBefore(inv_playerContainer.find(".inv_videoMainContainer"));
                }
                else*/
                {
                    inv_playerContainer.find(".inv_videoInformation").appendTo(inv_playerContainer.find(".inv_nowplayingContainer"));
                }
                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/
                /*////////////////////////////////Video Playlist on small mobile End*/
            } else if (op.rrcareers) {

                {
                    inv_playerContainer.find(".inv_videoMainContainer").unbind('mousemove');
                    inv_playerContainer.find(".inv_videoMainContainer").unbind('mouseleave');
                    inv_playerContainer.find(".inv_videoMainContainer").bind('mousemove', function() {
                        clearTimeout(inv_mouseOutBool);
                        inv_mouseOutBool = undefined;

                        inv_playerContainer.find(".inv_overlayPlay.inv_overlayPlayClicked").removeClass("trans");
                        /*if(inv_playerContainer.attr('iscareerssite')=='true')
                        {
                        	inv_playerContainer.find(".inv_videoControls").fadeIn("fast");
                        	inv_playerContainer.find(".inv_videoMainContainer").trigger('mouseleave');
                        }*/
                    });
                    inv_playerContainer.find(".inv_videoMainContainer").bind('mouseleave', function() {
                        clearTimeout(inv_mouseOutBool);
                        inv_mouseOutBool = undefined;

                        inv_mouseOutBool = setTimeout(function() {
                            inv_playerContainer.find(".inv_overlayPlay.inv_overlayPlayClicked").addClass("trans");
                            /*if(inv_playerContainer.attr('iscareerssite')=='true')
                            {
                            	if(inv_playerContainer.find(".inv_overlayPlay.inv_overlayPlayClicked").length!=0)
                            	{
                            		inv_playerContainer.find(".inv_videoControls").fadeOut("fast");								
                            	}
                            }*/
                        }, inv_mouseOutTimeout);
                    });
                }

                if (inv_DBO_Detail.IsTouchDevice) {
                    clearTimeout(inv_mouseOutBool);
                    inv_mouseOutBool = undefined;

                    inv_playerContainer.find(".inv_videoMainContainer")
                        .unbind("touchstart")
                        .bind("touchstart", function(e) {
                            e.stopPropagation();
                            inv_playerContainer.find(".inv_videoMainContainer").trigger('mousemove');
                        });

                    $j(document).unbind('touchstart');
                    $j(document).bind('touchstart', checkclick);
                }
            }

            /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
            /*if(inv_playerContainer.attr('testcareers')=='true') //calculating progressbar width
            {
            	var flag=false;
            	if(inv_playerContainer.find(".inv_videoControls_parent").is(":visible") == false)
            	{
            		inv_playerContainer.find(".inv_videoControls_parent").show();
            		flag=true;
            	}	
            	var cntrl_w=inv_playerContainer.find(".inv_videoControls").width();				
            	var others_w=0;
            	inv_playerContainer.find(".inv_videoControls>div").each(function()
            	{
            		if($j(this).attr("class").indexOf("inv_playheadWellContainer")==-1 && $j(this).attr("class").indexOf("inv_videoControls_extra") && $j(this).outerWidth(true)!=0)
            		{
            			others_w=others_w+$j(this).outerWidth(true);
            		}
            	});
            	inv_playerContainer.find(".inv_playheadWellContainer").width(cntrl_w-others_w);
            	if(flag)
            	{
            		inv_playerContainer.find(".inv_videoControls_parent").hide();
            	}
            }*/
            /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/
        }
        /****************************************************************** RR Careers End******************************************************************/
        var checkIsSmallDeviceOrMediumDevice = function() {
            var cond1 = (inv_DBO_Detail.IsSmallMobile || (inv_DBO_Detail.IsDesktop && inv_playerContainer.hasClass("inv_SmallMobile")));
            var cond2 = (inv_DBO_Detail.IsLargeMobile || (inv_DBO_Detail.IsDesktop && inv_playerContainer.hasClass("inv_MediumMobile")));

            return (cond1 || cond2);
        }
        /*var checkIsNotCareerAndSmallDevice=function()
        {
        	var cond1=(inv_playerContainer.attr('iscareerssite')!='true');
        	var cond2=(inv_DBO_Detail.IsSmallMobile || (inv_DBO_Detail.IsDesktop && inv_playerContainer.hasClass("inv_SmallMobile")));

        	return (cond1 && cond2);
        }
        var checkIsCareerOrNotSmallDevice=function()
        {
        	var cond1=(inv_playerContainer.attr('iscareerssite')=='true');
        	var cond2=!(inv_DBO_Detail.IsSmallMobile || (inv_DBO_Detail.IsDesktop && inv_playerContainer.hasClass("inv_SmallMobile")));

        	return (cond1 || cond2);
        }
        var checkIsCareerAndSmallDevice=function()
        {
        	var cond1=(inv_playerContainer.attr('iscareerssite')=='true');
        	var cond2=(inv_DBO_Detail.IsSmallMobile || (inv_DBO_Detail.IsDesktop && inv_playerContainer.hasClass("inv_SmallMobile")));

        	return (cond1 && cond2);
        }*/
        var checkIsSmallDevice = function() {
            var cond2 = (inv_DBO_Detail.IsSmallMobile || (inv_DBO_Detail.IsDesktop && inv_playerContainer.hasClass("inv_SmallMobile")));

            return (cond2);
        }
        var inv_videoPlayeroInstance;
        var triggerVideoOnSmallDevice = function(refId) {
            try {
                for (var i = 0; i < videoCollection.length; i++) {
                    var ref = videoCollection[i].referenceId;
                    if (ref == refId) {
                        currentMediaIndex = i;
                        break;
                    }
                }
                if (currentMediaIndex == undefined)
                    currentMediaIndex = 0;
                inv_playerContainer.find(".inv_videoStillArea").css("display", "block");
                if (inv_playerContainer.find(".inv_videoStillArea img").length == 0) {
                    inv_playerContainer.find(".inv_videoStillArea").html("<img src='" + videoCollection[currentMediaIndex]["videoURL"] + "' style='top: 0;left: 0px;width: 100%;position: absolute;'></img>");
                } else {
                    inv_playerContainer.find(".inv_videoStillArea img").attr("src", videoCollection[currentMediaIndex]["videoStillURL"]);
                }
                inv_playerContainer.find(".inv_videoStillArea").css("display", "block");
                if (inv_playerContainer.find(".inv_videoArea video").length == 0) {
                    inv_playerContainer.find(".inv_videoArea").html("<video src='" + videoCollection[currentMediaIndex]["videoURL"] + "' width='100%' height='100%' style='top: 0;left: 0px;width: 100%;position: absolute;'></video>");
                    inv_videoPlayeroInstance = inv_playerContainer.find(".inv_videoArea video")[0];
                    $j(inv_videoPlayeroInstance).bind('durationchange', function() {
                        inv_playerContainer.find(".inv_videoLoaderArea").css("display", "none");
                        if (inv_playerContainer.find(".inv_videoStillArea img").length == 0) {
                            inv_playerContainer.find(".inv_videoStillArea").html("<img src='" + videoCollection[currentMediaIndex]["videoURL"] + "' style='top: 0;left: 0px;width: 100%;position: absolute;'></img>");
                        } else {
                            inv_playerContainer.find(".inv_videoStillArea img").attr("src", videoCollection[currentMediaIndex]["videoStillURL"]);
                        }
                        inv_playerContainer.find(".inv_videoStillArea").css("display", "block");
                    });
                    inv_playerContainer.find(".inv_overlayPlay").unbind("click");
                    inv_playerContainer.find(".inv_overlayPlay").bind('click', function() {
                        inv_videoPlayeroInstance.play();
                    });

                } else {
                    inv_playerContainer.find(".inv_videoArea video").attr("src", videoCollection[currentMediaIndex]["videoURL"]);
                }


                inv_playerContainer.find(".inv_videoArea").attr("referenceid", videoCollection[currentMediaIndex]["referenceId"]);

                var s1 = videoCollection[currentMediaIndex]["name"].toString().split("<br/>")[0];
                var s2 = videoCollection[currentMediaIndex]["name"].toString().split("<br/>")[1];
                inv_playerContainer.find(".inv_videoInformation_Title").html(s1);
                if (s2 == undefined || s2 == '') {
                    inv_playerContainer.find(".inv_videoInformation_Title").addClass("oneLine");
                    inv_playerContainer.find(".inv_videoInformation_Description").html("");
                } else {
                    inv_playerContainer.find(".inv_videoInformation_Title").removeClass("oneLine");
                    inv_playerContainer.find(".inv_videoInformation_Description").html(s2);
                }

                inv_playerContainer.data("videoId", inv_playerContainer.find(".inv_videoArea").attr("referenceid"));
                inv_playerContainer.trigger("videoLoaded");
                createCareersPageLayout("changevideo");
                //changeLayoutControlbar("changevideo");
            } catch (e) {

            }

        }
        ///////////////////////////////////////////////////////////Public Methods///////////////////////////////////////////////////////////			
        this.triggerVideo = function(refId) {
            /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
            /*////////////////////////////////Video Playlist on small mobile Start*/
            //if(inv_DBO_Detail && inv_DBO_Detail.IsSmallMobile)
            /*if(checkIsNotCareerAndSmallDevice())
            {
            	for(var i=0; i<videoCollection.length; i++){
            		var ref = videoCollection[i].referenceId;
            		if(ref == refId){
            			currentMediaIndex = i;
            			break;
            		}
            	}
            	
            	inv_playerContainer.find(".inv_videoArea video").attr("src", videoCollection[currentMediaIndex]["videoURL"]);
            	inv_playerContainer.find(".inv_videoStillArea img").attr("src", videoCollection[currentMediaIndex]["videoStillURL"]);
            	
            	if(op.rrcareers && op.playerType.toLowerCase()=="galleryplayer")
            	{
            		var s1=videoCollection[currentMediaIndex]["name"].toString().split("<br/>")[0];
            		var s2=videoCollection[currentMediaIndex]["name"].toString().split("<br/>")[1];
            		inv_playerContainer.find(".inv_videoInformation_Title").html(s1);
            		if(s2==undefined || s2=='')
            		{
            			inv_playerContainer.find(".inv_videoInformation_Title").addClass("oneLine");
            			inv_playerContainer.find(".inv_videoInformation_Description").html("");
            		}
            		else
            		{
            			inv_playerContainer.find(".inv_videoInformation_Title").removeClass("oneLine");
            			inv_playerContainer.find(".inv_videoInformation_Description").html(s2);
            		}
            	}
            	else
            	{
            		inv_playerContainer.find(".inv_videoInformation_Title").html(videoCollection[currentMediaIndex]["shortDescription"]);
            		inv_playerContainer.find(".inv_videoInformation_Description").html(videoCollection[currentMediaIndex]["longDescription"]);
            	}
            }
            else*/
            /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/
            /*////////////////////////////////Video Playlist on small mobile End*/
            {
                var vid_cont = inv_playerContainer.find('.inv_videoListThumbnailOverimg[refid="' + refId + '"]');
                if (vid_cont.length != 0) {
                    vid_cont.parent().trigger("click");
                }
            }
        }

        this.playerLoaded = function() {
            inv_playerContainer.find(".inv_videoControls").css("display", "none");
            if (op.integrationMethod == "iframe")
                $j(window.frameElement).height(inv_playerContainer.height());

            inv_playerContainer.find(".inv_videoStillArea").css("display", "block");

            inv_playerContainer.find(".inv_videoStillArea").hover(
                function() {
                    $j(this).css("display", "block");
                },
                function() {
                    $j(this).css("display", "block");
                }
            );

            /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
            /*if(inv_playerContainer.attr('iscareerssite')=='true' && op.autoPlay)
            {
            	inv_playerContainer.find(".inv_videoStillArea").css("display","none");
            }*/
            /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/
            /****************************************************************** Transcript Code ******************************************************************/
            reszieTranscriptChildElements();
            $j(window).bind('orientationchange', function(e) {
                resizeTranscript(e);
            });

            if (op.transcriptFilePath) {} else {
                inv_playerContainer.find(".inv_videoTranscript").addClass("noTranscript");
            }
            /****************************************************************** Banner Player ******************************************************************/
            if (op.isBanner == true) {
                /*Urvi - 06/06/2016 removed rollsroyce careers site code ----------------*/
                if (!op.rrcareers) // || !inv_playerContainer.attr('iscareerssite')=='true') //27-5-2016 - homepage banner issue //VD
                {
                    inv_playerContainer.find(".inv_videoControls").addClass("banner");
                    inv_playerContainer.find(".inv_playheadWellContainer").addClass("banner");
                    //inv_playerContainer.find(".inv_videoArea").css("height","99.6% !important");
                }

                inv_playerContainer.find(".inv_videoInformation").addClass("banner");
                if (op.isLoop && !(inv_DBO_Detail.IsTouchDevice || navigator.userAgent.match(/Lumia 930/))) // Banner player with loop - vine
                    inv_playerContainer.find(".inv_overlayPlay").addClass("banner");
                inv_playerContainer.find(".inv_videoTranscript").addClass("banner");

                if (op.loop) {
                    $j(pageSpecificVariable).each(function(index, player) {
                        if (player.el && player.el.id) {
                            if (player.el.id.indexOf(inv_playerContainer.attr('id')) != -1) {
                                player.loop(true);
                            }
                        }
                    });
                }
            }

            /****************************************************************** RR Careers ******************************************************************/
            if (op.rrcareers) {
                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                try {

                    if (navigator.userAgent.match(/Lumia 930/)) {
                        inv_playerContainer.attr("IsLumia", "true");
                        inv_playerContainer.find("video").bind('play', function() {
                            inv_playerContainer.find(".inv_videoStillArea").css("display", "none");
                            inv_playerContainer.attr('playerMode', 'playing');
                            inv_playerContainer.find(".inv_overlayPlay").addClass("inv_overlayPlayClicked");
                        });
                        inv_playerContainer.find("video").bind('pause', function() {
                            inv_playerContainer.find(".inv_overlayPlay").removeClass("inv_overlayPlayClicked");
                        });
                        inv_playerContainer.find("video").bind('durationchange', function() {
                            inv_playerContainer.attr('playerMode', 'paused');
                        });
                        inv_playerContainer.find("video").bind('ended', function() {
                            inv_playerContainer.find(".inv_videoStillArea").css("display", "block");
                            inv_playerContainer.attr('playerMode', 'paused');
                            inv_playerContainer.find(".inv_overlayPlay").removeClass("inv_overlayPlayClicked");
                        });
                        inv_playerContainer.find(".inv_overlayPlay").unbind('click');
                        inv_playerContainer.find(".inv_overlayPlay").bind('click', function() {
                            if ($j(this).hasClass("inv_overlayPlayClicked")) {
                                inv_playerContainer.find("video")[0].pause();

                            } else {
                                inv_playerContainer.find("video")[0].play();
                            }

                        });
                    }
                } catch (e) {}
                /*if(navigator.userAgent.match(/Lumia 930/) && inv_playerContainer.attr('iscareerssite')=='true')
                {
                	inv_playerContainer.attr("IsLumia","true");					
                }*/
                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/
                $j(window).bind('orientationchange', function() {
                    createCareersPageLayout("resize");
                    //changeLayoutControlbar("resize");
                });

                if (op.playerType.toLowerCase() == "singleplayer") {
                    /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                    //if(!(inv_playerContainer.attr('iscareerssite')=='true'))
                    {
                        inv_playerContainer.find(".inv_videoControls").addClass("banner");
                    }
                    /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/
                    inv_playerContainer.find(".inv_shareBtn").addClass("banner");
                    inv_playerContainer.find(".inv_shareControls").addClass("banner");
                    if (!inv_DBO_Detail.IsDesktop) {
                        inv_playerContainer.find(".inv_overlayPlay").removeClass("banner");
                    }

                } else {
                    /*Urvi:16/05/2016 full width playlist start*/
                    /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                    /*if(inv_playerContainer.attr('testcareers')=='true' && op.playerType.toLowerCase()!="singleplayer")
                    {
                    	if(inv_DBO_Detail.IsDesktop)
                    	{
                    		inv_playerContainer.addClass('fullscreenVideo');
                    		inv_playerContainer.find(".inv_overlayPlay").bind('click.fullscreenVideo',function()
                    		{
                    			if(inv_playerContainer.find(".inv_fullscreenBtn").attr('class').indexOf('inv_normalmodeBtn')==-1)
                    			{
                    				inv_playerContainer.find(".inv_fullscreenBtn").trigger('click');
                    			}
                    		});
                    		inv_playerContainer.find(".inv_playBtn").bind('click.fullscreenVideo',function()
                    		{
                    			if(inv_playerContainer.find(".inv_fullscreenBtn").attr('class').indexOf('inv_normalmodeBtn')==-1)
                    			{
                    				inv_playerContainer.find(".inv_fullscreenBtn").trigger('click');
                    			}
                    		});
                    		inv_playerContainer.find(".inv_playheadWellContainer").bind('click.fullscreenVideo',function()
                    		{
                    			if(inv_playerContainer.find(".inv_fullscreenBtn").attr('class').indexOf('inv_normalmodeBtn')==-1)
                    			{
                    				inv_playerContainer.find(".inv_fullscreenBtn").trigger('click');
                    			}
                    		});
                    	}
                    }*/
                    /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/

                    /*Urvi:16/05/2016 full width playlist end*/

                    //if(inv_playerContainer.width() < 640 && !inv_DBO_Detail.IsSmallMobile)/*////////////////////////////////Video Playlist on small mobile*/
                    //if(( $j(window).width() < 640 || inv_DBO_Detail.IsLargeMobile || (inv_DBO_Detail.IsSmallMobile && inv_playerContainer.attr('iscareerssite')=='true') ))
                    if (checkIsSmallDeviceOrMediumDevice()) {
                        //if(!inv_DBO_Detail.IsSmallMobile)
                        {
                            inv_playerContainer.find('.inv_videoListTitle').bind('click', function() {
                                var imagCon = $j(this).closest(".inv_videoListThumbnail").find('.inv_videoListThumbnailimgContainer');
                                if (imagCon.length == 1) {
                                    imagCon.trigger('click');
                                    inv_playerContainer.find(".inv_videoGallery").hide();
                                }
                            });
                        }
                    }

                    /*Urvi - 06/06/2016 removed rollsroyce careers site code ----------------*/
                    if (checkIsSmallDevice()) {
                        inv_playerContainer.find('.inv_videoListThumbnailimgContainer').unbind("click");
                        inv_playerContainer.find('.inv_videoListThumbnailimgContainer').bind("click", function() {
                            inv_playerContainer.find(".inv_videoGallery").hide();
                            triggerVideoOnSmallDevice($j(this).find(".inv_videoListThumbnailOverimg").attr("refid"));
                        });
                    }
                }

                if (isIE()) {
                    inv_playerContainer.addClass("isIE");
                }

                inv_playerContainer.find('.inv_controlbigtext, .inv_nowplayingLabel, .inv_videoInformation, .inv_shareBtn, .videoListLabel, .videoListBtn, .inv_videoGallery, .inv_nowplayingContainer, .inv_videoListBtnContainer').addClass("inv_videoControls_extra");
                inv_playerContainer.find('.inv_videoListThumbnailimgContainer').unbind('touchstart');

                // Section text for control bar title //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                if (op.sectionText) {
                    inv_playerContainer.find(".inv_controlbigtext").html(op.sectionText);
                    inv_playerContainer.find(".galleryTitle").html(op.sectionText);
                }

                // Gallery type labels //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                inv_playerContainer.find(".inv_nowplayingLabel, .nowplayLabel").text("now playing");
                inv_playerContainer.find(".nextplayLabel").text("up next");
                inv_playerContainer.find(".morevideosLabel").text("more videos");
                inv_playerContainer.find(".videoListLabel").text("video list");

                // Hide gallery initially //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                inv_playerContainer.find(".inv_videoGallery").hide();

                // List Button Click  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                inv_playerContainer.find(".videoListBtn").bind("click", function() {
                    if (inv_playerContainer.find(".videoListBtn").hasClass("list-active")) {
                        inv_playerContainer.find(".videoListBtn").removeClass("list-active");
                        inv_playerContainer.removeClass("galleryActive");
                        inv_playerContainer.find(".inv_videoGallery").slideUp("fast");
                    } else {
                        inv_playerContainer.find(".inv_infoBtnNew.active").trigger("click");
                        inv_playerContainer.find('.inv_shareBtn.inv_shareBtnClick').trigger("click");

                        inv_playerContainer.find(".videoListBtn").addClass("list-active");
                        inv_playerContainer.addClass("galleryActive");
                        inv_playerContainer.find(".inv_videoGallery").slideDown("fast");
                    }
                });

                // Sharing Options //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                /*Urvi - 06/06/2016 removed rollsroyce careers site code ----------------*/
                //if(inv_DBO_Detail.IsSmallMobile)// || inv_playerContainer.attr('testcareers')=='true')
                {
                    inv_playerContainer.find(".inv_shareBtn").unbind("click");
                    inv_playerContainer.find(".inv_shareBtn").bind("click", function() {
                        if (inv_playerContainer.find(".inv_shareBtn").attr('class').indexOf('inv_shareBtnClick') != -1) {
                            inv_playerContainer.find(".inv_shareControls").fadeOut('fast', function() {
                                inv_playerContainer.find(".inv_shareBtn").removeClass("inv_shareBtnClick");
                            });
                        } else {
                            inv_playerContainer.find(".inv_shareControls").fadeIn('fast', function() {
                                inv_playerContainer.find(".inv_shareBtn").addClass("inv_shareBtnClick");
                            });
                        }
                    });
                }
                inv_playerContainer.find(".inv_facebookBtn").unbind("click");
                inv_playerContainer.find(".inv_facebookBtn").bind("click", function() {
                    trackGA("Facebook");
                    callFBshare(inv_videoShareTitle, "", window.location.href.toString());
                });
                inv_playerContainer.find(".inv_linkedinBtn").unbind("click");
                inv_playerContainer.find(".inv_linkedinBtn").bind("click", function() {
                    trackGA("Linkedin");
                    var querystring_test = window.parent.location;
                    var remove_string = querystring_test.toString().substring(querystring_test.toString().indexOf('?'), querystring_test.toString().indexOf('#'))

                    querystring_test = querystring_test.toString().replace(remove_string, '');
                    //querystring_test=querystring_test.toString().replace('#','?videoid=');
                    querystring_test = encodeURIComponent(remove_string + querystring_test);

                    window.open("http://www.linkedin.com/shareArticle?mini=false&url=" + querystring_test + "&title=" + inv_videoShareTitle + "&summary= ");
                });
                inv_playerContainer.find(".inv_twitterBtn").unbind("click");
                inv_playerContainer.find(".inv_twitterBtn").bind("click", function() {
                    trackGA("Twitter");
                    window.open("https://twitter.com/share?url=" + encodeURIComponent(window.location.href) + "&text=" + inv_videoShareTitle + ": ");
                });
                /*if(inv_playerContainer.attr('testcareers')=='true' && (inv_DBO_Detail.IsSmallMobile || inv_DBO_Detail.IsLargeMobile))
                {
                	if(inv_playerContainer.find(".inv_whatsappBtn").length==0)
                	{
                		$j("<div class='inv_whatsappBtn'></div>").insertAfter(inv_playerContainer.find(".inv_linkedinBtn"));	
                	}
                	inv_playerContainer.find(".inv_whatsappBtn").unbind("click");
                	inv_playerContainer.find(".inv_whatsappBtn").bind("click", function()
                	{
                		trackGA("Whatsapp");
                		window.open("whatsapp://send?text=" + inv_videoShareTitle + ": " + encodeURIComponent(window.location.href));
                	});	
                }*/
                /*inv_playerContainer.find(".inv_youtubeBtn").bind("click", function(){
                	window.open("https://www.youtube.com/user/RollsRoyceplc", "_blank");
                });
				
                inv_playerContainer.find(".inv_vineBtn").bind("click", function(){
                	window.open("https://vine.co/", "_blank");
                });*/

                // Information Button //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                if (op.showInfo) {
                    inv_playerContainer.find('.videoListLabel').html('<div class="inv_infoBtnNew"></div>');

                    inv_playerContainer.find('.inv_videoListBtnContainer').append('<div class="inv_infoBtnNewDetail"></div>');
                    inv_playerContainer.find('.inv_infoBtnNewDetail').append('<div class="inv_infoBtnNewDetail_NowPlaing">NOW PLAYING</div>');
                    inv_playerContainer.find('.inv_infoBtnNewDetail').append('<div class="inv_infoBtnNewDetail_CloseBtn"></div>');
                    inv_playerContainer.find('.inv_infoBtnNewDetail').append('<div class="inv_infoBtnNewDetail_Title"></div>');
                    inv_playerContainer.find('.inv_infoBtnNewDetail').append('<div class="inv_infoBtnNewDetail_Description"></div>');

                    inv_playerContainer.find('.inv_infoBtnNew').bind('touchstart click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        if (inv_playerContainer.find(".inv_infoBtnNew").hasClass("active")) {
                            inv_playerContainer.find(".inv_infoBtnNew").removeClass("active");
                            inv_playerContainer.find(".inv_infoBtnNewDetail").slideUp("fast");
                            //inv_playerContainer.find(".inv_playPauseBtn.inv_playBtn").trigger("click");
                        } else {
                            inv_playerContainer.find(".inv_infoBtnNew").addClass("active");
                            inv_playerContainer.find(".inv_infoBtnNewDetail").slideDown("fast");

                            inv_playerContainer.find(".videoListBtn.list-active").trigger("click");
                            inv_playerContainer.find('.inv_shareBtn.inv_shareBtnClick').trigger("click");
                            //inv_playerContainer.find(".inv_playPauseBtn.inv_pauseBtn").trigger("click");
                        }
                    });

                    inv_playerContainer.find('.inv_infoBtnNewDetail_CloseBtn').bind('touchstart click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        inv_playerContainer.find('.inv_infoBtnNew.active').trigger("click");
                    });
                }
                setTimeout(function() {
                    createCareersPageLayout();
                    //changeLayoutControlbar();
                }, 0); //500

            } else if (op.showInfo == false) {
                inv_playerContainer.find(".inv_videoInformation").addClass("banner");
            }
        }

        this.dataLoaded = function(data) {
            videoCollection = data;
        }

        /*Urvi:16/05/2016 full width playlist start*/
        this.videoLoaded = function() {
            trackVideoView = true;
            /****************************************************************** RR Careers Start ******************************************************************/
            if (op.rrcareers) {
                if (checkIsSmallDevice() && op.playerType.toLowerCase() == "galleryplayer") {
                    triggerVideoOnSmallDevice(op.videoId);
                } else {
                    inv_playerContainer.data("videoId", inv_playerContainer.find(".inv_videoArea").attr("referenceid"));

                    inv_playerContainer.trigger("videoLoaded");
                    createCareersPageLayout("changevideo");
                    //changeLayoutControlbar("changevideo");				
                }
                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                /*if(inv_playerContainer.attr('testcareers')=='true' && op.playerType.toLowerCase()!="singleplayer")
                	inv_playerContainer.attr('playerMode','paused');*/
                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/
            }
            /****************************************************************** RR Careers End ******************************************************************/
            /****************************************************************** Banner Player Start ******************************************************************/
            if (op.isLoop) // Banner player with loop - vine
            {
                if (navigator.userAgent.match(/Lumia 930/)) {
                    if (op.playerType == 'singleplayer') {
                        inv_playerContainer.find(".inv_overlayPlay").unbind('click');
                        inv_playerContainer.find(".inv_overlayPlay").bind('click', function() {
                            window.open(videoCollection[0]["videoURL"]);
                        });
                    }
                }
            }
            /****************************************************************** Banner Player End ******************************************************************/
        }

        this.mediaComplete = function() {
            if (op.isLoop && inv_DBO_Detail.IsDesktop && !(inv_DBO_Detail.IsTouchDevice || navigator.userAgent.match(/Lumia 930/))) // Banner player with loop - vine
            {
                inv_playerContainer.find(".inv_overlayPlay").trigger('click');
            }
            /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
            /*if(inv_playerContainer.attr('testcareers')=='true' && op.playerType.toLowerCase()!="singleplayer")
            	inv_playerContainer.attr('playerMode','paused');*/
            /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/
        }
        // Himaja: brightcove analytics implementation
        var trackVideoView = true;
        this.playModeChanged = function(mode) {
            /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
            /*if(inv_playerContainer.attr('testcareers')=='true' && op.playerType.toLowerCase()!="singleplayer")
            {
            	if(mode=='playing')
            		inv_playerContainer.attr('playerMode','playing');
            	if(inv_DBO_Detail.IsDesktop)
            	{
            		if(mode=='playing' && inv_playerContainer.find(".inv_fullscreenBtn").attr('class').indexOf('inv_normalmodeBtn')==-1)
            			inv_playerContainer.find(".inv_pauseBtn").trigger('click');
            	}
            }*/
            /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- end*/
            if (trackVideoView) {
                var videoId = inv_playerContainer.find('.inv_videoStillArea img').attr('src').split('videoId=')[1];
                var referenceId = inv_playerContainer.find('.inv_videoArea').attr('referenceid');
                var videoData = jQuery.grep(videoCollection, function(n, i) {
                    return (n.referenceId == referenceId);
                })[0];

                if (videoId != '' && videoId != undefined)
                    sendAnalyticsEvent('video_view', videoData.name, videoId);

                trackVideoView = false;
            }
        }
        /*Urvi:16/05/2016 full width playlist end*/
        // send analytics event
        var sendAnalyticsEvent = function(eventType, videoName, videoId) {
            var params = {
                baseURL: document.location.protocol + "//metrics.brightcove.com/v2/tracker",
                account: '2468238088001',
                time: Date.now(),
                destination: encodeURI(window.location.href),
                event: eventType,
                domain: 'videocloud',
                video: videoId,
                video_name: encodeURI(videoName)
            };
            inv_metricsApiCall(params);
            return;
        };
        var inv_metricsApiCall = function(params) {
            try {
                $j.support.cors = true;
                $j.ajax({
                        type: 'GET',
                        url: 'https://viz.tools.investis.com/rollsroyce/html5player/rebrand/files/sendBrightcoveAnalyticsData.php',
                        data: params,
                        crossDomain: true
                    })
                    .done(function(res) {
                        //console.log(res)
                    })
                    .fail(function(jqXHR, textStatus, errorThrown) {
                        //console.log(errorThrown);	
                    })
                    .always(function(res) {
                        //console.log(res)
                    });;
            } catch (e) {
                console.log(e)
            }
        }
        // Himaja: brightcove analytics implementation
        this.videoResized = function() {
            resizeTranscript();
            /****************************************************************** RR Careers Start ******************************************************************/
            if (op.rrcareers) {
                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/
                /*if(inv_playerContainer.attr('testcareers')=='true')
                {
                	inv_playerContainer.find(".videoListBtn.list-active").trigger("click");
                }				
                if(inv_playerContainer.attr('testcareers')=='true' && op.playerType.toLowerCase()!="singleplayer")
                {
                	if(inv_DBO_Detail.IsDesktop)
                	{
                		if(inv_playerContainer.find(".inv_fullscreenBtn").attr('class').indexOf('inv_normalmodeBtn')==-1)
                		{
                			inv_playerContainer.find(".inv_pauseBtn").trigger('click');
                		}
                	}
                }*/
                /*Urvi - 06/06/2016 removed rollsroyce careers site code ---------------- start*/

                /*Urvi:16/05/2016 full width playlist end*/

                createCareersPageLayout("resize");
                //changeLayoutControlbar("resize");
            }
            /****************************************************************** RR Careers End ******************************************************************/



            var normalwidth;
            var normalheight;
            if (op.integrationMethod == "lightbox") {
                if (inv_playerContainer.find(".inv_fullscreenBtn").length > 0 && inv_playerContainer.find(".inv_fullscreenBtn").attr('class').indexOf('inv_normalmodeBtn') != -1) {
                    var inv_videoPlayerWidth_Max = inv_DBO_Detail.WindowWidth;
                    var inv_videoPlayerHeight_Max = inv_DBO_Detail.WindowHeight;

                    normalwidth = $j('#colorbox').width();
                    normalheight = $j('#colorbox').height();

                    $j.colorbox.resize({
                        innerWidth: inv_videoPlayerWidth_Max,
                        innerHeight: inv_videoPlayerHeight_Max,
                        scrolling: false,
                        escKey: false,
                        arrowKey: false
                    });
                } else {
                    /*normalwidth=inv_playerContainer.find(".inv_videoArea").width();
                    normalheight=(normalwidth/16)*9;*/
                    $j.colorbox.resize({
                        innerWidth: normalwidth,
                        innerHeight: normalheight,
                        scrolling: false,
                        escKey: false,
                        arrowKey: false
                    });
                }
            }
            if (op.integrationMethod == "iframe")
                $j(window.frameElement).height(inv_playerContainer.height());
        }
        this.pauseVideo = function() {
            try {
                if (inv_playerContainer.find('.inv_overlayPlay').hasClass('inv_overlayPlayClicked'))
                    inv_playerContainer.find('.inv_overlayPlay').trigger('click');
            } catch (e) {}
        }
        this.stopVideo = function() {
            try {
                inv_playerContainer.find('.inv_stopBtn').trigger('click');
            } catch (e) {}
        }
        preinit();
    }
    $j.fn.pauseVideo = function() {
        var me = $j(this);
        var dataname = 'embedCode';
        var instance = me.data(dataname);
        if (instance != undefined) {
            instance.pauseVideo();
            return;
        }
    }
    $j.fn.stopVideo = function() {
        var me = $j(this);
        var dataname = 'embedCode';
        var instance = me.data(dataname);
        if (instance != undefined) {
            instance.stopVideo();
            return;
        }
    }
    $j.fn.embedCode = function(params) // namespace - Plugin Startup
    {
        var me = $j(this);
        var dataname = 'embedCode';
        var instance = me.data(dataname);
        var create_new_instance = true;
        var careers;

        try {
            // enable revised gallery design code with querystring
            /* var vars = {};
            var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
            	vars[key] = value;
            });			
            careers = vars["testcareers"];
            if(careers!=undefined && careers.indexOf("true")!=-1)
            	careers=true; */

            // enable revised gallery design code on live site
            if ((params.rrcareers == true && params.isCareersSite != true))
                careers = true;
        } catch (e) {

        }
        if ((careers && params.playerType == "galleryplayer") || me.data('rrCareers') != undefined) {
            var dataname = 'rrCareers';
            var instance = me.data(dataname);
            if (instance != undefined) {
                me.rrCareers(params);
            } else {
                $j.ajax({
                    url: "https://viz.tools.investis.com/rollsroyce/html5player/rebrand/javascripts/jquery.rrCareers.js",
                    crossDomain: true,
                    dataType: "script",
                    success: function() {
                        me.rrCareers(params);
                    },
                    error: function() {
                        // handle errors
                    }
                });
            }
        } else {
            if (instance != undefined) {
                if (params.playerLoaded) {
                    instance.playerLoaded();
                    return;
                } else if (params.videoLoaded) {
                    instance.videoLoaded();
                    return;
                } else if (params.videoResized) {
                    instance.videoResized();
                    return;
                } else if (params.playModeChanged) {
                    instance.playModeChanged(params.mode);
                    return;
                } else if (params.mediaComplete) {
                    instance.mediaComplete();
                    return;
                } else if (params.dataLoaded) {
                    instance.dataLoaded(params.videoData);
                    return;
                } else if (params.trigger) {
                    instance.triggerVideo(params.ref);
                    return;
                } else {
                    me.removeData(dataname);
                }
            } else if (typeof params === 'object' || !params) {
                return me.data(dataname, new playerConstruct(me, params));
            }

        }
    };
})($j); //jQuery maped to the $, so it can't be overwritten by another library in the scope of its execution
/*!---- main-----*/
/*------------ Back to Top Starts -----------*/
/**
 * Copyright (c) 2007-2012 Ariel Flesler - aflesler(at)gmail(dot)com | http://flesler.blogspot.com
 * Dual licensed under MIT and GPL.
 * @author Ariel Flesler
 * @version 1.4.3.1
 */
;
(function($j) {
    var h = $j.scrollTo = function(a, b, c) {
        $j(window).scrollTo(a, b, c)
    };
    h.defaults = {
        axis: 'xy',
        duration: parseFloat($j.fn.jquery) >= 1.3 ? 0 : 1,
        limit: true
    };
    h.window = function(a) {
        return $j(window)._scrollable()
    };
    $j.fn._scrollable = function() {
        return this.map(function() {
            var a = this,
                isWin = !a.nodeName || $j.inArray(a.nodeName.toLowerCase(), ['iframe', '#document', 'html', 'body']) != -1;
            if (!isWin) return a;
            var b = (a.contentWindow || a).document || a.ownerDocument || a;
            return /webkit/i.test(navigator.userAgent) || b.compatMode == 'BackCompat' ? b.body : b.documentElement
        })
    };
    $j.fn.scrollTo = function(e, f, g) {
        if (typeof f == 'object') {
            g = f;
            f = 0
        }
        if (typeof g == 'function') g = {
            onAfter: g
        };
        if (e == 'max') e = 9e9;
        g = $j.extend({}, h.defaults, g);
        f = f || g.duration;
        g.queue = g.queue && g.axis.length > 1;
        if (g.queue) f /= 2;
        g.offset = both(g.offset);
        g.over = both(g.over);
        return this._scrollable().each(function() {
            if (e == null) return;
            var d = this,
                $elem = $j(d),
                targ = e,
                toff, attr = {},
                win = $elem.is('html,body');
            switch (typeof targ) {
                case 'number':
                case 'string':
                    if (/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(targ)) {
                        targ = both(targ);
                        break
                    }
                    targ = $j(targ, this);
                    if (!targ.length) return;
                case 'object':
                    if (targ.is || targ.style) toff = (targ = $j(targ)).offset()
            }
            $j.each(g.axis.split(''), function(i, a) {
                var b = a == 'x' ? 'Left' : 'Top',
                    pos = b.toLowerCase(),
                    key = 'scroll' + b,
                    old = d[key],
                    max = h.max(d, a);
                if (toff) {
                    attr[key] = toff[pos] + (win ? 0 : old - $elem.offset()[pos]);
                    if (g.margin) {
                        attr[key] -= parseInt(targ.css('margin' + b)) || 0;
                        attr[key] -= parseInt(targ.css('border' + b + 'Width')) || 0
                    }
                    attr[key] += g.offset[pos] || 0;
                    if (g.over[pos]) attr[key] += targ[a == 'x' ? 'width' : 'height']() * g.over[pos]
                } else {
                    var c = targ[pos];
                    attr[key] = c.slice && c.slice(-1) == '%' ? parseFloat(c) / 100 * max : c
                }
                if (g.limit && /^\d+$/.test(attr[key])) attr[key] = attr[key] <= 0 ? 0 : Math.min(attr[key], max);
                if (!i && g.queue) {
                    if (old != attr[key]) animate(g.onAfterFirst);
                    delete attr[key]
                }
            });
            animate(g.onAfter);

            function animate(a) {
                $elem.animate(attr, f, g.easing, a && function() {
                    a.call(this, e, g)
                })
            }
        }).end()
    };
    h.max = function(a, b) {
        var c = b == 'x' ? 'Width' : 'Height',
            scroll = 'scroll' + c;
        if (!$j(a).is('html,body')) return a[scroll] - $j(a)[c.toLowerCase()]();
        var d = 'client' + c,
            html = a.ownerDocument.documentElement,
            body = a.ownerDocument.body;
        return Math.max(html[scroll], body[scroll]) - Math.min(html[d], body[d])
    };

    function both(a) {
        return typeof a == 'object' ? a : {
            top: a,
            left: a
        }
    }
})($j);

$j.fn.topLink = function(settings) {
    settings = $j.extend({
        min: 1,
        fadeSpeed: 200,
        ieOffset: 50
    }, settings);
    return this.each(function() {
        //listen for scroll
        var el = $j(this);
        el.css('display', 'none'); //in case the user forgot
        $j(window).scroll(function() {
            if (!$j.support.hrefNormalized) {
                el.css({
                    //'position': 'absolute',
                    //'top': $j(window).scrollTop() + $j(window).height() - settings.ieOffset
                });
            }
            if ($j(window).scrollTop() >= settings.min) {
                el.fadeIn(settings.fadeSpeed);
            } else {
                el.fadeOut(settings.fadeSpeed);
            }
        });
    });
};



/*------------ Back to Top Ends -----------*/


function breakList(numOfLists, list) {
    var listLength = list.find("li").size();
    var numInRow = Math.ceil(listLength / numOfLists);
    for (var i = 0; i < numOfLists; i++) {
        var listItems = list.find("li").slice(0, numInRow);
        var newList = $j('<ul/>').append(listItems);
        $j("#radiolist").append(newList);
    }
}


$j(document).ajaxComplete(function() {
    setTimeout(function() {
        if ($j(".listGridViewWrapper span.list-view").hasClass("active")) {
            $j(".new-press-releases-wrapper #insights-landing .hsp-custom-signpost").each(function() {
                if (!$j(this).hasClass("list-group-item")) {

                    $j(this).addClass("list-group-item");

                }
            });
        }
    }, 800);

    setTimeout(function() {
        $j('.insights-mid-fw .hsp-main').css('height', 'auto');
        setEqualHeight_CommonClass('.insights-mid-fw .hsp-main');
        setEqualHeight_CommonClass('.discover-landing-page .insights-mid-fw-inner .hsp-main .hsp-img img');
    }, 500);



    setEqualHeight_CommonClass($j(".fw-contact-cards-sld").find('.fw-contact-cards-box .cc-ttl'));
    setEqualHeight_CommonClass($j(".fw-contact-cards-sld").find('.fw-contact-cards-box .cc-info'));







    setEqualHeight_CommonClass($j('.new-press-releases-wrapper #insights-landing .hsp-main .hsp-text .hsp-innerwrapper h3')); // Press Releases Title

    setEqualHeight_CommonClass($j('.hsp-main.new-press-release-item .hsp-text .hsp-innerwrapper h3')); // Press Releases Title




    if ($j(".listGridViewWrapper span.grid-view").hasClass("active")) {

        $j(".differpagination").removeClass("list-group-item-wrapper");
        $j(".hsp-custom-signpost.hsp-main").removeClass("list-group-item");
        setEqualHeight_CommonClass($j('.new-press-releases-wrapper #insights-landing .hsp-main .hsp-text .hsp-innerwrapper h3'));

    }


});

$j(window).resize(function() {



    setEqualHeight_CommonClass($j('.new-press-releases-wrapper #insights-landing .hsp-main .hsp-text .hsp-innerwrapper h3')); // Press Releases Title

    setEqualHeight_CommonClass($j('.hsp-main.new-press-release-item .hsp-text .hsp-innerwrapper h3')); // Press Releases Title


    setTimeout(function() {
        $j('.insights-mid-fw .hsp-main').css('height', 'auto');
        setEqualHeight_CommonClass('.discover-landing-page .insights-mid-fw-inner .hsp-main .hsp-img img');
        setEqualHeight_CommonClass('.insights-mid-fw .hsp-main');
    }, 500);


});


$j(document).ready(function() {

    /* Anti-bribery - added title tag using js - start */
    /*var antiDoc = $j("#anti-bribery-manual .ar-lnk-btn a").attr("title");
    antiDoc = antiDoc + ", opens in a new window"
    var antiDoc = $j("#anti-bribery-manual .ar-lnk-btn a").attr("title",antiDoc); */
    /* Anti-bribery - added title tag using js - end */

    /* 3.2 - Download disclaimer - start */
    var DisPDFPath;
    $j(".download-disclaimer-module-content-button .download-ar-popup-button.download-ar-popup-button-closepop").on("click", function() {
        $j("body").removeClass("ArOverflow");
        $j('.download-disclaimer-module-overlay').fadeOut();
        $j('.download-disclaimer-module-wrapper').fadeOut();
    });

    $j(".download-disclaimer-module-content-button .download-ar-popup-button.download-ar-popup-button-accept").on("click", function() {
        $j("body").removeClass("ArOverflow");
        $j('.download-disclaimer-module-overlay').fadeOut();
        $j('.download-disclaimer-module-wrapper').fadeOut();
        window.open(DisPDFPath, '_blank');
    });

    $j(".fw-downloads-sld.fw-downloads-sld-disclaimer .fw-sld-wrapper .fw-dwld-sld-outer .fw-dwld-inner-box").each(function() {
        $j(this).children(".dwnld-centered-block").children("a").click(function(e) {
            e.preventDefault();
            $j("body").addClass("ArOverflow");
            DisPDFPath = $j(this).attr("href");
            $j('.download-disclaimer-module-overlay').fadeIn();
            $j('.download-disclaimer-module-wrapper').fadeIn();
        });
    });
    /* 3.2 - Download disclaimer - end*/


    setEqualHeight_CommonClass(".sustainable-item");


    $j('.fw-contact-cards-sld').each(function() {
        setEqualHeight_CommonClass($j(this).find('.fw-contact-cards-box .cc-ttl'));
        setEqualHeight_CommonClass($j(this).find('.fw-contact-cards-box .cc-info'));
    });


    /*$j('.new-press-releases-wrapper #insights-landing .hsp-main').getSameTopGroups({
      commonParent: '#insights-landing'
    }, function(gc) {
      for (i = 1; i <= gc; i++) {
        
        
        setEqualHeight_CommonClass(".gg-g-" + i + " .hsp-text .hsp-innerwrapper h3");
        
      }
      
    });*/




    setEqualHeight_CommonClass($j('.new-press-releases-wrapper #insights-landing .hsp-main .hsp-text .hsp-innerwrapper h3')); // Press Releases Title

    setEqualHeight_CommonClass($j('.hsp-main.new-press-release-item .hsp-text .hsp-innerwrapper h3')); // Press Releases Title



    $j(".listGridViewWrapper span").on('click', function(e) {

        $j(".listGridViewWrapper span").removeClass("active");

        if ($j(this).hasClass('grid-view')) {
            $j(this).addClass("active");
            $j(".new-press-releases-wrapper #insights-landing .hsp-custom-signpost").removeClass('list-group-item');

            $j(".new-press-releases-wrapper #insights-landing .differpagination").removeClass('list-group-item-wrapper');

            setTimeout(function() {
                $j('.insights-mid-fw .hsp-main').css('height', 'auto');
                setEqualHeight_CommonClass('.discover-landing-page .insights-mid-fw-inner .hsp-main .hsp-img img');
                setEqualHeight_CommonClass('.insights-mid-fw .hsp-main');
            }, 200);

            setEqualHeight_CommonClass($j('.new-press-releases-wrapper #insights-landing .hsp-main .hsp-text .hsp-innerwrapper h3')); // Press Releases Title

        } else if ($j(this).hasClass('list-view')) {
            $j(this).addClass("active");
            $j(".new-press-releases-wrapper #insights-landing .hsp-custom-signpost").addClass('list-group-item');
            $j(".new-press-releases-wrapper #insights-landing .differpagination").addClass('list-group-item-wrapper');
        }

    });




    /*if (viewport1().width > 768) {
     setTimeout(function() {
                $j(".fw-sld-wrapper .fw-dwld-sld-outer").each(function( index ) {
    			var downloadcount = $j(this).children(".slick-list").children(".slick-track").children(".fw-dwld-inner-box").length;
    			alert(downloadcount)
    			if(downloadcount == 1){


    			$j(this).attr("style","float:left;")
    			$j(this).slick('unslick');
    			}
    			});
     }, 200);
    }
    */

    // Split li list in colurmn for search result page - start


    breakList(3, $j(".sr-radiolist"));

    // Split li list in colurmn for search result page - end



    $j(".jobsection div.lhs-snaphead").addClass("open");
    $j(".jobsection div.lhs-snapcontent").css("display", "block");



    //if($j("body:has(#students-and-graduates)")){
    //$j("body#students-and-graduates div.lhs-snaphead").addClass("open");
    //$j("body#students-and-graduates div.lhs-snapcontent").css("display","block");
    //}


    //if($j("body").hasClass("ip3-students-and-graduates")){
    //$j("body.ip3-students-and-graduates div.lhs-snaphead").addClass("open");
    //$j("body.ip3-students-and-graduates div.lhs-snapcontent").css("display","block");
    //}

    //if($j("body").hasClass("ip3-careersinindia")){
    //$j("body.ip3-careersinindia div.lhs-snaphead").addClass("open");
    //$j("body.ip3-careersinindia div.lhs-snapcontent").css("display","block");
    //}


    /*------------ Deep linking KPI chart for Dashboard of targets section - Starts -----------*/
    function getParameterByName(name) {
        name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
        var regexS = "[\\?&]" + name + "=([^&#]*)";
        var regex = new RegExp(regexS);
        var results = regex.exec(window.location.search);
        if (results == null)
            return "";
        else
            return decodeURIComponent(results[1].replace(/\+/g, " "));
    }
    var new_chart_url = getParameterByName("ChartURL");
    var current_chart_url = $j("#iframe-container iframe").attr("src");

    if ((new_chart_url != '') && new_chart_url != "undefined") {
        $j("#iframe-container iframe").attr("src", current_chart_url + "#" + new_chart_url);
    } else {
        $j("#iframe-container iframe").attr("src", current_chart_url);
    }
    /*------------ Deep linking KPI chart for Dashboard of targets section - End -----------*/






    /*------------ Back to Top Starts -----------*/

    $j("#footerwrapper").append('<style type="text/css">#auto-top-link{ font-family: "TheMix";display:none; position:fixed; float:left; bottom:5px; right:10px; color:#fff;border: 1px solid #004d91;background-color:#004d91; font-weight:normal;z-index: 101; text-decoration:none; padding:5px 7px;webkit-transition: all .25s ease;-moz-transition: all .25s ease;-ms-transition: all .25s ease;-o-transition: all .25s ease;transition: all .25s ease;}#auto-top-link:hover{background:#004d91;color:#fff;}</style>');
    $j("#footerwrapper").append('<a href="#MainForm" id="auto-top-link">Top of Page</a>');

    //smoothscroll
    $j('#auto-top-link').click(function(e) {
        e.preventDefault();
        $j.scrollTo(0, 300);
    });


    /*-------------- Mobi Detect Starts -------------------*/
    var isMobile = {
        Android: function() {
            return navigator.userAgent.match(/Android/i);
        },
        BlackBerry: function() {
            return navigator.userAgent.match(/BlackBerry/i);
        },
        Opera: function() {
            return navigator.userAgent.match(/Opera Mini/i);
        },
        Windows: function() {
            return navigator.userAgent.match(/IEMobile/i);
        },
        iOS: function() {
            return navigator.userAgent.match(/iPhone|iPad|iPod/i);
        },
        any: function() {
            return (isMobile.Android() || isMobile.BlackBerry() || isMobile.Opera() || isMobile.Windows() || isMobile.iOS());
        }
    };

    if (isMobile.any()) {
        $j('a#auto-top-link').css('display', 'none !important');

        // starts for retina images replacement
        /*
                (function() {
                    function t(e) {
                        this.path = e;
                        var t = this.path.split("."),
                            n = t.slice(0, t.length - 1).join("."),
                            r = t[t.length - 1];
                        this.at_2x_path = n + "-2x." + r
                    }

                    function n(e) {
                        this.el = e, this.path = new t(this.el.getAttribute("src"));
                        var n = this;
                        this.path.check_2x_variant(function(e) {
                            e && n.swap()
                        })
                    }
                    var e = typeof exports == "undefined" ? window : exports;
                    e.RetinaImagePath = t, t.confirmed_paths = [], t.prototype.is_external = function() {
                        return !!this.path.match(/^https?\:/i) && !this.path.match("//" + document.domain)
                    }, t.prototype.check_2x_variant = function(e) {
                        var n, r = this;
                        if (this.is_external()) return e(!1);
                        if (this.at_2x_path in t.confirmed_paths) return e(!0);
                        n = new XMLHttpRequest, n.open("HEAD", this.at_2x_path), n.onreadystatechange = function() {
                            return n.readyState != 4 ? e(!1) : n.status >= 200 && n.status <= 399 ? (t.confirmed_paths.push(r.at_2x_path), e(!0)) : e(!1)
                        }, n.send()
                    }, e.RetinaImage = n, n.prototype.swap = function(e) {
                        function n() {
                            t.el.complete ? (t.el.setAttribute("width", t.el.offsetWidth), t.el.setAttribute("height", t.el.offsetHeight), t.el.setAttribute("src", e)) : setTimeout(n, 5)
                        }
                        typeof e == "undefined" && (e = this.path.at_2x_path);
                        var t = this;
                        n()
                    }, e.devicePixelRatio > 1 && (window.onload = function() {
                        var e = document.getElementsByTagName("img"),
                            t = [],
                            r, i;
                        for (r = 0; r < e.length; r++) i = e[r], t.push(new n(i))
                    })
                })();*/

        //ends for retina images replacement

    } else {
        $j('#auto-top-link').topLink({
            min: 400,
            fadeSpeed: 500
        });

        $j('a[href^=tel]').click(function(e) {
            e.preventDefault();
        });
    }
    /*----------------- Mobi Detect Ends ----------------*/
    /*------------ Back to Top Starts -----------*/


    /* ---------------- Search - Following function is used for <enter> issue in IE ----------- */

    $j("#searchTextboxContainer input").keypress(function(e) {
        if (e.keyCode == 13) {

            if ($j.trim($j(this).val()) != '') {
                document.getElementById("searchButton").click();
                return false;
            } else {
                //alert('Please enter valid search keyword');
            }
        }
    });

    $j("#searchTextBoxContainerRP input").keypress(function(e) {
        if (e.keyCode == 13) {

            if ($j.trim($j(this).val()) != '') {
                document.getElementById("SearchbuttonRP").click();
                return false;
            } else {
                //alert('Please enter valid search keyword');
            }
        }

    });
    /* ---------------- <END> Following function is used for <enter> issue in IE ------------ */

    /* ---------------- Start Scroll to Linked Content ------------ */
    $j(document).on("click", "a.rad-link[href^='#']", function(e) {
        //e.preventDefault();
        e.preventDefault();

        var targetLink = $j(this).attr("href").split("#")[1];
        //alert(targetLink);
        var target = $j('a[name=' + targetLink + ']');
        if (target.length) {
            var top = target.offset().top;
            $j('html,body').animate({
                scrollTop: top
            }, 1000);
            return false;
        }
    });
    /* ---------------- Ends Scroll to Linked Content ------------ */


    $j(".faq-questions li a").on('click', function(e) {
        e.preventDefault();
        var faqopen = $j(this).attr('href');
        setTimeout(function() {
            $j("html,body").animate({
                scrollTop: $j(faqopen).offset().top
            }, "slow");
        }, 300);
    });

    /* ------------------ File extension to UPPERCASE in title attribute ------------------ */
    $j("a.extension-link[title]").each(function() {
        var tmpTxt = $j(this).attr("title").split(",");
        if (tmpTxt.length > 1) {
            tmpTxt[0] = tmpTxt[0].toUpperCase();
        }
        $j(this).attr("title", tmpTxt.join());
    });

    $j("img.extension-link-img[alt]").each(function() {
        var tmpTxt = $j(this).attr("alt").split(",");
        var tmpTxt1 = tmpTxt[1].split(",");
        if (tmpTxt.length > 1 && tmpTxt1.length > 1) {
            tmpTxt1[0] = tmpTxt1[0].toUpperCase();
        }
        $j(this).attr("alt", tmpTxt[0] + ',' + tmpTxt1.join());
    });
    /* ------------------ <END> File extension to UPPERCASE in title attribute ------------ */


    /* -------------- Footer starts ------------- */
    $j(".col1 .footer-header").click(function() {

        if ($j(this).hasClass("footer-snap-head") && !($j(this).siblings(".footer-content").is(":animated"))) {
            $j(this).toggleClass("open");
            $j(this).siblings(".footer-content").slideToggle();
        }
    });
    /* -------------- Footer ends ------------- */

    /*--------------- Homepage Section1 video start (Added this code in home sublayout) ------------*/
    /* if ($j("#video-container").length > 0) {
         try {
             var videoID = $j.trim($j(".videoID").html());
             //alert(videoID);
             $j(".video-container").embedCode({
                 playerType: "singleplayer",
                 videoId: videoID,
                 overlayPlay: true,
                 autoPlay: false,
                 isBanner: true,
                 showInfo: false
             });
         } catch (err_msg) {
             //alert(err_msg.message);
         }
     }*/
    /*--------------- Homepage Section1 video starst ------------ */

    /*--------------- Homepage Section2 start ------------ */
    $j(".box-head").each(function() {

        if ($j(this).children(".bg-color").length > 0 && $j.trim($j(this).children(".bg-color").html()).length > 0) {
            $j(this).css("background-color", "#" + $j.trim($j(this).children(".bg-color").html()));
        }

        if ($j(this).children(".font-color").length > 0 && $j.trim($j(this).children(".font-color").html()).length > 0) {
            $j(this).css("color", "#" + $j.trim($j(this).children(".font-color").html()));
            $j(this).children(".box-title, .box-sub-title").css("color", "#" + $j.trim($j(this).children(".font-color").html()));
        }

    });
    /*--------------- Homepage Section2 ends ------------ */

    /*--------------- Banner video starts ------------ */

    if ($j("#inv_playerContainer261").length > 0) {
        $j("#inv_playerContainer261").embedCode({
            playerType: "singleplayer",
            videoId: "rolls-royce691",
            overlayPlay: true,
            autoPlay: true,
            isBanner: false,
            showInfo: false
        });
    }

    if ($j("#inv_playerContainer639").length > 0) {
        $j("#inv_playerContainer639").embedCode({
            playerType: "singleplayer",
            videoId: "rolls-royce639",
            overlayPlay: true,
            autoPlay: true,
            isBanner: false,
            showInfo: false
        });
    }

    if ($j("div[id^=banner-video-wrap]").length > 0) {
        $j("div[id^=banner-video-wrap]").each(function() {
            try {
                var videoID = $j.trim($j(this).attr("data-video-id"));

                /*------- Old embeed code initialization -----
                $j(this).embedCode({
                    playerType: "singleplayer",
                    videoId: videoID,
                    overlayPlay: true,
                    autoPlay: false,
                    isBanner: false,
                    showInfo: false
                }); */


                /*------- New embeed code initialization ---*/
                if (videoID == "rolls-royce013") {
                    $j(this).embedCode({
                        playerType: "singleplayer",
                        videoId: videoID,
                        overlayPlay: true,
                        autoPlay: false,
                        isBanner: false,
                        showInfo: false,
                        transcriptFilePath: "/tools/urlproxy/urlproxy.aspx?settingname=transcript-rolls-royce013&content-type=text/html"
                    });
                } else {
                    if (videoID == "rolls-royce293" || videoID == "rolls-royce333") {

                        $j(this).embedCode({
                            playerType: "singleplayer",
                            videoId: videoID,
                            overlayPlay: true,
                            autoPlay: true,
                            isBanner: true,
                            showInfo: false,
                            isLoop: true
                        });
                    }

                    if (videoID == "rolls-royce324") {
                        console.log(videoID);
                        $j(this).embedCode({
                            playerType: "singleplayer",
                            videoId: videoID,
                            overlayPlay: true,
                            autoPlay: false,
                            isBanner: false,
                            showInfo: false
                        });
                    } else {
                        $j(this).embedCode({
                            playerType: "singleplayer",
                            videoId: videoID,
                            overlayPlay: true,
                            autoPlay: false,
                            isBanner: false,
                            showInfo: false
                        });
                    }

                }
            } catch (err_msg) {
                //alert(err_msg.message);
            }
        });
    }
    /*--------------- Banner video ends ------------ */

    /*--------------- Left Column start ------------ */
    $j(".left-link-wrap").each(function() {

        if ($j(this).children(".bg-color").length > 0) {
            $j(this).find(".left-s-link").css("background-color", "#" + $j.trim($j(this).children(".bg-color").html()));
        }

        if ($j(this).children(".font-color").length > 0) {
            $j(this).find(".left-s-link").css("color", "#" + $j.trim($j(this).children(".font-color").html()));
        }

    });


    $j(".full-link-l-signpost").each(function() {

        if ($j(this).children(".bg-color").length > 0 && $j.trim($j(this).children(".bg-color").html()).length > 0) {
            $j(this).css("background-color", "#" + $j.trim($j(this).children(".bg-color").html()));
        }

        if ($j(this).children(".font-color").length > 0 && $j.trim($j(this).children(".font-color").html()).length > 0) {
            $j(this).children(".l-signpost-title").css("color", "#" + $j.trim($j(this).children(".font-color").html()));
        }

    });
    /*--------------- Left Column ends ------------ */

    /* -------------- Scrolling Table starts ------------- */
    $j(".page-content table,table.rad-datatable").not("table[id^='inv-responsive']").each(function() {
        $j(this).wrap('<div class="scroll-table-container" />');
    });

    $j('.breakdown').each(function() {
        $j(this).addClass('scroll-table-container');
    });
    /* -------------- Scrolling Table ends ------------- */

    /* -------------- Dropdown starts -------------- */


    if ($j(".dropdown"))

        $j(".dropdown").click(function() {
            $j(".dropdown").not(this).children("ul").removeClass("opened");
            $j(".dropdown").not(this).children("ul").slideUp();
            if ($j(this).children("ul").hasClass("opened")) {
                $j(this).children("ul").removeClass("opened");
                $j(this).children("ul").slideUp();
            } else {
                $j(this).children("ul").addClass("opened");
                $j(this).children("ul").slideDown();
            }
        });



    $j(".dropdown ul li").click(function(e) {
        $j(this).addClass("selected");
        var thisParent = $j(this).parents(".dropdown");
        selectedLi = thisParent.find(".selected");
        thisParent.find("li").not(selectedLi).show();
        selectedLi.removeClass("selected");
        var selected = selectedLi.html();
        selectedLi.hide();
        selectedLi.parent().siblings(".selected-box").html(selected);
        //selectedLi.parent().siblings(".selected-box").attr("data-id",selectedLi.attr("id"));
        selectedLi.parent().siblings(".selected-box").attr("data-value", selectedLi.attr("data-value"));
        selectedLi.parent("ul").slideUp();
    });
    /* -------------- Dropdown ends -------------- */

    $j(".media-contact-list-left ul li a").first().addClass("currlink");
    $j(".media-contact-list-left ul li a").first().trigger("click");

    $j(".media-contact-list-left ul li").click(function(e) {
        $j(".media-contact-list-left ul li a").removeClass("currlink");
        $j(this).children("a").addClass("currlink");
        currentcat = $j(this).find("a").attr("data-id");
        contactsSliderInit(currentcat);
        setEqualHeight_CommonClass(".media-contact-bars");
    });


    /* ----------- Events Filter starts ------------- */
    $j(".dropdown").each(function() {
        $j(this).find("ul").find("li.d-all").addClass("selected");
        var thisParent = $j(this);
        selectedLi = thisParent.find(".selected");
        thisParent.find("li").not(selectedLi).show();
        selectedLi.removeClass("selected");
        var selected = selectedLi.html();
        selectedLi.hide();
        selectedLi.parent().siblings(".selected-box").html(selected);
        //selectedLi.parent().siblings(".selected-box").attr("data-id",selectedLi.attr("id"));
        selectedLi.parent().siblings(".selected-box").attr("data-value", selectedLi.attr("data-value"));
        selectedLi.parent("ul").slideUp();
    });

    if ($j(".dropdown .selected-box").data("value") != "*") {
        $j(".location ul li").hide();
    }

    $j(".country ul li").click(function() {
        $j(".location ul li.d-all").addClass("selected");
        var thisParent = $j(".location ul li.d-all").parents(".dropdown");
        selectedLi = thisParent.find(".selected");
        thisParent.find("li").not(selectedLi).show();
        selectedLi.removeClass("selected");
        var selected = selectedLi.html();
        selectedLi.hide();
        selectedLi.parent().siblings(".selected-box").html(selected);
        //selectedLi.parent().siblings(".selected-box").attr("data-id",selectedLi.attr("id"));
        selectedLi.parent().siblings(".selected-box").attr("data-value", selectedLi.attr("data-value"));
        $j(".location ul li").hide();
        var selec = ".location ul li[data-country='" + $j(this).data("value") + "']";
        $j(selec).show();
    });

    $j("#event-search").click(function(e) {
        e.preventDefault();
        var country = $j(".country .selected-box").attr("data-value");
        var location = $j(".location .selected-box").attr("data-value") == '*' ? '*' : country + "/" + $j(".location .selected-box").attr("data-value");
        var year = $j(".year .selected-box").attr("data-value");
        //alert("COUNTRY : "+country+"---LOCATION : "+location+"---YEAR : "+year);
        $j(".event-wrapper").html('');
        $j(".event-wrapper").addClass("loader");
        $j(".event-wrapper").show();

        var rUrl = encodeURI($j(this).attr("href") + "?async=1&ac=1&country=" + country + "&location=" + location + "&year=" + year);

        $j(".loadedContent").load(rUrl, function(data) {
            $j(".event-wrapper").removeClass('loader');
            $j(".event-wrapper").html(data);
        });
    });


    /*---------------MAP CSS STARTS---------------*/
    $j(".dropdown-institute-university li").click(function() {
        var currentId = $j(this).attr('id');
        //alert(currentId);
        $j(".location-info.active").fadeOut();
        $j(".location-info.active").removeClass("active");

        $j(".location-info").each(function() {
            if ($j(this).hasClass(currentId)) {
                $j(".full-black-overlay").css({
                    "display": "block"
                });
                $j(this).addClass("active");
                $j(this).fadeIn();
            }
        });

        var loc = new google.maps.LatLng($j(this).attr("data-latitude"), $j(this).attr("data-longitude"));
        researchMap.setCenter(loc);
        researchMap.setZoom(8);

    });

    function closeModal() {
        $j(".location-info.active").fadeOut();
        $j(".location-info.active").removeClass("active");
        $j(".full-black-overlay").fadeOut();
    }
    $j(".full-black-overlay").click(function() {
        closeModal();
    });
    $j(".close-btn").click(function() {
        closeModal();
    });
    /* ----------- Events Filter ends ------------- */

    /*------------ Stay in touch sign up starts -----------*/
    $j("#singupBttn").click(function(e) {

        var returnVal = true;
        if ($j("#txt-signup-email").val() == "") {
            var x = $j("#txt-signup-email").val();
            $j("#txt-signup-email").addClass("requiredField");
            returnVal = false;
        } else {
            var x = $j("#txt-signup-email").val();
            var atpos = x.indexOf("@");
            var dotpos = x.lastIndexOf(".");
            if (atpos < 1 || dotpos < atpos + 2 || dotpos + 2 >= x.length) {
                $j("#txt-signup-email").addClass("requiredField");

                returnVal = false;
            } else {
                $j("#txt-signup-email").removeClass("requiredField");
            }
        }

        if (!returnVal) {
            e.preventDefault();
            $j("#txt-signup-email").focus();
        } else {
            var x = $j("#txt-signup-email").val();
            var newHref = $j(this).attr("href") + "?alertEmail=" + x;
            $j(this).attr("href", newHref);
        }

    });

    $j("#txt-signup-email").keypress(function(e) {
        if (e.keyCode == 13) {

            document.getElementById("singupBttn").click();

            return false;
        }
    });
    /*------------ Stay in touch sign up ends -----------*/

    /*--------------------for Tren XWB Technology------------------*/
    $j('.breakdown-items dt a:not(.hidehoverinfo)').hover(function() {
        //$j('.breakdown-items dt a.showhoverinfo').on('hover',function() {
        if (viewport().width > 800) {
            $j(this).parent().next('dd').addClass('is-active');
        }
    }, function() {
        if (viewport().width > 800) {
            $j(this).parent().next('dd').removeClass('is-active');
        }
    });

    $j("a.breakdown-point").click(function(e) {
        e.preventDefault();
    });
    /*--------------------for Tren XWB Technology------------------*/

    /*---------------- Related link image gallery arrow starts ----------------*/
    $j(".related-link-content a>img").each(function() {

        $j(this).parent().addClass("noArrow");

    });
    /*---------------- Related link image gallery arrow ends ----------------*/

    /*---------------- Careers Landing starts ----------------*/
    $j(".c-latest-job-wrapper").parent().removeClass("landing-box");
    $j(".c-latest-job-wrapper").parent().addClass("c-lastest-jobs-box");
    /*---------------- Careers Landing ends ----------------*/

    /*---------------- Careers Filter starts ----------------*/
    $j(".lhs-snaphead").click(function() {
        $j(this).siblings(".lhs-snapcontent").slideToggle();
        $j(this).toggleClass("open");
    });






    $j(".account-accor>li>a").click(function(e) {

        e.preventDefault();
        if ($j(this).parent().hasClass("snapopen")) {
            $j(this).siblings("ul").slideUp();
            $j(this).parent().removeClass("snapopen");
        } else {
            $j(this).parent().siblings(".snapopen").children("ul").slideUp();
            $j(this).parent().siblings(".snapopen").removeClass("snapopen");
            $j(this).parent().addClass("snapopen");
            $j(this).siblings("ul").slideDown();
        }
    });
    /*---------------- Careers Filter starts ----------------*/


    /*---------- KPI starts ----------------*/

    if ($j(".kpi-intro-box").length > 0) {
        var id = "#" + $j(".kpi-intro-box").data("parent");
        $j(id).addClass("current");

        $j(".kpi-title-bar").css('background-color', "#" + $j(".kpi-intro-box").data("color"));
        $j(".kpi-intro-box").css('color', "#" + $j(".kpi-intro-box").data("color"));
    }

    var oldScroll = 0;
    $j(window).scroll(function(e) {

        if ($j(".kpi-nav").hasClass("mobiNav")) {
            if ($j(window).scrollTop() >= ($j("#footer").offset().top - viewport().height)) {
                $j(".kpi-nav").fadeOut();
            } else {
                if (oldScroll < $j(window).scrollTop())
                    $j(".kpi-nav").fadeOut();
                else
                    $j(".kpi-nav").fadeIn(function() {
                        setEqualHeight_CommonClass($j(".kpi-nav li"));
                    });
            }

            oldScroll = $j(window).scrollTop();
        }

    });

    var pathName = location.pathname;
    if (pathName.indexOf("targets-dashboard/all") >= 0) {
        $j(".kpi-nav li a").click(function(e) {
            e.preventDefault();
            var prevCurrentId = $j(".kpi-nav li.current").attr("id");
            $j(".kpi-nav li.current").removeClass("current");

            var currentId = $j(this).parent().attr("id");
            currentId = "." + currentId.substring(currentId.indexOf("-") + 1, currentId.length);
            $j(this).parent().addClass("current");

            if ($j(this).parent().attr("id") != "kpi-all" && prevCurrentId != "") {
                $j(".kpi-item-wrap").fadeOut();
                if ($j(currentId).html() == undefined) {
                    $j(".no-kpi-text").show();
                } else {
                    $j(currentId).parent().fadeIn(function() {
                        setEqualHeight_CommonClass(".kpi-title");
                        setEqualHeight_CommonClass(".kpi-item-inner");
                    });
                    $j(".no-kpi-text").hide();
                }
            } else {
                $j(".no-kpi-text").hide();
                $j(".kpi-item-wrap").fadeIn(function() {
                    setEqualHeight_CommonClass(".kpi-title");
                    setEqualHeight_CommonClass(".kpi-item-inner");
                });
            }

        });
    }

    /*---------- KPI ends ----------------*/


    /*---------- China PR starts ----------------*/

    var pathName = location.pathname;
    if (pathName.indexOf("country-sites/china") >= 0) {
        var months = ["", "", "", "", "", "", "", "", "", "", "", ""];
        var days = ["", "", "", "", "", "", ""];

        $j(".news-wrapper .pr-date").each(function() {
            var datePR = $j(this).html();

            if (datePR.indexOf("Monday") >= 0)
                datePR = datePR.replace("Monday", days[0]);
            else if (datePR.indexOf("Tuesday") >= 0)
                datePR = datePR.replace("Tuesday", days[1]);
            else if (datePR.indexOf("Wednesday") >= 0)
                datePR = datePR.replace("Wednesday", days[2]);
            else if (datePR.indexOf("Thursday") >= 0)
                datePR = datePR.replace("Thursday", days[3]);
            else if (datePR.indexOf("Friday") >= 0)
                datePR = datePR.replace("Friday", days[4]);
            else if (datePR.indexOf("Saturday") >= 0)
                datePR = datePR.replace("Saturday", days[5]);
            else if (datePR.indexOf("Sunday") >= 0)
                datePR = datePR.replace("Sunday", days[6]);

            if (datePR.indexOf("January") >= 0)
                datePR = datePR.replace("January", months[0]);
            else if (datePR.indexOf("February") >= 0)
                datePR = datePR.replace("February", months[1]);
            else if (datePR.indexOf("March") >= 0)
                datePR = datePR.replace("March", months[2]);
            else if (datePR.indexOf("April") >= 0)
                datePR = datePR.replace("April", months[3]);
            else if (datePR.indexOf("May") >= 0)
                datePR = datePR.replace("May", months[4]);
            else if (datePR.indexOf("June") >= 0)
                datePR = datePR.replace("June", months[5]);
            else if (datePR.indexOf("July") >= 0)
                datePR = datePR.replace("July", months[6]);
            else if (datePR.indexOf("August") >= 0)
                datePR = datePR.replace("August", months[7]);
            else if (datePR.indexOf("September") >= 0)
                datePR = datePR.replace("September", months[8]);
            else if (datePR.indexOf("October") >= 0)
                datePR = datePR.replace("October", months[9]);
            else if (datePR.indexOf("November") >= 0)

                datePR = datePR.replace("November", months[10]);
            else if (datePR.indexOf("December") >= 0)
                datePR = datePR.replace("December", months[11]);


            $j(this).html(datePR);

        });

    }
    /*---------- China PR ends ----------------*/

    /*---------- Customers Section header name ----------------*/
    var csn = $j("body.ip3-customers .sectionname").val();

    $j("body.ip3-customers .section-header p#sectionheader").html(csn);
    $j("body.ip3-customers .section-header p#sectionheader").css("visibility", "visible");
    /*---------- Customers Section header name End ----------------*/


    //setEqualHeight_CommonClass(".media-contact-bars");


    $j(".fw-contact-cards-sld .fw-sld-inner-box").each(function() {
        var cmn = $j(this).find(".cc-ttl").text();

        $j(this).find(".icon-icon-mail-cc").live("click", function() {
            //alert(ct + 'LinkedIn Button Link - Clicked from ' , window.location.href);
            _gaq.push(['_trackEvent', 'Contact Module Email Link', 'Email - ' + cmn, 'Clicked from ' + window.location.href])
        });

        $j(this).find(".icon-linkedin-cc").live("click", function() {
            _gaq.push(['_trackEvent', 'Contact Module LinkedIn Link', 'LinkedIn - ' + cmn, 'Clicked from ' + window.location.href])
        });

    });

    setTimeout(function() {
        $j(".product-contacts-inner .product-contact-item").each(function() {
            var ct = $j(this).find(".product-contact-title").text();

            $j(this).find(".product-contact-link-item.mail-link a").live("click", function() {
                //alert(ct + 'LinkedIn Button Link - Clicked from ' , window.location.href);
                _gaq.push(['_trackEvent', 'Contact Email Button', 'Email - ' + ct, 'Clicked from ' + window.location.href])
            });

            $j(this).find(".product-contact-link-item.linkedin-link a").live("click", function() {
                _gaq.push(['_trackEvent', 'Contact LinkedIn Button', 'LinkedIn - ' + ct, 'Clicked from ' + window.location.href])
            });

            $j(this).find(".contact-bottom-email-contaier a").live("click", function() {
                _gaq.push(['_trackEvent', 'Contact Email Link', 'Email link - ' + ct, 'Clicked from ' + window.location.href])
            });

        });
    }, 3000);


    setTimeout(function() {
        $j(".fw-related-products .product-item").each(function() {
            var cpt = $j(this).find(".product-item-title").text();
            $j(this).find(".product-item-inner a").live("click", function() {
                _gaq.push(['_trackEvent', 'Related Products Link', 'Product - ' + cpt, 'Clicked from ' + window.location.href])
            });
        });
    }, 3000);

    setTimeout(function() {
        $j(".media-contacts-inner .media-contact-item").each(function() {
            var cmed = $j(this).find(".media-contact-title").text();

            $j(this).find(".mail-link").live("click", function() {
                _gaq.push(['_trackEvent', 'Media Contact Email Link', cmed, 'Clicked from ' + window.location.href])
            });

            $j(this).find(".linkedin-link").live("click", function() {
                _gaq.push(['_trackEvent', 'Media Contact LinkedIn Link', cmed, 'Clicked from ' + window.location.href])
            });

        });
    }, 3000);

});

$j(window).load(function() {
    /* Anti-bribery - added title tag using js - start -- same code added on top*/
    //var antiDoc = $j("#anti-bribery-manual .ar-lnk-btn a").attr("title");
    //antiDoc = antiDoc + ", opens in a new window"
    //var antiDoc = $j("#anti-bribery-manual .ar-lnk-btn a").attr("title",antiDoc);
    /* Anti-bribery - added title tag using js - end -- same code added on top*/


    if (viewport1().width > 768) {
        $j(".fw-sld-wrapper .fw-dwld-sld-outer").each(function(index) {
            var downloadcount = $j(this).children(".slick-list").children(".slick-track").children(".fw-dwld-inner-box").length;
            if (downloadcount == 1) {
                if ($j(this).closest('.sub-section').find('.fw-dwld-featured-left-main')[0]) {
                    $j(this).attr("style", "float:left;");
                    $j(this).slick('unslick');
                }
            }
        });
    }
});

/*$j(window).load(function(){
(function(){
  var counter = 5;

  setInterval(function() {
    counter--;
    if (counter >= 0) {
      span = document.getElementById("count");
      span.innerHTML = counter;
    }
    // Display 'counter' wherever you want to display it.
    if (counter === 0) {
      //  alert('this is where it happens');
        clearInterval(counter);
    }

  }, 1000);

})();

});*/


$j(document).ready(function() {
    $j(".socialShare .share-tag a").click(function() {
        $j(".share-icons").slideToggle();
    });


    if ($j(".msBannerTitle").hasClass("trueBannerImage")) {
        $j(".popup-story-date").addClass("hide");
    }


    // press releases share funtionality link change
    $j(".share-tag>a").click(function() {
        var hrefOfLink = window.location.href;
        $j(".twitter-share a").attr("href", "https://twitter.com/share?url=" + hrefOfLink);
        $j(".facebook-share a").attr("href", "https://www.facebook.com/sharer.php?u=" + hrefOfLink);
        $j(".linkedin-share a").attr("href", "https://www.linkedin.com/shareArticle?mini=true&url=" + hrefOfLink);
        var encodedURL_EMailShare = encodeURI(hrefOfLink);
        $j(".email-share a").attr("href", "mailto:?subject=Rolls-Royce%20Press%20releases&body=I%20thought%20this%20link%20might%20interest%20you%20" + encodedURL_EMailShare);
        //console.log("hrefOfLink",hrefOfLink);
    });

    setTimeout(function() {
        var dateText = $j(".popup-story-date.module-max-width.font24").text();
        //console.log(dateText, "dateText");

        // $j( "<p class='no-image-banner-date bannerDate font12 PioneerBold d-block mb-19'>"+dateText+"</p>" ).insertBefore( "body#press-releases .no-image .home-banner-fw-inner h1.msBannerTitle.falseBannerImage" );
    }, 500);


}); /* doc end */

setTimeout(function() {
    $j('#resources .pd-box-wrapper').each(function() {
        setEqualHeight_CommonClass($j(this).find('.pd-box-snapdown-click'));
    });
}, 1000);
$j(window).resize(function() {
    setTimeout(function() {
        $j('#resources .pd-box-wrapper').each(function() {
            setEqualHeight_CommonClass($j(this).find('.pd-box-snapdown-click'));
        });
    }, 1000);
});
/*!---- mmenu-----*/
/*	
 * jQuery mmenu v4.5.7
 * @requires jQuery 1.7.0 or later
 *
 * mmenu.frebsite.nl
 *	
 * Copyright (c) Fred Heusschen
 * www.frebsite.nl
 *
 * Licensed under the MIT license:
 * http://en.wikipedia.org/wiki/MIT_License
 */
! function(e) {
    function n(n, s, t) {
        if (t) return "object" != typeof n && (n = {}), n;
        n = e.extend(!0, {}, e[a].defaults, n);
        for (var i = ["position", "zposition", "modal", "moveBackground"], o = 0, l = i.length; l > o; o++) "undefined" != typeof n[i[o]] && (e[a].deprecated('The option "' + i[o] + '"', "offCanvas." + i[o]), n.offCanvas = n.offCanvas || {}, n.offCanvas[i[o]] = n[i[o]]);
        return n
    }

    function s(n) {
        n = e.extend(!0, {}, e[a].configuration, n);
        for (var s = ["panel", "list", "selected", "label", "spacer"], t = 0, i = s.length; i > t; t++) "undefined" != typeof n[s[t] + "Class"] && (e[a].deprecated('The configuration option "' + s[t] + 'Class"', "classNames." + s[t]), n.classNames[s[t]] = n[s[t] + "Class"]);
        if ("undefined" != typeof n.counterClass && (e[a].deprecated('The configuration option "counterClass"', "classNames.counters.counter"), n.classNames.counters = n.classNames.counters || {}, n.classNames.counters.counter = n.counterClass), "undefined" != typeof n.collapsedClass && (e[a].deprecated('The configuration option "collapsedClass"', "classNames.labels.collapsed"), n.classNames.labels = n.classNames.labels || {}, n.classNames.labels.collapsed = n.collapsedClass), "undefined" != typeof n.header)
            for (var s = ["panelHeader", "panelNext", "panelPrev"], t = 0, i = s.length; i > t; t++) "undefined" != typeof n.header[s[t] + "Class"] && (e[a].deprecated('The configuration option "header.' + s[t] + 'Class"', "classNames.header." + s[t]), n.classNames.header = n.classNames.header || {}, n.classNames.header[s[t]] = n.header[s[t] + "Class"]);
        for (var s = ["pageNodetype", "pageSelector", "menuWrapperSelector", "menuInjectMethod"], t = 0, i = s.length; i > t; t++) "undefined" != typeof n[s[t]] && (e[a].deprecated('The configuration option "' + s[t] + '"', "offCanvas." + s[t]), n.offCanvas = n.offCanvas || {}, n.offCanvas[s[t]] = n[s[t]]);
        return n
    }

    function t() {
        r = !0, c.$wndw = e(window), c.$html = e("html"), c.$body = e("body"), e.each([o, l, d], function(e, n) {
            n.add = function(e) {
                e = e.split(" ");
                for (var s in e) n[e[s]] = n.mm(e[s])
            }
        }), o.mm = function(e) {
            return "mm-" + e
        }, o.add("wrapper menu inline panel nopanel list nolist subtitle selected label spacer current highest hidden opened subopened subopen fullsubopen subclose"), o.umm = function(e) {
            return "mm-" == e.slice(0, 3) && (e = e.slice(3)), e
        }, l.mm = function(e) {
            return "mm-" + e
        }, l.add("parent"), d.mm = function(e) {
            return e + ".mm"
        }, d.add("toggle open close setSelected transitionend webkitTransitionEnd mousedown mouseup touchstart touchmove touchend scroll resize click keydown keyup"), e[a]._c = o, e[a]._d = l, e[a]._e = d, e[a].glbl = c
    }
    var a = "mmenu",
        i = "4.5.7";
    if (!e[a]) {
        var o = {},
            l = {},
            d = {},
            r = !1,
            c = {
                $wndw: null,
                $html: null,
                $body: null
            };
        e[a] = function(e, s, t) {
            return this.$menu = e, this.opts = s, this.conf = t, this.vars = {}, this.opts = n(this.opts, this.conf, this.$menu), this._initMenu(), this._init(this.$menu.children(this.conf.panelNodetype)), this
        }, e[a].version = i, e[a].addons = [], e[a].uniqueId = 0, e[a].defaults = {
            classes: "",
            slidingSubmenus: !0,
            onClick: {
                setSelected: !0
            }
        }, e[a].configuration = {
            panelNodetype: "ul, ol, div",
            transitionDuration: 400,
            openingInterval: 25,
            classNames: {
                panel: "Panel",
                selected: "Selected",
                label: "Label",
                spacer: "Spacer"
            }
        }, e[a].prototype = {
            _init: function(n) {
                n = n.not("." + o.nopanel), n = this._initPanels(n), n = this._initLinks(n), n = this._bindCustomEvents(n);
                for (var s = 0; s < e[a].addons.length; s++) "function" == typeof this["_init_" + e[a].addons[s]] && this["_init_" + e[a].addons[s]](n);
                this._update()
            },
            _initMenu: function() {
                this.opts.offCanvas && this.conf.clone && (this.$menu = this.$menu.clone(!0), this.$menu.add(this.$menu.find("*")).filter("[id]").each(function() {
                    e(this).attr("id", o.mm(e(this).attr("id")))
                })), this.$menu.contents().each(function() {
                    3 == e(this)[0].nodeType && e(this).remove()
                }), this.$menu.parent().addClass(o.wrapper);
                var n = [o.menu];
                n.push(o.mm(this.opts.slidingSubmenus ? "horizontal" : "vertical")), this.opts.classes && n.push(this.opts.classes), this.$menu.addClass(n.join(" "))
            },
            _initPanels: function(n) {
                var s = this;
                this.__findAddBack(n, "ul, ol").not("." + o.nolist).addClass(o.list);
                var t = this.__findAddBack(n, "." + o.list).find("> li");
                this.__refactorClass(t, this.conf.classNames.selected, "selected"), this.__refactorClass(t, this.conf.classNames.label, "label"), this.__refactorClass(t, this.conf.classNames.spacer, "spacer"), t.off(d.setSelected).on(d.setSelected, function(n, s) {
                    n.stopPropagation(), t.removeClass(o.selected), "boolean" != typeof s && (s = !0), s && e(this).addClass(o.selected)
                }), this.__refactorClass(this.__findAddBack(n, "." + this.conf.classNames.panel), this.conf.classNames.panel, "panel"), n.add(this.__findAddBack(n, "." + o.list).children().children().filter(this.conf.panelNodetype).not("." + o.nopanel)).addClass(o.panel);
                var a = this.__findAddBack(n, "." + o.panel),
                    i = e("." + o.panel, this.$menu);
                a.each(function() {
                    var n = e(this),
                        t = n.attr("id") || s.__getUniqueId();
                    n.attr("id", t)
                }), a.each(function() {
                    var n = e(this),
                        t = n.is("ul, ol") ? n : n.find("ul ,ol").first(),
                        a = n.parent(),
                        i = a.find("> a, > span"),
                        d = a.closest("." + o.panel);
                    if (a.parent().is("." + o.list)) {
                        n.data(l.parent, a);
                        var r = e('<a class="' + o.subopen + '" href="#' + n.attr("id") + '" />').insertBefore(i);
                        i.is("a") || r.addClass(o.fullsubopen), s.opts.slidingSubmenus && t.prepend('<li class="' + o.subtitle + '"><a class="' + o.subclose + '" href="#' + d.attr("id") + '">' + i.text() + "</a></li>")
                    }
                });
                var r = this.opts.slidingSubmenus ? d.open : d.toggle;
                if (i.each(function() {
                        var n = e(this),
                            s = n.attr("id");
                        e('a[href="#' + s + '"]', i).off(d.click).on(d.click, function(e) {
                            e.preventDefault(), n.trigger(r)
                        })
                    }), this.opts.slidingSubmenus) {
                    var c = this.__findAddBack(n, "." + o.list).find("> li." + o.selected);
                    c.parents("li").removeClass(o.selected).end().add(c.parents("li")).each(function() {
                        var n = e(this),
                            s = n.find("> ." + o.panel);
                        s.length && (n.parents("." + o.panel).addClass(o.subopened), s.addClass(o.opened))
                    }).closest("." + o.panel).addClass(o.opened).parents("." + o.panel).addClass(o.subopened)
                } else {
                    var c = e("li." + o.selected, i);
                    c.parents("li").removeClass(o.selected).end().add(c.parents("li")).addClass(o.opened)
                }
                var u = i.filter("." + o.opened);
                return u.length || (u = a.first()), u.addClass(o.opened).last().addClass(o.current), this.opts.slidingSubmenus && a.not(u.last()).addClass(o.hidden).end().appendTo(this.$menu), a
            },
            _initLinks: function(n) {
                var s = this;
                return this.__findAddBack(n, "." + o.list).find("> li > a").not("." + o.subopen).not("." + o.subclose).not('[rel="external"]').not('[target="_blank"]').off(d.click).on(d.click, function(n) {
                    var t = e(this),
                        a = t.attr("href") || "";
                    s.__valueOrFn(s.opts.onClick.setSelected, t) && t.parent().trigger(d.setSelected);
                    var i = s.__valueOrFn(s.opts.onClick.preventDefault, t, "#" == a.slice(0, 1));
                    i && n.preventDefault(), s.__valueOrFn(s.opts.onClick.blockUI, t, !i) && c.$html.addClass(o.blocking), s.__valueOrFn(s.opts.onClick.close, t, i) && s.$menu.triggerHandler(d.close)
                }), n
            },
            _bindCustomEvents: function(n) {
                var s = this;
                return n.off(d.toggle + " " + d.open + " " + d.close).on(d.toggle + " " + d.open + " " + d.close, function(e) {
                    e.stopPropagation()
                }), this.opts.slidingSubmenus ? n.on(d.open, function() {
                    return s._openSubmenuHorizontal(e(this))
                }) : n.on(d.toggle, function() {
                    var n = e(this);
                    return n.triggerHandler(n.parent().hasClass(o.opened) ? d.close : d.open)
                }).on(d.open, function() {
                    return e(this).parent().addClass(o.opened), "open"
                }).on(d.close, function() {
                    return e(this).parent().removeClass(o.opened), "close"
                }), n
            },
            _openSubmenuHorizontal: function(n) {
                if (n.hasClass(o.current)) return !1;
                var s = e("." + o.panel, this.$menu),
                    t = s.filter("." + o.current);
                return s.removeClass(o.highest).removeClass(o.current).not(n).not(t).addClass(o.hidden), n.hasClass(o.opened) ? t.addClass(o.highest).removeClass(o.opened).removeClass(o.subopened) : (n.addClass(o.highest), t.addClass(o.subopened)), n.removeClass(o.hidden).addClass(o.current), setTimeout(function() {
                    n.removeClass(o.subopened).addClass(o.opened)
                }, this.conf.openingInterval), "open"
            },
            _update: function(e) {
                if (this.updates || (this.updates = []), "function" == typeof e) this.updates.push(e);
                else
                    for (var n = 0, s = this.updates.length; s > n; n++) this.updates[n].call(this, e)
            },
            __valueOrFn: function(e, n, s) {
                return "function" == typeof e ? e.call(n[0]) : "undefined" == typeof e && "undefined" != typeof s ? s : e
            },
            __refactorClass: function(e, n, s) {
                e.filter("." + n).removeClass(n).addClass(o[s])
            },
            __findAddBack: function(e, n) {
                return e.find(n).add(e.filter(n))
            },
            __transitionend: function(e, n, s) {
                var t = !1,
                    a = function() {
                        t || n.call(e[0]), t = !0
                    };
                e.one(d.transitionend, a), e.one(d.webkitTransitionEnd, a), setTimeout(a, 1.1 * s)
            },
            __getUniqueId: function() {
                return o.mm(e[a].uniqueId++)
            }
        }, e.fn[a] = function(i, o) {
            return r || t(), i = n(i, o), o = s(o), this.each(function() {
                var n = e(this);
                n.data(a) || n.data(a, new e[a](n, i, o))
            })
        }, e[a].support = {
            touch: "ontouchstart" in window.document
        }, e[a].debug = function() {}, e[a].deprecated = function(e, n) {
            "undefined" != typeof console && "undefined" != typeof console.warn && console.warn("MMENU: " + e + " is deprecated, use " + n + " instead.")
        }
    }
}($j);
/*	
 * jQuery mmenu offCanvas addon
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
! function(e) {
    function o(o) {
        return ("top" == o.position || "bottom" == o.position) && ("back" == o.zposition || "next" == o.zposition) && (e[s].deprecated('Using position "' + o.position + '" in combination with zposition "' + o.zposition + '"', 'zposition "front"'), o.zposition = "front"), o
    }

    function t(e) {
        return "string" != typeof e.pageSelector && (e.pageSelector = "> " + e.pageNodetype), e
    }

    function n() {
        c = !0, p = e[s]._c, a = e[s]._d, r = e[s]._e, p.add("offcanvas modal background opening blocker page"), a.add("style"), r.add("opening opened closing closed setPage"), l = e[s].glbl, l.$allMenus = (l.$allMenus || e()).add(this.$menu), l.$wndw.on(r.keydown, function(e) {
            return l.$html.hasClass(p.opened) && 9 == e.keyCode ? (e.preventDefault(), !1) : void 0
        });
        var o = 0;
        l.$wndw.on(r.resize, function(e, t) {
            if (t || l.$html.hasClass(p.opened)) {
                var n = l.$wndw.height();
                (t || n != o) && (o = n, l.$page.css("minHeight", n))
            }
        })
    }
    var s = "mmenu",
        i = "offCanvas";
    e[s].prototype["_init_" + i] = function() {
        if (this.opts[i] && !this.vars[i + "_added"]) {
            this.vars[i + "_added"] = !0, c || n(), this.opts[i] = o(this.opts[i]), this.conf[i] = t(this.conf[i]);
            var e = this.opts[i],
                s = this.conf[i],
                a = [p.offcanvas];
            "boolean" != typeof this.vars.opened && (this.vars.opened = !1), "left" != e.position && a.push(p.mm(e.position)), "back" != e.zposition && a.push(p.mm(e.zposition)), this.$menu.addClass(a.join(" ")).parent().removeClass(p.wrapper), this[i + "_initPage"](l.$page), this[i + "_initBlocker"](), this[i + "_initOpenClose"](), this[i + "_bindCustomEvents"](), this.$menu[s.menuInjectMethod + "To"](s.menuWrapperSelector)
        }
    }, e[s].addons.push(i), e[s].defaults[i] = {
        position: "left",
        zposition: "back",
        modal: !1,
        moveBackground: !0
    }, e[s].configuration[i] = {
        pageNodetype: "div",
        pageSelector: null,
        menuWrapperSelector: "body",
        menuInjectMethod: "prepend"
    }, e[s].prototype.open = function() {
        if (this.vars.opened) return !1;
        var e = this;
        return this._openSetup(), setTimeout(function() {
            e._openFinish()
        }, this.conf.openingInterval), "open"
    }, e[s].prototype._openSetup = function() {
        l.$allMenus.not(this.$menu).trigger(r.close), l.$page.data(a.style, l.$page.attr("style") || ""), l.$wndw.trigger(r.resize, [!0]);
        var e = [p.opened];
        this.opts[i].modal && e.push(p.modal), this.opts[i].moveBackground && e.push(p.background), "left" != this.opts[i].position && e.push(p.mm(this.opts[i].position)), "back" != this.opts[i].zposition && e.push(p.mm(this.opts[i].zposition)), this.opts.classes && e.push(this.opts.classes), l.$html.addClass(e.join(" ")), this.vars.opened = !0, this.$menu.addClass(p.current + " " + p.opened)
    }, e[s].prototype._openFinish = function() {
        var e = this;
        this.__transitionend(l.$page, function() {
            e.$menu.trigger(r.opened)
        }, this.conf.transitionDuration), l.$html.addClass(p.opening), this.$menu.trigger(r.opening)
    }, e[s].prototype.close = function() {
        if (!this.vars.opened) return !1;
        var e = this;
        return this.__transitionend(l.$page, function() {
            e.$menu.removeClass(p.current).removeClass(p.opened), l.$html.removeClass(p.opened).removeClass(p.modal).removeClass(p.background).removeClass(p.mm(e.opts[i].position)).removeClass(p.mm(e.opts[i].zposition)), e.opts.classes && l.$html.removeClass(e.opts.classes), l.$page.attr("style", l.$page.data(a.style)), e.vars.opened = !1, e.$menu.trigger(r.closed)
        }, this.conf.transitionDuration), l.$html.removeClass(p.opening), this.$menu.trigger(r.closing), "close"
    }, e[s].prototype[i + "_initBlocker"] = function() {
        var o = this;
        l.$blck || (l.$blck = e('<div id="' + p.blocker + '" />').appendTo(l.$body)), l.$blck.off(r.touchstart).on(r.touchstart, function(e) {
            e.preventDefault(), e.stopPropagation(), l.$blck.trigger(r.mousedown)
        }).on(r.mousedown, function(e) {
            e.preventDefault(), l.$html.hasClass(p.modal) || o.close()
        })
    }, e[s].prototype[i + "_initPage"] = function(o) {
        o || (o = e(this.conf[i].pageSelector, l.$body), o.length > 1 && (e[s].debug("Multiple nodes found for the page-node, all nodes are wrapped in one <" + this.conf[i].pageNodetype + ">."), o = o.wrapAll("<" + this.conf[i].pageNodetype + " />").parent())), o.addClass(p.page), l.$page = o
    }, e[s].prototype[i + "_initOpenClose"] = function() {
        var o = this,
            t = this.$menu.attr("id");
        t && t.length && (this.conf.clone && (t = p.umm(t)), e('a[href="#' + t + '"]').off(r.click).on(r.click, function(e) {
            e.preventDefault(), o.open()
        }));
        var t = l.$page.attr("id");
        t && t.length && e('a[href="#' + t + '"]').on(r.click, function(e) {
            e.preventDefault(), o.close()
        })
    }, e[s].prototype[i + "_bindCustomEvents"] = function() {
        var e = this,
            o = r.open + " " + r.opening + " " + r.opened + " " + r.close + " " + r.closing + " " + r.closed + " " + r.setPage;
        this.$menu.off(o).on(o, function(e) {
            e.stopPropagation()
        }), this.$menu.on(r.open, function() {
            e.open()
        }).on(r.close, function() {
            e.close()
        }).on(r.setPage, function(o, t) {
            e[i + "_initPage"](t), e[i + "_initOpenClose"]()
        })
    };
    var p, a, r, l, c = !1
}($j);
/*	
 * jQuery mmenu buttonbars addon
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
! function(t) {
    function n(t) {
        return t
    }

    function a(t) {
        return t
    }

    function i() {
        d = !0, o = t[r]._c, e = t[r]._d, u = t[r]._e, o.add("buttonbar"), c = t[r].glbl
    }
    var r = "mmenu",
        s = "buttonbars";
    t[r].prototype["_init_" + s] = function(r) {
        d || i();
        var e = this.vars[s + "_added"];
        this.vars[s + "_added"] = !0, e || (this.opts[s] = n(this.opts[s]), this.conf[s] = a(this.conf[s])), this.opts[s], this.conf[s], this.__refactorClass(t("div", r), this.conf.classNames[s].buttonbar, "buttonbar"), t("div." + o.buttonbar, r).each(function() {
            var n = t(this),
                a = n.children().not("input"),
                i = n.children().filter("input");
            n.addClass(o.buttonbar + "-" + a.length), i.each(function() {
                var n = t(this),
                    i = a.filter('label[for="' + n.attr("id") + '"]');
                i.length && n.insertBefore(i)
            })
        })
    }, t[r].addons.push(s), t[r].defaults[s] = {}, t[r].configuration.classNames[s] = {
        buttonbar: "Buttonbar"
    };
    var o, e, u, c, d = !1
}($j);
/*	
 * jQuery mmenu counters addon
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
! function(t) {
    function e(e) {
        return "boolean" == typeof e && (e = {
            add: e,
            update: e
        }), "object" != typeof e && (e = {}), e = t.extend(!0, {}, t[o].defaults[s], e)
    }

    function n(t) {
        return t
    }

    function a() {
        i = !0, d = t[o]._c, r = t[o]._d, u = t[o]._e, d.add("counter search noresultsmsg"), r.add("updatecounter"), c = t[o].glbl
    }
    var o = "mmenu",
        s = "counters";
    t[o].prototype["_init_" + s] = function(o) {
        i || a();
        var u = this.vars[s + "_added"];
        this.vars[s + "_added"] = !0, u || (this.opts[s] = e(this.opts[s]), this.conf[s] = n(this.conf[s]));
        var c = this,
            h = this.opts[s];
        this.conf[s], this.__refactorClass(t("em", o), this.conf.classNames[s].counter, "counter"), h.add && o.each(function() {
            var e = t(this).data(r.parent);
            e && (e.find("> em." + d.counter).length || e.prepend(t('<em class="' + d.counter + '" />')))
        }), h.update && o.each(function() {
            var e = t(this),
                n = e.data(r.parent);
            if (n) {
                var a = n.find("> em." + d.counter);
                a.length && (e.is("." + d.list) || (e = e.find("> ." + d.list)), e.length && !e.data(r.updatecounter) && (e.data(r.updatecounter, !0), c._update(function() {
                    var t = e.children().not("." + d.label).not("." + d.subtitle).not("." + d.hidden).not("." + d.search).not("." + d.noresultsmsg);
                    a.html(t.length)
                })))
            }
        })
    }, t[o].addons.push(s), t[o].defaults[s] = {
        add: !1,
        update: !1
    }, t[o].configuration.classNames[s] = {
        counter: "Counter"
    };
    var d, r, u, c, i = !1
}($j);
/*	
 * jQuery mmenu dragOpen addon
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
! function(e) {
    function t(e, t, n) {
        return t > e && (e = t), e > n && (e = n), e
    }

    function n(t) {
        return "boolean" == typeof t && (t = {
            open: t
        }), "object" != typeof t && (t = {}), t = e.extend(!0, {}, e[s].defaults[i], t)
    }

    function o(e) {
        return e
    }

    function a() {
        c = !0, r = e[s]._c, p = e[s]._d, f = e[s]._e, r.add("dragging"), d = e[s].glbl
    }
    var s = "mmenu",
        i = "dragOpen";
    e[s].prototype["_init_" + i] = function() {
        if ("function" == typeof Hammer && this.opts.offCanvas && !this.vars[i + "_added"]) {
            this.vars[i + "_added"] = !0, c || a(), this.opts[i] = n(this.opts[i]), this.conf[i] = o(this.conf[i]);
            var p = this,
                h = this.opts[i],
                m = this.conf[i];
            if (h.open) {
                if (Hammer.VERSION < 2) return e[s].deprecated("Older version of the Hammer library", "version 2 or newer"), !1;
                var u, g, l, v, _ = {},
                    w = 0,
                    b = !1,
                    y = !1,
                    $ = 0,
                    x = 0;
                switch (this.opts.offCanvas.position) {
                    case "left":
                    case "right":
                        _.events = "panleft panright", _.typeLower = "x", _.typeUpper = "X", y = "width";
                        break;
                    case "top":
                    case "bottom":
                        _.events = "panup pandown", _.typeLower = "y", _.typeUpper = "Y", y = "height"
                }
                switch (this.opts.offCanvas.position) {
                    case "left":
                    case "top":
                        _.negative = !1;
                        break;
                    case "right":
                    case "bottom":
                        _.negative = !0
                }
                switch (this.opts.offCanvas.position) {
                    case "left":
                        _.open_dir = "right", _.close_dir = "left";
                        break;
                    case "right":
                        _.open_dir = "left", _.close_dir = "right";
                        break;
                    case "top":
                        _.open_dir = "down", _.close_dir = "up";
                        break;
                    case "bottom":
                        _.open_dir = "up", _.close_dir = "down"
                }
                var C = this.__valueOrFn(h.pageNode, this.$menu, d.$page);
                "string" == typeof C && (C = e(C));
                var k = d.$page;
                switch (this.opts.offCanvas.zposition) {
                    case "front":
                        k = this.$menu;
                        break;
                    case "next":
                        k = k.add(this.$menu)
                }
                var S = new Hammer(C[0]);
                S.on("panstart", function(e) {
                    switch (v = e.center[_.typeLower], p.opts.offCanvas.position) {
                        case "right":
                        case "bottom":
                            v >= d.$wndw[y]() - h.maxStartPos && (w = 1);
                            break;
                        default:
                            v <= h.maxStartPos && (w = 1)
                    }
                    b = _.open_dir
                }).on(_.events + " panend", function(e) {
                    w > 0 && e.preventDefault()
                }).on(_.events, function(e) {
                    if (u = e["delta" + _.typeUpper], _.negative && (u = -u), u != $ && (b = u >= $ ? _.open_dir : _.close_dir), $ = u, $ > h.threshold && 1 == w) {
                        if (d.$html.hasClass(r.opened)) return;
                        w = 2, p._openSetup(), p.$menu.trigger(f.opening), d.$html.addClass(r.dragging), x = t(d.$wndw[y]() * m[y].perc, m[y].min, m[y].max)
                    }
                    2 == w && (g = t($, 10, x) - ("front" == p.opts.offCanvas.zposition ? x : 0), _.negative && (g = -g), l = "translate" + _.typeUpper + "(" + g + "px )", k.css({
                        "-webkit-transform": "-webkit-" + l,
                        transform: l
                    }))
                }).on("panend", function() {
                    2 == w && (d.$html.removeClass(r.dragging), k.css("transform", ""), p[b == _.open_dir ? "_openFinish" : "close"]()), w = 0
                })
            }
        }
    }, e[s].addons.push(i), e[s].defaults[i] = {
        open: !1,
        maxStartPos: 100,
        threshold: 50
    }, e[s].configuration[i] = {
        width: {
            perc: .8,
            min: 140,
            max: 440
        },
        height: {
            perc: .8,
            min: 140,
            max: 880
        }
    };
    var r, p, f, d, c = !1
}($j);
/*	
 * jQuery mmenu fixedElements addon
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
! function(t) {
    function s(t) {
        return t
    }

    function o(t) {
        return t
    }

    function n() {
        c = !0, e = t[i]._c, f = t[i]._d, r = t[i]._e, e.add("fixed-top fixed-bottom"), d = t[i].glbl
    }
    var i = "mmenu",
        a = "fixedElements";
    t[i].prototype["_init_" + a] = function() {
        if (this.opts.offCanvas) {
            c || n();
            var i = this.vars[a + "_added"];
            if (this.vars[a + "_added"] = !0, i || (this.opts[a] = s(this.opts[a]), this.conf[a] = o(this.conf[a])), this.opts[a], this.conf[a], this.__refactorClass(t("div, span, a", d.$page), this.conf.classNames[a].fixedTop, "fixed-top"), this.__refactorClass(t("div, span, a", d.$page), this.conf.classNames[a].fixedBottom, "fixed-bottom"), !i) {
                var f, p;
                this.$menu.on(r.opening, function() {
                    var s = t(window).scrollTop(),
                        o = d.$page.height() - s - d.$wndw.height();
                    f = t("." + e["fixed-top"]), p = t("." + e["fixed-bottom"]), f.css({
                        "-webkit-transform": "translateY( " + s + "px )",
                        transform: "translateY( " + s + "px )"
                    }), p.css({
                        "-webkit-transform": "translateY( -" + o + "px )",
                        transform: "translateY( -" + o + "px )"
                    })
                }).on(r.closed, function() {
                    f.add(p).css({
                        "-webkit-transform": "none",
                        transform: "none"
                    })
                })
            }
        }
    }, t[i].addons.push(a), t[i].defaults[a] = {}, t[i].configuration.classNames[a] = {
        fixedTop: "FixedTop",
        fixedBottom: "FixedBottom"
    };
    var e, f, r, d, c = !1
}($j);
/*	
 * jQuery mmenu footer addon
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
! function(t) {
    function o(o) {
        return "boolean" == typeof o && (o = {
            add: o,
            update: o
        }), "object" != typeof o && (o = {}), o = t.extend(!0, {}, t[a].defaults[s], o)
    }

    function n(t) {
        return t
    }

    function e() {
        h = !0, i = t[a]._c, d = t[a]._d, r = t[a]._e, i.add("footer hasfooter"), f = t[a].glbl
    }
    var a = "mmenu",
        s = "footer";
    t[a].prototype["_init_" + s] = function(a) {
        h || e();
        var d = this.vars[s + "_added"];
        this.vars[s + "_added"] = !0, d || (this.opts[s] = o(this.opts[s]), this.conf[s] = n(this.conf[s]));
        var f = this,
            u = this.opts[s];
        if (this.conf[s], !d && u.add) {
            var c = u.content ? u.content : u.title;
            t('<div class="' + i.footer + '" />').appendTo(this.$menu).append(c)
        }
        var p = t("div." + i.footer, this.$menu);
        p.length && (this.$menu.addClass(i.hasfooter), u.update && a.each(function() {
            var o = t(this),
                n = t("." + f.conf.classNames[s].panelFooter, o),
                e = n.html();
            e || (e = u.title);
            var a = function() {
                p[e ? "show" : "hide"](), p.html(e)
            };
            o.on(r.open, a), o.hasClass(i.current) && a()
        }), "function" == typeof this._init_buttonbars && this._init_buttonbars(p))
    }, t[a].addons.push(s), t[a].defaults[s] = {
        add: !1,
        content: !1,
        title: "",
        update: !1
    }, t[a].configuration.classNames[s] = {
        panelFooter: "Footer"
    };
    var i, d, r, f, h = !1
}($j);
/*	
 * jQuery mmenu header addon
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
! function(e) {
    function t(t) {
        return "boolean" == typeof t && (t = {
            add: t,
            update: t
        }), "object" != typeof t && (t = {}), t = e.extend(!0, {}, e[s].defaults[r], t)
    }

    function a(e) {
        return e
    }

    function n() {
        l = !0, i = e[s]._c, o = e[s]._d, h = e[s]._e, i.add("header hasheader prev next title"), d = e[s].glbl
    }
    var s = "mmenu",
        r = "header";
    e[s].prototype["_init_" + r] = function(s) {
        l || n();
        var o = this.vars[r + "_added"];
        this.vars[r + "_added"] = !0, o || (this.opts[r] = t(this.opts[r]), this.conf[r] = a(this.conf[r]));
        var c = this,
            f = this.opts[r];
        if (this.conf[r], !o && f.add) {
            var p = f.content ? f.content : '<a class="' + i.prev + '" href="#"></a><span class="' + i.title + '"></span><a class="' + i.next + '" href="#"></a>';
            e('<div class="' + i.header + '" />').prependTo(this.$menu).append(p)
        }
        var u = e("div." + i.header, this.$menu);
        if (u.length) {
            if (this.$menu.addClass(i.hasheader), f.update) {
                var v = u.find("." + i.title),
                    m = u.find("." + i.prev),
                    _ = u.find("." + i.next),
                    g = !1;
                d.$page && (g = "#" + d.$page.attr("id")), o || m.add(_).off(h.click).on(h.click, function(t) {
                    t.preventDefault(), t.stopPropagation();
                    var a = e(this).attr("href");
                    "#" !== a && (g && a == g ? c.$menu.trigger(h.close) : e(a, c.$menu).trigger(h.open))
                }), s.each(function() {
                    var t = e(this),
                        a = e("." + c.conf.classNames[r].panelHeader, t),
                        n = e("." + c.conf.classNames[r].panelPrev, t),
                        s = e("." + c.conf.classNames[r].panelNext, t),
                        o = a.html(),
                        d = n.attr("href"),
                        l = s.attr("href");
                    o || (o = e("." + i.subclose, t).html()), o || (o = f.title), d || (d = e("." + i.subclose, t).attr("href"));
                    var p = n.html(),
                        u = s.html(),
                        g = function() {
                            v[o ? "show" : "hide"](), v.html(o), m[d ? "attr" : "removeAttr"]("href", d), m[d || p ? "show" : "hide"](), m.html(p), _[l ? "attr" : "removeAttr"]("href", l), _[l || u ? "show" : "hide"](), _.html(u)
                        };
                    t.on(h.open, g), t.hasClass(i.current) && g()
                })
            }
            "function" == typeof this._init_buttonbars && this._init_buttonbars(u)
        }
    }, e[s].addons.push(r), e[s].defaults[r] = {
        add: !1,
        content: !1,
        title: "Menu",
        update: !1
    }, e[s].configuration.classNames[r] = {
        panelHeader: "Header",
        panelNext: "Next",
        panelPrev: "Prev"
    };
    var i, o, h, d, l = !1
}($j);
/*	
 * jQuery mmenu labels addon
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
! function(l) {
    function a(a) {
        return "boolean" == typeof a && (a = {
            collapse: a
        }), "object" != typeof a && (a = {}), a = l.extend(!0, {}, l[o].defaults[t], a)
    }

    function e(l) {
        return l
    }

    function s() {
        i = !0, n = l[o]._c, d = l[o]._d, c = l[o]._e, n.add("collapsed"), d.add("updatelabel"), p = l[o].glbl
    }
    var o = "mmenu",
        t = "labels";
    l[o].prototype["_init_" + t] = function(o) {
        i || s();
        var p = this.vars[t + "_added"];
        this.vars[t + "_added"] = !0, p || (this.opts[t] = a(this.opts[t]), this.conf[t] = e(this.conf[t]));
        var u = this.opts[t];
        this.conf[t], u.collapse && (this.__refactorClass(l("li", this.$menu), this.conf.classNames[t].collapsed, "collapsed"), l("." + n.label, o).each(function() {
            var a = l(this),
                e = a.nextUntil("." + n.label, "all" == u.collapse ? null : "." + n.collapsed);
            "all" == u.collapse && (a.addClass(n.opened), e.removeClass(n.collapsed)), e.length && (a.data(d.updatelabel) || (a.data(d.updatelabel, !0), a.wrapInner("<span />"), a.prepend('<a href="#" class="' + n.subopen + " " + n.fullsubopen + '" />')), a.find("a." + n.subopen).off(c.click).on(c.click, function(l) {
                l.preventDefault(), a.toggleClass(n.opened), e[a.hasClass(n.opened) ? "removeClass" : "addClass"](n.collapsed)
            }))
        }))
    }, l[o].addons.push(t), l[o].defaults[t] = {
        collapse: !1
    }, l[o].configuration.classNames[t] = {
        collapsed: "Collapsed"
    };
    var n, d, c, p, i = !1
}($j);
/*	
 * jQuery mmenu searchfield addon
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
! function(e) {
    function s(e) {
        switch (e) {
            case 9:
            case 16:
            case 17:
            case 18:
            case 37:
            case 38:
            case 39:
            case 40:
                return !0
        }
        return !1
    }

    function n(s) {
        return "boolean" == typeof s && (s = {
            add: s,
            search: s
        }), "object" != typeof s && (s = {}), s = e.extend(!0, {}, e[r].defaults[o], s), "boolean" != typeof s.showLinksOnly && (s.showLinksOnly = "menu" == s.addTo), s
    }

    function t(e) {
        return e
    }

    function a() {
        c = !0, i = e[r]._c, l = e[r]._d, d = e[r]._e, i.add("search hassearch noresultsmsg noresults nosubresults"), d.add("search reset change"), h = e[r].glbl
    }
    var r = "mmenu",
        o = "searchfield";
    e[r].prototype["_init_" + o] = function(r) {
        c || a();
        var h = this.vars[o + "_added"];
        this.vars[o + "_added"] = !0, h || (this.opts[o] = n(this.opts[o]), this.conf[o] = t(this.conf[o]));
        var u = this,
            f = this.opts[o];
        if (this.conf[o], f.add) {
            switch (f.addTo) {
                case "menu":
                    var p = this.$menu;
                    break;
                case "panels":
                    var p = r;
                    break;
                default:
                    var p = e(f.addTo, this.$menu).filter("." + i.panel)
            }
            p.length && p.each(function() {
                var s = e(this),
                    n = s.is("." + i.list) ? "li" : "div";
                if (!s.children(n + "." + i.search).length) {
                    if (s.is("." + i.menu)) var t = u.$menu,
                        a = "prependTo";
                    else var t = s.children().first(),
                        a = t.is("." + i.subtitle) ? "insertAfter" : "insertBefore";
                    e("<" + n + ' class="' + i.search + '" />').append('<input placeholder="' + f.placeholder + '" type="text" autocomplete="off" />')[a](t)
                }
                f.noResults && (s.is("." + i.menu) && (s = s.children("." + i.panel).first()), n = s.is("." + i.list) ? "li" : "div", s.children(n + "." + i.noresultsmsg).length || e("<" + n + ' class="' + i.noresultsmsg + '" />').html(f.noResults).appendTo(s))
            })
        }
        if (this.$menu.children("div." + i.search).length && this.$menu.addClass(i.hassearch), f.search) {
            var v = e("." + i.search, this.$menu);
            v.length && v.each(function() {
                var n = e(this);
                if ("menu" == f.addTo) var t = e("." + i.panel, u.$menu),
                    a = u.$menu;
                else var t = n.closest("." + i.panel),
                    a = t;
                var r = n.children("input"),
                    o = u.__findAddBack(t, "." + i.list).children("li"),
                    h = o.filter("." + i.label),
                    c = o.not("." + i.subtitle).not("." + i.label).not("." + i.search).not("." + i.noresultsmsg),
                    p = "> a";
                f.showLinksOnly || (p += ", > span"), r.off(d.keyup + " " + d.change).on(d.keyup, function(e) {
                    s(e.keyCode) || n.trigger(d.search)
                }).on(d.change, function() {
                    n.trigger(d.search)
                }), n.off(d.reset + " " + d.search).on(d.reset + " " + d.search, function(e) {
                    e.stopPropagation()
                }).on(d.reset, function() {
                    n.trigger(d.search, [""])
                }).on(d.search, function(s, n) {
                    "string" == typeof n ? r.val(n) : n = r.val(), n = n.toLowerCase(), t.scrollTop(0), c.add(h).addClass(i.hidden), c.each(function() {
                        var s = e(this);
                        e(p, s).text().toLowerCase().indexOf(n) > -1 && s.add(s.prevAll("." + i.label).first()).removeClass(i.hidden)
                    }), e(t.get().reverse()).each(function(s) {
                        var n = e(this),
                            t = n.data(l.parent);
                        if (t) {
                            var a = n.add(n.find("> ." + i.list)).find("> li").not("." + i.subtitle).not("." + i.search).not("." + i.noresultsmsg).not("." + i.label).not("." + i.hidden);
                            a.length ? t.removeClass(i.hidden).removeClass(i.nosubresults).prevAll("." + i.label).first().removeClass(i.hidden) : "menu" == f.addTo && (n.hasClass(i.opened) && setTimeout(function() {
                                t.trigger(d.open)
                            }, 1.5 * (s + 1) * u.conf.openingInterval), t.addClass(i.nosubresults))
                        }
                    }), a[c.not("." + i.hidden).length ? "removeClass" : "addClass"](i.noresults), u._update()
                })
            })
        }
    }, e[r].addons.push(o), e[r].defaults[o] = {
        add: !1,
        addTo: "menu",
        search: !1,
        placeholder: "Search",
        noResults: "No results found."
    };
    var i, l, d, h, c = !1
}($j);
/*	
 * jQuery mmenu toggles addon
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
! function(t) {
    function s(t) {
        return t
    }

    function e(t) {
        return t
    }

    function a() {
        r = !0, n = t[c]._c, o = t[c]._d, l = t[c]._e, n.add("toggle check"), h = t[c].glbl
    }
    var c = "mmenu",
        i = "toggles";
    t[c].prototype["_init_" + i] = function(c) {
        r || a();
        var o = this.vars[i + "_added"];
        this.vars[i + "_added"] = !0, o || (this.opts[i] = s(this.opts[i]), this.conf[i] = e(this.conf[i]));
        var l = this;
        this.opts[i], this.conf[i], this.__refactorClass(t("input", c), this.conf.classNames[i].toggle, "toggle"), this.__refactorClass(t("input", c), this.conf.classNames[i].check, "check"), t("input." + n.toggle, c).add("input." + n.check, c).each(function() {
            var s = t(this),
                e = s.closest("li"),
                a = s.hasClass(n.toggle) ? "toggle" : "check",
                c = s.attr("id") || l.__getUniqueId();
            e.children('label[for="' + c + '"]').length || (s.attr("id", c), e.prepend(s), t('<label for="' + c + '" class="' + n[a] + '"></label>').insertBefore(e.children("a, span").last()))
        })
    }, t[c].addons.push(i), t[c].defaults[i] = {}, t[c].configuration.classNames[i] = {
        toggle: "Toggle",
        check: "Check"
    };
    var n, o, l, h, r = !1
}($j);

$j(document).ready(function() {
    //alert($j("#toplinks").html());
    var foooterContent = $j("#menu-links").html();
    $j("#menu-links").html('');

    if (window.location.href.indexOf("arabic") > -1) {

        if ($j("#scWebEditRibbon").length > 0) {
            $j("#mob-menu-wrap").mmenu({
                offCanvas: {
                    position: "left"
                },
                footer: {
                    add: true,
                    title: ""
                }
            }, {
                offCanvas: {
                    pageSelector: "#MainWrapper",
                    position: "left",
                    menuWrapperSelector: '#MainForm'
                }
            });
        } else {
            $j("#mob-menu-wrap").mmenu({
                offCanvas: {
                    position: "left"
                },
                footer: {
                    add: true,
                    title: "<div class='bottonContet'>" + foooterContent + "</div>"
                }
            }, {
                offCanvas: {
                    pageSelector: "#MainWrapper",
                    position: "left",
                    menuWrapperSelector: '#MainForm'
                }
            });
        }
    } else {
        if ($j("#scWebEditRibbon").length > 0) {
            $j("#mob-menu-wrap").mmenu({
                offCanvas: {
                    position: "right"
                },
                footer: {
                    add: true,
                    title: ""
                }
            }, {
                offCanvas: {
                    pageSelector: "#MainWrapper",
                    position: "right",
                    menuWrapperSelector: '#MainForm'
                }
            });
        } else {
            $j("#mob-menu-wrap").mmenu({
                offCanvas: {
                    position: "right"
                },
                footer: {
                    add: true,
                    title: "<div class='bottonContet'>" + foooterContent + "</div>"
                }
            }, {
                offCanvas: {
                    pageSelector: "#MainWrapper",
                    position: "right",
                    menuWrapperSelector: '#MainForm'
                }
            });
        }
    }


    //$j(".mm-footer").html(foooterContent);

    $j(".mob-menu").click(function() {

        /* Filter Functionality */

        $j('#mobfilter .insights-filter-wrap span.filter-close').hide();
        $j('.filter-click').slideUp('500', function() {
            $j('.filter-mobi-panel-text').hide();
            $j('.insights-filter-wrap .filter-ttl-mobi').removeClass('active');
            $j('.insights-filter-wrap .filter-ttl-mobi').show();
            $j('body').removeClass('insights-mobi-filter-active');
            $j('.insights-filter-main').css('height', 'auto');
        });

        $j('#mobfilter .insights-filter-wrap span.filter-back').hide();
        $j('.filter-mobi-panel-text').text('Filter');
        $j('.filter-click li').slideUp();
        $j('.filter-click li').removeClass('active');
        $j('.insights-filter-inner').find('.filter-tab-content').removeClass('active');

        $j('.insights-filter-inner-total').slideUp();
        $j('.open-mobi-selected-tags').removeClass('active');
        /* Filter Functionality */

        /* Added b'coz mmenu seems offset after open */
        $j('html,body').animate({
            scrollTop: 0
        }, 'slow');
        /* Added b'coz mmenu seems offset after open */

        var maxHeight;
        var open_page_parent = $j('#mob-menu-wrap li.current:last').parent().find('.mm-subtitle>a').attr('href');
        var selected = false;

        if (open_page_parent == undefined) {
            open_page_parent = $j('#mob-menu-wrap li.selected:last').parent().find('.mm-subtitle>a').attr('href');
            selected = true;
        }

        if ($j('#mob-menu-wrap li.current:last').parent().attr('id') != 'mm-0' && open_page_parent) {
            //$j(open_page_parent).find('li.selected a.mm-subopen').click();
            $j(".mm-list").removeClass("mm-opened mm-subopened");
            $j(".mm-list.mm-current").addClass("mm-hidden");
            $j(".mm-list.mm-current").removeClass("mm-highest mm-current mm-opened");
            $j('#mm-0').removeClass("mm-current");
            if (selected) {
                $j('#mob-menu-wrap li.selected:last').parent().removeClass('mm-hidden').addClass('mm-highest mm-current mm-opened');
                openMenu($j('#mob-menu-wrap li.selected:last').parent());
                maxHeight = $j('#mob-menu-wrap li.selected:last').parent().height() + 525;

            } else {
                $j('#mob-menu-wrap li.current:last').parent().removeClass('mm-hidden').addClass('mm-highest mm-current mm-opened');
                openMenu($j('#mob-menu-wrap li.current:last').parent());
                maxHeight = $j('#mob-menu-wrap li.current:last').parent().height() + 525;
            }

            $j(open_page_parent).removeClass("mm-hidden");
        } else {
            maxHeight = $j('#mm-0').height() + 525;
        }

        //maxHeight =  maxHeight > viewport().height? maxHeight : viewport().height;
        $j(".mm-menu,.mm-page").height(maxHeight);

        //var open_page = $j('#mob-menu-wrap li.current:last').parent().find('.mmenu-section-head').html();

    });

    var noOfUl = $j(".mm-subclose").length;

    $j(".mm-subclose").each(function(i) {
        var currentText = $j(this).html();
        $j(this).html("Back");
        $j(this).parent().after("<li class='mmenu-section-head'>" + currentText + "</li>");
    });

    $j(".mm-subopen,.mm-subclose").click(function() {

        var thisSelec = $j(this);
        var selector = $j(this).attr("href");
        var maxHeight = $j(selector).height() + 525;

        //maxHeight =  maxHeight > viewport().height? maxHeight : viewport().height;
        $j(".mm-menu,.mm-page").height(maxHeight);
    });

});



function openMenu(parentSelector) {
    var prevParent = $j(parentSelector).find(".mm-subtitle>a").attr("href");
    $j(prevParent).addClass("mm-opened mm-subopened mm-hidden");

    if (prevParent == "#mm-0") {
        return;
    } else {
        openMenu(prevParent);
    }
}

function getMaxHeight(arr) {
    var x = new Array([]);
    $j(arr).each(function(i) {
        x[i] = parseInt($j(this).children("li").length) * 42;
    });
    Max_Value = Array.max(x);

    return Max_Value;
}


/*!---- flickr-----*/
//$j = jQuery.noConflict();
//prot = location.protocol;


prot = "https:";

(function($j) {
    $j.fn.flickr = function(o) {
        var s = {
            api_key: null,
            type: null,
            photoset_id: null,
            text: null,
            user_id: null,
            group_id: null,
            tags: null,
            tag_mode: 'any',
            sort: 'relevance',
            thumb_size: 's',
            size: null,
            per_page: 100,
            page: 1,
            attr: '',
            api_url: null,
            params: '',
            href: '#',
            layout: 'table',
            api_callback: '?',
            callback: null
        };
        if (o) $j.extend(s, o);
        return this.each(function() {
            if (s.layout == "ul") {
                var list = $j('<ul id="images-carousel" class="jcarousel jcarousel-skin-rotator">').appendTo(this);
                //var listdesc = $j('<ul id="images-carousel-shortdesc" style="display:none;">').appendTo(this);
                var url = $j.flickr.format(s);
                $j.getJSON(url, function(r) {
                    //alert(r.stat);	

                    if (r.stat != "ok") {
                        for (i in r) {
                            $j('<li>').text(i + ': ' + r[i]).appendTo(list);
                        };
                    } else {
                        if (s.type == 'photoset') r.photos = r.photoset;

                        //list.append("<p>Showing " + s.per_page + " of " + r.photos.total + " photos in the pool.</p>");
                        for (var i = 0; i < r.photos.photo.length; i++) {
                            var photo = r.photos.photo[i];

                            var th = prot + '//farm' + photo['farm'] + '.static.flickr.com/' + photo['server'] + '/' + photo['id'] + '_' + photo['secret'] + '_s.jpg';
                            var preview = prot + '//farm' + photo['farm'] + '.static.flickr.com/' + photo['server'] + '/' + photo['id'] + '_' + photo['secret'] + '.jpg';
                            var t = prot + '//farm' + photo['farm'] + '.static.flickr.com/' + photo['server'] + '/' + photo['id'] + '_' + photo['secret'] + '_' + s.thumb_size + '.jpg';
                            var h = prot + '//farm' + photo['farm'] + '.static.flickr.com/' + photo['server'] + '/' + photo['id'] + '_';
                            switch (s.size) {
                                case 'm':
                                    h += photo['secret'] + '_m.jpg';
                                    break;
                                case 'b':
                                    h += photo['secret'] + '_b.jpg';
                                    break;
                                case 'o':
                                    if (photo['originalsecret'] && photo['originalformat']) {
                                        h += photo['originalsecret'] + '_o.' + photo['originalformat'];
                                    } else {
                                        h += photo['secret'] + '_b.jpg';
                                    };
                                    break;
                                default:
                                    h += photo['secret'] + '.jpg';
                            };
                            //list.append('<li><a href="javascript:void(0);"  onclick="disp_image('+preview+')" data-photoid="photoid_'+photo['id']+'" title="'+photo['title']+'" ><img src="'+th+'" alt="'+photo['title']+'" width="144" height="84" /></a></li>');
                            list.append('<li><a data-photoid="photoid_' + photo['id'] + '" title="' + photo['title'] + '" href="' + preview + '"><img src="' + th + '" alt="' + photo['title'] + '" /></a></li>');

                            if (location.protocol == "https:") {
                                photourl = "https://www.flickr.com/services/rest/?method=flickr.photos.getInfo&api_key=" + s.api_key + "&photo_id=" + photo['id'] + "&secret=" + photo['secret'] + "&format=json&jsoncallback=?";
                            } else {
                                photourl = "https://api.flickr.com/services/rest/?method=flickr.photos.getInfo&api_key=" + s.api_key + "&photo_id=" + photo['id'] + "&secret=" + photo['secret'] + "&format=json&jsoncallback=?";
                            }

                            $j.getJSON(photourl,
                                function(data) {
                                    //alert(data);  
                                    // listdesc.append('<li data-photoid="photoid_'+data.photo.id+'"><p>'+data.photo.description._content+'</p></li>');


                                });
                        }



                        if (s.callback) s.callback(list);
                    };
                });
            }
        });
    };
    $j.flickr = {
        format: function(s) {
            if (s.url) return s.url;
            if (location.protocol == "https:") {
                var url = '//www.flickr.com/services/rest/?format=json&jsoncallback=' + s.api_callback + '&api_key=' + s.api_key;
            } else {
                var url = 'https://api.flickr.com/services/rest/?format=json&jsoncallback=' + s.api_callback + '&api_key=' + s.api_key;
            }


            switch (s.type) {
                case 'photoset':
                    url += '&method=flickr.photosets.getPhotos&photoset_id=' + s.photoset_id;
                    break;
                case 'search':
                    url += '&method=flickr.photos.search&sort=' + s.sort;
                    if (s.user_id) url += '&user_id=' + s.user_id;
                    if (s.group_id) url += '&group_id=' + s.group_id;
                    if (s.tags) url += '&tags=' + s.tags;
                    if (s.tag_mode) url += '&tag_mode=' + s.tag_mode;
                    if (s.text) url += '&text=' + s.text;
                    break;
                default:
                    url += '&method=flickr.photos.getRecent';
            };
            if (s.size == 'o') url += '&extras=original_format';
            url += '&per_page=' + s.per_page + '&page=' + s.page + s.params;
            //alert(url);
            return url;
        }
    };
})(jQuery);
/*!---- color-box-----*/
/*!
	Colorbox v1.5.4 - 2014-03-07
	jQuery lightbox and modal window plugin
	(c) 2014 Jack Moore - http://www.jacklmoore.com/colorbox
	license: http://www.opensource.org/licenses/mit-license.php
*/
(function($j, document, window) {
    var
        // Default settings object.
        // See http://jacklmoore.com/colorbox for details.
        defaults = {
            // data sources
            html: false,
            photo: false,
            iframe: false,
            inline: false,

            // behavior and appearance
            transition: "elastic",
            speed: 300,
            fadeOut: 300,
            width: false,
            initialWidth: "600",
            innerWidth: false,
            maxWidth: false,
            height: false,
            initialHeight: "450",
            innerHeight: false,
            maxHeight: false,
            scalePhotos: true,
            scrolling: true,
            opacity: 0.9,
            preloading: true,
            className: false,
            overlayClose: true,
            escKey: true,
            arrowKey: true,
            top: false,
            bottom: false,
            left: false,
            right: false,
            fixed: false,
            data: undefined,
            closeButton: true,
            fastIframe: true,
            open: false,
            reposition: true,
            loop: true,
            slideshow: false,
            slideshowAuto: true,
            slideshowSpeed: 2500,
            slideshowStart: "start slideshow",
            slideshowStop: "stop slideshow",
            photoRegex: /\.(gif|png|jp(e|g|eg)|bmp|ico|webp|jxr|svg)((#|\?).*)?$/i,

            // alternate image paths for high-res displays
            retinaImage: false,
            retinaUrl: false,
            retinaSuffix: '@2x.$1',

            // internationalization
            current: "image {current} of {total}",
            previous: "previous",
            next: "next",
            close: "close",
            xhrError: "This content failed to load.",
            imgError: "This image failed to load.",

            // accessbility
            returnFocus: true,
            trapFocus: true,

            // callbacks
            onOpen: false,
            onLoad: false,
            onComplete: false,
            onCleanup: false,
            onClosed: false,

            rel: function() {
                return this.rel;
            },
            href: function() {
                // Using .attr() so that the href can also be used to provide a selector for inline content
                return $j(this).attr('href');
            },
            title: function() {
                return this.title;
            }
        },


        // Abstracting the HTML and event identifiers for easy rebranding
        colorbox = 'colorbox',
        prefix = 'cbox',
        boxElement = prefix + 'Element',

        // Events
        event_open = prefix + '_open',
        event_load = prefix + '_load',
        event_complete = prefix + '_complete',
        event_cleanup = prefix + '_cleanup',
        event_closed = prefix + '_closed',
        event_purge = prefix + '_purge',

        // Cached jQuery Object Variables
        $overlay,
        $box,
        $wrap,
        $content,
        $topBorder,
        $leftBorder,
        $rightBorder,
        $bottomBorder,
        $related,
        $window,
        $loaded,
        $loadingBay,
        $loadingOverlay,
        $title,
        $current,
        $slideshow,
        $next,
        $prev,
        $close,
        $groupControls,
        $events = $j('<a/>'), // $j({}) would be prefered, but there is an issue with jQuery 1.4.2

        // Variables for cached values or use across multiple functions
        settings,
        interfaceHeight,
        interfaceWidth,
        loadedHeight,
        loadedWidth,
        index,
        photo,
        open,
        active,
        closing,
        loadingTimer,
        publicMethod,
        div = "div",
        requests = 0,
        previousCSS = {},
        init;

    // ****************
    // HELPER FUNCTIONS
    // ****************

    // Convenience function for creating new jQuery objects
    function $tag(tag, id, css) {
        var element = document.createElement(tag);

        if (id) {
            element.id = prefix + id;
        }

        if (css) {
            element.style.cssText = css;
        }

        return $j(element);
    }

    // Get the window height using innerHeight when available to avoid an issue with iOS
    // http://bugs.jquery.com/ticket/6724
    function winheight() {
        return window.innerHeight ? window.innerHeight : $j(window).height();
    }

    function Settings(element, options) {
        if (options !== Object(options)) {
            options = {};
        }

        this.cache = {};
        this.el = element;

        this.value = function(key) {
            var dataAttr;

            if (this.cache[key] === undefined) {
                dataAttr = $j(this.el).attr('data-cbox-' + key);

                if (dataAttr !== undefined) {
                    this.cache[key] = dataAttr;
                } else if (options[key] !== undefined) {
                    this.cache[key] = options[key];
                } else if (defaults[key] !== undefined) {
                    this.cache[key] = defaults[key];
                }
            }

            return this.cache[key];
        };

        this.get = function(key) {
            var value = this.value(key);
            return $j.isFunction(value) ? value.call(this.el, this) : value;
        };
    }

    // Determine the next and previous members in a group.
    function getIndex(increment) {
        var
            max = $related.length,
            newIndex = (index + increment) % max;

        return (newIndex < 0) ? max + newIndex : newIndex;
    }

    // Convert '%' and 'px' values to integers
    function setSize(size, dimension) {
        return Math.round((/%/.test(size) ? ((dimension === 'x' ? $window.width() : winheight()) / 100) : 1) * parseInt(size, 10));
    }

    // Checks an href to see if it is a photo.
    // There is a force photo option (photo: true) for hrefs that cannot be matched by the regex.
    function isImage(settings, url) {
        return settings.get('photo') || settings.get('photoRegex').test(url);
    }

    function retinaUrl(settings, url) {
        return settings.get('retinaUrl') && window.devicePixelRatio > 1 ? url.replace(settings.get('photoRegex'), settings.get('retinaSuffix')) : url;
    }

    function trapFocus(e) {
        if ('contains' in $box[0] && !$box[0].contains(e.target) && e.target !== $overlay[0]) {
            e.stopPropagation();
            $box.focus();
        }
    }

    function setClass(str) {
        if (setClass.str !== str) {
            $box.add($overlay).removeClass(setClass.str).addClass(str);
            setClass.str = str;
        }
    }

    function getRelated() {
        index = 0;

        if (rel && rel !== 'nofollow') {
            $related = $j('.' + boxElement).filter(function() {
                var options = $j.data(this, colorbox);
                var settings = new Settings(this, options);
                return (settings.get('rel') === rel);
            });
            index = $related.index(settings.el);

            // Check direct calls to Colorbox.
            if (index === -1) {
                $related = $related.add(settings.el);
                index = $related.length - 1;
            }
        } else {
            $related = $j(settings.el);
        }
    }

    function trigger(event) {
        // for external use
        $j(document).trigger(event);
        // for internal use
        $events.triggerHandler(event);
    }

    var slideshow = (function() {
        var active,
            className = prefix + "Slideshow_",
            click = "click." + prefix,
            timeOut;

        function clear() {
            clearTimeout(timeOut);
        }

        function set() {
            if (settings.get('loop') || $related[index + 1]) {
                clear();
                timeOut = setTimeout(publicMethod.next, settings.get('slideshowSpeed'));
            }
        }

        function start() {
            $slideshow
                .html(settings.get('slideshowStop'))
                .unbind(click)
                .one(click, stop);

            $events
                .bind(event_complete, set)
                .bind(event_load, clear);

            $box.removeClass(className + "off").addClass(className + "on");
        }

        function stop() {
            clear();

            $events
                .unbind(event_complete, set)
                .unbind(event_load, clear);

            $slideshow
                .html(settings.get('slideshowStart'))
                .unbind(click)
                .one(click, function() {
                    publicMethod.next();
                    start();
                });

            $box.removeClass(className + "on").addClass(className + "off");
        }

        function reset() {
            active = false;
            $slideshow.hide();
            clear();
            $events
                .unbind(event_complete, set)
                .unbind(event_load, clear);
            $box.removeClass(className + "off " + className + "on");
        }

        return function() {
            if (active) {
                if (!settings.get('slideshow')) {
                    $events.unbind(event_cleanup, reset);
                    reset();
                }
            } else {
                if (settings.get('slideshow') && $related[1]) {
                    active = true;
                    $events.one(event_cleanup, reset);
                    if (settings.get('slideshowAuto')) {
                        start();
                    } else {
                        stop();
                    }
                    $slideshow.show();
                }
            }
        };

    }());


    function launch(element) {
        var options;

        if (!closing) {

            options = $j(element).data('colorbox');

            settings = new Settings(element, options);

            rel = settings.get('rel');

            getRelated();

            if (!open) {
                open = active = true; // Prevents the page-change action from queuing up if the visitor holds down the left or right keys.

                setClass(settings.get('className'));

                // Show colorbox so the sizes can be calculated in older versions of jQuery
                $box.css({
                    visibility: 'hidden',
                    display: 'block'
                });

                $loaded = $tag(div, 'LoadedContent', 'width:0; height:0; overflow:hidden; visibility:hidden');
                $content.css({
                    width: '',
                    height: ''
                }).append($loaded);

                // Cache values needed for size calculations
                interfaceHeight = $topBorder.height() + $bottomBorder.height() + $content.outerHeight(true) - $content.height();
                interfaceWidth = $leftBorder.width() + $rightBorder.width() + $content.outerWidth(true) - $content.width();
                loadedHeight = $loaded.outerHeight(true);
                loadedWidth = $loaded.outerWidth(true);

                // Opens inital empty Colorbox prior to content being loaded.
                settings.w = setSize(settings.get('initialWidth'), 'x');
                settings.h = setSize(settings.get('initialHeight'), 'y');
                $loaded.css({
                    width: '',
                    height: settings.h
                });
                publicMethod.position();

                trigger(event_open);
                settings.get('onOpen');

                $groupControls.add($title).hide();

                $box.focus();

                if (settings.get('trapFocus')) {
                    // Confine focus to the modal
                    // Uses event capturing that is not supported in IE8-
                    if (document.addEventListener) {

                        document.addEventListener('focus', trapFocus, true);

                        $events.one(event_closed, function() {
                            document.removeEventListener('focus', trapFocus, true);
                        });
                    }
                }

                // Return focus on closing
                if (settings.get('returnFocus')) {
                    $events.one(event_closed, function() {
                        $j(settings.el).focus();
                    });
                }
            }

            $overlay.css({
                opacity: parseFloat(settings.get('opacity')),
                cursor: settings.get('overlayClose') ? "pointer" : "auto",
                visibility: 'visible'
            }).show();

            if (settings.get('closeButton')) {
                $close.html(settings.get('close')).appendTo($content);
            } else {
                $close.appendTo('<div/>'); // replace with .detach() when dropping jQuery < 1.4
            }

            load();
        }
    }

    // Colorbox's markup needs to be added to the DOM prior to being called
    // so that the browser will go ahead and load the CSS background images.
    function appendHTML() {
        if (!$box && document.body) {
            init = false;
            $window = $j(window);
            $box = $tag(div).attr({
                id: colorbox,
                'class': $j.support.opacity === false ? prefix + 'IE' : '', // class for optional IE8 & lower targeted CSS.
                role: 'dialog',
                tabindex: '-1'
            }).hide();
            $overlay = $tag(div, "Overlay").hide();
            $loadingOverlay = $j([$tag(div, "LoadingOverlay")[0], $tag(div, "LoadingGraphic")[0]]);
            $wrap = $tag(div, "Wrapper");
            $content = $tag(div, "Content").append(
                $title = $tag(div, "Title"),
                $current = $tag(div, "Current"),
                $prev = $j('<button type="button"/>').attr({
                    id: prefix + 'Previous'
                }),
                $next = $j('<button type="button"/>').attr({
                    id: prefix + 'Next'
                }),
                $slideshow = $tag('button', "Slideshow"),
                $loadingOverlay
            );

            $close = $j('<button type="button"/>').attr({
                id: prefix + 'Close'
            });

            $wrap.append( // The 3x3 Grid that makes up Colorbox
                $tag(div).append(
                    $tag(div, "TopLeft"),
                    $topBorder = $tag(div, "TopCenter"),
                    $tag(div, "TopRight")
                ),
                $tag(div, false, 'clear:left').append(
                    $leftBorder = $tag(div, "MiddleLeft"),
                    $content,
                    $rightBorder = $tag(div, "MiddleRight")
                ),
                $tag(div, false, 'clear:left').append(
                    $tag(div, "BottomLeft"),
                    $bottomBorder = $tag(div, "BottomCenter"),
                    $tag(div, "BottomRight")
                )
            ).find('div div').css({
                'float': 'left'
            });

            $loadingBay = $tag(div, false, 'position:absolute; width:9999px; visibility:hidden; display:none; max-width:none;');

            $groupControls = $next.add($prev).add($current).add($slideshow);

            $j(document.body).append($overlay, $box.append($wrap, $loadingBay));
        }
    }

    // Add Colorbox's event bindings
    function addBindings() {
        function clickHandler(e) {
            // ignore non-left-mouse-clicks and clicks modified with ctrl / command, shift, or alt.
            // See: http://jacklmoore.com/notes/click-events/
            if (!(e.which > 1 || e.shiftKey || e.altKey || e.metaKey || e.ctrlKey)) {
                e.preventDefault();
                launch(this);
            }
        }

        if ($box) {
            if (!init) {
                init = true;

                // Anonymous functions here keep the public method from being cached, thereby allowing them to be redefined on the fly.
                $next.click(function() {
                    publicMethod.next();
                });
                $prev.click(function() {
                    publicMethod.prev();
                });
                $close.click(function() {
                    publicMethod.close();
                });
                $overlay.click(function() {
                    if (settings.get('overlayClose')) {
                        publicMethod.close();
                    }
                });

                // Key Bindings
                $j(document).bind('keydown.' + prefix, function(e) {
                    var key = e.keyCode;
                    if (open && settings.get('escKey') && key === 27) {
                        e.preventDefault();
                        publicMethod.close();
                    }
                    if (open && settings.get('arrowKey') && $related[1] && !e.altKey) {
                        if (key === 37) {
                            e.preventDefault();
                            $prev.click();
                        } else if (key === 39) {
                            e.preventDefault();
                            $next.click();
                        }
                    }
                });

                if ($j.isFunction($j.fn.on)) {
                    // For jQuery 1.7+
                    $j(document).on('click.' + prefix, '.' + boxElement, clickHandler);
                } else {
                    // For jQuery 1.3.x -> 1.6.x
                    // This code is never reached in jQuery 1.9, so do not contact me about 'live' being removed.
                    // This is not here for jQuery 1.9, it's here for legacy users.
                    $j('.' + boxElement).live('click.' + prefix, clickHandler);
                }
            }
            return true;
        }
        return false;
    }

    // Don't do anything if Colorbox already exists.
    if ($j.colorbox) {
        return;
    }

    // Append the HTML when the DOM loads
    $j(appendHTML);


    // ****************
    // PUBLIC FUNCTIONS
    // Usage format: $j.colorbox.close();
    // Usage from within an iframe: parent.jQuery.colorbox.close();
    // ****************

    publicMethod = $j.fn[colorbox] = $j[colorbox] = function(options, callback) {
        var settings;
        var $obj = this;

        options = options || {};

        if ($j.isFunction($obj)) { // assume a call to $j.colorbox
            $obj = $j('<a/>');
            options.open = true;
        } else if (!$obj[0]) { // colorbox being applied to empty collection
            return $obj;
        }


        if (!$obj[0]) { // colorbox being applied to empty collection
            return $obj;
        }

        appendHTML();

        if (addBindings()) {

            if (callback) {
                options.onComplete = callback;
            }

            $obj.each(function() {
                var old = $j.data(this, colorbox) || {};
                $j.data(this, colorbox, $j.extend(old, options));
            }).addClass(boxElement);

            settings = new Settings($obj[0], options);

            if (settings.get('open')) {
                launch($obj[0]);
            }
        }

        return $obj;
    };

    publicMethod.position = function(speed, loadedCallback) {
        var
            css,
            top = 0,
            left = 0,
            offset = $box.offset(),
            scrollTop,
            scrollLeft;

        $window.unbind('resize.' + prefix);

        // remove the modal so that it doesn't influence the document width/height
        $box.css({
            top: -9e4,
            left: -9e4
        });

        scrollTop = $window.scrollTop();
        scrollLeft = $window.scrollLeft();

        if (settings.get('fixed')) {
            offset.top -= scrollTop;
            offset.left -= scrollLeft;
            $box.css({
                position: 'fixed'
            });
        } else {
            top = scrollTop;
            left = scrollLeft;
            $box.css({
                position: 'absolute'
            });
        }

        // keeps the top and left positions within the browser's viewport.
        if (settings.get('right') !== false) {
            left += Math.max($window.width() - settings.w - loadedWidth - interfaceWidth - setSize(settings.get('right'), 'x'), 0);
        } else if (settings.get('left') !== false) {
            left += setSize(settings.get('left'), 'x');
        } else {
            left += Math.round(Math.max($window.width() - settings.w - loadedWidth - interfaceWidth, 0) / 2);
        }

        if (settings.get('bottom') !== false) {
            top += Math.max(winheight() - settings.h - loadedHeight - interfaceHeight - setSize(settings.get('bottom'), 'y'), 0);
        } else if (settings.get('top') !== false) {
            top += setSize(settings.get('top'), 'y');
        } else {
            top += Math.round(Math.max(winheight() - settings.h - loadedHeight - interfaceHeight, 0) / 2);
        }

        $box.css({
            top: offset.top,
            left: offset.left,
            visibility: 'visible'
        });

        // this gives the wrapper plenty of breathing room so it's floated contents can move around smoothly,
        // but it has to be shrank down around the size of div#colorbox when it's done.  If not,
        // it can invoke an obscure IE bug when using iframes.
        $wrap[0].style.width = $wrap[0].style.height = "9999px";

        function modalDimensions() {
            $topBorder[0].style.width = $bottomBorder[0].style.width = $content[0].style.width = (parseInt($box[0].style.width, 10) - interfaceWidth) + 'px';
            $content[0].style.height = $leftBorder[0].style.height = $rightBorder[0].style.height = (parseInt($box[0].style.height, 10) - interfaceHeight) + 'px';
        }

        css = {
            width: settings.w + loadedWidth + interfaceWidth,
            height: settings.h + loadedHeight + interfaceHeight,
            top: top,
            left: left
        };

        // setting the speed to 0 if the content hasn't changed size or position
        if (speed) {
            var tempSpeed = 0;
            $j.each(css, function(i) {
                if (css[i] !== previousCSS[i]) {
                    tempSpeed = speed;
                    return;
                }
            });
            speed = tempSpeed;
        }

        previousCSS = css;

        if (!speed) {
            $box.css(css);
        }

        $box.dequeue().animate(css, {
            duration: speed || 0,
            complete: function() {
                modalDimensions();

                active = false;

                // shrink the wrapper down to exactly the size of colorbox to avoid a bug in IE's iframe implementation.
                $wrap[0].style.width = (settings.w + loadedWidth + interfaceWidth) + "px";
                $wrap[0].style.height = (settings.h + loadedHeight + interfaceHeight) + "px";

                if (settings.get('reposition')) {
                    setTimeout(function() { // small delay before binding onresize due to an IE8 bug.
                        $window.bind('resize.' + prefix, publicMethod.position);
                    }, 1);
                }

                if (loadedCallback) {
                    loadedCallback();
                }
            },
            step: modalDimensions
        });
    };

    publicMethod.resize = function(options) {
        var scrolltop;

        if (open) {
            options = options || {};

            if (options.width) {
                settings.w = setSize(options.width, 'x') - loadedWidth - interfaceWidth;
            }

            if (options.innerWidth) {
                settings.w = setSize(options.innerWidth, 'x');
            }

            $loaded.css({
                width: settings.w
            });

            if (options.height) {
                settings.h = setSize(options.height, 'y') - loadedHeight - interfaceHeight;
            }

            if (options.innerHeight) {
                settings.h = setSize(options.innerHeight, 'y');
            }

            if (!options.innerHeight && !options.height) {
                scrolltop = $loaded.scrollTop();
                $loaded.css({
                    height: "auto"
                });
                settings.h = $loaded.height();
            }

            $loaded.css({
                height: settings.h
            });

            if (scrolltop) {
                $loaded.scrollTop(scrolltop);
            }

            publicMethod.position(settings.get('transition') === "none" ? 0 : settings.get('speed'));
        }
    };

    publicMethod.prep = function(object) {
        if (!open) {
            return;
        }

        var callback, speed = settings.get('transition') === "none" ? 0 : settings.get('speed');

        $loaded.remove();

        $loaded = $tag(div, 'LoadedContent').append(object);

        function getWidth() {
            settings.w = settings.w || $loaded.width();
            settings.w = settings.mw && settings.mw < settings.w ? settings.mw : settings.w;
            return settings.w;
        }

        function getHeight() {
            settings.h = settings.h || $loaded.height();
            settings.h = settings.mh && settings.mh < settings.h ? settings.mh : settings.h;
            return settings.h;
        }

        $loaded.hide()
            .appendTo($loadingBay.show()) // content has to be appended to the DOM for accurate size calculations.
            .css({
                width: getWidth(),
                overflow: settings.get('scrolling') ? 'auto' : 'hidden'
            })
            .css({
                height: getHeight()
            }) // sets the height independently from the width in case the new width influences the value of height.
            .prependTo($content);

        $loadingBay.hide();

        // floating the IMG removes the bottom line-height and fixed a problem where IE miscalculates the width of the parent element as 100% of the document width.

        $j(photo).css({
            'float': 'none'
        });

        setClass(settings.get('className'));

        callback = function() {
            var total = $related.length,
                iframe,
                complete;

            if (!open) {
                return;
            }

            function removeFilter() { // Needed for IE8 in versions of jQuery prior to 1.7.2
                if ($j.support.opacity === false) {
                    $box[0].style.removeAttribute('filter');
                }
            }

            complete = function() {
                clearTimeout(loadingTimer);
                $loadingOverlay.hide();
                trigger(event_complete);
                settings.get('onComplete');
            };


            $title.html(settings.get('title')).show();
            $loaded.show();

            if (total > 1) { // handle grouping
                if (typeof settings.get('current') === "string") {
                    $current.html(settings.get('current').replace('{current}', index + 1).replace('{total}', total)).show();
                }

                $next[(settings.get('loop') || index < total - 1) ? "show" : "hide"]().html(settings.get('next'));
                $prev[(settings.get('loop') || index) ? "show" : "hide"]().html(settings.get('previous'));

                slideshow();

                // Preloads images within a rel group
                if (settings.get('preloading')) {
                    $j.each([getIndex(-1), getIndex(1)], function() {
                        var img,
                            i = $related[this],
                            settings = new Settings(i, $j.data(i, colorbox)),
                            src = settings.get('href');

                        if (src && isImage(settings, src)) {
                            src = retinaUrl(settings, src);
                            img = document.createElement('img');
                            img.src = src;
                        }
                    });
                }
            } else {
                $groupControls.hide();
            }

            if (settings.get('iframe')) {
                iframe = document.createElement('iframe');

                if ('frameBorder' in iframe) {
                    iframe.frameBorder = 0;
                }

                if ('allowTransparency' in iframe) {
                    iframe.allowTransparency = "true";
                }

                if (!settings.get('scrolling')) {
                    iframe.scrolling = "no";
                }

                $j(iframe)
                    .attr({
                        src: settings.get('href'),
                        name: (new Date()).getTime(), // give the iframe a unique name to prevent caching
                        'class': prefix + 'Iframe',
                        allowFullScreen: true // allow HTML5 video to go fullscreen
                    })
                    .one('load', complete)
                    .appendTo($loaded);

                $events.one(event_purge, function() {
                    iframe.src = "//about:blank";
                });

                if (settings.get('fastIframe')) {
                    $j(iframe).trigger('load');
                }
            } else {
                complete();
            }

            if (settings.get('transition') === 'fade') {
                $box.fadeTo(speed, 1, removeFilter);
            } else {
                removeFilter();
            }
        };

        if (settings.get('transition') === 'fade') {
            $box.fadeTo(speed, 0, function() {
                publicMethod.position(0, callback);
            });
        } else {
            publicMethod.position(speed, callback);
        }
    };

    function load() {
        var href, setResize, prep = publicMethod.prep,
            $inline, request = ++requests;

        active = true;

        photo = false;

        trigger(event_purge);
        trigger(event_load);
        settings.get('onLoad');

        settings.h = settings.get('height') ?
            setSize(settings.get('height'), 'y') - loadedHeight - interfaceHeight :
            settings.get('innerHeight') && setSize(settings.get('innerHeight'), 'y');

        settings.w = settings.get('width') ?
            setSize(settings.get('width'), 'x') - loadedWidth - interfaceWidth :
            settings.get('innerWidth') && setSize(settings.get('innerWidth'), 'x');

        // Sets the minimum dimensions for use in image scaling
        settings.mw = settings.w;
        settings.mh = settings.h;

        // Re-evaluate the minimum width and height based on maxWidth and maxHeight values.
        // If the width or height exceed the maxWidth or maxHeight, use the maximum values instead.
        if (settings.get('maxWidth')) {
            settings.mw = setSize(settings.get('maxWidth'), 'x') - loadedWidth - interfaceWidth;
            settings.mw = settings.w && settings.w < settings.mw ? settings.w : settings.mw;
        }
        if (settings.get('maxHeight')) {
            settings.mh = setSize(settings.get('maxHeight'), 'y') - loadedHeight - interfaceHeight;
            settings.mh = settings.h && settings.h < settings.mh ? settings.h : settings.mh;
        }

        href = settings.get('href');

        loadingTimer = setTimeout(function() {
            $loadingOverlay.show();
        }, 100);

        if (settings.get('inline')) {
            // Inserts an empty placeholder where inline content is being pulled from.
            // An event is bound to put inline content back when Colorbox closes or loads new content.
            $inline = $tag(div).hide().insertBefore($j(href)[0]);

            $events.one(event_purge, function() {
                $inline.replaceWith($loaded.children());
            });

            prep($j(href));
        } else if (settings.get('iframe')) {
            // IFrame element won't be added to the DOM until it is ready to be displayed,
            // to avoid problems with DOM-ready JS that might be trying to run in that iframe.
            prep(" ");
        } else if (settings.get('html')) {
            prep(settings.get('html'));
        } else if (isImage(settings, href)) {

            href = retinaUrl(settings, href);

            photo = document.createElement('img');

            $j(photo)
                .addClass(prefix + 'Photo')
                .bind('error', function() {
                    prep($tag(div, 'Error').html(settings.get('imgError')));
                })
                .one('load', function() {
                    var percent;

                    if (request !== requests) {
                        return;
                    }

                    $j.each(['alt', 'longdesc', 'aria-describedby'], function(i, val) {
                        var attr = $j(settings.el).attr(val) || $j(settings.el).attr('data-' + val);
                        if (attr) {
                            photo.setAttribute(val, attr);
                        }
                    });

                    if (settings.get('retinaImage') && window.devicePixelRatio > 1) {
                        photo.height = photo.height / window.devicePixelRatio;
                        photo.width = photo.width / window.devicePixelRatio;
                    }

                    if (settings.get('scalePhotos')) {
                        setResize = function() {
                            photo.height -= photo.height * percent;
                            photo.width -= photo.width * percent;
                        };
                        if (settings.mw && photo.width > settings.mw) {
                            percent = (photo.width - settings.mw) / photo.width;
                            setResize();
                        }
                        if (settings.mh && photo.height > settings.mh) {
                            percent = (photo.height - settings.mh) / photo.height;
                            setResize();
                        }
                    }

                    if (settings.h) {
                        photo.style.marginTop = Math.max(settings.mh - photo.height, 0) / 2 + 'px';
                    }

                    if ($related[1] && (settings.get('loop') || $related[index + 1])) {
                        photo.style.cursor = 'pointer';
                        photo.onclick = function() {
                            publicMethod.next();
                        };
                    }

                    photo.style.width = photo.width + 'px';
                    photo.style.height = photo.height + 'px';

                    setTimeout(function() { // A pause because Chrome will sometimes report a 0 by 0 size otherwise.
                        prep(photo);
                    }, 1);
                });

            setTimeout(function() { // A pause because Opera 10.6+ will sometimes not run the onload function otherwise.
                photo.src = href;
            }, 1);
        } else if (href) {
            $loadingBay.load(href, settings.get('data'), function(data, status) {
                if (request === requests) {
                    prep(status === 'error' ? $tag(div, 'Error').html(settings.get('xhrError')) : $j(this).contents());
                }
            });
        }
    }

    // Navigates to the next page/image in a set.
    publicMethod.next = function() {
        if (!active && $related[1] && (settings.get('loop') || $related[index + 1])) {
            index = getIndex(1);
            launch($related[index]);
        }
    };

    publicMethod.prev = function() {
        if (!active && $related[1] && (settings.get('loop') || index)) {
            index = getIndex(-1);
            launch($related[index]);
        }
    };

    // Note: to use this within an iframe use the following format: parent.jQuery.colorbox.close();
    publicMethod.close = function() {
        if (open && !closing) {

            closing = true;

            open = false;

            trigger(event_cleanup);
            settings.get('onCleanup');

            $window.unbind('.' + prefix);

            $overlay.fadeTo(settings.get('fadeOut') || 0, 0);

            $box.stop().fadeTo(settings.get('fadeOut') || 0, 0, function() {

                $box.add($overlay).css({
                    'opacity': 1,
                    cursor: 'auto'
                }).hide();

                trigger(event_purge);

                $loaded.remove();

                setTimeout(function() {
                    closing = false;
                    trigger(event_closed);
                    settings.get('onClosed');
                }, 1);
            });
        }
    };

    // Removes changes Colorbox made to the document, but does not remove the plugin.
    publicMethod.remove = function() {
        if (!$box) {
            return;
        }

        $box.stop();
        $j.colorbox.close();
        $box.stop().remove();
        $overlay.remove();
        closing = false;
        $box = null;
        $j('.' + boxElement)
            .removeData(colorbox)
            .removeClass(boxElement);

        $j(document).unbind('click.' + prefix);
    };

    // A method for fetching the current element Colorbox is referencing.
    // returns a jQuery object.
    publicMethod.element = function() {
        return $j(settings.el);
    };

    publicMethod.settings = defaults;

}($j, document, window));

var cboxOptions, cboxImageGallery;
$j(document).ready(function() {
    var videoID;
    /*   $j(".popup-video").on('click',function(e){
          e.preventDefault();
          videoID = $j(this).attr("data-video-id");
          });*/

    cboxOptions = {
        href: "#media-container",
        inline: true,
        width: '95%',
        height: 220,
        maxWidth: '95%',
        maxHeight: '95%',
        onOpen: function() {
            videoID = $j(this).data("video-id");
            $j("#media-container").html('<div id="inv_playerContainer" class="inv_playerContainer"></div>');
            $j("#inv_playerContainer").embedCode({
                playerType: "singleplayer",
                videoId: videoID,
                integrationMethod: "lightbox",
                overlayPlay: true,
                autoPlay: true,
                isBanner: false,
                showInfo: false
            });
        },
        onClosed: function(e) {

            $j("#inv_playerContainer").empty();
            $j("#inv_playerContainer").remove();
        }
    };

    $j(".popup-video").on('click', function(e) {
        //alert("working");
        e.preventDefault();
        $j(this).colorbox(cboxOptions);
    });


    $j(document).bind('cbox_complete', function() {
        if ($j(".cboxPhoto").length == 0) {
            var interval = setInterval(function() {

                if ($j("#inv_playerContainer").html() != '') {
                    var cHeight = parseInt($j("#inv_playerContainer").height) + 40;

                    $j.colorbox.resize({
                        width: '95%',
                        height: cHeight
                    });

                    clearInterval(interval);
                }

            }, 500);
        }
    });

    $j(".popup-image").colorbox({
        rel: 'group1'
    });

});

$j(window).resize(function() {

    if ($j("#media-container").length != 0) {

        var cHeight = parseInt($j("#inv_playerContainer").height) + 40;

        $j.colorbox.resize({
            width: '95%',
            height: cHeight
        });
    }

});

/*!---- fw-sustainability-main-----*/
$j(document).ready(function() {

    //var flb = $j('.fw-text-download-and-language .ar-languages-list .label').text();
    //console.log(flb); 
    $j('.fw-text-download-and-language .ar-languages-list .label').click(function() {
        $j(this).toggleClass('active').next().slideToggle();
    });

    if ($j(".fw-text-download-and-language .ar-languages-list ul li").length > 0) {

        $j('.fw-text-download-and-language .ar-languages-list ul li.first a').each(function() {
            var flb = $j(this).parent().parent().parent().parent().find('.label').text();

            var firsthrf = $j(this).attr('href');
            var dtttlf = $j(this).attr('dt-title').toUpperCase();
            $j(this).parent().parent().parent().next().find("a").attr('href', firsthrf);
            $j(this).parent().parent().parent().next().find("a").attr('download', "pdf-" + flb + ".pdf");
            $j(this).parent().parent().parent().next().find("a").attr('title', dtttlf);
        });


        //$j(document).off('click touchstart', '.fw-text-download-and-language .ar-right-cntnt-box .label');

    }

}); //  End of document ready

$j(document).on('click', '.fw-text-download-and-language .ar-languages-list ul li a', function() {

    var hrf = $j(this).attr('href');
    var dtttl2 = $j(this).attr('dt-title').toUpperCase();
    $j('.fw-text-download-and-language .ar-languages-list ul').slideUp();
    $j('.fw-text-download-and-language .ar-languages-list .label').removeClass('active');
    $j(this).parent().parent().parent().parent().parent().next().find("a").attr('href', hrf);
    $j(this).parent().parent().parent().parent().parent().next().find("a").attr('download', "pdf-" + $j(this).text() + ".pdf");
    $j(this).parent().parent().parent().parent().parent().next().find("a").attr('title', dtttl2);
    $j(this).parent().parent().parent().parent().parent().find('.label').text($j(this).text());

    return false;

});

$j(document).on('click touchstart', function(event) {

    var container = $j(".fw-text-download-and-language .ar-right-cntnt-box .label");
    if (!$j(event.target).closest('.fw-text-download-and-language .ar-right-cntnt-box .label').length && !$j(event.target).closest('.fw-text-download-and-language #mCSB_1').length) {
        container.prev().animate({
            width: "0"
        }, 400);
        container.removeClass('active');
        container.next().slideUp();
    }

});
/*!---- search-test-----*/
$j(window).load(function() {
    //if($j(".Nav-search>a.icon-Icon_Search").hasClass("open")){

    // }

});
$j(document).on("click", ".Nav-search__close", function(e) {
    e.preventDefault();

    $j(".Nav-search__wrapper").css("opacity", "0");
    $j(".Nav-search>a.icon-Icon_Search").removeClass("open");
    $j("body").removeClass("HideScroll");
    $j("html").removeClass("HideScroll");



});


$j(document).ready(function() {


    $j(".Nav-search>a.icon-Icon_Search").removeClass("open");
    $j("body").removeClass("BgColor");
    $j("body").removeClass("HideScroll");
    $j("html").removeClass("HideScroll");


    $j("a.icon-Icon_Search").click(function() {
        if (viewport().width > 991) {
            $j(this).addClass("open");

            $j("body").addClass("HideScroll");
            $j("html").addClass("HideScroll");

            $j(".Nav-search__wrapper").css("opacity", "1");
            if ($j('#searchTextbox').val() == 'Search') {
                $j('#searchTextbox').val('');
            }
            $j("#searchTextbox").focus();

        } else {
            $j("body").removeClass("HideScroll");

        }
    });



});

$j(document).keyup(function(e) {
    if (e.keyCode == 27) { // escape key maps to keycode `27`
        $j(".Nav-search__close").trigger("click");

    }
});

$j("input").focus(function() {
    if (this.value == 'Search') {
        this.value = '';
    }
    if (this.value == '') {
        this.value = '';
    }
});

$j(document).ready(function() {
    /*var heiHeader = $j('#header').outerHeight();
      var SearchViewport = viewport().height;
      var diffOfHeight = SearchViewport - heiHeader;
      $j('.Nav-search__wrapper').css('top',heiHeader);*/

    /*var SearchViewport = viewport().height;
    var heiHeader;
    var diffOfHeight;
    if($j('.new-second-level-navigation-outer').length > 0){
      heiHeader = $j('#header').outerHeight();
      diffOfHeight = SearchViewport - heiHeader;
      $j('.Nav-search__wrapper').css('height',diffOfHeight);
    }
    else{
      heiHeader = $j('#header').outerHeight();
      diffOfHeight = SearchViewport - heiHeader;
      $j('.Nav-search__wrapper').css('height',diffOfHeight);
    }*/

});

$j(window).resize(function() {


});

$j(document).on('click touchstart', function(event) {
    //event.preventDefault();
    if (!$j(event.target).closest('.Nav-search__wrapper').length && !$j(event.target).closest('.icon-Icon_Search').length && !$j(event.target).closest('#SearchButtonContainer').length) {

        if ($j('.Nav-search__button').hasClass("open")) {
            $j(".Nav-search__close").trigger("click");
        }
    }
});
var isMobile;

$j(document).ready(function() {
    if (is_touch_device()) {
        $j('.searchText').hide();
    }
    /* $j('.fwMenuwrapper ul > li.level1>a>span').hover(function(){
      $j("body").removeClass("HideScroll");
      $j(".Nav-search>a.icon-Icon_Search").removeClass("open");
      
     });*/
    $j('.fwMenuwrapper ul > li.level1').hover(function() {

        $j("body").addClass("SearchOpened");
    });



    /*if (viewport().width > 991){ 
     // if($j(".HideScroll").length > 0){
        var lastScrollTop = 0;
    $j(window).scroll(function(event){
       var st = $j(this).scrollTop();
       if (st > lastScrollTop){
          $j("body.HideScroll .Nav-search__wrapper").addClass("OverlayAppears");
       } else {
           $j("body.HideScroll .Nav-search__wrapper").removeClass("OverlayAppears");
       }
       lastScrollTop = st;
       // $j(".BannerContent").css("margin-top", -($j(".BannerContent").outerHeight() / 2));
    });
    //}
    }*/

});

$j(window).scroll(function() {
    if ($j('body').hasClass('HideScroll')) {
        $j('.ui-autocomplete').hide();
    }
});
/*!---- innovation-customScroll-js-----*/
/*
== malihu jquery custom scrollbar plugin == 
Version: 3.0.9 
Plugin URI: http://manos.malihu.gr/jquery-custom-content-scroller 
Author: malihu
Author URI: http://manos.malihu.gr
License: MIT License (MIT)
*/

/*
Copyright 2010 Manos Malihutsakis (email: manos@malihu.gr)

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/

/*
The code below is fairly long, fully commented and should be normally used in development. 
For production, use either the minified jquery.mCustomScrollbar.min.js script or 
the production-ready jquery.mCustomScrollbar.concat.min.js which contains the plugin 
and dependencies (minified). 
*/

(function(factory) {
    if (typeof module !== "undefined" && module.exports) {
        module.exports = factory;
    } else {
        factory($j, window, document);
    }
}(function($j) {
    (function(init) {
        var _rjs = typeof define === "function" && define.amd,
            /* RequireJS */
            _njs = typeof module !== "undefined" && module.exports,
            /* NodeJS */
            _dlp = ("https:" == document.location.protocol) ? "https:" : "http:",
            /* location protocol */
            _url = "cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.12/jquery.mousewheel.min.js";
        if (!_rjs) {
            if (_njs) {
                require("jquery-mousewheel")($j);
            } else {
                /* load jquery-mousewheel plugin (via CDN) if it's not present or not loaded via RequireJS 
                (works when mCustomScrollbar fn is called on window load) */
                $j.event.special.mousewheel || $j("head").append(decodeURI("%3Cscript src=" + _dlp + "//" + _url + "%3E%3C/script%3E"));
            }
        }
        init();
    }(function() {

        /* 
        ----------------------------------------
        PLUGIN NAMESPACE, PREFIX, DEFAULT SELECTOR(S) 
        ----------------------------------------
        */

        var pluginNS = "mCustomScrollbar",
            pluginPfx = "mCS",
            defaultSelector = ".mCustomScrollbar",





            /* 
            ----------------------------------------
            DEFAULT OPTIONS 
            ----------------------------------------
            */

            defaults = {
                /*
                set element/content width/height programmatically 
                values: boolean, pixels, percentage 
                	option						default
                	-------------------------------------
                	setWidth					false
                	setHeight					false
                */
                /*
                set the initial css top property of content  
                values: string (e.g. "-100px", "10%" etc.)
                */
                setTop: 0,
                /*
                set the initial css left property of content  
                values: string (e.g. "-100px", "10%" etc.)
                */
                setLeft: 0,
                /* 
                scrollbar axis (vertical and/or horizontal scrollbars) 
                values (string): "y", "x", "yx"
                */
                axis: "y",
                /*
                position of scrollbar relative to content  
                values (string): "inside", "outside" ("outside" requires elements with position:relative)
                */
                scrollbarPosition: "inside",
                /*
                scrolling inertia
                values: integer (milliseconds)
                */
                scrollInertia: 950,
                /* 
                auto-adjust scrollbar dragger length
                values: boolean
                */
                autoDraggerLength: true,
                /*
                auto-hide scrollbar when idle 
                values: boolean
                	option						default
                	-------------------------------------
                	autoHideScrollbar			false
                */
                /*
                auto-expands scrollbar on mouse-over and dragging
                values: boolean
                	option						default
                	-------------------------------------
                	autoExpandScrollbar			false
                */
                /*
                always show scrollbar, even when there's nothing to scroll 
                values: integer (0=disable, 1=always show dragger rail and buttons, 2=always show dragger rail, dragger and buttons), boolean
                */
                alwaysShowScrollbar: 0,
                /*
                scrolling always snaps to a multiple of this number in pixels
                values: integer
                	option						default
                	-------------------------------------
                	snapAmount					null
                */
                /*
                when snapping, snap with this number in pixels as an offset 
                values: integer
                */
                snapOffset: 0,
                /* 
                mouse-wheel scrolling
                */
                mouseWheel: {
                    /* 
                    enable mouse-wheel scrolling
                    values: boolean
                    */
                    enable: true,
                    /* 
                    scrolling amount in pixels
                    values: "auto", integer 
                    */
                    scrollAmount: "auto",
                    /* 
                    mouse-wheel scrolling axis 
                    the default scrolling direction when both vertical and horizontal scrollbars are present 
                    values (string): "y", "x" 
                    */
                    axis: "y",
                    /* 
                    prevent the default behaviour which automatically scrolls the parent element(s) when end of scrolling is reached 
                    values: boolean
                    	option						default
                    	-------------------------------------
                    	preventDefault				null
                    */
                    /*
                    the reported mouse-wheel delta value. The number of lines (translated to pixels) one wheel notch scrolls.  
                    values: "auto", integer 
                    "auto" uses the default OS/browser value 
                    */
                    deltaFactor: "auto",
                    /*
                    normalize mouse-wheel delta to -1 or 1 (disables mouse-wheel acceleration) 
                    values: boolean
                    	option						default
                    	-------------------------------------
                    	normalizeDelta				null
                    */
                    /*
                    invert mouse-wheel scrolling direction 
                    values: boolean
                    	option						default
                    	-------------------------------------
                    	invert						null
                    */
                    /*
                    the tags that disable mouse-wheel when cursor is over them
                    */
                    disableOver: ["select", "option", "keygen", "datalist", "textarea"]
                },
                /* 
                scrollbar buttons
                */
                scrollButtons: {
                    /*
                    enable scrollbar buttons
                    values: boolean
                    	option						default
                    	-------------------------------------
                    	enable						null
                    */
                    /*
                    scrollbar buttons scrolling type 
                    values (string): "stepless", "stepped"
                    */
                    scrollType: "stepless",
                    /*
                    scrolling amount in pixels
                    values: "auto", integer 
                    */
                    scrollAmount: "auto"
                    /*
                    tabindex of the scrollbar buttons
                    values: false, integer
                    	option						default
                    	-------------------------------------
                    	tabindex					null
                    */
                },
                /* 
                keyboard scrolling
                */
                keyboard: {
                    /*
                    enable scrolling via keyboard
                    values: boolean
                    */
                    enable: true,
                    /*
                    keyboard scrolling type 
                    values (string): "stepless", "stepped"
                    */
                    scrollType: "stepless",
                    /*
                    scrolling amount in pixels
                    values: "auto", integer 
                    */
                    scrollAmount: "auto"
                },
                /*
                enable content touch-swipe scrolling 
                values: boolean, integer, string (number)
                integer values define the axis-specific minimum amount required for scrolling momentum
                */
                contentTouchScroll: 25,
                /*
                advanced option parameters
                */
                advanced: {
                    /*
                    auto-expand content horizontally (for "x" or "yx" axis) 
                    values: boolean
                    	option						default
                    	-------------------------------------
                    	autoExpandHorizontalScroll	null
                    */
                    /*
                    auto-scroll to elements with focus
                    */
                    autoScrollOnFocus: "input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",
                    /*
                    auto-update scrollbars on content, element or viewport resize 
                    should be true for fluid layouts/elements, adding/removing content dynamically, hiding/showing elements, content with images etc. 
                    values: boolean
                    */
                    updateOnContentResize: true,
                    /*
                    auto-update scrollbars each time each image inside the element is fully loaded 
                    values: boolean
                    */
                    updateOnImageLoad: true,
                    /*
                    auto-update scrollbars based on the amount and size changes of specific selectors 
                    useful when you need to update the scrollbar(s) automatically, each time a type of element is added, removed or changes its size 
                    values: boolean, string (e.g. "ul li" will auto-update scrollbars each time list-items inside the element are changed) 
                    a value of true (boolean) will auto-update scrollbars each time any element is changed
                    	option						default
                    	-------------------------------------
                    	updateOnSelectorChange		null
                    */
                    /*
                    extra selectors that'll release scrollbar dragging upon mouseup, pointerup, touchend etc. (e.g. "selector-1, selector-2")
                    	option						default
                    	-------------------------------------
                    	releaseDraggableSelectors	null
                    */
                    /*
                    auto-update timeout 
                    values: integer (milliseconds)
                    */
                    autoUpdateTimeout: 60
                },
                /* 
                scrollbar theme 
                values: string (see CSS/plugin URI for a list of ready-to-use themes)
                */
                theme: "light",
                /*
                user defined callback functions
                */
                callbacks: {
                    /*
                    Available callbacks: 
                    	callback					default
                    	-------------------------------------
                    	onInit						null
                    	onScrollStart				null
                    	onScroll					null
                    	onTotalScroll				null
                    	onTotalScrollBack			null
                    	whileScrolling				null
                    	onOverflowY					null
                    	onOverflowX					null
                    	onOverflowYNone				null
                    	onOverflowXNone				null
                    	onImageLoad					null
                    	onSelectorChange			null
                    	onUpdate					null
                    */
                    onTotalScrollOffset: 0,
                    onTotalScrollBackOffset: 0,
                    alwaysTriggerOffsets: true
                }
                /*
                add scrollbar(s) on all elements matching the current selector, now and in the future 
                values: boolean, string 
                string values: "on" (enable), "once" (disable after first invocation), "off" (disable)
                liveSelector values: string (selector)
                	option						default
                	-------------------------------------
                	live						false
                	liveSelector				null
                */
            },





            /* 
            ----------------------------------------
            VARS, CONSTANTS 
            ----------------------------------------
            */

            totalInstances = 0,
            /* plugin instances amount */
            liveTimers = {},
            /* live option timers */
            oldIE = (window.attachEvent && !window.addEventListener) ? 1 : 0,
            /* detect IE < 9 */
            touchActive = false,
            touchable, /* global touch vars (for touch and pointer events) */
            /* general plugin classes */
            classes = [
                "mCSB_dragger_onDrag", "mCSB_scrollTools_onDrag", "mCS_img_loaded", "mCS_disabled", "mCS_destroyed", "mCS_no_scrollbar",
                "mCS-autoHide", "mCS-dir-rtl", "mCS_no_scrollbar_y", "mCS_no_scrollbar_x", "mCS_y_hidden", "mCS_x_hidden", "mCSB_draggerContainer",
                "mCSB_buttonUp", "mCSB_buttonDown", "mCSB_buttonLeft", "mCSB_buttonRight"
            ],





            /* 
            ----------------------------------------
            METHODS 
            ----------------------------------------
            */

            methods = {

                /* 
                plugin initialization method 
                creates the scrollbar(s), plugin data object and options
                ----------------------------------------
                */

                init: function(options) {

                    var options = $j.extend(true, {}, defaults, options),
                        selector = _selector.call(this); /* validate selector */

                    /* 
                    if live option is enabled, monitor for elements matching the current selector and 
                    apply scrollbar(s) when found (now and in the future) 
                    */
                    if (options.live) {
                        var liveSelector = options.liveSelector || this.selector || defaultSelector,
                            /* live selector(s) */
                            $liveSelector = $j(liveSelector); /* live selector(s) as jquery object */
                        if (options.live === "off") {
                            /* 
                            disable live if requested 
                            usage: $j(selector).mCustomScrollbar({live:"off"}); 
                            */
                            removeLiveTimers(liveSelector);
                            return;
                        }
                        liveTimers[liveSelector] = setTimeout(function() {
                            /* call mCustomScrollbar fn on live selector(s) every half-second */
                            $liveSelector.mCustomScrollbar(options);
                            if (options.live === "once" && $liveSelector.length) {
                                /* disable live after first invocation */
                                removeLiveTimers(liveSelector);
                            }
                        }, 500);
                    } else {
                        removeLiveTimers(liveSelector);
                    }

                    /* options backward compatibility (for versions < 3.0.0) and normalization */
                    options.setWidth = (options.set_width) ? options.set_width : options.setWidth;
                    options.setHeight = (options.set_height) ? options.set_height : options.setHeight;
                    options.axis = (options.horizontalScroll) ? "x" : _findAxis(options.axis);
                    options.scrollInertia = options.scrollInertia > 0 && options.scrollInertia < 17 ? 17 : options.scrollInertia;
                    if (typeof options.mouseWheel !== "object" && options.mouseWheel == true) { /* old school mouseWheel option (non-object) */
                        options.mouseWheel = {
                            enable: true,
                            scrollAmount: "auto",
                            axis: "y",
                            preventDefault: false,
                            deltaFactor: "auto",
                            normalizeDelta: false,
                            invert: false
                        }
                    }
                    options.mouseWheel.scrollAmount = !options.mouseWheelPixels ? options.mouseWheel.scrollAmount : options.mouseWheelPixels;
                    options.mouseWheel.normalizeDelta = !options.advanced.normalizeMouseWheelDelta ? options.mouseWheel.normalizeDelta : options.advanced.normalizeMouseWheelDelta;
                    options.scrollButtons.scrollType = _findScrollButtonsType(options.scrollButtons.scrollType);

                    _theme(options); /* theme-specific options */

                    /* plugin constructor */
                    return $j(selector).each(function() {

                        var $this = $j(this);

                        if (!$this.data(pluginPfx)) { /* prevent multiple instantiations */

                            /* store options and create objects in jquery data */
                            $this.data(pluginPfx, {
                                idx: ++totalInstances,
                                /* instance index */
                                opt: options,
                                /* options */
                                scrollRatio: {
                                    y: null,
                                    x: null
                                },
                                /* scrollbar to content ratio */
                                overflowed: null,
                                /* overflowed axis */
                                contentReset: {
                                    y: null,
                                    x: null
                                },
                                /* object to check when content resets */
                                bindEvents: false,
                                /* object to check if events are bound */
                                tweenRunning: false,
                                /* object to check if tween is running */
                                sequential: {},
                                /* sequential scrolling object */
                                langDir: $this.css("direction"),
                                /* detect/store direction (ltr or rtl) */
                                cbOffsets: null,
                                /* object to check whether callback offsets always trigger */
                                /* 
                                object to check how scrolling events where last triggered 
                                "internal" (default - triggered by this script), "external" (triggered by other scripts, e.g. via scrollTo method) 
                                usage: object.data("mCS").trigger
                                */
                                trigger: null
                            });

                            var d = $this.data(pluginPfx),
                                o = d.opt,
                                /* HTML data attributes */
                                htmlDataAxis = $this.data("mcs-axis"),
                                htmlDataSbPos = $this.data("mcs-scrollbar-position"),
                                htmlDataTheme = $this.data("mcs-theme");

                            if (htmlDataAxis) {
                                o.axis = htmlDataAxis;
                            } /* usage example: data-mcs-axis="y" */
                            if (htmlDataSbPos) {
                                o.scrollbarPosition = htmlDataSbPos;
                            } /* usage example: data-mcs-scrollbar-position="outside" */
                            if (htmlDataTheme) { /* usage example: data-mcs-theme="minimal" */
                                o.theme = htmlDataTheme;
                                _theme(o); /* theme-specific options */
                            }

                            _pluginMarkup.call(this); /* add plugin markup */

                            $j("#mCSB_" + d.idx + "_container img:not(." + classes[2] + ")").addClass(classes[2]); /* flag loaded images */

                            methods.update.call(null, $this); /* call the update method */

                        }

                    });

                },
                /* ---------------------------------------- */



                /* 
                plugin update method 
                updates content and scrollbar(s) values, events and status 
                ----------------------------------------
                usage: $j(selector).mCustomScrollbar("update");
                */

                update: function(el, cb) {

                    var selector = el || _selector.call(this); /* validate selector */

                    return $j(selector).each(function() {

                        var $this = $j(this);

                        if ($this.data(pluginPfx)) { /* check if plugin has initialized */

                            var d = $this.data(pluginPfx),
                                o = d.opt,
                                mCSB_container = $j("#mCSB_" + d.idx + "_container"),
                                mCSB_dragger = [$j("#mCSB_" + d.idx + "_dragger_vertical"), $j("#mCSB_" + d.idx + "_dragger_horizontal")];

                            if (!mCSB_container.length) {
                                return;
                            }

                            if (d.tweenRunning) {
                                _stop($this);
                            } /* stop any running tweens while updating */

                            /* if element was disabled or destroyed, remove class(es) */
                            if ($this.hasClass(classes[3])) {
                                $this.removeClass(classes[3]);
                            }
                            if ($this.hasClass(classes[4])) {
                                $this.removeClass(classes[4]);
                            }

                            _maxHeight.call(this); /* detect/set css max-height value */

                            _expandContentHorizontally.call(this); /* expand content horizontally */

                            if (o.axis !== "y" && !o.advanced.autoExpandHorizontalScroll) {
                                mCSB_container.css("width", _contentWidth(mCSB_container.children()));
                            }

                            d.overflowed = _overflowed.call(this); /* determine if scrolling is required */

                            _scrollbarVisibility.call(this); /* show/hide scrollbar(s) */

                            /* auto-adjust scrollbar dragger length analogous to content */
                            if (o.autoDraggerLength) {
                                _setDraggerLength.call(this);
                            }

                            _scrollRatio.call(this); /* calculate and store scrollbar to content ratio */

                            _bindEvents.call(this); /* bind scrollbar events */

                            /* reset scrolling position and/or events */
                            var to = [Math.abs(mCSB_container[0].offsetTop), Math.abs(mCSB_container[0].offsetLeft)];
                            if (o.axis !== "x") { /* y/yx axis */
                                if (!d.overflowed[0]) { /* y scrolling is not required */
                                    _resetContentPosition.call(this); /* reset content position */
                                    if (o.axis === "y") {
                                        _unbindEvents.call(this);
                                    } else if (o.axis === "yx" && d.overflowed[1]) {
                                        _scrollTo($this, to[1].toString(), {
                                            dir: "x",
                                            dur: 0,
                                            overwrite: "none"
                                        });
                                    }
                                } else if (mCSB_dragger[0].height() > mCSB_dragger[0].parent().height()) {
                                    _resetContentPosition.call(this); /* reset content position */
                                } else { /* y scrolling is required */
                                    _scrollTo($this, to[0].toString(), {
                                        dir: "y",
                                        dur: 0,
                                        overwrite: "none"
                                    });
                                    d.contentReset.y = null;
                                }
                            }
                            if (o.axis !== "y") { /* x/yx axis */
                                if (!d.overflowed[1]) { /* x scrolling is not required */
                                    _resetContentPosition.call(this); /* reset content position */
                                    if (o.axis === "x") {
                                        _unbindEvents.call(this);
                                    } else if (o.axis === "yx" && d.overflowed[0]) {
                                        _scrollTo($this, to[0].toString(), {
                                            dir: "y",
                                            dur: 0,
                                            overwrite: "none"
                                        });
                                    }
                                } else if (mCSB_dragger[1].width() > mCSB_dragger[1].parent().width()) {
                                    _resetContentPosition.call(this); /* reset content position */
                                } else { /* x scrolling is required */
                                    _scrollTo($this, to[1].toString(), {
                                        dir: "x",
                                        dur: 0,
                                        overwrite: "none"
                                    });
                                    d.contentReset.x = null;
                                }
                            }

                            /* callbacks: onImageLoad, onSelectorChange, onUpdate */
                            if (cb && d) {
                                if (cb === 2 && o.callbacks.onImageLoad && typeof o.callbacks.onImageLoad === "function") {
                                    o.callbacks.onImageLoad.call(this);
                                } else if (cb === 3 && o.callbacks.onSelectorChange && typeof o.callbacks.onSelectorChange === "function") {
                                    o.callbacks.onSelectorChange.call(this);
                                } else if (o.callbacks.onUpdate && typeof o.callbacks.onUpdate === "function") {
                                    o.callbacks.onUpdate.call(this);
                                }
                            }

                            _autoUpdate.call(this); /* initialize automatic updating (for dynamic content, fluid layouts etc.) */

                        }

                    });

                },
                /* ---------------------------------------- */



                /* 
                plugin scrollTo method 
                triggers a scrolling event to a specific value
                ----------------------------------------
                usage: $j(selector).mCustomScrollbar("scrollTo",value,options);
                */

                scrollTo: function(val, options) {

                    /* prevent silly things like $j(selector).mCustomScrollbar("scrollTo",undefined); */
                    if (typeof val == "undefined" || val == null) {
                        return;
                    }

                    var selector = _selector.call(this); /* validate selector */

                    return $j(selector).each(function() {

                        var $this = $j(this);

                        if ($this.data(pluginPfx)) { /* check if plugin has initialized */

                            var d = $this.data(pluginPfx),
                                o = d.opt,
                                /* method default options */
                                methodDefaults = {
                                    trigger: "external",
                                    /* method is by default triggered externally (e.g. from other scripts) */
                                    scrollInertia: o.scrollInertia,
                                    /* scrolling inertia (animation duration) */
                                    scrollEasing: "mcsEaseInOut",
                                    /* animation easing */
                                    moveDragger: false,
                                    /* move dragger instead of content */
                                    timeout: 60,
                                    /* scroll-to delay */
                                    callbacks: true,
                                    /* enable/disable callbacks */
                                    onStart: true,
                                    onUpdate: true,
                                    onComplete: true
                                },
                                methodOptions = $j.extend(true, {}, methodDefaults, options),
                                to = _arr.call(this, val),
                                dur = methodOptions.scrollInertia > 0 && methodOptions.scrollInertia < 17 ? 17 : methodOptions.scrollInertia;

                            /* translate yx values to actual scroll-to positions */
                            to[0] = _to.call(this, to[0], "y");
                            to[1] = _to.call(this, to[1], "x");

                            /* 
                            check if scroll-to value moves the dragger instead of content. 
                            Only pixel values apply on dragger (e.g. 100, "100px", "-=100" etc.) 
                            */
                            if (methodOptions.moveDragger) {
                                to[0] *= d.scrollRatio.y;
                                to[1] *= d.scrollRatio.x;
                            }

                            methodOptions.dur = dur;

                            setTimeout(function() {
                                /* do the scrolling */
                                if (to[0] !== null && typeof to[0] !== "undefined" && o.axis !== "x" && d.overflowed[0]) { /* scroll y */
                                    methodOptions.dir = "y";
                                    methodOptions.overwrite = "all";
                                    _scrollTo($this, to[0].toString(), methodOptions);
                                }
                                if (to[1] !== null && typeof to[1] !== "undefined" && o.axis !== "y" && d.overflowed[1]) { /* scroll x */
                                    methodOptions.dir = "x";
                                    methodOptions.overwrite = "none";
                                    _scrollTo($this, to[1].toString(), methodOptions);
                                }
                            }, methodOptions.timeout);

                        }

                    });

                },
                /* ---------------------------------------- */



                /*
                plugin stop method 
                stops scrolling animation
                ----------------------------------------
                usage: $j(selector).mCustomScrollbar("stop");
                */
                stop: function() {

                    var selector = _selector.call(this); /* validate selector */

                    return $j(selector).each(function() {

                        var $this = $j(this);

                        if ($this.data(pluginPfx)) { /* check if plugin has initialized */

                            _stop($this);

                        }

                    });

                },
                /* ---------------------------------------- */



                /*
                plugin disable method 
                temporarily disables the scrollbar(s) 
                ----------------------------------------
                usage: $j(selector).mCustomScrollbar("disable",reset); 
                reset (boolean): resets content position to 0 
                */
                disable: function(r) {

                    var selector = _selector.call(this); /* validate selector */

                    return $j(selector).each(function() {

                        var $this = $j(this);

                        if ($this.data(pluginPfx)) { /* check if plugin has initialized */

                            var d = $this.data(pluginPfx);

                            _autoUpdate.call(this, "remove"); /* remove automatic updating */

                            _unbindEvents.call(this); /* unbind events */

                            if (r) {
                                _resetContentPosition.call(this);
                            } /* reset content position */

                            _scrollbarVisibility.call(this, true); /* show/hide scrollbar(s) */

                            $this.addClass(classes[3]); /* add disable class */

                        }

                    });

                },
                /* ---------------------------------------- */



                /*
                plugin destroy method 
                completely removes the scrollbar(s) and returns the element to its original state
                ----------------------------------------
                usage: $j(selector).mCustomScrollbar("destroy"); 
                */
                destroy: function() {

                    var selector = _selector.call(this); /* validate selector */

                    return $j(selector).each(function() {

                        var $this = $j(this);

                        if ($this.data(pluginPfx)) { /* check if plugin has initialized */

                            var d = $this.data(pluginPfx),
                                o = d.opt,
                                mCustomScrollBox = $j("#mCSB_" + d.idx),
                                mCSB_container = $j("#mCSB_" + d.idx + "_container"),
                                scrollbar = $j(".mCSB_" + d.idx + "_scrollbar");

                            if (o.live) {
                                removeLiveTimers(o.liveSelector || $j(selector).selector);
                            } /* remove live timers */

                            _autoUpdate.call(this, "remove"); /* remove automatic updating */

                            _unbindEvents.call(this); /* unbind events */

                            _resetContentPosition.call(this); /* reset content position */

                            $this.removeData(pluginPfx); /* remove plugin data object */

                            _delete(this, "mcs"); /* delete callbacks object */

                            /* remove plugin markup */
                            scrollbar.remove(); /* remove scrollbar(s) first (those can be either inside or outside plugin's inner wrapper) */
                            mCSB_container.find("img." + classes[2]).removeClass(classes[2]); /* remove loaded images flag */
                            mCustomScrollBox.replaceWith(mCSB_container.contents()); /* replace plugin's inner wrapper with the original content */
                            /* remove plugin classes from the element and add destroy class */
                            $this.removeClass(pluginNS + " _" + pluginPfx + "_" + d.idx + " " + classes[6] + " " + classes[7] + " " + classes[5] + " " + classes[3]).addClass(classes[4]);

                        }

                    });

                }
                /* ---------------------------------------- */

            },





            /* 
            ----------------------------------------
            FUNCTIONS
            ----------------------------------------
            */

            /* validates selector (if selector is invalid or undefined uses the default one) */
            _selector = function() {
                return (typeof $j(this) !== "object" || $j(this).length < 1) ? defaultSelector : this;
            },
            /* -------------------- */


            /* changes options according to theme */
            _theme = function(obj) {
                var fixedSizeScrollbarThemes = ["rounded", "rounded-dark", "rounded-dots", "rounded-dots-dark"],
                    nonExpandedScrollbarThemes = ["rounded-dots", "rounded-dots-dark", "3d", "3d-dark", "3d-thick", "3d-thick-dark", "inset", "inset-dark", "inset-2", "inset-2-dark", "inset-3", "inset-3-dark"],
                    disabledScrollButtonsThemes = ["minimal", "minimal-dark"],
                    enabledAutoHideScrollbarThemes = ["minimal", "minimal-dark"],
                    scrollbarPositionOutsideThemes = ["minimal", "minimal-dark"];
                obj.autoDraggerLength = $j.inArray(obj.theme, fixedSizeScrollbarThemes) > -1 ? false : obj.autoDraggerLength;
                obj.autoExpandScrollbar = $j.inArray(obj.theme, nonExpandedScrollbarThemes) > -1 ? false : obj.autoExpandScrollbar;
                obj.scrollButtons.enable = $j.inArray(obj.theme, disabledScrollButtonsThemes) > -1 ? false : obj.scrollButtons.enable;
                obj.autoHideScrollbar = $j.inArray(obj.theme, enabledAutoHideScrollbarThemes) > -1 ? true : obj.autoHideScrollbar;
                obj.scrollbarPosition = $j.inArray(obj.theme, scrollbarPositionOutsideThemes) > -1 ? "outside" : obj.scrollbarPosition;
            },
            /* -------------------- */


            /* live option timers removal */
            removeLiveTimers = function(selector) {
                if (liveTimers[selector]) {
                    clearTimeout(liveTimers[selector]);
                    _delete(liveTimers, selector);
                }
            },
            /* -------------------- */


            /* normalizes axis option to valid values: "y", "x", "yx" */
            _findAxis = function(val) {
                return (val === "yx" || val === "xy" || val === "auto") ? "yx" : (val === "x" || val === "horizontal") ? "x" : "y";
            },
            /* -------------------- */


            /* normalizes scrollButtons.scrollType option to valid values: "stepless", "stepped" */
            _findScrollButtonsType = function(val) {
                return (val === "stepped" || val === "pixels" || val === "step" || val === "click") ? "stepped" : "stepless";
            },
            /* -------------------- */


            /* generates plugin markup */
            _pluginMarkup = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt,
                    expandClass = o.autoExpandScrollbar ? " " + classes[1] + "_expand" : "",
                    scrollbar = ["<div id='mCSB_" + d.idx + "_scrollbar_vertical' class='mCSB_scrollTools mCSB_" + d.idx + "_scrollbar mCS-" + o.theme + " mCSB_scrollTools_vertical" + expandClass + "'><div class='" + classes[12] + "'><div id='mCSB_" + d.idx + "_dragger_vertical' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>", "<div id='mCSB_" + d.idx + "_scrollbar_horizontal' class='mCSB_scrollTools mCSB_" + d.idx + "_scrollbar mCS-" + o.theme + " mCSB_scrollTools_horizontal" + expandClass + "'><div class='" + classes[12] + "'><div id='mCSB_" + d.idx + "_dragger_horizontal' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],
                    wrapperClass = o.axis === "yx" ? "mCSB_vertical_horizontal" : o.axis === "x" ? "mCSB_horizontal" : "mCSB_vertical",
                    scrollbars = o.axis === "yx" ? scrollbar[0] + scrollbar[1] : o.axis === "x" ? scrollbar[1] : scrollbar[0],
                    contentWrapper = o.axis === "yx" ? "<div id='mCSB_" + d.idx + "_container_wrapper' class='mCSB_container_wrapper' />" : "",
                    autoHideClass = o.autoHideScrollbar ? " " + classes[6] : "",
                    scrollbarDirClass = (o.axis !== "x" && d.langDir === "rtl") ? " " + classes[7] : "";
                if (o.setWidth) {
                    $this.css("width", o.setWidth);
                } /* set element width */
                if (o.setHeight) {
                    $this.css("height", o.setHeight);
                } /* set element height */
                o.setLeft = (o.axis !== "y" && d.langDir === "rtl") ? "989999px" : o.setLeft; /* adjust left position for rtl direction */
                $this.addClass(pluginNS + " _" + pluginPfx + "_" + d.idx + autoHideClass + scrollbarDirClass).wrapInner("<div id='mCSB_" + d.idx + "' class='mCustomScrollBox mCS-" + o.theme + " " + wrapperClass + "'><div id='mCSB_" + d.idx + "_container' class='mCSB_container' style='position:relative; top:" + o.setTop + "; left:" + o.setLeft + ";' dir=" + d.langDir + " /></div>");
                var mCustomScrollBox = $j("#mCSB_" + d.idx),
                    mCSB_container = $j("#mCSB_" + d.idx + "_container");
                if (o.axis !== "y" && !o.advanced.autoExpandHorizontalScroll) {
                    mCSB_container.css("width", _contentWidth(mCSB_container.children()));
                }
                if (o.scrollbarPosition === "outside") {
                    if ($this.css("position") === "static") { /* requires elements with non-static position */
                        $this.css("position", "relative");
                    }
                    $this.css("overflow", "visible");
                    mCustomScrollBox.addClass("mCSB_outside").after(scrollbars);
                } else {
                    mCustomScrollBox.addClass("mCSB_inside").append(scrollbars);
                    mCSB_container.wrap(contentWrapper);
                }
                _scrollButtons.call(this); /* add scrollbar buttons */
                /* minimum dragger length */
                var mCSB_dragger = [$j("#mCSB_" + d.idx + "_dragger_vertical"), $j("#mCSB_" + d.idx + "_dragger_horizontal")];
                mCSB_dragger[0].css("min-height", mCSB_dragger[0].height());
                mCSB_dragger[1].css("min-width", mCSB_dragger[1].width());
            },
            /* -------------------- */


            /* calculates content width */
            _contentWidth = function(el) {
                return Math.max.apply(Math, el.map(function() {
                    return $j(this).outerWidth(true);
                }).get());
            },
            /* -------------------- */


            /* expands content horizontally */
            _expandContentHorizontally = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt,
                    mCSB_container = $j("#mCSB_" + d.idx + "_container");
                if (o.advanced.autoExpandHorizontalScroll && o.axis !== "y") {
                    /* 
                    wrap content with an infinite width div and set its position to absolute and width to auto. 
                    Setting width to auto before calculating the actual width is important! 
                    We must let the browser set the width as browser zoom values are impossible to calculate.
                    */
                    mCSB_container.css({
                            "position": "absolute",
                            "width": "auto"
                        })
                        .wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />")
                        .css({ /* set actual width, original position and un-wrap */
                            /* 
                            get the exact width (with decimals) and then round-up. 
                            Using jquery outerWidth() will round the width value which will mess up with inner elements that have non-integer width
                            */
                            "width": (Math.ceil(mCSB_container[0].getBoundingClientRect().right + 0.4) - Math.floor(mCSB_container[0].getBoundingClientRect().left)),
                            "position": "relative"
                        }).unwrap();
                }
            },
            /* -------------------- */


            /* adds scrollbar buttons */
            _scrollButtons = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt,
                    mCSB_scrollTools = $j(".mCSB_" + d.idx + "_scrollbar:first"),
                    tabindex = !_isNumeric(o.scrollButtons.tabindex) ? "" : "tabindex='" + o.scrollButtons.tabindex + "'",
                    btnHTML = [
                        "<a href='#' class='" + classes[13] + "' oncontextmenu='return false;' " + tabindex + " />",
                        "<a href='#' class='" + classes[14] + "' oncontextmenu='return false;' " + tabindex + " />",
                        "<a href='#' class='" + classes[15] + "' oncontextmenu='return false;' " + tabindex + " />",
                        "<a href='#' class='" + classes[16] + "' oncontextmenu='return false;' " + tabindex + " />"
                    ],
                    btn = [(o.axis === "x" ? btnHTML[2] : btnHTML[0]), (o.axis === "x" ? btnHTML[3] : btnHTML[1]), btnHTML[2], btnHTML[3]];
                if (o.scrollButtons.enable) {
                    mCSB_scrollTools.prepend(btn[0]).append(btn[1]).next(".mCSB_scrollTools").prepend(btn[2]).append(btn[3]);
                }
            },
            /* -------------------- */


            /* detects/sets css max-height value */
            _maxHeight = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    mCustomScrollBox = $j("#mCSB_" + d.idx),
                    mh = $this.css("max-height") || "none",
                    pct = mh.indexOf("%") !== -1,
                    bs = $this.css("box-sizing");
                if (mh !== "none") {
                    var val = pct ? $this.parent().height() * parseInt(mh) / 100 : parseInt(mh);
                    /* if element's css box-sizing is "border-box", subtract any paddings and/or borders from max-height value */
                    if (bs === "border-box") {
                        val -= (($this.innerHeight() - $this.height()) + ($this.outerHeight() - $this.innerHeight()));
                    }
                    mCustomScrollBox.css("max-height", Math.round(val));
                }
            },
            /* -------------------- */


            /* auto-adjusts scrollbar dragger length */
            _setDraggerLength = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    mCustomScrollBox = $j("#mCSB_" + d.idx),
                    mCSB_container = $j("#mCSB_" + d.idx + "_container"),
                    mCSB_dragger = [$j("#mCSB_" + d.idx + "_dragger_vertical"), $j("#mCSB_" + d.idx + "_dragger_horizontal")],
                    ratio = [mCustomScrollBox.height() / mCSB_container.outerHeight(false), mCustomScrollBox.width() / mCSB_container.outerWidth(false)],
                    l = [
                        parseInt(mCSB_dragger[0].css("min-height")), Math.round(ratio[0] * mCSB_dragger[0].parent().height()),
                        parseInt(mCSB_dragger[1].css("min-width")), Math.round(ratio[1] * mCSB_dragger[1].parent().width())
                    ],
                    h = oldIE && (l[1] < l[0]) ? l[0] : l[1],
                    w = oldIE && (l[3] < l[2]) ? l[2] : l[3];
                mCSB_dragger[0].css({
                    "height": h,
                    "max-height": (mCSB_dragger[0].parent().height() - 10)
                }).find(".mCSB_dragger_bar").css({
                    "line-height": l[0] + "px"
                });
                mCSB_dragger[1].css({
                    "width": w,
                    "max-width": (mCSB_dragger[1].parent().width() - 10)
                });
            },
            /* -------------------- */


            /* calculates scrollbar to content ratio */
            _scrollRatio = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    mCustomScrollBox = $j("#mCSB_" + d.idx),
                    mCSB_container = $j("#mCSB_" + d.idx + "_container"),
                    mCSB_dragger = [$j("#mCSB_" + d.idx + "_dragger_vertical"), $j("#mCSB_" + d.idx + "_dragger_horizontal")],
                    scrollAmount = [mCSB_container.outerHeight(false) - mCustomScrollBox.height(), mCSB_container.outerWidth(false) - mCustomScrollBox.width()],
                    ratio = [
                        scrollAmount[0] / (mCSB_dragger[0].parent().height() - mCSB_dragger[0].height()),
                        scrollAmount[1] / (mCSB_dragger[1].parent().width() - mCSB_dragger[1].width())
                    ];
                d.scrollRatio = {
                    y: ratio[0],
                    x: ratio[1]
                };
            },
            /* -------------------- */


            /* toggles scrolling classes */
            _onDragClasses = function(el, action, xpnd) {
                var expandClass = xpnd ? classes[0] + "_expanded" : "",
                    scrollbar = el.closest(".mCSB_scrollTools");
                if (action === "active") {
                    el.toggleClass(classes[0] + " " + expandClass);
                    scrollbar.toggleClass(classes[1]);
                    el[0]._draggable = el[0]._draggable ? 0 : 1;
                } else {
                    if (!el[0]._draggable) {
                        if (action === "hide") {
                            el.removeClass(classes[0]);
                            scrollbar.removeClass(classes[1]);
                        } else {
                            el.addClass(classes[0]);
                            scrollbar.addClass(classes[1]);
                        }
                    }
                }
            },
            /* -------------------- */


            /* checks if content overflows its container to determine if scrolling is required */
            _overflowed = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    mCustomScrollBox = $j("#mCSB_" + d.idx),
                    mCSB_container = $j("#mCSB_" + d.idx + "_container"),
                    contentHeight = d.overflowed == null ? mCSB_container.height() : mCSB_container.outerHeight(false),
                    contentWidth = d.overflowed == null ? mCSB_container.width() : mCSB_container.outerWidth(false);
                return [contentHeight > mCustomScrollBox.height(), contentWidth > mCustomScrollBox.width()];
            },
            /* -------------------- */


            /* resets content position to 0 */
            _resetContentPosition = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt,
                    mCustomScrollBox = $j("#mCSB_" + d.idx),
                    mCSB_container = $j("#mCSB_" + d.idx + "_container"),
                    mCSB_dragger = [$j("#mCSB_" + d.idx + "_dragger_vertical"), $j("#mCSB_" + d.idx + "_dragger_horizontal")];
                _stop($this); /* stop any current scrolling before resetting */
                if ((o.axis !== "x" && !d.overflowed[0]) || (o.axis === "y" && d.overflowed[0])) { /* reset y */
                    mCSB_dragger[0].add(mCSB_container).css("top", 0);
                    _scrollTo($this, "_resetY");
                }
                if ((o.axis !== "y" && !d.overflowed[1]) || (o.axis === "x" && d.overflowed[1])) { /* reset x */
                    var cx = dx = 0;
                    if (d.langDir === "rtl") { /* adjust left position for rtl direction */
                        cx = mCustomScrollBox.width() - mCSB_container.outerWidth(false);
                        dx = Math.abs(cx / d.scrollRatio.x);
                    }
                    mCSB_container.css("left", cx);
                    mCSB_dragger[1].css("left", dx);
                    _scrollTo($this, "_resetX");
                }
            },
            /* -------------------- */


            /* binds scrollbar events */
            _bindEvents = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt;
                if (!d.bindEvents) { /* check if events are already bound */
                    _draggable.call(this);
                    if (o.contentTouchScroll) {
                        _contentDraggable.call(this);
                    }
                    _selectable.call(this);
                    if (o.mouseWheel.enable) { /* bind mousewheel fn when plugin is available */
                        function _mwt() {
                            mousewheelTimeout = setTimeout(function() {
                                if (!$j.event.special.mousewheel) {
                                    _mwt();
                                } else {
                                    clearTimeout(mousewheelTimeout);
                                    _mousewheel.call($this[0]);
                                }
                            }, 100);
                        }
                        var mousewheelTimeout;
                        _mwt();
                    }
                    _draggerRail.call(this);
                    _wrapperScroll.call(this);
                    if (o.advanced.autoScrollOnFocus) {
                        _focus.call(this);
                    }
                    if (o.scrollButtons.enable) {
                        _buttons.call(this);
                    }
                    if (o.keyboard.enable) {
                        _keyboard.call(this);
                    }
                    d.bindEvents = true;
                }
            },
            /* -------------------- */


            /* unbinds scrollbar events */
            _unbindEvents = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt,
                    namespace = pluginPfx + "_" + d.idx,
                    sb = ".mCSB_" + d.idx + "_scrollbar",
                    sel = $j("#mCSB_" + d.idx + ",#mCSB_" + d.idx + "_container,#mCSB_" + d.idx + "_container_wrapper," + sb + " ." + classes[12] + ",#mCSB_" + d.idx + "_dragger_vertical,#mCSB_" + d.idx + "_dragger_horizontal," + sb + ">a"),
                    mCSB_container = $j("#mCSB_" + d.idx + "_container");
                if (o.advanced.releaseDraggableSelectors) {
                    sel.add($j(o.advanced.releaseDraggableSelectors));
                }
                if (d.bindEvents) { /* check if events are bound */
                    /* unbind namespaced events from document/selectors */
                    $j(document).unbind("." + namespace);
                    sel.each(function() {
                        $j(this).unbind("." + namespace);
                    });
                    /* clear and delete timeouts/objects */
                    clearTimeout($this[0]._focusTimeout);
                    _delete($this[0], "_focusTimeout");
                    clearTimeout(d.sequential.step);
                    _delete(d.sequential, "step");
                    clearTimeout(mCSB_container[0].onCompleteTimeout);
                    _delete(mCSB_container[0], "onCompleteTimeout");
                    d.bindEvents = false;
                }
            },
            /* -------------------- */


            /* toggles scrollbar visibility */
            _scrollbarVisibility = function(disabled) {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt,
                    contentWrapper = $j("#mCSB_" + d.idx + "_container_wrapper"),
                    content = contentWrapper.length ? contentWrapper : $j("#mCSB_" + d.idx + "_container"),
                    scrollbar = [$j("#mCSB_" + d.idx + "_scrollbar_vertical"), $j("#mCSB_" + d.idx + "_scrollbar_horizontal")],
                    mCSB_dragger = [scrollbar[0].find(".mCSB_dragger"), scrollbar[1].find(".mCSB_dragger")];
                if (o.axis !== "x") {
                    if (d.overflowed[0] && !disabled) {
                        scrollbar[0].add(mCSB_dragger[0]).add(scrollbar[0].children("a")).css("display", "block");
                        content.removeClass(classes[8] + " " + classes[10]);
                    } else {
                        if (o.alwaysShowScrollbar) {
                            if (o.alwaysShowScrollbar !== 2) {
                                mCSB_dragger[0].css("display", "none");
                            }
                            content.removeClass(classes[10]);
                        } else {
                            scrollbar[0].css("display", "none");
                            content.addClass(classes[10]);
                        }
                        content.addClass(classes[8]);
                    }
                }
                if (o.axis !== "y") {
                    if (d.overflowed[1] && !disabled) {
                        scrollbar[1].add(mCSB_dragger[1]).add(scrollbar[1].children("a")).css("display", "block");
                        content.removeClass(classes[9] + " " + classes[11]);
                    } else {
                        if (o.alwaysShowScrollbar) {
                            if (o.alwaysShowScrollbar !== 2) {
                                mCSB_dragger[1].css("display", "none");
                            }
                            content.removeClass(classes[11]);
                        } else {
                            scrollbar[1].css("display", "none");
                            content.addClass(classes[11]);
                        }
                        content.addClass(classes[9]);
                    }
                }
                if (!d.overflowed[0] && !d.overflowed[1]) {
                    $this.addClass(classes[5]);
                } else {
                    $this.removeClass(classes[5]);
                }
            },
            /* -------------------- */


            /* returns input coordinates of pointer, touch and mouse events (relative to document) */
            _coordinates = function(e) {
                var t = e.type;
                switch (t) {
                    case "pointerdown":
                    case "MSPointerDown":
                    case "pointermove":
                    case "MSPointerMove":
                    case "pointerup":
                    case "MSPointerUp":
                        return e.target.ownerDocument !== document ? [e.originalEvent.screenY, e.originalEvent.screenX, false] : [e.originalEvent.pageY, e.originalEvent.pageX, false];
                        break;
                    case "touchstart":
                    case "touchmove":
                    case "touchend":
                        var touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0],
                            touches = e.originalEvent.touches.length || e.originalEvent.changedTouches.length;
                        return e.target.ownerDocument !== document ? [touch.screenY, touch.screenX, touches > 1] : [touch.pageY, touch.pageX, touches > 1];
                        break;
                    default:
                        return [e.pageY, e.pageX, false];
                }
            },
            /* -------------------- */


            /* 
            SCROLLBAR DRAG EVENTS
            scrolls content via scrollbar dragging 
            */
            _draggable = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt,
                    namespace = pluginPfx + "_" + d.idx,
                    draggerId = ["mCSB_" + d.idx + "_dragger_vertical", "mCSB_" + d.idx + "_dragger_horizontal"],
                    mCSB_container = $j("#mCSB_" + d.idx + "_container"),
                    mCSB_dragger = $j("#" + draggerId[0] + ",#" + draggerId[1]),
                    draggable, dragY, dragX,
                    rds = o.advanced.releaseDraggableSelectors ? mCSB_dragger.add($j(o.advanced.releaseDraggableSelectors)) : mCSB_dragger;
                mCSB_dragger.bind("mousedown." + namespace + " touchstart." + namespace + " pointerdown." + namespace + " MSPointerDown." + namespace, function(e) {
                    e.stopImmediatePropagation();
                    e.preventDefault();
                    if (!_mouseBtnLeft(e)) {
                        return;
                    } /* left mouse button only */
                    touchActive = true;
                    if (oldIE) {
                        document.onselectstart = function() {
                            return false;
                        }
                    } /* disable text selection for IE < 9 */
                    _iframe(false); /* enable scrollbar dragging over iframes by disabling their events */
                    _stop($this);
                    draggable = $j(this);
                    var offset = draggable.offset(),
                        y = _coordinates(e)[0] - offset.top,
                        x = _coordinates(e)[1] - offset.left,
                        h = draggable.height() + offset.top,
                        w = draggable.width() + offset.left;
                    if (y < h && y > 0 && x < w && x > 0) {
                        dragY = y;
                        dragX = x;
                    }
                    _onDragClasses(draggable, "active", o.autoExpandScrollbar);
                }).bind("touchmove." + namespace, function(e) {
                    e.stopImmediatePropagation();
                    e.preventDefault();
                    var offset = draggable.offset(),
                        y = _coordinates(e)[0] - offset.top,
                        x = _coordinates(e)[1] - offset.left;
                    _drag(dragY, dragX, y, x);
                });
                $j(document).bind("mousemove." + namespace + " pointermove." + namespace + " MSPointerMove." + namespace, function(e) {
                    if (draggable) {
                        var offset = draggable.offset(),
                            y = _coordinates(e)[0] - offset.top,
                            x = _coordinates(e)[1] - offset.left;
                        if (dragY === y) {
                            return;
                        } /* has it really moved? */
                        _drag(dragY, dragX, y, x);
                    }
                }).add(rds).bind("mouseup." + namespace + " touchend." + namespace + " pointerup." + namespace + " MSPointerUp." + namespace, function(e) {
                    if (draggable) {
                        _onDragClasses(draggable, "active", o.autoExpandScrollbar);
                        draggable = null;
                    }
                    touchActive = false;
                    if (oldIE) {
                        document.onselectstart = null;
                    } /* enable text selection for IE < 9 */
                    _iframe(true); /* enable iframes events */
                });

                function _iframe(evt) {
                    var el = mCSB_container.find("iframe");
                    if (!el.length) {
                        return;
                    } /* check if content contains iframes */
                    var val = !evt ? "none" : "auto";
                    el.css("pointer-events", val); /* for IE11, iframe's display property should not be "block" */
                }

                function _drag(dragY, dragX, y, x) {
                    mCSB_container[0].idleTimer = o.scrollInertia < 233 ? 250 : 0;
                    if (draggable.attr("id") === draggerId[1]) {
                        var dir = "x",
                            to = ((draggable[0].offsetLeft - dragX) + x) * d.scrollRatio.x;
                    } else {
                        var dir = "y",
                            to = ((draggable[0].offsetTop - dragY) + y) * d.scrollRatio.y;
                    }
                    _scrollTo($this, to.toString(), {
                        dir: dir,
                        drag: true
                    });
                }
            },
            /* -------------------- */


            /* 
            TOUCH SWIPE EVENTS
            scrolls content via touch swipe 
            Emulates the native touch-swipe scrolling with momentum found in iOS, Android and WP devices 
            */
            _contentDraggable = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt,
                    namespace = pluginPfx + "_" + d.idx,
                    mCustomScrollBox = $j("#mCSB_" + d.idx),
                    mCSB_container = $j("#mCSB_" + d.idx + "_container"),
                    mCSB_dragger = [$j("#mCSB_" + d.idx + "_dragger_vertical"), $j("#mCSB_" + d.idx + "_dragger_horizontal")],
                    dragY, dragX, touchStartY, touchStartX, touchMoveY = [],
                    touchMoveX = [],
                    startTime, runningTime, endTime, distance, speed, amount,
                    durA = 0,
                    durB, overwrite = o.axis === "yx" ? "none" : "all",
                    touchIntent = [],
                    touchDrag, docDrag,
                    iframe = mCSB_container.find("iframe"),
                    events = [
                        "touchstart." + namespace + " pointerdown." + namespace + " MSPointerDown." + namespace, //start
                        "touchmove." + namespace + " pointermove." + namespace + " MSPointerMove." + namespace, //move
                        "touchend." + namespace + " pointerup." + namespace + " MSPointerUp." + namespace //end
                    ];
                mCSB_container.bind(events[0], function(e) {
                    _onTouchstart(e);
                }).bind(events[1], function(e) {
                    _onTouchmove(e);
                });
                mCustomScrollBox.bind(events[0], function(e) {
                    _onTouchstart2(e);
                }).bind(events[2], function(e) {
                    _onTouchend(e);
                });
                if (iframe.length) {
                    iframe.each(function() {
                        $j(this).load(function() {
                            /* bind events on accessible iframes */
                            if (_canAccessIFrame(this)) {
                                $j(this.contentDocument || this.contentWindow.document).bind(events[0], function(e) {
                                    _onTouchstart(e);
                                    _onTouchstart2(e);
                                }).bind(events[1], function(e) {
                                    _onTouchmove(e);
                                }).bind(events[2], function(e) {
                                    _onTouchend(e);
                                });
                            }
                        });
                    });
                }

                function _onTouchstart(e) {
                    if (!_pointerTouch(e) || touchActive || _coordinates(e)[2]) {
                        touchable = 0;
                        return;
                    }
                    touchable = 1;
                    touchDrag = 0;
                    docDrag = 0;
                    $this.removeClass("mCS_touch_action");
                    var offset = mCSB_container.offset();
                    dragY = _coordinates(e)[0] - offset.top;
                    dragX = _coordinates(e)[1] - offset.left;
                    touchIntent = [_coordinates(e)[0], _coordinates(e)[1]];
                }

                function _onTouchmove(e) {
                    if (!_pointerTouch(e) || touchActive || _coordinates(e)[2]) {
                        return;
                    }
                    e.stopImmediatePropagation();
                    if (docDrag && !touchDrag) {
                        return;
                    }
                    runningTime = _getTime();
                    var offset = mCustomScrollBox.offset(),
                        y = _coordinates(e)[0] - offset.top,
                        x = _coordinates(e)[1] - offset.left,
                        easing = "mcsLinearOut";
                    touchMoveY.push(y);
                    touchMoveX.push(x);
                    touchIntent[2] = Math.abs(_coordinates(e)[0] - touchIntent[0]);
                    touchIntent[3] = Math.abs(_coordinates(e)[1] - touchIntent[1]);
                    if (d.overflowed[0]) {
                        var limit = mCSB_dragger[0].parent().height() - mCSB_dragger[0].height(),
                            prevent = ((dragY - y) > 0 && (y - dragY) > -(limit * d.scrollRatio.y) && (touchIntent[3] * 2 < touchIntent[2] || o.axis === "yx"));
                    }
                    if (d.overflowed[1]) {
                        var limitX = mCSB_dragger[1].parent().width() - mCSB_dragger[1].width(),
                            preventX = ((dragX - x) > 0 && (x - dragX) > -(limitX * d.scrollRatio.x) && (touchIntent[2] * 2 < touchIntent[3] || o.axis === "yx"));
                    }
                    if (prevent || preventX) { /* prevent native document scrolling */
                        e.preventDefault();
                        touchDrag = 1;
                    } else {
                        docDrag = 1;
                        $this.addClass("mCS_touch_action");
                    }
                    amount = o.axis === "yx" ? [(dragY - y), (dragX - x)] : o.axis === "x" ? [null, (dragX - x)] : [(dragY - y), null];
                    mCSB_container[0].idleTimer = 250;
                    if (d.overflowed[0]) {
                        _drag(amount[0], durA, easing, "y", "all", true);
                    }
                    if (d.overflowed[1]) {
                        _drag(amount[1], durA, easing, "x", overwrite, true);
                    }
                }

                function _onTouchstart2(e) {
                    if (!_pointerTouch(e) || touchActive || _coordinates(e)[2]) {
                        touchable = 0;
                        return;
                    }
                    touchable = 1;
                    e.stopImmediatePropagation();
                    _stop($this);
                    startTime = _getTime();
                    var offset = mCustomScrollBox.offset();
                    touchStartY = _coordinates(e)[0] - offset.top;
                    touchStartX = _coordinates(e)[1] - offset.left;
                    touchMoveY = [];
                    touchMoveX = [];
                }

                function _onTouchend(e) {
                    if (!_pointerTouch(e) || touchActive || _coordinates(e)[2]) {
                        return;
                    }
                    e.stopImmediatePropagation();
                    touchDrag = 0;
                    docDrag = 0;
                    endTime = _getTime();
                    var offset = mCustomScrollBox.offset(),
                        y = _coordinates(e)[0] - offset.top,
                        x = _coordinates(e)[1] - offset.left;
                    if ((endTime - runningTime) > 30) {
                        return;
                    }
                    speed = 1000 / (endTime - startTime);
                    var easing = "mcsEaseOut",
                        slow = speed < 2.5,
                        diff = slow ? [touchMoveY[touchMoveY.length - 2], touchMoveX[touchMoveX.length - 2]] : [0, 0];
                    distance = slow ? [(y - diff[0]), (x - diff[1])] : [y - touchStartY, x - touchStartX];
                    var absDistance = [Math.abs(distance[0]), Math.abs(distance[1])];
                    speed = slow ? [Math.abs(distance[0] / 4), Math.abs(distance[1] / 4)] : [speed, speed];
                    var a = [
                        Math.abs(mCSB_container[0].offsetTop) - (distance[0] * _m((absDistance[0] / speed[0]), speed[0])),
                        Math.abs(mCSB_container[0].offsetLeft) - (distance[1] * _m((absDistance[1] / speed[1]), speed[1]))
                    ];
                    amount = o.axis === "yx" ? [a[0], a[1]] : o.axis === "x" ? [null, a[1]] : [a[0], null];
                    durB = [(absDistance[0] * 4) + o.scrollInertia, (absDistance[1] * 4) + o.scrollInertia];
                    var md = parseInt(o.contentTouchScroll) || 0; /* absolute minimum distance required */
                    amount[0] = absDistance[0] > md ? amount[0] : 0;
                    amount[1] = absDistance[1] > md ? amount[1] : 0;
                    if (d.overflowed[0]) {
                        _drag(amount[0], durB[0], easing, "y", overwrite, false);
                    }
                    if (d.overflowed[1]) {
                        _drag(amount[1], durB[1], easing, "x", overwrite, false);
                    }
                }

                function _m(ds, s) {
                    var r = [s * 1.5, s * 2, s / 1.5, s / 2];
                    if (ds > 90) {
                        return s > 4 ? r[0] : r[3];
                    } else if (ds > 60) {
                        return s > 3 ? r[3] : r[2];
                    } else if (ds > 30) {
                        return s > 8 ? r[1] : s > 6 ? r[0] : s > 4 ? s : r[2];
                    } else {
                        return s > 8 ? s : r[3];
                    }
                }

                function _drag(amount, dur, easing, dir, overwrite, drag) {
                    if (!amount) {
                        return;
                    }
                    _scrollTo($this, amount.toString(), {
                        dur: dur,
                        scrollEasing: easing,
                        dir: dir,
                        overwrite: overwrite,
                        drag: drag
                    });
                }
            },
            /* -------------------- */


            /* 
            SELECT TEXT EVENTS 
            scrolls content when text is selected 
            */
            _selectable = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt,
                    seq = d.sequential,
                    namespace = pluginPfx + "_" + d.idx,
                    mCSB_container = $j("#mCSB_" + d.idx + "_container"),
                    wrapper = mCSB_container.parent(),
                    action;
                mCSB_container.bind("mousedown." + namespace, function(e) {
                    if (touchable) {
                        return;
                    }
                    if (!action) {
                        action = 1;
                        touchActive = true;
                    }
                }).add(document).bind("mousemove." + namespace, function(e) {
                    if (!touchable && action && _sel()) {
                        var offset = mCSB_container.offset(),
                            y = _coordinates(e)[0] - offset.top + mCSB_container[0].offsetTop,
                            x = _coordinates(e)[1] - offset.left + mCSB_container[0].offsetLeft;
                        if (y > 0 && y < wrapper.height() && x > 0 && x < wrapper.width()) {
                            if (seq.step) {
                                _seq("off", null, "stepped");
                            }
                        } else {
                            if (o.axis !== "x" && d.overflowed[0]) {
                                if (y < 0) {
                                    _seq("on", 38);
                                } else if (y > wrapper.height()) {
                                    _seq("on", 40);
                                }
                            }
                            if (o.axis !== "y" && d.overflowed[1]) {
                                if (x < 0) {
                                    _seq("on", 37);
                                } else if (x > wrapper.width()) {
                                    _seq("on", 39);
                                }
                            }
                        }
                    }
                }).bind("mouseup." + namespace, function(e) {
                    if (touchable) {
                        return;
                    }
                    if (action) {
                        action = 0;
                        _seq("off", null);
                    }
                    touchActive = false;
                });

                function _sel() {
                    return window.getSelection ? window.getSelection().toString() :
                        document.selection && document.selection.type != "Control" ? document.selection.createRange().text : 0;
                }

                function _seq(a, c, s) {
                    seq.type = s && action ? "stepped" : "stepless";
                    seq.scrollAmount = 10;
                    _sequentialScroll($this, a, c, "mcsLinearOut", s ? 60 : null);
                }
            },
            /* -------------------- */


            /* 
            MOUSE WHEEL EVENT
            scrolls content via mouse-wheel 
            via mouse-wheel plugin (https://github.com/brandonaaron/jquery-mousewheel)
            */
            _mousewheel = function() {
                if (!$j(this).data(pluginPfx)) {
                    return;
                } /* Check if the scrollbar is ready to use mousewheel events (issue: #185) */
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt,
                    namespace = pluginPfx + "_" + d.idx,
                    mCustomScrollBox = $j("#mCSB_" + d.idx),
                    mCSB_dragger = [$j("#mCSB_" + d.idx + "_dragger_vertical"), $j("#mCSB_" + d.idx + "_dragger_horizontal")],
                    iframe = $j("#mCSB_" + d.idx + "_container").find("iframe");
                if (iframe.length) {
                    iframe.each(function() {
                        $j(this).load(function() {
                            /* bind events on accessible iframes */
                            if (_canAccessIFrame(this)) {
                                $j(this.contentDocument || this.contentWindow.document).bind("mousewheel." + namespace, function(e, delta) {
                                    _onMousewheel(e, delta);
                                });
                            }
                        });
                    });
                }
                mCustomScrollBox.bind("mousewheel." + namespace, function(e, delta) {
                    _onMousewheel(e, delta);
                });

                function _onMousewheel(e, delta) {
                    _stop($this);
                    if (_disableMousewheel($this, e.target)) {
                        return;
                    } /* disables mouse-wheel when hovering specific elements */
                    var deltaFactor = o.mouseWheel.deltaFactor !== "auto" ? parseInt(o.mouseWheel.deltaFactor) : (oldIE && e.deltaFactor < 100) ? 100 : e.deltaFactor || 100;
                    if (o.axis === "x" || o.mouseWheel.axis === "x") {
                        var dir = "x",
                            px = [Math.round(deltaFactor * d.scrollRatio.x), parseInt(o.mouseWheel.scrollAmount)],
                            amount = o.mouseWheel.scrollAmount !== "auto" ? px[1] : px[0] >= mCustomScrollBox.width() ? mCustomScrollBox.width() * 0.9 : px[0],
                            contentPos = Math.abs($j("#mCSB_" + d.idx + "_container")[0].offsetLeft),
                            draggerPos = mCSB_dragger[1][0].offsetLeft,
                            limit = mCSB_dragger[1].parent().width() - mCSB_dragger[1].width(),
                            dlt = e.deltaX || e.deltaY || delta;
                    } else {
                        var dir = "y",
                            px = [Math.round(deltaFactor * d.scrollRatio.y), parseInt(o.mouseWheel.scrollAmount)],
                            amount = o.mouseWheel.scrollAmount !== "auto" ? px[1] : px[0] >= mCustomScrollBox.height() ? mCustomScrollBox.height() * 0.9 : px[0],
                            contentPos = Math.abs($j("#mCSB_" + d.idx + "_container")[0].offsetTop),
                            draggerPos = mCSB_dragger[0][0].offsetTop,
                            limit = mCSB_dragger[0].parent().height() - mCSB_dragger[0].height(),
                            dlt = e.deltaY || delta;
                    }
                    if ((dir === "y" && !d.overflowed[0]) || (dir === "x" && !d.overflowed[1])) {
                        return;
                    }
                    if (o.mouseWheel.invert || e.webkitDirectionInvertedFromDevice) {
                        dlt = -dlt;
                    }
                    if (o.mouseWheel.normalizeDelta) {
                        dlt = dlt < 0 ? -1 : 1;
                    }
                    if ((dlt > 0 && draggerPos !== 0) || (dlt < 0 && draggerPos !== limit) || o.mouseWheel.preventDefault) {
                        e.stopImmediatePropagation();
                        e.preventDefault();
                    }
                    _scrollTo($this, (contentPos - (dlt * amount)).toString(), {
                        dir: dir
                    });
                }
            },
            /* -------------------- */


            /* checks if iframe can be accessed */
            _canAccessIFrame = function(iframe) {
                var html = null;
                try {
                    var doc = iframe.contentDocument || iframe.contentWindow.document;
                    html = doc.body.innerHTML;
                } catch (err) { /* do nothing */ }
                return (html !== null);
            },
            /* -------------------- */


            /* disables mouse-wheel when hovering specific elements like select, datalist etc. */
            _disableMousewheel = function(el, target) {
                var tag = target.nodeName.toLowerCase(),
                    tags = el.data(pluginPfx).opt.mouseWheel.disableOver,
                    /* elements that require focus */
                    focusTags = ["select", "textarea"];
                return $j.inArray(tag, tags) > -1 && !($j.inArray(tag, focusTags) > -1 && !$j(target).is(":focus"));
            },
            /* -------------------- */


            /* 
            DRAGGER RAIL CLICK EVENT
            scrolls content via dragger rail 
            */
            _draggerRail = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    namespace = pluginPfx + "_" + d.idx,
                    mCSB_container = $j("#mCSB_" + d.idx + "_container"),
                    wrapper = mCSB_container.parent(),
                    mCSB_draggerContainer = $j(".mCSB_" + d.idx + "_scrollbar ." + classes[12]);
                mCSB_draggerContainer.bind("touchstart." + namespace + " pointerdown." + namespace + " MSPointerDown." + namespace, function(e) {
                    touchActive = true;
                }).bind("touchend." + namespace + " pointerup." + namespace + " MSPointerUp." + namespace, function(e) {
                    touchActive = false;
                }).bind("click." + namespace, function(e) {
                    if ($j(e.target).hasClass(classes[12]) || $j(e.target).hasClass("mCSB_draggerRail")) {
                        _stop($this);
                        var el = $j(this),
                            mCSB_dragger = el.find(".mCSB_dragger");
                        if (el.parent(".mCSB_scrollTools_horizontal").length > 0) {
                            if (!d.overflowed[1]) {
                                return;
                            }
                            var dir = "x",
                                clickDir = e.pageX > mCSB_dragger.offset().left ? -1 : 1,
                                to = Math.abs(mCSB_container[0].offsetLeft) - (clickDir * (wrapper.width() * 0.9));
                        } else {
                            if (!d.overflowed[0]) {
                                return;
                            }
                            var dir = "y",
                                clickDir = e.pageY > mCSB_dragger.offset().top ? -1 : 1,
                                to = Math.abs(mCSB_container[0].offsetTop) - (clickDir * (wrapper.height() * 0.9));
                        }
                        _scrollTo($this, to.toString(), {
                            dir: dir,
                            scrollEasing: "mcsEaseInOut"
                        });
                    }
                });
            },
            /* -------------------- */


            /* 
            FOCUS EVENT
            scrolls content via element focus (e.g. clicking an input, pressing TAB key etc.)
            */
            _focus = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt,
                    namespace = pluginPfx + "_" + d.idx,
                    mCSB_container = $j("#mCSB_" + d.idx + "_container"),
                    wrapper = mCSB_container.parent();
                mCSB_container.bind("focusin." + namespace, function(e) {
                    var el = $j(document.activeElement),
                        nested = mCSB_container.find(".mCustomScrollBox").length,
                        dur = 0;
                    if (!el.is(o.advanced.autoScrollOnFocus)) {
                        return;
                    }
                    _stop($this);
                    clearTimeout($this[0]._focusTimeout);
                    $this[0]._focusTimer = nested ? (dur + 17) * nested : 0;
                    $this[0]._focusTimeout = setTimeout(function() {
                        var to = [_childPos(el)[0], _childPos(el)[1]],
                            contentPos = [mCSB_container[0].offsetTop, mCSB_container[0].offsetLeft],
                            isVisible = [
                                (contentPos[0] + to[0] >= 0 && contentPos[0] + to[0] < wrapper.height() - el.outerHeight(false)),
                                (contentPos[1] + to[1] >= 0 && contentPos[0] + to[1] < wrapper.width() - el.outerWidth(false))
                            ],
                            overwrite = (o.axis === "yx" && !isVisible[0] && !isVisible[1]) ? "none" : "all";
                        if (o.axis !== "x" && !isVisible[0]) {
                            _scrollTo($this, to[0].toString(), {
                                dir: "y",
                                scrollEasing: "mcsEaseInOut",
                                overwrite: overwrite,
                                dur: dur
                            });
                        }
                        if (o.axis !== "y" && !isVisible[1]) {
                            _scrollTo($this, to[1].toString(), {
                                dir: "x",
                                scrollEasing: "mcsEaseInOut",
                                overwrite: overwrite,
                                dur: dur
                            });
                        }
                    }, $this[0]._focusTimer);
                });
            },
            /* -------------------- */


            /* sets content wrapper scrollTop/scrollLeft always to 0 */
            _wrapperScroll = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    namespace = pluginPfx + "_" + d.idx,
                    wrapper = $j("#mCSB_" + d.idx + "_container").parent();
                wrapper.bind("scroll." + namespace, function(e) {
                    if (wrapper.scrollTop() !== 0 || wrapper.scrollLeft() !== 0) {
                        $j(".mCSB_" + d.idx + "_scrollbar").css("visibility", "hidden"); /* hide scrollbar(s) */
                    }
                });
            },
            /* -------------------- */


            /* 
            BUTTONS EVENTS
            scrolls content via up, down, left and right buttons 
            */
            _buttons = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt,
                    seq = d.sequential,
                    namespace = pluginPfx + "_" + d.idx,
                    sel = ".mCSB_" + d.idx + "_scrollbar",
                    btn = $j(sel + ">a");
                btn.bind("mousedown." + namespace + " touchstart." + namespace + " pointerdown." + namespace + " MSPointerDown." + namespace + " mouseup." + namespace + " touchend." + namespace + " pointerup." + namespace + " MSPointerUp." + namespace + " mouseout." + namespace + " pointerout." + namespace + " MSPointerOut." + namespace + " click." + namespace, function(e) {
                    e.preventDefault();
                    if (!_mouseBtnLeft(e)) {
                        return;
                    } /* left mouse button only */
                    var btnClass = $j(this).attr("class");
                    seq.type = o.scrollButtons.scrollType;
                    switch (e.type) {
                        case "mousedown":
                        case "touchstart":
                        case "pointerdown":
                        case "MSPointerDown":
                            if (seq.type === "stepped") {
                                return;
                            }
                            touchActive = true;
                            d.tweenRunning = false;
                            _seq("on", btnClass);
                            break;
                        case "mouseup":
                        case "touchend":
                        case "pointerup":
                        case "MSPointerUp":
                        case "mouseout":
                        case "pointerout":
                        case "MSPointerOut":
                            if (seq.type === "stepped") {
                                return;
                            }
                            touchActive = false;
                            if (seq.dir) {
                                _seq("off", btnClass);
                            }
                            break;
                        case "click":
                            if (seq.type !== "stepped" || d.tweenRunning) {
                                return;
                            }
                            _seq("on", btnClass);
                            break;
                    }

                    function _seq(a, c) {
                        seq.scrollAmount = o.snapAmount || o.scrollButtons.scrollAmount;
                        _sequentialScroll($this, a, c);
                    }
                });
            },
            /* -------------------- */


            /* 
            KEYBOARD EVENTS
            scrolls content via keyboard 
            Keys: up arrow, down arrow, left arrow, right arrow, PgUp, PgDn, Home, End
            */
            _keyboard = function() {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt,
                    seq = d.sequential,
                    namespace = pluginPfx + "_" + d.idx,
                    mCustomScrollBox = $j("#mCSB_" + d.idx),
                    mCSB_container = $j("#mCSB_" + d.idx + "_container"),
                    wrapper = mCSB_container.parent(),
                    editables = "input,textarea,select,datalist,keygen,[contenteditable='true']",
                    iframe = mCSB_container.find("iframe"),
                    events = ["blur." + namespace + " keydown." + namespace + " keyup." + namespace];
                if (iframe.length) {
                    iframe.each(function() {
                        $j(this).load(function() {
                            /* bind events on accessible iframes */
                            if (_canAccessIFrame(this)) {
                                $j(this.contentDocument || this.contentWindow.document).bind(events[0], function(e) {
                                    _onKeyboard(e);
                                });
                            }
                        });
                    });
                }
                mCustomScrollBox.attr("tabindex", "0").bind(events[0], function(e) {
                    _onKeyboard(e);
                });

                function _onKeyboard(e) {
                    switch (e.type) {
                        case "blur":
                            if (d.tweenRunning && seq.dir) {
                                _seq("off", null);
                            }
                            break;
                        case "keydown":
                        case "keyup":
                            var code = e.keyCode ? e.keyCode : e.which,
                                action = "on";
                            if ((o.axis !== "x" && (code === 38 || code === 40)) || (o.axis !== "y" && (code === 37 || code === 39))) {
                                /* up (38), down (40), left (37), right (39) arrows */
                                if (((code === 38 || code === 40) && !d.overflowed[0]) || ((code === 37 || code === 39) && !d.overflowed[1])) {
                                    return;
                                }
                                if (e.type === "keyup") {
                                    action = "off";
                                }
                                if (!$j(document.activeElement).is(editables)) {
                                    e.preventDefault();
                                    e.stopImmediatePropagation();
                                    _seq(action, code);
                                }
                            } else if (code === 33 || code === 34) {
                                /* PgUp (33), PgDn (34) */
                                if (d.overflowed[0] || d.overflowed[1]) {
                                    e.preventDefault();
                                    e.stopImmediatePropagation();
                                }
                                if (e.type === "keyup") {
                                    _stop($this);
                                    var keyboardDir = code === 34 ? -1 : 1;
                                    if (o.axis === "x" || (o.axis === "yx" && d.overflowed[1] && !d.overflowed[0])) {
                                        var dir = "x",
                                            to = Math.abs(mCSB_container[0].offsetLeft) - (keyboardDir * (wrapper.width() * 0.9));
                                    } else {
                                        var dir = "y",
                                            to = Math.abs(mCSB_container[0].offsetTop) - (keyboardDir * (wrapper.height() * 0.9));
                                    }
                                    _scrollTo($this, to.toString(), {
                                        dir: dir,
                                        scrollEasing: "mcsEaseInOut"
                                    });
                                }
                            } else if (code === 35 || code === 36) {
                                /* End (35), Home (36) */
                                if (!$j(document.activeElement).is(editables)) {
                                    if (d.overflowed[0] || d.overflowed[1]) {
                                        e.preventDefault();
                                        e.stopImmediatePropagation();
                                    }
                                    if (e.type === "keyup") {
                                        if (o.axis === "x" || (o.axis === "yx" && d.overflowed[1] && !d.overflowed[0])) {
                                            var dir = "x",
                                                to = code === 35 ? Math.abs(wrapper.width() - mCSB_container.outerWidth(false)) : 0;
                                        } else {
                                            var dir = "y",
                                                to = code === 35 ? Math.abs(wrapper.height() - mCSB_container.outerHeight(false)) : 0;
                                        }
                                        _scrollTo($this, to.toString(), {
                                            dir: dir,
                                            scrollEasing: "mcsEaseInOut"
                                        });
                                    }
                                }
                            }
                            break;
                    }

                    function _seq(a, c) {
                        seq.type = o.keyboard.scrollType;
                        seq.scrollAmount = o.snapAmount || o.keyboard.scrollAmount;
                        if (seq.type === "stepped" && d.tweenRunning) {
                            return;
                        }
                        _sequentialScroll($this, a, c);
                    }
                }
            },
            /* -------------------- */


            /* scrolls content sequentially (used when scrolling via buttons, keyboard arrows etc.) */
            _sequentialScroll = function(el, action, trigger, e, s) {
                var d = el.data(pluginPfx),
                    o = d.opt,
                    seq = d.sequential,
                    mCSB_container = $j("#mCSB_" + d.idx + "_container"),
                    once = seq.type === "stepped" ? true : false,
                    steplessSpeed = o.scrollInertia < 26 ? 26 : o.scrollInertia,
                    /* 26/1.5=17 */
                    steppedSpeed = o.scrollInertia < 1 ? 17 : o.scrollInertia;
                switch (action) {
                    case "on":
                        seq.dir = [
                            (trigger === classes[16] || trigger === classes[15] || trigger === 39 || trigger === 37 ? "x" : "y"),
                            (trigger === classes[13] || trigger === classes[15] || trigger === 38 || trigger === 37 ? -1 : 1)
                        ];
                        _stop(el);
                        if (_isNumeric(trigger) && seq.type === "stepped") {
                            return;
                        }
                        _on(once);
                        break;
                    case "off":
                        _off();
                        if (once || (d.tweenRunning && seq.dir)) {
                            _on(true);
                        }
                        break;
                }
                /* starts sequence */
                function _on(once) {
                    var c = seq.type !== "stepped",
                        /* continuous scrolling */
                        t = s ? s : !once ? 1000 / 60 : c ? steplessSpeed / 1.5 : steppedSpeed,
                        /* timer */
                        m = !once ? 2.5 : c ? 7.5 : 40,
                        /* multiplier */
                        contentPos = [Math.abs(mCSB_container[0].offsetTop), Math.abs(mCSB_container[0].offsetLeft)],
                        ratio = [d.scrollRatio.y > 10 ? 10 : d.scrollRatio.y, d.scrollRatio.x > 10 ? 10 : d.scrollRatio.x],
                        amount = seq.dir[0] === "x" ? contentPos[1] + (seq.dir[1] * (ratio[1] * m)) : contentPos[0] + (seq.dir[1] * (ratio[0] * m)),
                        px = seq.dir[0] === "x" ? contentPos[1] + (seq.dir[1] * parseInt(seq.scrollAmount)) : contentPos[0] + (seq.dir[1] * parseInt(seq.scrollAmount)),
                        to = seq.scrollAmount !== "auto" ? px : amount,
                        easing = e ? e : !once ? "mcsLinear" : c ? "mcsLinearOut" : "mcsEaseInOut",
                        onComplete = !once ? false : true;
                    if (once && t < 17) {
                        to = seq.dir[0] === "x" ? contentPos[1] : contentPos[0];
                    }
                    _scrollTo(el, to.toString(), {
                        dir: seq.dir[0],
                        scrollEasing: easing,
                        dur: t,
                        onComplete: onComplete
                    });
                    if (once) {
                        seq.dir = false;
                        return;
                    }
                    clearTimeout(seq.step);
                    seq.step = setTimeout(function() {
                        _on();
                    }, t);
                }
                /* stops sequence */
                function _off() {
                    clearTimeout(seq.step);
                    _delete(seq, "step");
                    _stop(el);
                }
            },
            /* -------------------- */


            /* returns a yx array from value */
            _arr = function(val) {
                var o = $j(this).data(pluginPfx).opt,
                    vals = [];
                if (typeof val === "function") {
                    val = val();
                } /* check if the value is a single anonymous function */
                /* check if value is object or array, its length and create an array with yx values */
                if (!(val instanceof Array)) { /* object value (e.g. {y:"100",x:"100"}, 100 etc.) */
                    vals[0] = val.y ? val.y : val.x || o.axis === "x" ? null : val;
                    vals[1] = val.x ? val.x : val.y || o.axis === "y" ? null : val;
                } else { /* array value (e.g. [100,100]) */
                    vals = val.length > 1 ? [val[0], val[1]] : o.axis === "x" ? [null, val[0]] : [val[0], null];
                }
                /* check if array values are anonymous functions */
                if (typeof vals[0] === "function") {
                    vals[0] = vals[0]();
                }
                if (typeof vals[1] === "function") {
                    vals[1] = vals[1]();
                }
                return vals;
            },
            /* -------------------- */


            /* translates values (e.g. "top", 100, "100px", "#id") to actual scroll-to positions */
            _to = function(val, dir) {
                if (val == null || typeof val == "undefined") {
                    return;
                }
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt,
                    mCSB_container = $j("#mCSB_" + d.idx + "_container"),
                    wrapper = mCSB_container.parent(),
                    t = typeof val;
                if (!dir) {
                    dir = o.axis === "x" ? "x" : "y";
                }
                var contentLength = dir === "x" ? mCSB_container.outerWidth(false) : mCSB_container.outerHeight(false),
                    contentPos = dir === "x" ? mCSB_container[0].offsetLeft : mCSB_container[0].offsetTop,
                    cssProp = dir === "x" ? "left" : "top";
                switch (t) {
                    case "function":
                        /* this currently is not used. Consider removing it */
                        return val();
                        break;
                    case "object":
                        /* js/jquery object */
                        var obj = val.jquery ? val : $j(val);
                        if (!obj.length) {
                            return;
                        }
                        return dir === "x" ? _childPos(obj)[1] : _childPos(obj)[0];
                        break;
                    case "string":
                    case "number":
                        if (_isNumeric(val)) { /* numeric value */
                            return Math.abs(val);
                        } else if (val.indexOf("%") !== -1) { /* percentage value */
                            return Math.abs(contentLength * parseInt(val) / 100);
                        } else if (val.indexOf("-=") !== -1) { /* decrease value */
                            return Math.abs(contentPos - parseInt(val.split("-=")[1]));
                        } else if (val.indexOf("+=") !== -1) { /* inrease value */
                            var p = (contentPos + parseInt(val.split("+=")[1]));
                            return p >= 0 ? 0 : Math.abs(p);
                        } else if (val.indexOf("px") !== -1 && _isNumeric(val.split("px")[0])) { /* pixels string value (e.g. "100px") */
                            return Math.abs(val.split("px")[0]);
                        } else {
                            if (val === "top" || val === "left") { /* special strings */
                                return 0;
                            } else if (val === "bottom") {
                                return Math.abs(wrapper.height() - mCSB_container.outerHeight(false));
                            } else if (val === "right") {
                                return Math.abs(wrapper.width() - mCSB_container.outerWidth(false));
                            } else if (val === "first" || val === "last") {
                                var obj = mCSB_container.find(":" + val);
                                return dir === "x" ? _childPos(obj)[1] : _childPos(obj)[0];
                            } else {
                                if ($j(val).length) { /* jquery selector */
                                    return dir === "x" ? _childPos($j(val))[1] : _childPos($j(val))[0];
                                } else { /* other values (e.g. "100em") */
                                    mCSB_container.css(cssProp, val);
                                    methods.update.call(null, $this[0]);
                                    return;
                                }
                            }
                        }
                        break;
                }
            },
            /* -------------------- */


            /* calls the update method automatically */
            _autoUpdate = function(rem) {
                var $this = $j(this),
                    d = $this.data(pluginPfx),
                    o = d.opt,
                    mCSB_container = $j("#mCSB_" + d.idx + "_container");
                if (rem) {
                    /* 
                    removes autoUpdate timer 
                    usage: _autoUpdate.call(this,"remove");
                    */
                    clearTimeout(mCSB_container[0].autoUpdate);
                    _delete(mCSB_container[0], "autoUpdate");
                    return;
                }
                var wrapper = mCSB_container.parent(),
                    scrollbar = [$j("#mCSB_" + d.idx + "_scrollbar_vertical"), $j("#mCSB_" + d.idx + "_scrollbar_horizontal")],
                    scrollbarSize = function() {
                        return [
                            scrollbar[0].is(":visible") ? scrollbar[0].outerHeight(true) : 0, /* returns y-scrollbar height */
                            scrollbar[1].is(":visible") ? scrollbar[1].outerWidth(true) : 0 /* returns x-scrollbar width */
                        ]
                    },
                    oldSelSize = sizesSum(),
                    newSelSize,
                    os = [mCSB_container.outerHeight(false), mCSB_container.outerWidth(false), wrapper.height(), wrapper.width(), scrollbarSize()[0], scrollbarSize()[1]],
                    ns,
                    oldImgsLen = imgSum(),
                    newImgsLen;
                upd();

                function upd() {
                    clearTimeout(mCSB_container[0].autoUpdate);
                    if ($this.parents("html").length === 0) {
                        /* check element in dom tree */
                        $this = null;
                        return;
                    }
                    mCSB_container[0].autoUpdate = setTimeout(function() {
                        /* update on specific selector(s) length and size change */
                        if (o.advanced.updateOnSelectorChange) {
                            newSelSize = sizesSum();
                            if (newSelSize !== oldSelSize) {
                                doUpd(3);
                                oldSelSize = newSelSize;
                                return;
                            }
                        }
                        /* update on main element and scrollbar size changes */
                        if (o.advanced.updateOnContentResize) {
                            ns = [mCSB_container.outerHeight(false), mCSB_container.outerWidth(false), wrapper.height(), wrapper.width(), scrollbarSize()[0], scrollbarSize()[1]];
                            if (ns[0] !== os[0] || ns[1] !== os[1] || ns[2] !== os[2] || ns[3] !== os[3] || ns[4] !== os[4] || ns[5] !== os[5]) {
                                doUpd(ns[0] !== os[0] || ns[1] !== os[1]);
                                os = ns;
                            }
                        }
                        /* update on image load */
                        if (o.advanced.updateOnImageLoad) {
                            newImgsLen = imgSum();
                            if (newImgsLen !== oldImgsLen) {
                                mCSB_container.find("img").each(function() {
                                    imgLoader(this);
                                });
                                oldImgsLen = newImgsLen;
                            }
                        }
                        if (o.advanced.updateOnSelectorChange || o.advanced.updateOnContentResize || o.advanced.updateOnImageLoad) {
                            upd();
                        }
                    }, o.advanced.autoUpdateTimeout);
                }
                /* returns images amount */
                function imgSum() {
                    var total = 0
                    if (o.advanced.updateOnImageLoad) {
                        total = mCSB_container.find("img").length;
                    }
                    return total;
                }
                /* a tiny image loader */
                function imgLoader(el) {
                    if ($j(el).hasClass(classes[2])) {
                        doUpd();
                        return;
                    }
                    var img = new Image();

                    function createDelegate(contextObject, delegateMethod) {
                        return function() {
                            return delegateMethod.apply(contextObject, arguments);
                        }
                    }

                    function imgOnLoad() {
                        this.onload = null;
                        $j(el).addClass(classes[2]);
                        doUpd(2);
                    }
                    img.onload = createDelegate(img, imgOnLoad);
                    img.src = el.src;
                }
                /* returns the total height and width sum of all elements matching the selector */
                function sizesSum() {
                    if (o.advanced.updateOnSelectorChange === true) {
                        o.advanced.updateOnSelectorChange = "*";
                    }
                    var total = 0,
                        sel = mCSB_container.find(o.advanced.updateOnSelectorChange);
                    if (o.advanced.updateOnSelectorChange && sel.length > 0) {
                        sel.each(function() {
                            total += $j(this).height() + $j(this).width();
                        });
                    }
                    return total;
                }
                /* calls the update method */
                function doUpd(cb) {
                    clearTimeout(mCSB_container[0].autoUpdate);
                    methods.update.call(null, $this[0], cb);
                }
            },
            /* -------------------- */


            /* snaps scrolling to a multiple of a pixels number */
            _snapAmount = function(to, amount, offset) {
                return (Math.round(to / amount) * amount - offset);
            },
            /* -------------------- */


            /* stops content and scrollbar animations */
            _stop = function(el) {
                var d = el.data(pluginPfx),
                    sel = $j("#mCSB_" + d.idx + "_container,#mCSB_" + d.idx + "_container_wrapper,#mCSB_" + d.idx + "_dragger_vertical,#mCSB_" + d.idx + "_dragger_horizontal");
                sel.each(function() {
                    _stopTween.call(this);
                });
            },
            /* -------------------- */


            /* 
            ANIMATES CONTENT 
            This is where the actual scrolling happens
            */
            _scrollTo = function(el, to, options) {
                var d = el.data(pluginPfx),
                    o = d.opt,
                    defaults = {
                        trigger: "internal",
                        dir: "y",
                        scrollEasing: "mcsEaseOut",
                        drag: false,
                        dur: o.scrollInertia,
                        overwrite: "all",
                        callbacks: true,
                        onStart: true,
                        onUpdate: true,
                        onComplete: true
                    },
                    options = $j.extend(defaults, options),
                    dur = [options.dur, (options.drag ? 0 : options.dur)],
                    mCustomScrollBox = $j("#mCSB_" + d.idx),
                    mCSB_container = $j("#mCSB_" + d.idx + "_container"),
                    wrapper = mCSB_container.parent(),
                    totalScrollOffsets = o.callbacks.onTotalScrollOffset ? _arr.call(el, o.callbacks.onTotalScrollOffset) : [0, 0],
                    totalScrollBackOffsets = o.callbacks.onTotalScrollBackOffset ? _arr.call(el, o.callbacks.onTotalScrollBackOffset) : [0, 0];
                d.trigger = options.trigger;
                if (wrapper.scrollTop() !== 0 || wrapper.scrollLeft() !== 0) { /* always reset scrollTop/Left */
                    $j(".mCSB_" + d.idx + "_scrollbar").css("visibility", "visible");
                    wrapper.scrollTop(0).scrollLeft(0);
                }
                if (to === "_resetY" && !d.contentReset.y) {
                    /* callbacks: onOverflowYNone */
                    if (_cb("onOverflowYNone")) {
                        o.callbacks.onOverflowYNone.call(el[0]);
                    }
                    d.contentReset.y = 1;
                }
                if (to === "_resetX" && !d.contentReset.x) {
                    /* callbacks: onOverflowXNone */
                    if (_cb("onOverflowXNone")) {
                        o.callbacks.onOverflowXNone.call(el[0]);
                    }
                    d.contentReset.x = 1;
                }
                if (to === "_resetY" || to === "_resetX") {
                    return;
                }
                if ((d.contentReset.y || !el[0].mcs) && d.overflowed[0]) {
                    /* callbacks: onOverflowY */
                    if (_cb("onOverflowY")) {
                        o.callbacks.onOverflowY.call(el[0]);
                    }
                    d.contentReset.x = null;
                }
                if ((d.contentReset.x || !el[0].mcs) && d.overflowed[1]) {
                    /* callbacks: onOverflowX */
                    if (_cb("onOverflowX")) {
                        o.callbacks.onOverflowX.call(el[0]);
                    }
                    d.contentReset.x = null;
                }
                if (o.snapAmount) {
                    to = _snapAmount(to, o.snapAmount, o.snapOffset);
                } /* scrolling snapping */
                switch (options.dir) {
                    case "x":
                        var mCSB_dragger = $j("#mCSB_" + d.idx + "_dragger_horizontal"),
                            property = "left",
                            contentPos = mCSB_container[0].offsetLeft,
                            limit = [
                                mCustomScrollBox.width() - mCSB_container.outerWidth(false),
                                mCSB_dragger.parent().width() - mCSB_dragger.width()
                            ],
                            scrollTo = [to, to === 0 ? 0 : (to / d.scrollRatio.x)],
                            tso = totalScrollOffsets[1],
                            tsbo = totalScrollBackOffsets[1],
                            totalScrollOffset = tso > 0 ? tso / d.scrollRatio.x : 0,
                            totalScrollBackOffset = tsbo > 0 ? tsbo / d.scrollRatio.x : 0;
                        break;
                    case "y":
                        var mCSB_dragger = $j("#mCSB_" + d.idx + "_dragger_vertical"),
                            property = "top",
                            contentPos = mCSB_container[0].offsetTop,
                            limit = [
                                mCustomScrollBox.height() - mCSB_container.outerHeight(false),
                                mCSB_dragger.parent().height() - mCSB_dragger.height()
                            ],
                            scrollTo = [to, to === 0 ? 0 : (to / d.scrollRatio.y)],
                            tso = totalScrollOffsets[0],
                            tsbo = totalScrollBackOffsets[0],
                            totalScrollOffset = tso > 0 ? tso / d.scrollRatio.y : 0,
                            totalScrollBackOffset = tsbo > 0 ? tsbo / d.scrollRatio.y : 0;
                        break;
                }
                if (scrollTo[1] < 0 || (scrollTo[0] === 0 && scrollTo[1] === 0)) {
                    scrollTo = [0, 0];
                } else if (scrollTo[1] >= limit[1]) {
                    scrollTo = [limit[0], limit[1]];
                } else {
                    scrollTo[0] = -scrollTo[0];
                }
                if (!el[0].mcs) {
                    _mcs(); /* init mcs object (once) to make it available before callbacks */
                    if (_cb("onInit")) {
                        o.callbacks.onInit.call(el[0]);
                    } /* callbacks: onInit */
                }
                clearTimeout(mCSB_container[0].onCompleteTimeout);
                if (!d.tweenRunning && ((contentPos === 0 && scrollTo[0] >= 0) || (contentPos === limit[0] && scrollTo[0] <= limit[0]))) {
                    return;
                }
                _tweenTo(mCSB_dragger[0], property, Math.round(scrollTo[1]), dur[1], options.scrollEasing);
                _tweenTo(mCSB_container[0], property, Math.round(scrollTo[0]), dur[0], options.scrollEasing, options.overwrite, {
                    onStart: function() {
                        if (options.callbacks && options.onStart && !d.tweenRunning) {
                            /* callbacks: onScrollStart */
                            if (_cb("onScrollStart")) {
                                _mcs();
                                o.callbacks.onScrollStart.call(el[0]);
                            }
                            d.tweenRunning = true;
                            _onDragClasses(mCSB_dragger);
                            d.cbOffsets = _cbOffsets();
                        }
                    },
                    onUpdate: function() {
                        if (options.callbacks && options.onUpdate) {
                            /* callbacks: whileScrolling */
                            if (_cb("whileScrolling")) {
                                _mcs();
                                o.callbacks.whileScrolling.call(el[0]);
                            }
                        }
                    },
                    onComplete: function() {
                        if (options.callbacks && options.onComplete) {
                            if (o.axis === "yx") {
                                clearTimeout(mCSB_container[0].onCompleteTimeout);
                            }
                            var t = mCSB_container[0].idleTimer || 0;
                            mCSB_container[0].onCompleteTimeout = setTimeout(function() {
                                /* callbacks: onScroll, onTotalScroll, onTotalScrollBack */
                                if (_cb("onScroll")) {
                                    _mcs();
                                    o.callbacks.onScroll.call(el[0]);
                                }
                                if (_cb("onTotalScroll") && scrollTo[1] >= limit[1] - totalScrollOffset && d.cbOffsets[0]) {
                                    _mcs();
                                    o.callbacks.onTotalScroll.call(el[0]);
                                }
                                if (_cb("onTotalScrollBack") && scrollTo[1] <= totalScrollBackOffset && d.cbOffsets[1]) {
                                    _mcs();
                                    o.callbacks.onTotalScrollBack.call(el[0]);
                                }
                                d.tweenRunning = false;
                                mCSB_container[0].idleTimer = 0;
                                _onDragClasses(mCSB_dragger, "hide");
                            }, t);
                        }
                    }
                });
                /* checks if callback function exists */
                function _cb(cb) {
                    return d && o.callbacks[cb] && typeof o.callbacks[cb] === "function";
                }
                /* checks whether callback offsets always trigger */
                function _cbOffsets() {
                    return [o.callbacks.alwaysTriggerOffsets || contentPos >= limit[0] + tso, o.callbacks.alwaysTriggerOffsets || contentPos <= -tsbo];
                }
                /* 
                populates object with useful values for the user 
                values: 
                	content: this.mcs.content
                	content top position: this.mcs.top 
                	content left position: this.mcs.left 
                	dragger top position: this.mcs.draggerTop 
                	dragger left position: this.mcs.draggerLeft 
                	scrolling y percentage: this.mcs.topPct 
                	scrolling x percentage: this.mcs.leftPct 
                	scrolling direction: this.mcs.direction
                */
                function _mcs() {
                    var cp = [mCSB_container[0].offsetTop, mCSB_container[0].offsetLeft],
                        /* content position */
                        dp = [mCSB_dragger[0].offsetTop, mCSB_dragger[0].offsetLeft],
                        /* dragger position */
                        cl = [mCSB_container.outerHeight(false), mCSB_container.outerWidth(false)],
                        /* content length */
                        pl = [mCustomScrollBox.height(), mCustomScrollBox.width()]; /* content parent length */
                    el[0].mcs = {
                        content: mCSB_container,
                        /* original content wrapper as jquery object */
                        top: cp[0],
                        left: cp[1],
                        draggerTop: dp[0],
                        draggerLeft: dp[1],
                        topPct: Math.round((100 * Math.abs(cp[0])) / (Math.abs(cl[0]) - pl[0])),
                        leftPct: Math.round((100 * Math.abs(cp[1])) / (Math.abs(cl[1]) - pl[1])),
                        direction: options.dir
                    };
                    /* 
                    this refers to the original element containing the scrollbar(s)
                    usage: this.mcs.top, this.mcs.leftPct etc. 
                    */
                }
            },
            /* -------------------- */


            /* 
            CUSTOM JAVASCRIPT ANIMATION TWEEN 
            Lighter and faster than jquery animate() and css transitions 
            Animates top/left properties and includes easings 
            */
            _tweenTo = function(el, prop, to, duration, easing, overwrite, callbacks) {
                if (!el._mTween) {
                    el._mTween = {
                        top: {},
                        left: {}
                    };
                }
                var callbacks = callbacks || {},
                    onStart = callbacks.onStart || function() {},
                    onUpdate = callbacks.onUpdate || function() {},
                    onComplete = callbacks.onComplete || function() {},
                    startTime = _getTime(),
                    _delay, progress = 0,
                    from = el.offsetTop,
                    elStyle = el.style,
                    _request, tobj = el._mTween[prop];
                if (prop === "left") {
                    from = el.offsetLeft;
                }
                var diff = to - from;
                tobj.stop = 0;
                if (overwrite !== "none") {
                    _cancelTween();
                }
                _startTween();

                function _step() {
                    if (tobj.stop) {
                        return;
                    }
                    if (!progress) {
                        onStart.call();
                    }
                    progress = _getTime() - startTime;
                    _tween();
                    if (progress >= tobj.time) {
                        tobj.time = (progress > tobj.time) ? progress + _delay - (progress - tobj.time) : progress + _delay - 1;
                        if (tobj.time < progress + 1) {
                            tobj.time = progress + 1;
                        }
                    }
                    if (tobj.time < duration) {
                        tobj.id = _request(_step);
                    } else {
                        onComplete.call();
                    }
                }

                function _tween() {
                    if (duration > 0) {
                        tobj.currVal = _ease(tobj.time, from, diff, duration, easing);
                        elStyle[prop] = Math.round(tobj.currVal) + "px";
                    } else {
                        elStyle[prop] = to + "px";
                    }
                    onUpdate.call();
                }

                function _startTween() {
                    _delay = 1000 / 60;
                    tobj.time = progress + _delay;
                    _request = (!window.requestAnimationFrame) ? function(f) {
                        _tween();
                        return setTimeout(f, 0.01);
                    } : window.requestAnimationFrame;
                    tobj.id = _request(_step);
                }

                function _cancelTween() {
                    if (tobj.id == null) {
                        return;
                    }
                    if (!window.requestAnimationFrame) {
                        clearTimeout(tobj.id);
                    } else {
                        window.cancelAnimationFrame(tobj.id);
                    }
                    tobj.id = null;
                }

                function _ease(t, b, c, d, type) {
                    switch (type) {
                        case "linear":
                        case "mcsLinear":
                            return c * t / d + b;
                            break;
                        case "mcsLinearOut":
                            t /= d;
                            t--;
                            return c * Math.sqrt(1 - t * t) + b;
                            break;
                        case "easeInOutSmooth":
                            t /= d / 2;
                            if (t < 1) return c / 2 * t * t + b;
                            t--;
                            return -c / 2 * (t * (t - 2) - 1) + b;
                            break;
                        case "easeInOutStrong":
                            t /= d / 2;
                            if (t < 1) return c / 2 * Math.pow(2, 10 * (t - 1)) + b;
                            t--;
                            return c / 2 * (-Math.pow(2, -10 * t) + 2) + b;
                            break;
                        case "easeInOut":
                        case "mcsEaseInOut":
                            t /= d / 2;
                            if (t < 1) return c / 2 * t * t * t + b;
                            t -= 2;
                            return c / 2 * (t * t * t + 2) + b;
                            break;
                        case "easeOutSmooth":
                            t /= d;
                            t--;
                            return -c * (t * t * t * t - 1) + b;
                            break;
                        case "easeOutStrong":
                            return c * (-Math.pow(2, -10 * t / d) + 1) + b;
                            break;
                        case "easeOut":
                        case "mcsEaseOut":
                        default:
                            var ts = (t /= d) * t,
                                tc = ts * t;
                            return b + c * (0.499999999999997 * tc * ts + -2.5 * ts * ts + 5.5 * tc + -6.5 * ts + 4 * t);
                    }
                }
            },
            /* -------------------- */


            /* returns current time */
            _getTime = function() {
                if (window.performance && window.performance.now) {
                    return window.performance.now();
                } else {
                    if (window.performance && window.performance.webkitNow) {
                        return window.performance.webkitNow();
                    } else {
                        if (Date.now) {
                            return Date.now();
                        } else {
                            return new Date().getTime();
                        }
                    }
                }
            },
            /* -------------------- */


            /* stops a tween */
            _stopTween = function() {
                var el = this;
                if (!el._mTween) {
                    el._mTween = {
                        top: {},
                        left: {}
                    };
                }
                var props = ["top", "left"];
                for (var i = 0; i < props.length; i++) {
                    var prop = props[i];
                    if (el._mTween[prop].id) {
                        if (!window.requestAnimationFrame) {
                            clearTimeout(el._mTween[prop].id);
                        } else {
                            window.cancelAnimationFrame(el._mTween[prop].id);
                        }
                        el._mTween[prop].id = null;
                        el._mTween[prop].stop = 1;
                    }
                }
            },
            /* -------------------- */


            /* deletes a property (avoiding the exception thrown by IE) */
            _delete = function(c, m) {
                try {
                    delete c[m];
                } catch (e) {
                    c[m] = null;
                }
            },
            /* -------------------- */


            /* detects left mouse button */
            _mouseBtnLeft = function(e) {
                return !(e.which && e.which !== 1);
            },
            /* -------------------- */


            /* detects if pointer type event is touch */
            _pointerTouch = function(e) {
                var t = e.originalEvent.pointerType;
                return !(t && t !== "touch" && t !== 2);
            },
            /* -------------------- */


            /* checks if value is numeric */
            _isNumeric = function(val) {
                return !isNaN(parseFloat(val)) && isFinite(val);
            },
            /* -------------------- */


            /* returns element position according to content */
            _childPos = function(el) {
                var p = el.parents(".mCSB_container");
                return [el.offset().top - p.offset().top, el.offset().left - p.offset().left];
            };
        /* -------------------- */





        /* 
        ----------------------------------------
        PLUGIN SETUP 
        ----------------------------------------
        */

        /* plugin constructor functions */
        $j.fn[pluginNS] = function(method) { /* usage: $j(selector).mCustomScrollbar(); */
            if (methods[method]) {
                return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
            } else if (typeof method === "object" || !method) {
                return methods.init.apply(this, arguments);
            } else {
                $j.error("Method " + method + " does not exist");
            }
        };
        $j[pluginNS] = function(method) { /* usage: $j.mCustomScrollbar(); */
            if (methods[method]) {
                return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
            } else if (typeof method === "object" || !method) {
                return methods.init.apply(this, arguments);
            } else {
                $j.error("Method " + method + " does not exist");
            }
        };

        /* 
        allow setting plugin default options. 
        usage: $j.mCustomScrollbar.defaults.scrollInertia=500; 
        to apply any changed default options on default selectors (below), use inside document ready fn 
        e.g.: $j(document).ready(function(){ $j.mCustomScrollbar.defaults.scrollInertia=500; });
        */
        $j[pluginNS].defaults = defaults;

        /* 
        add window object (window.mCustomScrollbar) 
        usage: if(window.mCustomScrollbar){console.log("custom scrollbar plugin loaded");}
        */
        window[pluginNS] = true;

        $j(window).load(function() {

            $j(defaultSelector)[pluginNS](); /* add scrollbars automatically on default selector */

            /* extend jQuery expressions */
            $j.extend($j.expr[":"], {
                /* checks if element is within scrollable viewport */
                mcsInView: $j.expr[":"].mcsInView || function(el) {
                    var $el = $j(el),
                        content = $el.parents(".mCSB_container"),
                        wrapper, cPos;
                    if (!content.length) {
                        return;
                    }
                    wrapper = content.parent();
                    cPos = [content[0].offsetTop, content[0].offsetLeft];
                    return cPos[0] + _childPos($el)[0] >= 0 && cPos[0] + _childPos($el)[0] < wrapper.height() - $el.outerHeight(false) &&
                        cPos[1] + _childPos($el)[1] >= 0 && cPos[1] + _childPos($el)[1] < wrapper.width() - $el.outerWidth(false);
                },
                /* checks if element is overflowed having visible scrollbar(s) */
                mcsOverflow: $j.expr[":"].mcsOverflow || function(el) {
                    var d = $j(el).data(pluginPfx);
                    if (!d) {
                        return;
                    }
                    return d.overflowed[0] || d.overflowed[1];
                }
            });

        });

    }))
}));

/*
$j(document).ready(function(){
  
  $j(".solutionInoWrap .mCustomScrollbar").mCustomScrollbar({
    autoHideScrollbar: true,
    keyboard:{enable:true}
  });
  
  $j(".scrollArticles.mCustomScrollbar,.scrollProducts.mCustomScrollbar").mCustomScrollbar({
    scrollbarPosition: "inside",
    autoHideScrollbar: true,
    keyboard:{enable:true,scrollType:"stepped",scrollAmount:330},
    axis:'x',
    advanced:{autoExpandHorizontalScroll:true},
    mouseWheel:{enable:true,scrollAmount:330},
    scrollButtons:{enable: false}
  });
  
  function scrollFade(el){
    $j(el).addClass("scrollFadeStyle");
    
  }
  
  
});*/
/*!---- annual-report-----*/
function setEqualHeight_fromCalculated(arr) {
    var x = new Array([]);
    $j(arr).each(function(i) {
        x[i] = $j(this).height();
    });
    Max_Value = Array.max(x);
    $j(arr).each(function(i) {
        //if($j(arr[i]).height() != Max_Value)
        //	{x[i] = $j(arr[i]).height(Max_Value);}
        $j(this).outerHeight(Max_Value);
    });
}

$j(document).on('click', '.strategic-priority-content', function(e) {
    if (viewport().width > 767) {
        e.preventDefault();

        $j(this).off("click");
    }
});

$j(document).ready(function() {

    $j(".hovereffect").append("<div class='close-section closecenter'>X</div>");

    $j(".ar-popup-container-outer").hide();


    var FinalHei = $j(".ar-popup-container-outer").height();
    var MarTop = FinalHei / 2;
    $j(".ar-popup-container-outer").css("margin-top", -MarTop);


    var url = window.location.pathname;

    if ($j("url:contains('annual-report')")) {


        var cval2 = GetCookie('v2.popupFirstTimeVisit');

        if (cval2 != "true") {
            $j(".ar-popup-container-outer").show();
            if ($j(".ar-popup-container-outer").length > 0) {
                $j("body").addClass("ArOverflow");
            } else {
                $j("body").removeClass("ArOverflow");
            }
            $j(".OuterWrapper").show();
        } else {
            $j("body").removeClass("ArOverflow");
            $j(".OuterWrapper").hide();


        }
    }

    $j(".ar-popup-buttonlink").click(function() {
        $j(".ar-popup-container-outer").hide();
        $j(".OuterWrapper").hide();
        $j("body").removeClass("ArOverflow");

    });





    if (viewport().width < 768) {
        if ($j('.download-list .download-right-inner-box').length > 0) {
            $j('.download-list').slick({
                infinite: false,
                dots: true,
                prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                slidesToShow: 1,
                slidesToScroll: 1,
                speed: 300,
                responsive: [{
                    breakpoint: 768,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1,
                        dots: true
                    }
                }]
            });
        }
    }

    /*$j(document).on("click",".close-section",function(e){

    $j(this).parents(".StrategicWrap").sibling(".fw-section-ttl").trigger("click");
    });*/


    /*$j(document).on("click",".close-section",function(e){
      e.preventDefault();    
      $j('.hovereffect').css('display','none');
    });*/
    /* $j(document).on("click","#close-section",function(e){
       e.preventDefault();    
       $j('.hovereffect').css('display','none');
     });
     $j(document).on("tap",".strategic-item",function(e){
       e.preventDefault();    
       $j(this).find('.hovereffect').css('display','block');
     });
     */


    $j(document).on("click", ".strategic-item.hoverhidden", function(e) {
        $j(this).find('.hovereffect').show();
        $j(this).removeClass('hoverhidden');
    });

    $j(document).on("click", ".close-section", function(e) {
        e.preventDefault();
        //$j('.hovereffect').removeClass('removeVisibility');
        $j(this).parents('.hovereffect').hide();
        $j(this).parents(".strategic-item").addClass('hoverhidden');
        //$j(".fw-strategic-prio h2").trigger('click');
    });

});

$j(window).load(function() {

    if (viewport().width < 768) {
        setTimeout(function() {
            slider_arrows_adjust('.download-list');
        }, 500);
    }

    if (viewport().width > 991) {
        $j(".strategic-item").each(function() {
            //$j(".strategic-item").hover(function (){
            //var HoverCon = $j(this).children(".hovereffect").outerHeight();
            var HoverCon = $j(this).children(".hovereffect").children(".hover-container").outerHeight();
            var HoverPadOf2 = ($j(this).children(".hovereffect").css("padding-top"));
            var FinalHover = parseInt(HoverPadOf2.split("px")[0], 10);
            var HoverPad = (FinalHover * 2);
            //var FinalHoverHeight = HoverCon;
            var FinalHoverHeight = parseInt(HoverCon, 10) + parseInt(HoverPad, 10);

            //$j(this).children(".hovereffect").height(FinalHoverHeight);

            //$j(this).height(FinalHoverHeight);
        });


        //setEqualHeight_fromCalculated(".hovereffect");
        setEqualHeight_fromCalculated(".strategic-titlewrap");
        setEqualHeight_CommonClass(".strategic-content");
        setEqualHeight_fromCalculated(".strategic-link");

        setEqualHeight_CommonClass(".sustainable-title");
        setEqualHeight_CommonClass(".sustainable-content");

        //$j(".strategic-item").height($j(".strategic-item .hovereffect").height());

        //$j(window).trigger("resize");
    } else {
        $j(".hovereffect").outerHeight("auto");
        $j(".strategic-titlewrap").outerHeight("auto");
        $j(".strategic-link").outerHeight("auto");
        $j(".strategic-item").outerHeight("auto");
        $j(".sustainable-title").height("auto");
        $j(".sustainable-content").height("auto");
    }
    //  $j(".hovereffect").addClass("hoverAftLoad");
    // setEqualHeight_CommonClass(".hovereffect");

    // });

    // setEqualHeight_CommonClass(".BusinessHighlights .rad-highlight");
    // setEqualHeight_CommonClass(".BusinessHighlights .rad-big");



    //  $j(".strategic-item .hovereffect").css('height','');

    // $j(".close-section.closecenter").hide();
    if (viewport().width <= 767) {

        $j(".strategic-priority-content a").attr("title", "Opens in a new window");

    } else {

        $j(".strategic-priority-content a").removeAttr("title");
    }
});



$j(window).resize(function() {



    if (viewport().width < 992) {
        $j('strategic-item').removeClass("hoverhidden");
    } else {
        $j('strategic-item').removeClass("hoverhidden");
        //$j(".hovereffect").show().css('visibility','hidden');
    }

    if (viewport().width <= 767) {
        $j(".strategic-priority-content a").attr("title", "Opens in a new window");




        $j(".sustainable-title").height("auto");
        $j(".sustainable-content").height("auto");
        //  $j(".BusinessHighlights .rad-highlight").height("auto");
        // $j(".BusinessHighlights .rad-big").height("auto");




        if ($j('.download-list .download-right-inner-box').length > 0) {

            $j('.download-list').not('.slick-initialized').slick({
                infinite: false,
                dots: true,
                prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                slidesToShow: 1,
                slidesToScroll: 1,
                speed: 300,
                responsive: [{
                    breakpoint: 768,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1,
                        dots: true,
                        prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                        nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>"
                    }
                }]
            });
            $j('.download-list.slick-initialized').get(0).slick.setPosition();
        }

        setTimeout(function() {
            slider_arrows_adjust('.download-list');
            /*$j('.download-list').each(function() {
              
              if($j(this).find('.slick-dots > li').length > 0){
                var totalWidth1 = 0;
                $j(this).find('.slick-dots > li').each(function() {
                  totalWidth1 = totalWidth1 + $j(this).width();
                });
                var newPrevNext1 = (totalWidth1*2) + 50;      
                if(currWidth < 768){
                  if($j(this).find('.slick-dots > li').length > 8){
                    $j(this).find('.slick-dots > li').hide();
                    $j(this).parent().parent().find('.slick-initialized').addClass('morethen8dots');
                    $j(this).find('.slick-arrow.slick-next').css('right','-8px');
                    $j(this).find('.slick-arrow.slick-prev').css('left','0');
                  }else{
                    $j(this).find('.slick-dots > li').show();
                    $j(this).parent().parent().find('.slick-initialized').removeClass('morethen8dots');
                    $j(this).find('.slick-arrow.slick-next').css('right',-newPrevNext1);
                    $j(this).find('.slick-arrow.slick-prev').css('left',-(newPrevNext1-15));
                  }
                }else{
                  $j(this).find('.slick-dots > li').show();
                  $j(this).parent().parent().find('.slick-initialized').removeClass('morethen8dots');
                  $j(this).find('.slick-arrow.slick-next').css('right',-newPrevNext1);
                  $j(this).find('.slick-arrow.slick-prev').css('left',-(newPrevNext1-15));
                }
              }
              
            });*/
        }, 200);
    }

    if (viewport().width > 767) {

        $j(".strategic-priority-content a").removeAttr("title");


        setEqualHeight_CommonClass(".sustainable-title");
        setEqualHeight_CommonClass(".sustainable-content");
        // setEqualHeight_CommonClass(".BusinessHighlights .rad-highlight");
        //setEqualHeight_CommonClass(".BusinessHighlights .rad-big");
        if ($j('.download-list.slick-initialized').length > 0) {
            $j('.download-list').slick('unslick');
        }
    }

    /*if(viewport().width < 768){
         
      setTimeout(function(){
        
        $j('.download-list').each(function() {
          
          if($j(this).find('.slick-dots > li').length > 0){
            var totalWidth1 = 0;
            $j(this).find('.slick-dots > li').each(function() {
              totalWidth1 = totalWidth1 + $j(this).width();
            });
            var newPrevNext1 = (totalWidth1*2) + 50;      
            if(viewport().width < 768){
              if($j(this).find('.slick-dots > li').length > 8){
                $j(this).find('.slick-dots > li').hide();
                $j(this).parent().parent().find('.slick-initialized').addClass('morethen8dots');
                $j(this).find('.slick-arrow.slick-next').css('right','-8px');
                $j(this).find('.slick-arrow.slick-prev').css('left','0');
              }else{
                $j(this).find('.slick-dots > li').show();
                $j(this).parent().parent().find('.slick-initialized').removeClass('morethen8dots');
                $j(this).find('.slick-arrow.slick-next').css('right',-newPrevNext1);
                $j(this).find('.slick-arrow.slick-prev').css('left',-(newPrevNext1-15));
              }
            }else{
              $j(this).find('.slick-dots > li').show();
              $j(this).parent().parent().find('.slick-initialized').removeClass('morethen8dots');
              $j(this).find('.slick-arrow.slick-next').css('right',-newPrevNext1);
              $j(this).find('.slick-arrow.slick-prev').css('left',-(newPrevNext1-15));
            }
          }
          
        });
      },200);
    }*/
    //setEqualHeight_CommonClass(".hovereffect");

    /* $j(".strategic-item").each(function () {
      var Hover = $j(this).children(".hovereffect").outerHeight();
      $j(this).outerHeight(Hover);
      //setEqualHeight_CommonClass(".gg-g-" + i + " .pool-item .pool-image table th");
    });*/

    setEqualHeight_CommonClass(".strategic-titlewrap");
    // setEqualHeight_CommonClass(".strategic-content");
    setEqualHeight_CommonClass(".strategic-link");
    setEqualHeight_CommonClass(".strategic-item");

    setEqualHeight_CommonClass(".sustainable-title");
    setEqualHeight_CommonClass(".sustainable-content");

});
/*!---- main-2019-----*/
$j(document).ready(function() {

    //$j('.full-width-banner .full-width-banner-inner').height($j(window).height() -143 );

    $j('.banner-down-arrow #arrow-down .fa').click(function() {
        var parentThis = $j(this);
        $j("html, body").animate({
            scrollTop: parentThis.parents(".full-width-banner").parent().find('.section').first().offset().top - 0
        }, 500);
    });

    /*------------- Related Cntent Slider -------------*/
    setTimeout(function() {

        if ($j('.related-content-manually-inner .related-content-manually-item').length > 1) {
            $j('.related-content-manually-inner').not('.slick-initialized').slick({
                infinite: false,
                dots: true,
                prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
                nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
                slidesToShow: 4,
                slidesToScroll: 4,
                speed: 300,
                responsive: [{
                        breakpoint: 1170,
                        settings: {
                            slidesToShow: 3,
                            slidesToScroll: 3,
                            dots: true
                        }
                    },
                    {
                        breakpoint: 992,
                        settings: {
                            slidesToShow: 2,
                            slidesToScroll: 2,
                            dots: true
                        }
                    },
                    {
                        breakpoint: 639,
                        settings: {
                            slidesToShow: 1,
                            slidesToScroll: 1,
                            dots: true
                        }
                    }
                ]
            });
        }
        slider_arrows_adjust('.related-content-manually-inner');
    }, 200);


    /*------------- Related Cntent Slider -------------*/


});


$j(window).scroll(function() {
    ModuleAnimation();
});


$j(window).load(function() {
    setTimeout(function() {
        $j('.full-width-banner-main').addClass('banner-done');
    }, 50);

});

function ModuleAnimation() {
    $j('.new-module-section').each(function() {
        var bottom_of_object = $j(this).offset().top + 30;
        var bottom_of_window = $j(window).scrollTop() + $j(window).height();

        /* If the object is completely visible in the window, fade it it */
        if (bottom_of_window > bottom_of_object) {

            $j(this).addClass('animation-done');

        } else {}
    });
}


/*!---- module-animation-2019-----*/
$j('.is-image-transition').each(function() {
    var windscroll = $j(window).scrollTop();
    var img = $j(this).find('.tm-img-cnt-img').children('img');
    var imgParent = $j(this).find('.tm-img-cnt-img');

    function parallaxImg() {
        if ($j(window).width() > 992) {
            var speed = img.data('speed');
            var imgY = imgParent.offset().top;
            var winY = $j(this).scrollTop();
            var winH = $j(this).height();
            var parentH = imgParent.innerHeight();


            // The next pixel to show on screen      
            var winBottom = winY + winH;

            // If block is shown on screen
            if (winBottom > imgY && winY < imgY + parentH) {
                // Number of pixels shown after block appear
                var imgBottom = ((winBottom - imgY) * speed);
                // Max number of pixels until block disappear
                var imgTop = winH + parentH;
                // Porcentage between start showing until disappearing
                var imgPercent = ((imgBottom / imgTop) * 100) + (50 - (speed * 50));
            }
            img.css({
                top: imgPercent + '%',
                transform: 'translateY(-' + imgPercent + '%)'
            });
        }
    }
    $j(document).on({
        scroll: function() {
            parallaxImg();
        },
        resize: function() {
            parallaxImg();
        }
    });

});
/*!---- new-module-spacing-----*/
/*if($j(".story-load-more-btn:visible").length === 0){
    $j(".story-load-more-btn").removeClass("new-module-spacing");  
}*/

var sectionLength = $j(".sections-wrap").length;
console.log("Section Length:" + sectionLength);
$j(".sections-wrap").each(function(index) {
    if ($j(this).hasClass("fist-div") && sectionLength < 2) {
        if ($j(this).children(".new-module-spacing").length < 2) {
            $j(this).children(".new-module-spacing").addClass("last");
        } else {
            $j(this).children(".new-module-spacing").last().addClass("last");
        }
    }
    if ($j(this).hasClass("last-div") || index === (sectionLength - 1)) {
        $j(this).children(".new-module-spacing").last().addClass("last");
    }

    if ($j(this).children(".new-module-spacing").last().hasClass("has-background") && $j(this).next().children(".new-module-spacing").first().hasClass("has-background")) {
        $j(this).next().children(".new-module-spacing").first().addClass("minus-margin");
        if ($j(this).children(".new-module-spacing").last().hasClass("fw-dataviz-map")) {
            $j(this).next().children(".new-module-spacing").first().addClass("new-module-inner-space");
        }
    }
});



// By default first tab click for Brochure List module - start
$j(window).load(function() {
    if ($j('.fw-brochure-list .tab-list .tabs li').length > 0) {
        if (window.location.hash === "") {
            $j(".fw-brochure-list .tab-list .tabs li.current").click();
            $j('.fw-brochure-list .fw-tabbed-wrap .tab-list .mobi-tabs-list').hide();
        }
    }
    $j('.fw-brochure-list .fw-tabbed-wrap .tab-list .mobi-tabs-list').hide();
    $j('.fw-brochure-list .fw-tabbed-wrap .tab-list').each(function() {
        if ($j(this).find('.mobi-tabs-list').length > 0) {
            $j(this).find('.mobi-tabs-list').hide();
        }
    });

});
// By default first tab click for Brochure List module - end

$j(document).ready(function() {

    setTimeout(function() {
        $j('.fw-brochure-list .fw-tabbed-wrap .tab-list').each(function() {
            if ($j(this).find('.mobi-tabs-list').length > 0) {
                $j(this).find('.mobi-tabs-list').hide();
            }
        });
    }, 3000);
});
/*!---- word-break-keep-all-----*/
/*!
 * jQuery word-break keep-all Plugin
 * ver 1.3.0
 *
 * Copyright 2012, Ahn Hyoung-woo (mytory@gmail.com)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * https://github.com/mytory/jquery-word-break-keep-all
 * http://mytory.co.kr/archives/2801
 *
 * Date: 2013-09-04
 */

$j.fn.wordBreakKeepAll = function(option) {
    var is_there_end_angle_bracket = function(str) {
        return str.lastIndexOf('<') < str.lastIndexOf('>');
    };

    var is_there_start_angle_bracket = function(str) {
        return str.lastIndexOf('>') < str.lastIndexOf('<');
    };

    var is_there_no_angle_bracket = function(str) {
        //only -1
        return str.lastIndexOf('>') == str.lastIndexOf('<');
    };

    var defaultOption = {
        OffForIE: false, // If IE, turn off plugin.
        useCSSonIE: true, // on IE, use CSS word-break: keep-all
        imgCntTitle: false // add <div> instead <span> for image and content module
    };

    var opt = $j.extend(defaultOption, option);

    if (/MSIE/.test(navigator.userAgent) && opt.OffForIE == false && opt.useCSSonIE == true) {
        var addWordBreakKeepAll = function(obj) {
            $j(obj).css({
                'word-break': 'keep-all',
                'word-wrap': 'break-word'
            });
            if ($j(obj).css('display') == 'inline') {
                $j(obj).css('display', 'block');
            }
        };
    } else if (!/MSIE/.test(navigator.userAgent) || /MSIE/.test(navigator.userAgent) && opt.OffForIE == false && opt.useCSSonIE == false) {
        var addWordBreakKeepAll = function(obj) {

            var html = $j(obj).html();

            // to store line break
            html = html.replace(/(\r\n|\n|\r)/gm, '  ');

            // .html()    ,           <,>  .
            var textArr = html.split(' ');

            // remove empty array
            textArr = textArr.filter(function(e) {
                return e;
            });
            $j(obj).text('');
            var skip = false;
            var full_str = '';

            for (var i = 0, j = textArr.length; i < j; i++) {
                var str = textArr[i];

                /*
                 *          skip = false;
                 *    skip = true;
                 *     skip  .       .
                 * 
                 * nowrap   :   and skip == false
                 * nowrap     :    or skip == true
                 * 
                 * skip = true    :    
                 * skip = false    :    
                 */
                if (skip == false && is_there_no_angle_bracket(str) && str.indexOf('') == -1) {
                    if (opt.imgCntTitle) {
                        full_str += '<div class="nowraptext">' + str + '</div> ';
                    } else {
                        full_str += '<span class="nowraptext">' + str + '</span> ';
                    }
                } else {
                    full_str += str + ' ';
                }

                if (is_there_start_angle_bracket(str)) {
                    skip = true;
                }
                if (is_there_end_angle_bracket(str)) {
                    skip = false;
                }
            };
            $j(obj).html(full_str.replace(//g, "\n"));
        };
    }
    return this.each(function() {
        addWordBreakKeepAll(this);
    });
};

/* Wrap up every word in to span tag starts */
$j(document).ready(function() {
    if ($j('body').hasClass('ip3-korea') || $j('body').attr('id') == 'korea') {
        setTimeout(function() {
            $j('.MainWrapperInner p, .MainWrapperInner a, .MainWrapperInner ul li, .MainWrapperInner ol li, .MainWrapperInner h1, .MainWrapperInner h2, .MainWrapperInner h3').wordBreakKeepAll();

            // add <div> instead <span> for image and content module
            $j('.fw-img-cnt-section .img-cnt-ttl, .fw-stats-section .fw-stats-top').wordBreakKeepAll({
                imgCntTitle: true
            });
        }, 1000);
        if ($j('.do-slick').length > 0) {
            $j('.do-slick').on("init", function() {
                $j(this).find("a").wordBreakKeepAll();
            });
        }
    }
});
/* Wrap up every word in to span tag ends */
/*!---- 3-5-relates-content-slider-----*/
setTimeout(function() {


    $j('.home-mid-fw-inner1.fw-sld-wrapper').slick({
        infinite: false,
        dots: true,
        prevArrow: "<span class='rr-icon-arrow-nav slick-prev'></span>",
        nextArrow: "<span class='rr-icon-arrow-nav slick-next'></span>",
        slidesToShow: 4,
        slidesToScroll: 4,
        speed: 300,
        responsive: [{
                breakpoint: 1170,
                settings: {
                    slidesToShow: 3,
                    slidesToScroll: 3,
                    dots: true
                }
            },
            {
                breakpoint: 992,
                settings: {
                    slidesToShow: 2,
                    slidesToScroll: 2,
                    dots: true
                }
            },
            {
                breakpoint: 639,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1,
                    dots: true
                }
            }
        ]
    });

    slider_arrows_adjust('.related-content-manually-inner');
}, 1000);

/*!---- solr-autocomplete-----*/
//var $j = jQuery.noConflict();

$j(document).ready(function() {

    /* ======= For Solr search page textbox starts ======= */
    $j('#solrstrap-searchbox').keyup(keyuphandler);

    $j("#solrstrap-searchbox").keypress(function(e) {
        if (e.keyCode == 60 || e.keyCode == 62 || e.keyCode == 36 || e.keyCode == 37 || e.keyCode == 38 || e.keyCode == 42) {
            e.preventDefault();
            return false;
        }
    });

    $j("#solrstrap-searchbox").keypress(function(e) {
        if (e.keyCode == 13) {
            if (document.getElementById("submitButton") !== null)
                $j('#submitButton').trigger("click");
            else
                $j('#searchButton').trigger("click");

            $j('#solrstrap-searchbox').autocomplete('close');

            $j('.ui-autocomplete').hide();
            return false;
        }
    });

    $j("#submitButton").click(function(e) {
        if ($j("#solrstrap-searchbox").val() != null && $j("#solrstrap-searchbox").val() != "") {
            var keywordtracking = "";
            if (SolrPopularSearchConfig.ENABLEPOPULARSEARCH === true)
                keywordtracking = "keywordtracking=1&";
            else
                keywordtracking = "&";

            document.location.href = "/site-services/search-results#queryType=Exact&" + keywordtracking + "q=" + encodeURIComponent($j("#solrstrap-searchbox").val().replace(":", "\:"));
            return false;
        }
    });

    /* ======= For Solr search page textbox ends ======= */

    /* ======= For Desktop textbox starts ======= */
    $j('#searchTextbox').keyup(keyuphandler2);

    $j("#searchTextbox").keypress(function(e) {
        if (e.keyCode == 60 || e.keyCode == 62 || e.keyCode == 36 || e.keyCode == 37 || e.keyCode == 38 || e.keyCode == 42) {
            e.preventDefault();
            return false;
        }
    });

    $j("#searchTextbox").keypress(function(e) {
        if (e.keyCode == 13) {
            if (document.getElementById("searchButton") !== null)
                $j('#searchButton').trigger("click");
            else
                $j('#searchButton1').trigger("click");

            $j('#searchTextbox').autocomplete('close');

            $j('.ui-autocomplete').hide();
            return false;
        }
    });

    $j("#searchButton").click(function(e) {
        if ($j("#searchTextbox").val() != null && $j("#searchTextbox").val() != "") {
            var keywordtracking = "";
            if (SolrPopularSearchConfig.ENABLEPOPULARSEARCH === true)
                keywordtracking = "keywordtracking=1&";
            else
                keywordtracking = "&";
            document.location.href = "/site-services/search-results#queryType=Exact&" + keywordtracking + "q=" + encodeURIComponent($j("#searchTextbox").val().replace(":", "\:"));
            return false;
        }
    });

    /* ======= For Desktop pagetext box ends ======= */

    /* ======= For Mobile textbox starts ======= */
    $j('#searchTextbox1').keyup(keyuphandler3);

    $j("#searchTextbox1").keypress(function(e) {
        if (e.keyCode == 60 || e.keyCode == 62 || e.keyCode == 36 || e.keyCode == 37 || e.keyCode == 38 || e.keyCode == 42) {
            e.preventDefault();
            return false;
        }
    });

    $j("#searchTextbox1").keypress(function(e) {
        if (e.keyCode == 13) {
            if (document.getElementById("searchButton1") !== null)
                $j('#searchButton1').trigger("click");
            else
                $j('#searchButton').trigger("click");

            $j('#searchTextbox1').autocomplete('close');

            $j('.ui-autocomplete').hide();
            return false;
        }
    });

    $j("#searchButton1").click(function(e) {
        if ($j("#searchTextbox1").val() != null && $j("#searchTextbox1").val() != "") {
            var keywordtracking = "";
            if (SolrPopularSearchConfig.ENABLEPOPULARSEARCH === true)
                keywordtracking = "keywordtracking=1&";
            else
                keywordtracking = "&";

            document.location.href = "/site-services/search-results#queryType=Exact&" + keywordtracking + "q=" + encodeURIComponent($j("#searchTextbox1").val().replace(":", "\:"));
            return false;
        }
    });

    /* ======= For Mobile textbox ends ======= */

    setTimeout(function() {
        if (window.location.href.indexOf("site-services/search-results#queryType=All") > -1) {
            //$j("#searchFilter > input[value='Exact']").trigger("click");
        } else if (window.location.href.indexOf("site-services/search-results#queryType=Exact") > -1) {
            $j("#searchFilter > input[value='All']").trigger("click");
            $j("#searchFilter > input[value='Exact']").trigger("click");
        }
    }, 1000);

});

/* ======== For Solr search page starts ======= */

function keyuphandler() {
    var q = $j.trim($j('#solrstrap-searchbox').val());
    if (q.length > 3) {
        AutocompleteText();
    }
}

function AutocompleteText() {
    $j("#solrstrap-searchbox").autocomplete({
        appendTo: "#searchTextboxContainerSolr",
        source: function(request, response) {
            var inputs = {
                'Handler': 'autocomplete',
                'Query': buildAutocompleParams()
            };
            $j.ajax({
                url: SolrGlobalConfig.APIURI,
                data: inputs,
                type: 'POST',
                dataType: 'json',
                success: function(data) {
                    if (data !== null && data !== "" && data != "Failure") {
                        //Create a json that is understood by render item easily
                        var json = JSON.parse(data);
                        //faceted autocomplete field
                        json = json.facet_counts.facet_fields[SolrGlobalConfig.AUTOCOMPLETEFIELD];
                        var autocompleteresult = "[";
                        for (var i = 0; i < json.length; i++) {
                            if ((i % 2) === 0)
                                autocompleteresult += '{"label":"' + json[i];
                            else
                                autocompleteresult += '","value":' + json[i] + '},';
                        }
                        autocompleteresult = autocompleteresult.replace(/\,$/, '');
                        autocompleteresult += "]";
                        autocompleteresult = JSON.parse(autocompleteresult);
                        response(autocompleteresult);
                    }
                },
                error: function(result) {}
            });
        },
        minLength: 1,
        select: function(event, ui) {
            event.preventDefault();
            $j("#solrstrap-searchbox").val(ui.item.label);
            if (document.getElementById("submitButtonHeader") !== null)
                $j('#submitButtonHeader').trigger("click");
            else
                $j('#submitButton').trigger("click");
        },
        focus: function(event, ui) {
            event.preventDefault();
            $j("#solrstrap-searchbox").val(ui.item.label);
        }
    }).data("ui-autocomplete")._renderItem = function(ul, item) {
        return $j("<li class='ui-corner-all'>")
            .append("<a> <span style='float:left;'>" + decodeURIComponent(item.label) + "</span><span style='float:right;'>(" + item.value + ")</span></a>").appendTo(ul);
    };
}

function buildAutocompleParams() {
    var ret = {
        'q': "(client:" + SolrGlobalConfig.CLIENT + " AND (otplanguage:" + SolrOtpToolsSearchConfig.OTPLANGUAGE + " OR language:" + SolrGlobalConfig.LANGUAGE + "))",
        "facet.prefix": encodeURIComponent($j.trim($j('#solrstrap-searchbox').val().replace(":", "\\:")).toLowerCase()),
        "facet.method": "enum"
    };
    return JSON.stringify(ret);
}

/* ======== For Solr search page ends ======= */

/* ======== For Desktop search starts ======= */

function keyuphandler2() {
    var q = $j.trim($j('#searchTextbox').val());
    if (q.length > 2) {
        AutocompleteText2();
    }
}

function AutocompleteText2() {
    $j("#searchTextbox").autocomplete({
        appendTo: "#searchTextboxContainer",
        source: function(request, response) {
            var inputs = {
                'Handler': 'autocomplete',
                'Query': buildAutocompleParams2()
            };
            $j.ajax({
                url: SolrGlobalConfig.APIURI,
                data: inputs,
                type: 'POST',
                dataType: 'json',
                success: function(data) {
                    if (data !== null && data !== "" && data != "Failure") {
                        //Create a json that is understood by render item easily
                        var json = JSON.parse(data);
                        //faceted autocomplete field
                        json = json.facet_counts.facet_fields[SolrGlobalConfig.AUTOCOMPLETEFIELD];
                        var autocompleteresult = "[";
                        for (var i = 0; i < json.length; i++) {
                            if ((i % 2) === 0)
                                autocompleteresult += '{"label":"' + json[i];
                            else
                                autocompleteresult += '","value":' + json[i] + '},';
                        }
                        autocompleteresult = autocompleteresult.replace(/\,$/, '');
                        autocompleteresult += "]";
                        autocompleteresult = JSON.parse(autocompleteresult);
                        response(autocompleteresult);
                    }
                },
                error: function(result) {}
            });
        },
        minLength: 1,
        select: function(event, ui) {
            event.preventDefault();
            $j("#searchTextbox").val(ui.item.label);
            if (document.getElementById("searchButton") !== null)
                $j('#searchButton').trigger("click");
            else
                $j('#searchButton1').trigger("click");
        },
        focus: function(event, ui) {
            event.preventDefault();
            $j("#searchTextbox").val(ui.item.label);
        }
    }).data("ui-autocomplete")._renderItem = function(ul, item) {
        return $j("<li class='ui-corner-all'>")
            .append("<a> <span style='float:left;'>" + decodeURIComponent(item.label) + "</span><span style='float:right;'>(" + item.value + ")</span></a>").appendTo(ul);
    };
}

function buildAutocompleParams2() {
    var ret = {
        'q': "(client:" + SolrGlobalConfig.CLIENT + " AND (otplanguage:" + SolrOtpToolsSearchConfig.OTPLANGUAGE + " OR language:" + SolrGlobalConfig.LANGUAGE + "))",
        "facet.prefix": encodeURIComponent($j.trim($j('#searchTextbox').val().replace(":", "\\:")).toLowerCase()),
        "facet.method": "enum"
    };
    return JSON.stringify(ret);
}

/* ======== For Desktop search ends ======= */

/* ======== For mobile search starts ======= */

function keyuphandler3() {
    var q = $j.trim($j('#searchTextbox1').val());
    if (q.length > 2) {
        AutocompleteText3();
    }
}

function AutocompleteText3() {
    $j("#searchTextbox1").autocomplete({
        appendTo: ".searchTextboxContainer1",
        source: function(request, response) {
            var inputs = {
                'Handler': 'autocomplete',
                'Query': buildAutocompleParams3()
            };
            $j.ajax({
                url: SolrGlobalConfig.APIURI,
                data: inputs,
                type: 'POST',
                dataType: 'json',
                success: function(data) {
                    if (data !== null && data !== "" && data != "Failure") {
                        //Create a json that is understood by render item easily
                        var json = JSON.parse(data);
                        //faceted autocomplete field
                        json = json.facet_counts.facet_fields[SolrGlobalConfig.AUTOCOMPLETEFIELD];
                        var autocompleteresult = "[";
                        for (var i = 0; i < json.length; i++) {
                            if ((i % 2) === 0)
                                autocompleteresult += '{"label":"' + json[i];
                            else
                                autocompleteresult += '","value":' + json[i] + '},';
                        }
                        autocompleteresult = autocompleteresult.replace(/\,$/, '');
                        autocompleteresult += "]";
                        autocompleteresult = JSON.parse(autocompleteresult);
                        response(autocompleteresult);
                    }
                },
                error: function(result) {}
            });
        },
        minLength: 1,
        select: function(event, ui) {
            event.preventDefault();
            $j("#searchTextbox1").val(ui.item.label);
            if (document.getElementById("searchButton1") !== null)
                $j('#searchButton1').trigger("click");
            else
                $j('#searchButton').trigger("click");
        },
        focus: function(event, ui) {
            event.preventDefault();
            $j("#searchTextbox1").val(ui.item.label);
        }
    }).data("ui-autocomplete")._renderItem = function(ul, item) {
        return $j("<li class='ui-corner-all'>")
            .append("<a> <span style='float:left;'>" + decodeURIComponent(item.label) + "</span><span style='float:right;'>(" + item.value + ")</span></a>").appendTo(ul);
    };
}

function buildAutocompleParams3() {
    var ret = {
        'q': "(client:" + SolrGlobalConfig.CLIENT + " AND (otplanguage:" + SolrOtpToolsSearchConfig.OTPLANGUAGE + " OR language:" + SolrGlobalConfig.LANGUAGE + "))",
        "facet.prefix": encodeURIComponent($j.trim($j('#searchTextbox1').val().replace(":", "\\:")).toLowerCase()),
        "facet.method": "enum"
    };
    return JSON.stringify(ret);
}

/* ======== For mobile search ends ======= */
/*!---- solr-search-configuration-----*/
//All madantory global configuration for SOLR SEARCH goes here.

//Required parameters that will change according to client.
var SolrGlobalConfig = {
    //CONST- CHANGE ALL THESE TO TELL SOLRSTRAP ABOUT THE LOCATION AND STRUCTURE OF YOUR SOLR
    APIURI: "/tools/urlproxy/advurlproxy.aspx?settingname=solrservice", //API URI
    //Name of the client that has been configured in SOLR SEARCH ADMIN.
    CLIENT: "RollsRoyce",
    //LANGUAGE in which you want your search results.
    LANGUAGE: "en",
    //Autocomplete field name which has been indexed in solr search.
    //Prefix for this field will always be tnt_txt_
    //Suffic for this field will be the language
    AUTOCOMPLETEFIELD: "tnt_txt_en",
    //Required fields that you want in results.
    //Please you have configured any dynamic meta field in CMS it is required that it should be present below.
    //Default Value: absoluteurl,title,score,id,header_date_publish-date
    FIELDS: "absoluteurl, title, titleh1, score, id, header_date_publish-date, otptoolname, solrdocumenttype, meta_about, meta_thumb, meta_products, meta_date,meta_suppliers,meta_sustainability,meta_media,meta_investors,meta_careers,meta_futuresmart,meta_image,meta_video,meta_isfeatured,meta_date,metanum_filesize"
};

//Solr Tabs Configuration.
//If you don't want to use TABS in view just disable this functionality.
var SolrTabsConfig = {
    ENABLEMETATAGSEARCH: true,
    //Field name on which you want your tabs to be rendered.
    //Value for this field will be meta_section as we have configured the same in solr admin panel.
    TAB_METATAG: "meta_section",
    //Configure Tabs / Sections names that needs to be displayed.
    TABS: ['innovation', 'productsandservices', 'about', 'investors', 'sustainability', 'media', 'documents'],
    //Facet titles that will be shown on result page.
    //Example : If the facet field is "aboutus" and you want to show "About Us" instead of it then you can configure it below.
    TABS_TITLES: {
        'innovation': 'Innovation',
        'productsandservices': 'Products and Services',
        'about': 'About',
        'investors': 'Investors',
        'sustainability': 'Sustainability',
        'media': 'Media',
        'documents': 'Documents'
    }
};

//Solr Facets Configuration.
//If you don't want to use FACETS in view just disable this functionality.
var SolrFacetingConfig = {
    ENABLEFACETSEARCH: true,
    //Field names that will be used for FACETING of results.
    FACETS: ['solrdocumenttype', 'meta_site', 'meta_domain', 'otptoolname'],
    //Facet titles that will be shown on result page.
    //Example : If the facet field is "solrdocumenttype" and you want to show "Content Type" instead of it then you can configure it below.
    FACETS_TITLES: {
        'solrdocumenttype': 'Content type',
        'meta_site': 'Websites',
        'meta_domain': 'Related domains',
        'header_date_publish-date': 'Publish Date',
        'otptoolname': 'Feeds'
    },

    //This array will be used to replace values that will be returned in facet result for field meta_site.
    //Exmaple : If field meta_site has value "american" and you want to show "About Us" instead of it then you can configure it below.
    FACETS_ALIAS: {
        'rollsroyce': 'Rolls Royce',
        'japan': 'Rolls Royce Japan',
        'germany': 'Rolls Royce Germany',
        'india': 'Rolls Royce India',
        'unitedkingdom': 'Rolls Royce United Kingdom',
        'sea': 'Rolls Royce South East Asia',
        'korea': 'Rolls Royce Careers Korea',
        'china': 'Rolls Royce Careers China',
        'WebPage': 'Web page',
        'File': 'PDF'
    }
};

//Solr Popular Search / Trending Keyword Configuration.
//If you don't want to use TRENDING KEYWORDS Search in view just disable this functionality.
var SolrPopularSearchConfig = {
    ENABLEPOPULARSEARCH: true,
    //CONST- CHANGE ALL THESE TO TELL SOLRSTRAP ABOUT THE LOCATION AND STRUCTURE OF YOUR SOLR
    APIPOPULARSEARCH: "/tools/urlproxy/advurlproxy.aspx?settingname=popularsearch"
};

//Solr Featured Search Configuration.
//This search will be displayed as a featured search above the actual search result.
//If you don't want to use FEATURED Search in view just disable this functionality.
//Result that needs to be displayed in Featured Search must be tagged with "meta_isfeatured"
var SolrFeaturedSearchConfig = {
    ENABLEFEATUREDSEARCH: true
};

//Solr Otp Tools Data Search Configuration.
//If you don't want to OTP TOOLS DATA in search just disable this functionality.
var SolrOtpToolsSearchConfig = {
    //Value must be true if OTP TOOLS DATA needs to be shown in results.
    OTPENABLED: 'true',
    //LANGUAGE which is configured in OTP ADMIN
    OTPLANGUAGE: 'en-GB',
    //Provide the tools that have been configured for this client in solr admin.
    OTPTOOLS: ['rns'],
    OTPCAT: [],
    TAG: 'otptoolname',
    FORMTYPE: "meta_seccategory"
};

//Solr Presentation Details Configuration.
//This functionality will hold the values for different dynamic fields that we will use to achieve specific results in search.(For example showing an thumb image / video url)
var SolrPresentationConfig = {
    //Start Section for paths that define icons of files to be displayed.
    //Icon path for different types of files.
    //This will be site specific and needs to be uploaded in respective location.
    /*solrPDFimg:'/~/media/Images/R/Rolls-Royce/css/pdf-link-icon.gif',
    solrXLSimg:'/~/media/Images/R/Rolls-Royce/css/icon-xls.svg',
    solrDOCimg:'/~/media/Images/R/Rolls-Royce/css/icon-doc.svg',
    solrPPTimg:'/~/media/Images/R/Rolls-Royce/css/icon-ppt.svg',*/
    //End Section for paths that define icons of files to be displayed.
    HITLINK: 'absoluteurl',
    THUMB_URL: 'meta_thumb',
    VIDEO_URL: 'meta_video',
    IMAGE_URL: 'meta_image',
    BOD_NAME: 'meta_bodname'
};

//Solr Pagination Details Configuration.
//By Default we have configured for LOAD MORE view.
var SolrPaginationConfig = {
    //Number of documents / results to be shown in a single hit.
    HITSPERPAGE: 15,
    PAGESIZE: 0,
    CURRENTPAGE: 0
};

//Solr Boosting Configuration.
var SolrBoostingConfig = {
    //If enabled sorting will be done by using edismax functionality of solr search.
    //If disabled sorting will be done by publish date / score (relevancy)
    ENABLEBOOSTING: true
};

//Solr Boosting Details Configuration.
var SolrBoosting = [
    ["meta_searchkeywords_txt_" + SolrGlobalConfig.LANGUAGE, "100000000"],
    ["title_txt_" + SolrGlobalConfig.LANGUAGE, "90000"],
    ["titleh1_txt_" + SolrGlobalConfig.LANGUAGE, "80000"],
    ["description_txt_" + SolrGlobalConfig.LANGUAGE, "70000"]
    /*,
      ["host:investis-sales-demo-v2.prod-euw1.investis.com", "10000000000"]*/
];

var TEMPLATES;
/*!---- solr-search-global-----*/
//Start Section for Gloabal variables with static values

//Do not change the values of below variable untill required. These values will be common for all clients.
//Document ID
var HITID = 'id';
//Title field of HTML. This will be displayed as heading in each respective result.
var HITTITLE = 'title';
//H1 Title field of HTML. If required this can be displayed in each respective result.
var HITTITLEH1 = 'titleh1';
//Meta description of HTML. If required this can be displayed in each respective result.
var METADESCRIPTIONBOAST = 'description_txt_' + SolrGlobalConfig.LANGUAGE;
//Text field of HTML. This will be displayed as search text in each respective result.
var HITBODY = 'text';
//Field name for data of publish.
var HITPUBLISHDATE = "header_date_publish-date";
//Field name that will used for sort the results.
//By default it will be on pulish date.
//There will be two options for this value header_date_publish-date (i.e publish date) / score (i.e relevancy)
var SORTBY = "header_date_publish-date";
var submitClicked = false;
//To show the file size that will be calculated and stored in below field.
var FILE_SIZE = "metanum_filesize";
var monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
var AUTOSEARCH_DELAY = 5;
//Show description text only if it exceeds the below value.
var MINDESCRIPTIONLENGTH = 5;
//Start section for highlighting text in result
var HL = true;
var HL_FL = SolrBoostingConfig.METADESCRIPTIONBOAST + SolrGlobalConfig.LANGUAGE + ",text";
var HL_SIMPLE_PRE = '%3Cb%3E';
var HL_SIMPLE_POST = '%3C%2Fb%3E';
var HL_SNIPPETS = 1;
var HL_FRAGSIZE = 320;
//End section for highlighting text in result

//End Section for Gloabal variables with static values
/*!---- solr-search-helper-functions-----*/
//EVENTS - START
function hashchange(event) {
    jQuery('#solrstrap-hits div[offset="0"]').loadSolrResults(getURLParam('q'), getURLParamArray('fq'), 0);
    $j('.loader').show();
}

function handle_submit(event) {
    var q = encodeURIComponent($j.trim($j('#solrstrap-searchbox').val()));
    var queryType = $j('input[name=querytype]:radio:checked').val();
    if (q !== '') {
        submitClicked = true;
        CURRENTPAGE = 0;
        $j.bbq.pushState({
            'queryType': queryType,
            'q': q,
            'keywordtracking': "1"
        });
    }
    return false;
}

function handle_radio(event) {
    var q = encodeURIComponent($j.trim($j('#solrstrap-searchbox').val()));
    var queryType = $j('input[name=querytype]:radio:checked').val();
    if (q !== '') {
        CURRENTPAGE = 0;
        $j.bbq.pushState({
            'queryType': queryType,
            'q': q,
            'keywordtracking': "1"
        });
    }
    return false;
}

function sortchange(event) {
    if (getURLParam("q") !== '') {
        CURRENTPAGE = 0;
        $j.bbq.pushState({
            'sort': this.value + ' desc'
        });
    }
    return false;
}

function ExecuteRangeQuery() {
    var fromdate = $j.datepicker.formatDate('yy-mm-dd', $j("#startDate").datepicker('getDate'));
    var todate = $j.datepicker.formatDate('yy-mm-dd', $j("#endDate").datepicker('getDate'));
    if (todate != "" || fromdate != "") {
        $j('#filterPublishDate').attr('disabled', false);
        var rangequery = "[" + fromdate + "T00:00:00.00Z TO " + todate + "T23:59:59.999Z]";
        rangequery = HITPUBLISHDATE + ":" + rangequery;
        var fq = getURLParamArray("fq");
        //Remove publishdate and add the new one as at a time only one section will be selected
        for (var i = fq.length - 1; i >= 0; i--) {
            if (fq[i].indexOf(HITPUBLISHDATE + ":") > -1) {
                fq.splice(i, 1);
            }
        }
        // check if it already exists...
        var existing = $j.grep(fq, function(elt, idx) {
            return decodeURIComponent(elt) === rangequery;
        });
        console.log(fq);
        if (existing.length === 0) {
            fq.push(rangequery);
            CURRENTPAGE = 0;
            $j.bbq.pushState({
                'fq': fq
            });
        }
        return false;
    } else {
        $j('#filterPublishDate').attr('disabled', false);
    }
}
//EVENTS - END


//HELPER FUNCTIONS - START
//get the fqs from querystring and pass to handler in required format
function getProperFilterQuery(fq, excludeTabfq) {
    var fqobjs = [];
    var otpfqobjs = [];
    var clientObj = "client:" + SolrGlobalConfig.CLIENT;
    fqobjs.push(clientObj);
    if (fq !== undefined && fq.length > 0) {
        for (var i = 0; i < fq.length; i++) {
            //change the publish date title in querystring to range query
            var strRegExPattern = '^' + HITPUBLISHDATE + ':(.*)';
            var m = fq[i].match(new RegExp(strRegExPattern, 'i'));
            //When section tab is clicked then dont change the result of other tabs
            if (excludeTabfq) {
                strRegExPattern = '^' + SolrTabsConfig.TAB_METATAG + ':(.*)';
                m = fq[i].match(new RegExp(strRegExPattern, 'i'));
                if (m) {
                    //Dont add to final fqobjs
                    continue;
                }
            }
            //in case of otpcategories put an OR condition
            strRegExPattern = '^otpcatname:(.*)';
            m = fq[i].match(new RegExp(strRegExPattern, 'i'));
            if (m) {
                otpfqobjs.push(fq[i]);
                continue;
            }
            fqobjs.push(fq[i]);
        }
    }
    if (otpfqobjs.length > 0) {
        otpfqobjs = "(" + otpfqobjs.join(" OR ") + ")";
        fqobjs.push(otpfqobjs);
    }
    return fqobjs.join(" AND ");
}
//Set the active css for the current tab and remove it from previous tab
function setactivetab(fq) {
    $j("[data-metacontent='*']").addClass('active');
    if (fq != undefined) {
        for (var i = fq.length - 1; i >= 0; i--) {
            var strRegExPattern = '^' + SolrTabsConfig.TAB_METATAG + ':(.*)';
            var m = fq[i].match(new RegExp(strRegExPattern, 'i'));
            if (m) {
                $j('.tab-links li > a.active').removeClass('active');
                $j("[data-metacontent=" + m[1] + "]").addClass('active');
                break;
            }
        }
    }
}
//translates the ropey solr facet format to a more sensible map structure


function makeNavsSensible(navs) {
    var newNav = {};
    for (var i = 0; i < navs.length; i += 2) {
        if (SolrFacetingConfig.FACETS_ALIAS.hasOwnProperty(navs[i]))
            newNav[navs[i]] = SolrFacetingConfig.FACETS_ALIAS[navs[i]] + ": " + navs[i + 1];
        else
            newNav[navs[i]] = navs[i] + ": " + navs[i + 1];
    }
    return newNav;
}

function makeTabsSensible(navs) {
    var newNav = {};
    for (var i = 0; i < SolrTabsConfig.TABS.length; i++) {
        for (var j = 0; j < navs.length; j += 2) {
            if (SolrTabsConfig.TABS[i] == navs[j]) {
                newNav[navs[j]] = navs[j + 1];
                break;
            }
            newNav[SolrTabsConfig.TABS[i]] = 0;
        }
    }
    return newNav;
}
//utility function for grabbling URLs
function getURLParam(name) {
    var ret = jQuery.bbq.getState(name);
    return ret;
}

//function to generate an array of URL parameters, where there are likely to be several params with the same key
function getURLParamArray(name) {
    var ret = jQuery.bbq.getState(name) || [];
    if (typeof(ret) == 'string')
        ret = [ret];
    return ret;
}

//utility function that checks to see if an element is onscreen
function isScrolledIntoView(elem) {
    var docViewTop = $j(window).scrollTop();
    var docViewBottom = docViewTop + $j(window).height();
    var elemTop = $j(elem).offset().top;
    var elemBottom = elemTop + $j(elem).height();
    return ((elemBottom <= docViewBottom) && (elemTop >= docViewTop));
}

//optionally convert a string array to a string, by concatenation
function array_as_string(array_or_string) {
    var ret = '';
    if (typeof(array_or_string) == 'string') {
        ret = array_or_string;
    } else if (typeof(array_or_string) == 'object' &&
        array_or_string.hasOwnProperty('length') &&
        array_or_string.length > 0) {
        ret = array_or_string.join(" ... ");
    }
    //ret = array_or_string;
    return ret;
}

//normalize a string with respect to whitespace:
//1) Remove all leadsing and trailing whitespace
//2) Replace all runs of tab, space and &nbsp; with a single space
function normalize_ws(string) {
    return string.replace(/^\s+/, '')
        .replace(/\s+$j/, '')
        .replace(/(?: |\t|&nbsp;|&#xa0;|\xa0)+/g, ' ');
}


//get field from result for document i, optionally replacing with
//highlit version
function get_maybe_highlit(result, i, field) {
    var res = result.response.docs[i][field];
    if (HL) {
        var id = result.response.docs[i][HITID];
        var hl_map = result.highlighting[id];
        if (hl_map.hasOwnProperty(field)) {
            res = hl_map[field];
        }
    }
    return array_as_string(res);
}

//get file size.
function bytesToSize(bytes) {
    var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
    if (bytes == 0) return '0 Byte';
    var i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));
    return Math.round(bytes / Math.pow(1024, i), 2) + ' ' + sizes[i];
};

//handler for navigator selection
function add_nav(event) {
    var whence = event.target;
    var navname = $j(whence).closest("div.facet").children("span.nav-title").data("facetname");
    var navvalue = "";
    var fq = getURLParamArray("fq");
    if (whence.type == "select-one") {
        //Remove otpcatname and add the new one as at a time only one section will be selected
        for (var i = fq.length - 1; i >= 0; i--) {
            if (fq[i].indexOf("otpcatname:") > -1) {
                fq.splice(i, 1);
            }
        }
        if (whence.value != null && whence.value != "")
            navvalue = whence.value;
    } else {
        if ($j(whence).attr("data-key"))
            navvalue = $j(whence).attr("data-key");
        else
            navvalue = $j(whence).text();
    }
    if (navvalue === '') {
        navvalue = event.target.value;
    }
    var newnav = navname + ':"' + encodeURIComponent(navvalue.replace(/([\\\"])/g, "\\$j1")) + '"';
    console.log(newnav);
    //var fq = getURLParamArray("fq");
    // check if it already exists...
    var existing = $j.grep(fq, function(elt, idx) {
        return decodeURIComponent(elt) === (newnav);
    });
    if (existing.length === 0) {
        if (navvalue != '') {
            fq.push(newnav);
        }
        CURRENTPAGE = 0;
        $j.bbq.pushState({
            'fq': fq
        });
    }
    return false;
}

//handler for navigator de-selection
function del_nav(event) {
    var whence = event.target;
    if ($j(whence).hasClass("close")) {
        whence = $j(whence).next();
    }
    var text = $j(whence).text();
    if (text != null && text == "Publish Date") {
        $j('#filterPublishDate').attr('disabled', true);
        $j("#startDate").datepicker('setDate', null);
        $j("#endDate").datepicker('setDate', null);
    }

    var filter = $j(whence).data("filter");
    var fq = getURLParamArray("fq");

    if (filter.indexOf("otptoolname:") > -1) {
        for (var i = fq.length - 1; i >= 0; i--) {
            if (fq[i].indexOf("otpcatname:") > -1) {
                fq.splice(i, 1);
            }
        }
    }

    fq = $j.grep(fq, function(elt, idx) {
        return decodeURIComponent(elt) === decodeURIComponent(filter);
    }, true);

    CURRENTPAGE = 0;
    $j.bbq.pushState({
        "fq": fq
    });
    return false;
}

function tab_click(event) {
    OTPCAT = [];
    $j('input[name=chkOTPCat]').prop("checked", false);
    var whence = event.target;
    var navname = $j(whence).closest("div.tab-links").children("span.nav-title").data("facetname");
    var navvalue = $j(whence).data("metacontent");
    var fq = getURLParamArray("fq");
    //Remove meta_section and add the new one as at a time only one section will be selected
    for (var i = fq.length - 1; i >= 0; i--) {
        if (fq[i].indexOf(SolrTabsConfig.TAB_METATAG + ":") > -1 || fq[i].indexOf("otpcatname:") > -1) {
            fq.splice(i, 1);
        }
    }
    var newnav;
    if (navvalue.indexOf("*") > -1) {
        newnav = '';
    } else {
        newnav = navname + ':"' + navvalue.replace(/([\\\"])/g, "\\$j1") + '"';
    }
    // check if it already exists...
    var existing = $j.grep(fq, function(elt, idx) {
        return decodeURIComponent(elt) === (newnav);
    });
    if (existing.length === 0) {
        if (newnav != "") {
            fq.push(newnav);
        }
        CURRENTPAGE = 0;
        $j.bbq.pushState({
            'fq': fq
        });
    }
    return false;
}

function getUrlParameter(name) {
    name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
    var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
    var results = regex.exec(location.href);
    return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
}


function buildBoostingQuery(sortvalue, ret, q) {
    var boostingquery = "";
    ret["defType"] = "edismax";
    $j.each(SolrBoosting, function(key, value) {
        if (value[0].indexOf('host') === 0)
            boostingquery += value[0] + "^" + value[1];
        else
            boostingquery += value[0] + ":" + q + "^" + value[1];
    });
    ret["bq"] = boostingquery;

    if (sortvalue === "header_date_publish-date")
        ret["bf"] = "recip(abs(ms(NOW/HOUR," + sortvalue + ")),3.16e-11,1000000000000,1)";
}

//HELPER FUNCTIONS - END
/*!---- solr-search-custom-----*/
function closeAnimationSearchTextbox() {
    $j(".searchbox-wrapper").removeClass("active").css('overflow', 'hidden');
    $j(".searchbox-wrapper").animate({
        width: 0
    }, 400, function() {
        $j("#searchTextboxContainer input").animate({
            paddingLeft: "0px",
            paddingRight: "0px"
        });
    });
}

function getScrollbarWidth() {
    var outer = document.createElement("div");
    outer.style.visibility = "hidden";
    outer.style.width = "100px";
    document.body.appendChild(outer);

    var widthNoScroll = outer.offsetWidth;
    // force scrollbars
    outer.style.overflow = "scroll";

    // add innerdiv
    var inner = document.createElement("div");
    inner.style.width = "100%";
    outer.appendChild(inner);

    var widthWithScroll = inner.offsetWidth;

    // remove divs
    outer.parentNode.removeChild(outer);

    return widthNoScroll - widthWithScroll;
}

function siteTabs() {
    var TotalLiwidth = 0;
    var TabsWidth = $j('.solr-search-tab').width();

    $j('ul.tab-links-main').show();
    $j('ul.tab-links-main > li').each(function() {

        TotalLiwidth += $j(this).width();
    });

    if (TotalLiwidth >= TabsWidth) {
        $j('.solr-search-tab').addClass('isDropdown');
        $j('ul.tab-links-main').hide();
        $j('.solr-search-tab-mobiDropdown').show();
    } else {
        $j('.solr-search-tab').removeClass('isDropdown');
        $j('ul.tab-links-main').show();
        $j('.solr-search-tab-mobiDropdown').hide();
    }

}

function handle_submit2(event) {

    if ($j('#searchTextbox').val().length <= 0) {
        return false;
    }

    $j('#solrstrap-searchbox').val($j('#searchTextbox').val());
    $j('#searchTextbox1').val($j('#searchTextbox').val());
    $j('#submitButton').click();

    $j('#solrstrap-searchbox').focus();

    return false;
}

function handle_submit3(event) {

    $j("#solrstrap-searchbox").val($j('#searchTextbox1').val());
    $j("#searchTextbox").val($j('#searchTextbox1').val());
    $j('#searchButton1').trigger('click');

    return false;
}


$j(window).load(function() {

    /**-- Document click Search Starts --**/
    $j(document).on("click", function(event) {
        if (!$j(event.target).closest('.header--search').length && !$j(event.target).closest('.header--searchbox').length) {
            $j(".header--searchbox").slideUp();
        }
    });
    /**-- Document click Search Ends --**/

    /*----------- search close button ---------*/
    $j("#searchButtonContainer,#searchButtonContainer1").click(function() {
        closeAnimationSearchTextbox();
    });
    /*----------- search close button ---------*/

    /*------- header search -----*/
    $j(document).on("click", ".icon-search", function() {
        if (!$j(".searchbox-wrapper").hasClass('active')) {
            $j(".searchbox-wrapper").animate({
                width: "430px"
            }, 400, function() {
                $j("#searchTextboxContainer input").animate({
                    paddingLeft: "35px",
                    paddingRight: "30px"
                });
                $j(".searchbox-wrapper").addClass("active").css('overflow', 'visible');
                $j('#searchTextbox').val('').focus();
            });
        } else {
            closeAnimationSearchTextbox();
        }
    });

    $j(document).on("click", function(event) {
        if (!$j(event.target).closest('.searchbox-wrapper').length && !$j(event.target).closest('.icon-search').length) {
            closeAnimationSearchTextbox();
        }
    });
    /*----- header search ends ----*/


    if (window.location.href.indexOf('/site-services/search-results') > 0) {
        $j("#searchTextbox").val($j('#solrstrap-searchbox').val());
        $j("#searchTextbox1").val($j('#solrstrap-searchbox').val());
    }

    $j('.solr-search-tab-mobiDropdown').text($j('#solrstrap-tabs .solr-search-tab ul li a.active').text());


});

$j(document).ajaxComplete(function() {

    $j('.solr-search-tab-mobiDropdown').text($j('#solrstrap-tabs .solr-search-tab ul li a.active').text());
    setTimeout(function() {
        if ($j('#solrstrap-tabs .solr-search-tab').length > 1) {
            $j('#solrstrap-tabs .solr-search-tab:first-child').remove();
            $j('.solr-search-tab-mobiDropdown').text($j('#solrstrap-tabs .solr-search-tab ul li a.active').text());
        }
    }, 600);

});

$j(document).ready(function() {

    $j('#searchButton').click(handle_submit2);
    $j('#searchButton1').click(handle_submit3);

    $j("#SearchButtonContainer #searchButton").click(function() {
        if ($j('#searchTextbox').val().indexOf("<script>") > -1) {
            document.location.href = "/error-page";
        }
    });

    $j("#searchTextboxContainerSolr #submitButton").click(function() {
        if ($j('#solrstrap-searchbox').val().indexOf("<script>") > -1) {
            document.location.href = "/error-page";
        }
    });


    $j(document).on('click', '.solr-search-tab-mobiDropdown', function() {
        if ($j(this).parent().hasClass('active')) {
            $j(this).parent().removeClass('active');
            $j(this).parent().find('ul').slideUp();
        } else {
            $j(this).parent().addClass('active');
            $j(this).parent().find('ul').slideDown();
        }
    });

    $j(document).on('click', '.showAdvSearchMobi', function() {
        if ($j(this).parent().hasClass('active')) {
            $j(this).parent().removeClass('active');
            $j(this).parent().find('.solarLeftSide').slideUp();
        } else {
            $j(this).parent().addClass('active');
            $j(this).parent().find('.solarLeftSide').slideDown();
        }
    });

});